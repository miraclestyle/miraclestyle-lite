function Steady(e){if(!e)throw new Error("missing options");if(!e.handler)throw new Error("missing handler parameter");this.scrollElement=e.scrollElement||window,this.conditions=e.conditions||{},this.handler=e.handler,this.values={},this.tracked={},this.success=!1,this.throttleVal=e.throttle||100,this.processing=!1,this.stopped=!1,this._parse(),"pageYOffset"in this.scrollElement?(this._addBottom(),this._addTop()):(this._addBottomEl(),this._addTopEl(),this._addScrollLeft()),this._addWidth(),this._onScroll()}function injector(e){return $(document).injector().get(e)}function $apply(){console.time("$apply");var e=injector("$rootScope");e.$apply(),console.timeEnd("$apply")}function msieversion(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var r=e.indexOf("rv:");return parseInt(e.substring(r+3,e.indexOf(".",r)),10)}var i=e.indexOf("Edge/");return i>0?parseInt(e.substring(i+5,e.indexOf(".",i)),10):!1}window.ng||(window.ng=function(e){return e}),window.getTracker=function(){return!window.ga||window.tracker&&!window.tracker._fake?window.ga||(window.tracker={_fake:!0,send:function(){console.log("Tracker not ready...",arguments)}}):window.tracker=window.ga.create(window.GOOGLE_ANALYTICS_TRACKING_ID,"auto"),window.tracker},window.ENGINE={SERVER:{URL:"https://themiraclestyle-testing-site.appspot.com"},CORDOVA:{ACTIVE:"cordova"in window},CHROMEAPP:{ACTIVE:window.chrome&&chrome.app&&chrome.app.runtime},DESKTOP:{ACTIVE:!0}},window.ENGINE.DESKTOP.ACTIVE=!(window.ENGINE.CHROMEAPP.ACTIVE||window.ENGINE.CORDOVA.ACTIVE),window.getLocalStorage=function(){return window.ENGINE.CHROMEAPP.ACTIVE?window.ENGINE.CHROMEAPP.ACTIVE?(window._chromeLocalStorage||(window._chromeLocalStorage={_data:{},setItem:function(e,t){return this._data[e]=String(t)},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0},removeItem:function(e){return delete this._data[e]},clear:function(){return this._data={}}}),window._chromeLocalStorage):void 0:window.localStorage},function(){var e=window.getLocalStorage();e&&e.getItem("version")!==window.VERSION&&(e.clear(),e.setItem("version",window.VERSION))}(),Steady.prototype.addCondition=function(e,t){this.conditions[e]=t,this._parse()},Steady.prototype.removeCondition=function(e){delete this.conditions[e],this._parse()},Steady.prototype.addTracker=function(e,t){this.tracked[e]={cb:t,name:e}},Steady.prototype._addBottom=function(){this.addTracker("bottom",function(e){var t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);return t-(e.pageYOffset+e.innerHeight)})},Steady.prototype._addTop=function(){this.addTracker("top",function(e){return e.pageYOffset})},Steady.prototype._addBottomEl=function(){this.addTracker("bottom",function(e){var t=Math.max(e.scrollHeight,e.offsetHeight);return t-(e.scrollTop+e.offsetHeight)})},Steady.prototype._addTopEl=function(){this.addTracker("top",function(e){return e.scrollTop})},Steady.prototype._addScrollLeft=function(){this.addTracker("scrollLeft",function(e){return e.scrollLeft})},Steady.prototype._addWidth=function(){this.addTracker("width",function(e){return e.innerWidth})},Steady.prototype._parse=function(){this._parsed={},this._wantedTrackers=[],this._parsedMax={},this._parsedMin={};for(var e in this.conditions)if(this.conditions.hasOwnProperty(e)){var t=e.substr(0,4);switch(t){case"min-":this._wantedTrackers.push(e.substr(4,e.length)),this._parsedMin[e.substr(4,e.length)]=this.conditions[e];break;case"max-":this._wantedTrackers.push(e.substr(4,e.length)),this._parsedMax[e.substr(4,e.length)]=this.conditions[e];break;default:this._wantedTrackers.push(e),this._parsed[e]=this.conditions[e]}}},Steady.prototype._check=function(){var e=[];for(var t in this.values)this._parsed.hasOwnProperty(t)&&e.push(this._parsed[t]==this.values[t]),this._parsedMin.hasOwnProperty(t)&&e.push(this._parsedMin[t]<=this.values[t]),this._parsedMax.hasOwnProperty(t)&&e.push(this._parsedMax[t]>=this.values[t]);if(e.length&&-1==e.indexOf(!1)){this.processing=!0;var n=this._done.bind(this);window.requestAnimationFrame(this.handler.bind(this,this.values,n))}},Steady.prototype._done=function(){this.processing=!1},Steady.prototype._onScroll=function(){this._onScrollHandler=this._throttledHandler(),this.scrollElement.addEventListener("scroll",this._onScrollHandler,!1)},Steady.prototype._throttledHandler=function(){var e=this;return this.throttle(function(t){if(e._wantedTrackers.length&&!e.processing){for(var n=0;n<e._wantedTrackers.length;n++)e.tracked[e._wantedTrackers[n]]&&(e.values[e._wantedTrackers[n]]=e.tracked[e._wantedTrackers[n]].cb(e.scrollElement||window));window.requestAnimationFrame(e._check.bind(e))}},this.throttleVal)},Steady.prototype.stop=function(){this.stopped||(this.scrollElement.removeEventListener("scroll",this._onScrollHandler,!1),this.stopped=!0)},Steady.prototype.resume=function(){this.stopped&&this._onScroll(),this.stopped=!1},Steady.prototype.throttle=function(e,t){var n,r=!0;return function(){var i=this,a=arguments;return r?(e.apply(i,a),void(r=!1)):void(n||(n=!0,setTimeout(function(){e.apply(i,a),n=!1},t)))}},"object"==typeof module&&module.exports&&(module.exports=Steady),function(){function e(e){var t,r,i,a,o,s;for(i=e.length,r=0,t="";i>r;){if(a=255&e.charCodeAt(r++),r==i){t+=n.charAt(a>>2),t+=n.charAt((3&a)<<4),t+="==";break}if(o=e.charCodeAt(r++),r==i){t+=n.charAt(a>>2),t+=n.charAt((3&a)<<4|(240&o)>>4),t+=n.charAt((15&o)<<2),t+="=";break}s=e.charCodeAt(r++),t+=n.charAt(a>>2),t+=n.charAt((3&a)<<4|(240&o)>>4),t+=n.charAt((15&o)<<2|(192&s)>>6),t+=n.charAt(63&s)}return t}function t(e){var t,n,i,a,o,s,c;for(s=e.length,o=0,c="";s>o;){do t=r[255&e.charCodeAt(o++)];while(s>o&&-1==t);if(-1==t)break;do n=r[255&e.charCodeAt(o++)];while(s>o&&-1==n);if(-1==n)break;c+=String.fromCharCode(t<<2|(48&n)>>4);do{if(i=255&e.charCodeAt(o++),61==i)return c;i=r[i]}while(s>o&&-1==i);if(-1==i)break;c+=String.fromCharCode((15&n)<<4|(60&i)>>2);do{if(a=255&e.charCodeAt(o++),61==a)return c;a=r[H4]}while(s>o&&-1==a);if(-1==a)break;c+=String.fromCharCode((3&i)<<6|a)}return c}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);window.btoa||(window.btoa=e),window.atob||(window.atob=t)}(),Array.prototype.insert=function(e,t){this.splice(e,0,t)},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return-1;var a=+t||0;if(Math.abs(a)===1/0&&(a=0),a>=i)return-1;for(n=Math.max(a>=0?a:i-Math.abs(a),0);i>n;){if(n in r&&r[n]===e)return n;n++}return-1}),function(){"use strict";Array.prototype.iremove=function(e){for(var t=this.length;t--;)e(this[t],t)&&this.splice(t,1)},Array.prototype.remove=function(e){var t=this.indexOf(e);return-1!==t&&this.splice(t,1),this},Array.prototype.empty=function(e){return this.splice(0,this.length),this},Array.prototype.contains=function(e,t){if(angular.isArray(e)){var n=[];return angular.forEach(e,function(t){n.push(this.indexOf(e)>-1)}),t?_.all(n):_.some(n)}return this.indexOf(e)>-1},Array.prototype.equals=function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0,n=this.length;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},Array.prototype.compare=function(e){if(!e)return!1;if(this.length!==e.length)return!1;var t,n=this.length;for(t=0;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].compare(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},Array.prototype.prepend=function(e){var t=this;angular.forEach(e,function(e){t.unshift(e)})},Array.prototype.extend=function(e){var t=this;angular.forEach(e,function(e){t.push(e)})}}(),function(){"use strict";window.console||(window.console={}),angular.forEach(["log","error","trace","debug","info"],function(e){window.console[e]||(window.console[e]=angular.noop)});var e=window.ENGINE.DESKTOP.ACTIVE?window.location.protocol+"//"+window.location.host:window.ENGINE.SERVER.URL,t={debug:window.DEBUG,host:e,tracker:{},modules:["config","ngAnimate","ngMessages","ui.router","ui.sortable","ui.inflector","ngSanitize","ngDragDrop","timer","googlechart","btford.markdown","pasvaz.bindonce","material.core","material.core.gestures","material.components.button","material.components.checkbox","material.components.content","material.components.simpledialog","material.components.input","material.components.radioButton","material.components.sidenav","material.components.swipe","material.components.textField","material.components.toolbar"],api:{endpoint:{path:e+"/api/endpoint"},modelsMeta:e+"/api/model_meta"},date:{format:"d MMM yyyy, HH:mm"},toolbar:{titles:{}},snackbar:{messages:{}},misc:{text:{}},subheaders:{},fields:{validationErrors:{},help:{},label:{},translateChoices:{},emptyHelp:{}},sellerPluginName:{},labels:{},modals:{confirmations:{},alerts:{}},defaultImage:"client/dist/static/240x240_placeholder.png",defaultLogo:"client/dist/static/720x300_placeholder.png",defaultCatalogCover:"client/dist/static/1920x2496_placeholder.png",grid:{maxWidth:240,minWidth:180,maxHeight:312,margin:1},emptyHelp:{},imageSizes:_.range(50,1650,50),social:{facebook:{id:"125702284258635"}},admin:{listTemplates:{},menu:[{name:"Accounts",kind:11},{name:"Catalogs",kind:31},{name:"Orders",kind:"34"}],listViewDirective:{31:!0,11:!0,34:!0},listTitles:{31:"catalogs",11:"users",34:"orders"}}};t.debug&&(window._GLOBAL_CONFIG=t),angular.module("config",["ng"]).constant("GLOBAL_CONFIG",t).config(["$httpProvider","$locationProvider","$compileProvider",function(e,t,n){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",t.hashPrefix("!");var r=window.ENGINE.DESKTOP.ACTIVE?!0:{enabled:!0,requireBase:!1};t.html5Mode(r)}]),angular.module("app",t.modules)}(),$(function(){"use strict";var e=$("<div>").css({height:1,overflow:"scroll"}).appendTo("body"),t=$("<div>").css({height:2}).appendTo(e);window.SCROLLBAR_WIDTH=e.width()-t.width(),Modernizr.touch&&(window.SCROLLBAR_WIDTH=0),e.remove()}),function(){"use strict";function e(e){return window.ENGINE.CORDOVA.ACTIVE?document.addEventListener("deviceready",function(){window.open=cordova.InAppBrowser.open,$(e)},!1):$(document).ready(e)}function t(){function e(e,n){return Modernizr[e]?!0:(n||t.push(e),!1)}var t=[],n=["borderradius",["flexbox","flexboxlegacy"],"textshadow","csstransforms3d","csstransforms","fontface","opacity","history","csstransitions","rgba","localstorage","cssanimations"];return angular.forEach(n,function(n){if(angular.isArray(n)){var r=!1,i=[];angular.forEach(n,function(t){e(t,!0)?r=!0:i.push(t)}),r||t.extend(i)}else e(n)}),t.length&&window.getTracker().send("event","Browser Incompatibility","check",t.join(", ")),!t.length}e(function(){if(!t())return $(".loading-splash").find(".progress").hide(),void $("#browser-sucks").show();var e=function(e){if(-1!==e.status){var t=confirm("Could not start application. Reload your browser and try again?");t&&window.location.reload(!0)}},n=angular.injector(["config"]),r=n.get("$http"),i=n.get("$q"),a=n.get("GLOBAL_CONFIG"),o=[r.get(a.api.modelsMeta),r.get(a.api.endpoint.path+"?action_id=current_account&action_model=11")];i.all(o).then(function(t){var n=t[0].data,r=t[1].data;window.MODELS_META=n,window.CURRENT_ACCOUNT=r.entity,n&&n.errors||r&&r.errors?e():angular.bootstrap(document,["app"],{strictDi:!1})},e)})}(),window.DEBUG,function(){"use strict";angular.module("app").factory("errorHandling",["$modal","snackbar","GLOBAL_CONFIG","modals",function(e,t,n,r){var i=n.backendErrorHandling,a={translate:function(e,t,n){var r=i[e];return angular.isString(r)?r:angular.isFunction(r)?r(t,n):t},modal:function(e){r.alert(null,{title:"Error while performing an action",templateUrl:"core/misc/errors.html",text:{primary:"Got it"},errors:function(){var t=[];return angular.forEach(e,function(e,n){t.push([n,a.translate(n,e)])}),t}()})},snackbar:function(e,n,r){if(e.traceback)return t.showK("errorWithTraceback");var i,o=function(){var t=[];return angular.forEach(e,function(e,n){t.push(a.translate(n,e,r))}),t}().join("\n");n&&(i=n(e),i!==!1&&(o=i)),t.show(o)}};return a}]).factory("helpers",["GLOBAL_CONFIG",function(e){var t={callable:function(e){return angular.isFunction(e)?e:angular.noop},track:{noop:{},events:{},exception:function(){if(window.getTracker()){var e=_.toArray(arguments);return e.unshift("exception"),window.getTracker().send.apply(window.getTracker(),e)}},pageview:function(t){var n=t;window.getTracker()&&(angular.isArray(t)||(n=_.toArray(arguments)),e.debug&&console.log("Tracking pageview",n),n.unshift("pageview"),window.getTracker().send.apply(window.getTracker(),n))},proxyLabelToEvents:function(e,t){var n=angular.copy(e);return angular.forEach(n,function(e,r){angular.isFunction(e)&&(n[r]=function(){return e(t)})}),n},event:function(t){var n=t;window.getTracker()&&(angular.isArray(t)||(n=_.toArray(arguments)),n.unshift("event"),window.getTracker().send.apply(window.getTracker(),n),e.debug&&console.log("Tracking event",n))}},endpoint:{isResponseError:function(e){return angular.isString(e)||200!==e.status||e.data.errors},isResponseHttpError:function(e){return angular.isString(e)||200!==e.status}},alwaysObject:function(e){return angular.isObject(e)?e:{}},splitLines:function(e){return e.match(/[^\r\n]+/g)},addslashes:function(e){return e.toString().replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},resolveDefaults:function(e,n){return n=t.alwaysObject(n),angular.forEach(e,function(e,t){angular.isUndefined(n[t])||(n[t]=e)}),n},setProperty:function(e,t,n){var r,i,a=t;return angular.isArray(t)||(t=t.split("."),a=t),i=_.last(a),a=a.slice(0,a.length-1),a.length?(r=this.getProperty(e,a),void(r[i]=n)):void(e[t.join("")]=n)},forceSetProperty:function(e,t,n){var r,i,a=e;return angular.isArray(t)||(t=t.split(".")),1===t.length?void(e[t.join("")]=n):void angular.forEach(t,function(e,o){r=a,a=a[e],i=o===t.length-1,angular.isUndefined(a)&&!i&&(a={},r[e]=a),i&&(r[e]=n)})},getProperty:function(e,t,n){var r=t;return angular.isArray(r)||(r=t.split(".")),angular.forEach(r,function(t){try{e=e[t]}catch(r){return n}}),angular.isUndefined(e)?n:e},extendDeep:function(e){return angular.forEach(arguments,function(n){n!==e&&angular.forEach(n,function(n,r){e[r]&&angular.isObject(e[r])?t.extendDeep(e[r],n):e[r]=n})}),e},extend:function(e){return angular.forEach(arguments,function(t){t!==e&&angular.forEach(t,function(t,n){e[n]=t})}),e},merge:function(e){return angular.forEach(arguments,function(t){t!==e&&angular.forEach(t,function(t,n){angular.isDefined(e[n])||(e[n]=t)})}),e},mergeDeep:function(e){return angular.forEach(arguments,function(n){n!==e&&angular.forEach(n,function(n,r){e[r]&&angular.isObject(e[r])?t.mergeDeep(e[r],n):angular.isDefined(e[r])||(e[r]=n)})}),e},update:function(e,n,r){angular.isDefined(r)?angular.forEach(r,function(r){var i=t.getProperty(n,r);t.setProperty(e,r,i)}):$.extend(e,n)}};return e.debug&&(window._helpers=t),t}]).factory("endpoint",["$http","generalLocalCache","GLOBAL_CONFIG","helpers","modelsUtil","$rootScope","$q","$cacheFactory","$injector",function(e,t,n,r,i,a,o,s,c){var l,u=s("endpointOnlyInMemory"),d=function(e){return void 0===e||"local"===e?t:"memory"===e?u:void console.error("Invalid type of cache provided: "+e)},p=function(e,t,n,i){i=r.alwaysObject(i),n=r.alwaysObject(n);var a=c.get("currentAccount");return n._csrf=a._csrf,[angular.extend({action_model:t,action_id:e},n),i]},f="endpoint_",g=[];return g.push(u),g.push(t),l={getCache:function(e){var t=null;return angular.forEach(g,function(n){t||(t=n.get(f+e))}),t},setCache:function(e,n,r){var i=[];r&&"memory"!==r&&"all"!==r||i.push(u),("local"===r||"all"===r)&&i.push(t),angular.forEach(i,function(t){t.put(f+e,n)})},removeCache:function(e){return angular.isDefined(e)?angular.isArray(e)?(angular.forEach(e,function(e){l.removeCache(e)}),!0):void angular.forEach(g,function(t){t.remove(f+e)}):(angular.forEach(g,function(e){e.removeAll()}),!0)},url:n.api.endpoint.path,cached:function(e,t,n,r,i){var a,s,c=d(i?i.cacheType:void 0),u=f+e,p=c.get(u),g=p&&angular.isFunction(p.then);return g?p:void 0===p?(s=l[i.method?i.method.toLowerCase():"post"](t,n,r,i),s.then(function(e){c.put(u,e)},function(){c.remove(u)}),c.put(u,s),s):(a=o.defer(),s=a.promise,a.resolve(p),s)},post:function(t,n,r,a){var o,s=p(t,n,r,a),c={method:"POST",url:l.url};return s[0]=i.argumentsToJson(s[0]),s[1]&&angular.isString(s[1].cache)?(o=s[1].cache,s[1].cache=!1,l.cached(o,t,n,r,s[1])):(angular.extend(c,s[1]),c.data=s[0],e(c))},get:function(t,n,r,a){var o,s=p(t,n,r,a),c={params:s[0]},u={method:"GET",url:l.url};return s[0]=i.argumentsToJson(s[0]),$.extend(c,s[1]),angular.extend(u,c),u&&angular.isString(u.cache)?(o=u.cache,u.cache=!1,l.cached(o,t,n,r,c)):e(u)}},n.debug&&(window._endpoint=l),l}]).factory("generalLocalCache",["DSCacheFactory","$cacheFactory",function(e,t){function n(e,t){return t&&(t.value&&angular.isFunction(t.value.then)||angular.isObject(t.value)&&void 0!==t.value[s])?o:angular.toJson(t)}var r,i,a=t("localStoragePolyfillInMemory"),o="___undefined___",s="___in_memory_only___",c=window.getLocalStorage();return r={getItem:function(e){var t=a.get(e);return t&&angular.isObject(t)&&void 0!==t[s]&&(t=t[s]),void 0===t&&(t=c.getItem(e)),t!==o?t:void 0},setItem:function(e,t){var r;a.put(e,t),t=n(e,t);try{r=c.setItem(e,t)}catch(i){}return r},removeItem:function(e){return a.remove(e),c.removeItem(e)}},i=e("generalCache",{storageMode:"localStorage",storageImpl:r}),i.inMemory=function(e){var t={};return t[s]=e,t},i}]).run(["$http","generalLocalCache",function(e,t){e.defaults.cache=t}]).config(["$httpProvider",function(e){var t=!1;e.interceptors.push(["$rootScope","$q","$injector",function(e,n,r){var i=function(i){var a,o,s,c,l,u,d=i.data,p=void 0===i.config.normalizeEntity||i.config.normalizeEntity,f=r.get("errorHandling"),g=r.get("modelsUtil"),m=i.config.activitySpinner===!0,h=function(){e.disableUI(!1)},v=r.get("currentAccount"),y=i.config.disableUI===!0;if(m&&e.activitySpinner.stop(),-1===i.status)return f.snackbar({connection_refused:!0},void 0,i.data),y&&h(),n.reject(i);if(!t&&angular.isObject(i.data)&&void 0!==v._is_guest&&void 0!==i.data.is_guest&&i.data.is_guest!==v._is_guest&&(o=r.get("models"),s=r.get("$state"),l=r.get("$timeout"),c=r.get("snackbar"),u=!0,t=!0,o[11].actions.current_account().then(function(e){var n=e.data.entity,r="youAreNotSignedIn";v._is_guest!==n._is_guest&&($.extend(v,n),n._is_guest?i.data.errors&&s.go("home"):(s.go(s.current,{},{inherit:!0,location:!1,reload:!0}),r="loginSuccess"),l(function(){c.showK(r)})),t=!1})),!i.config.ignoreErrors||i.config.ignoreErrors>1){if(i.status>200&&(!i.config.ignoreErrors||2===i.config.ignoreErrors))return u||f.snackbar(angular.isString(i.data)?{traceback:i.data}:i.data.errors,i.config.handleError,i.data),y&&h(),n.reject(i);if(d&&d.errors&&(!i.config.ignoreErrors||i.config.ignoreErrors>2)&&(u||f.snackbar(i.data.errors,i.config.handleError,i.data),a=void 0===i.config.rejectOnErrors||i.config.rejectOnErrors===!0,d.errors.action_denied&&(a=!0),a))return y&&h(),n.reject(i)}return p&&d&&(angular.isDefined(d.entities)?g.normalizeMultiple(d.entities):angular.isDefined(d.entity)&&g.normalize(d.entity)),y&&h(),i||n.when(i)};return{response:i,responseError:i,request:function(t){var r=t.disableUI===!0,i=t.activitySpinner===!0;return r&&e.disableUI(!0),i&&e.activitySpinner.start(),t||n.when(t)}}}])}]).factory("underscoreTemplate",["$templateCache",function(e){return{get:function(t){return _.template(e.get(t))}}}]).factory("animationGenerator",function(){var e={classNamePrefix:"tmp-",prefix:function(e){return(/WebKit/.test(navigator.userAgent)?"-webkit-":"")+e},compile:function(t){var n="";return angular.forEach(t,function(t,r){n+=e.prefix(r)+": "+t+";\n"}),n},make:function(t,n){var r="@"+e.prefix("keyframes")+" "+t+" {\n";return r+=n,r+="\n} ."+e.classNamePrefix+t+"{"+e.prefix("animation-name")+":"+t+";}"},single:function(t,n){var r=_.uniqueId(),i="temporary-animator"+r,a=$("#"+i);return t+=r,a.length||(a=$("<style/>").attr("id",i),a.appendTo("head")),a.text(e.make(t,n)),{name:t,className:e.classNamePrefix+t,destroy:function(){a.remove()}}}};return e})}(),function(){"use strict";angular.module("app").config(["GLOBAL_CONFIG","$injector",function(e,t){var n={};n.guideByHost={"localhost:9982":"aiBkZXZ-dGhlbWlyYWNsZXN0eWxlLXRlc3Rpbmctc2l0ZXIsCxICMTEYgICAgID4hQkMCxICMjMiBnNlbGxlcgwLEgIzMRiAgICAgMqgCQw","themiraclestyle-testing-site.appspot.com":"asd"},e.guideKey=n.guideByHost[window.location.host],$.extend(e.modals.confirmations,{discardWithFieldsRequired:{title:"Discard changes?",message:"There are some invalid changes on the form you are trying to leave. If you discard them, the changes will not be applied and will be lost permanently.",text:{primary:"Discard"}},disconnectSignInMethod:{title:"Disconnect the identity?",message:"If this is the only sign in identity connected to your MIRACLESTYLE account, you will permanently lose access to the account and all of its data after this action is completed!",text:{primary:"Disconnect"}},removePricetagConfirm:{title:"Remove the product?",message:"The product will be permanently removed from the catalog! You will be notified once this action is completed.",text:{primary:"Remove"}},connectSignInMethod:{title:"Connect the identity?",message:"If this sign in identity is already connected to another MIRACLESTYLE account, you will have to disconnect it before you proceed with this action!",text:{primary:"Connect"}},discard:{title:"Discard unsaved changes?",message:"There are some unsaved changes on the form you are trying to close. If you discard them, the changes will be lost permanently, and the form will revert to previously saved state.",text:{primary:"Discard"}},maybeLogout:{title:"Confirm sign out",message:"Are you sure you want to sign out?",text:{primary:"Sign out"}},deleteCart:{title:"Empty the cart at once?",message:"If you empty the cart all of its items and settings will be lost permanently.",text:{primary:"Empty"}},deleteOrder:{title:"Delete the order?",message:"This order will be deleted, and all of its settings will be lost after this action is completed.",text:{primary:"Delete"}},convertToOrder:{title:"Place your order and pay?",message:'If you click on "PAY", a new purchase order will be generated in your "Buyer / Orders" section, and you will be automatically redirected to a payment gateway web page to complete the payment transaction for the new purchase order.',text:{primary:"Pay"}},publishCatalog:{title:"Publish the catalog?",message:'A published catalog is accessible to the general public and can be shared and embedded to third party websites. With an exception of a product "Stock configurations", a published catalog cannot be edited. However, a published catalog can be duplicated, and the duplicate is ready for editing. You will be notified once this action is completed.',text:{primary:"Publish"}},discontinueCatalog:{title:"Discontinue the catalog?",message:"A discontinued catalog is not accessible to anyone and is entirely removed from the MIRACLESTYLE app after 15 days. You will be notified once this action is completed.",text:{primary:"Discontinue"}},duplicateCatalogPricetag:{title:"Schedule duplication?",message:"Duplication can take a while to complete! You will be notified once this action is completed.",text:{primary:"Schedule"}},duplicateCatalog:{title:"Schedule duplication?",message:"Duplication can take a while to complete! You will be notified once this action is completed.",text:{primary:"Schedule"}}}),n.gotit={primary:"Got it"},$.extend(e.modals.alerts,{howToSort:{title:"How to use this action",messages:["Reorder the item by dragging it within its group.","Remove the item by dragging it outside the left edge of the screen."],text:n.gotit},howToDeleteDragging:{title:"How to use this action",message:"Remove the item by dragging it outside the left edge of the screen.",text:n.gotit},howToDropPricetag:{title:"How to use this action",messages:['Add a new product to the catalog by dragging the "Add" tag to a catalog image. While dragging, it is preferable to aim the tag dot for the image area that shows the product that the tag will link to. Add one tag per product per catalog.',"Reposition a tag by dragging it within images area.",'Click on a tag to open the "Edit Product" form while editing the catalog.',"Click on a tag to open the product view while viewing the catalog."],text:n.gotit}}),n.catalogActions=function(){return{openCatalog:"open catalog",closeCatalog:"close catalog",openCatalogDrawer:"open catalog drawer",closeCatalogDrawer:"close catalog drawer",loadMoreCatalogImages:"load more catalog images",openCatalogShareDrawer:"open catalog share drawer",closeCatalogShareDrawer:"close catalog share drawer",focusCatalogShareLink:"focus catalog share link",focusCatalogShareEmbedCode:"focus catalog share embed code"}},n.productActions=function(){return{openProduct:"open product",closeProduct:"close product",openProductDrawer:"open product drawer",closeProductDrawer:"close product drawer",changeProductVariantOption:"change product variant option",focusProductCustomVariant:"focus product custom variant",changeProductQuantity:"change product quantity",addToCartSuccess:"add to cart success",addToCartFail:"add to cart fail",updateCartSuccess:"update cart success",updateCartFail:"update cart fail",openProductShareDrawer:"open product share drawer",closeProductShareDrawer:"close product share drawer",focusProductShareLink:"focus product share link"}},n.cartActions=function(){return{openCart:"open cart",closeCart:"close cart",initiateEmptyCart:"initiate empty cart",confirmEmptyCart:"confirm empty cart",cancelEmptyCart:"cancel empty cart",proceedToCheckoutSuccess:"proceed to checkout success",proceedToCheckoutFail:"proceed to checkout fail",selectShippingMethodSuccess:"select shipping method success",selectShippingMethodFail:"select shipping method fail",reviewCartSuccess:"review cart success",reviewCartFail:"review cart fail",payWithCardSuccess:"pay with card success",payWithCardFail:"pay with card fail",paySuccess:"pay success",payFail:"pay fail",openMessages:"open messages",closeMessages:"close messages",sendMessageSuccess:"send message success",sendMessageFail:"send message fail",openSellerDrawer:"open seller drawer",closeSellerDrawer:"close seller drawer",useSavedAddressForShipping:"use saved address for shipping",useSavedAddressForBilling:"use saved address for billing",removeLineSuccess:"remove line success",removeLineFail:"remove line fail"}},n.sellerActions=function(){return{}},n.makeActions=function(e,t){var n=t();return angular.forEach(n,function(t,r){n[r]=[e,t]}),n},$.extend(e.tracker,{catalogHome:n.makeActions("Home",n.catalogActions),catalogSellerCatalogs:n.makeActions("Seller / Catalogs",n.catalogActions),catalogLink:n.makeActions("Link",n.catalogActions),catalogLinkByProduct:n.makeActions("Link",n.catalogActions),catalogEmbed:n.makeActions("Embed",n.catalogActions),productHomeCatalog:n.makeActions("Home / Catalog",n.productActions),productSellerCatalogsCatalog:n.makeActions("Seller / Catalogs / Catalog",n.productActions),productLinkCatalog:n.makeActions("Link / Catalog",n.productActions),productEmbedCatalog:n.makeActions("Embed / Catalog",n.productActions),productHomeCatalogCart:n.makeActions("Home / Catalog / Cart",n.productActions),productSellerCatalogsCatalogCart:n.makeActions("Seller / Catalogs / Catalog / Cart",n.productActions),productLinkCatalogCart:n.makeActions("Link / Catalog / Cart",n.productActions),productEmbedCatalogCart:n.makeActions("Embed / Catalog / Cart",n.productActions),productBuyerCartsCart:n.makeActions("Buyer / Carts / Cart",n.productActions),productLink:n.makeActions("Link",n.productActions),sellerHomeCatalog:n.makeActions("Home / Catalog",n.sellerActions),sellerSellerCatalogsCatalog:n.makeActions("Seller / Catalogs / Catalog",n.sellerActions),sellerLinkCatalog:n.makeActions("Link / Catalog",n.sellerActions),sellerEmbedCatalog:n.makeActions("Embed / Catalog",n.sellerActions),sellerHomeCatalogCart:n.makeActions("Home / Catalog / Cart",n.sellerActions),sellerSellerCatalogsCatalogCart:n.makeActions("Seller / Catalogs / Catalog / Cart",n.sellerActions),sellerLinkCatalogCart:n.makeActions("Link / Catalog / Cart",n.sellerActions),sellerEmbedCatalogCart:n.makeActions("Embed / Catalog / Cart",n.sellerActions),sellerBuyerCartsCart:n.makeActions("Buyer / Carts / Cart",n.sellerActions),sellerLink:n.makeActions("Link",n.sellerActions),cartHomeCatalog:n.makeActions("Home / Catalog",n.cartActions),cartSellerCatalogsCatalog:n.makeActions("Seller / Catalogs / Catalog",n.cartActions),cartLinkCatalog:n.makeActions("Link / Catalog",n.cartActions),cartEmbedCatalog:n.makeActions("Embed / Catalog",n.cartActions),cartBuyerCarts:n.makeActions("Buyer / Carts",n.cartActions)}),e.tracker.catalogHome.product=e.tracker.productHomeCatalog,e.tracker.catalogSellerCatalogs.product=e.tracker.productSellerCatalogsCatalog,e.tracker.catalogLink.product=e.tracker.productLinkCatalog,e.tracker.catalogLinkByProduct.product=e.tracker.productLink,e.tracker.catalogEmbed.product=e.tracker.productEmbedCatalog,e.tracker.catalogHome.cart=e.tracker.cartHomeCatalog,e.tracker.catalogSellerCatalogs.cart=e.tracker.cartSellerCatalogsCatalog,e.tracker.catalogLink.cart=e.tracker.cartLinkCatalog,e.tracker.catalogLinkByProduct.cart=e.tracker.cartLinkCatalog,e.tracker.catalogEmbed.cart=e.tracker.cartEmbedCatalog,e.tracker.cartHomeCatalog.product=e.tracker.productHomeCatalogCart,e.tracker.cartSellerCatalogsCatalog.product=e.tracker.productSellerCatalogsCatalogCart,e.tracker.cartLinkCatalog.product=e.tracker.productLinkCatalogCart,e.tracker.cartEmbedCatalog.product=e.tracker.productEmbedCatalogCart,e.tracker.cartBuyerCarts.product=e.tracker.productBuyerCartsCart,e.tracker.cartHomeCatalog.seller=e.tracker.sellerHomeCatalogCart,e.tracker.cartSellerCatalogsCatalog.seller=e.tracker.sellerSellerCatalogsCatalogCart,e.tracker.cartLinkCatalog.seller=e.tracker.sellerLinkCatalogCart,e.tracker.cartEmbedCatalog.seller=e.tracker.sellerEmbedCatalogCart,e.tracker.cartBuyerCarts.seller=e.tracker.sellerBuyerCartsCart,e.tracker.catalogHome.seller=e.tracker.sellerHomeCatalog,e.tracker.catalogSellerCatalogs.seller=e.tracker.sellerSellerCatalogsCatalog,e.tracker.catalogLink.seller=e.tracker.sellerLinkCatalog,e.tracker.catalogLinkByProduct.seller=e.tracker.sellerLinkCatalog,e.tracker.catalogEmbed.seller=e.tracker.sellerEmbedCatalog,$.extend(e.labels,{account:{active:"Active",suspended:"Suspended"},catalog:{draft:"Draft",published:"Published",indexed:"Indexed",discontinued:"Discontinued",unindex:"Unindex",index:"Index"},order:{cart:"Cart",checkout:"Checkout",completed:"Completed",canceled:"Canceled",positive:"Positive",negative:"Negative",neutral:"Neutral",revision:"Review",reported:"Reported",sudo:"Administered",review:"Review","null":"Unpaid"}}),n.fieldhelpForProduct={weight:"Product weight, expressed in kilograms, per unit of measurement. This field is used by the Carrier rule for calculating delivery costs.",volume:"Product volume, expressed in liters, per unit of measurement. This field is used by the Carrier rule for calculating delivery costs."},$.extend(e.fields.help,{"124-update":{condition_type:"Condition under which this line applies.",price_type:"Price formula that calculates this price."},114:{webhook_endpoint:'Live webhook endpoint that you have to setup in your Stripe account settings. For more details read the "Sell with confidence" on this form.',
secret_key:'Live secret key that you can find in your Stripe account settings. Once you save the settings, this value will be encrypted before it is stored in the MIRACLESTYLE app database. For more details read the "Sell with confidence" on this form.',publishable_key:"Live publishable key that you can find in your Stripe account settings."},order:{card_exp:"Card expiration printed on the front of your card.",cvc:"Card verification code printed on the back of your card."},106:{postal_codes:"Postal codes this location affects. Specify one postal code per line."},108:{reciever_email:"Primary email address for your PayPal account.",business:'Email address on which you want to receive your PayPal payments. This value will be the same as "Receiver Email" in case that you have only one email address associated with your PayPal account.'},109:{product_codes:"Specific product codes this rule applies to. Specify one product code per line.",address_type:"Buyer address type this rule applies to."},124:{product_codes:"Specific product codes this line applies to. Specify one product code per line."},117:{currency:"Currency you accept, and your product unit prices are expressed in."},"111-update":{condition_type:"Condition under which this price applies.",price_type:"Price formula that calculates this price."},"23-update":{name:"Name of the brand, company, or store that you represent.",logo:"Click on the logo above to upload logo image of the brand, company, or store that you represent. Logo must be of 2.4:1 aspect ratio, preferably 720 pixels wide and 300 pixels high."},14:{name:"Recipient's full name or business name."},107:{address_type:"Buyer address type this rule applies to."},27:n.fieldhelpForProduct,28:n.fieldhelpForProduct,"31-update":{discontinued_date:"Date when this catalog will be automatically discontinued and become unavailable to the general public."},26:{name:"Name of the variant input control that is visible on the product view.",options:"Options that are available for selection on the variant input control. Specify one option per line.",description:"Brief description visible beneath the variant input control.",allow_custom_value:"If enabled, options defined above will be ignored, and buyers will be able to supply a custom value in the variant input control"}}),$.extend(e.fields.validationErrors,{invalid_card_number:"Invalid card number.",invalid_card_cvc:"Invalid cvc.",invalid_card_date:"Invalid card date."}),$.extend(e.fields.label,{search:{indexID:"Search options",ancestor:"Ancestor",operator:"Operator"},plugins:{kind:"Rule"},order:{cvc:"CVC",card_exp:"Card expiration (MM / YY)"},28:{uom:"Unit of measurement",variant_options:"Select all variant options you want this configuration to be matched with",weight:"Weight (kilogram)",volume:"Volume (liter)",_stock:"Stock configurations"},27:{uom:"Unit of measurement",weight:"Weight (kilogram)",volume:"Volume (liter)"},109:{carriers:"Carriers this rule applies to"},112:{rules:"Prices"},124:{discount_value:"Discount (%)",product_categories:"Product categories"},"31-update":{discontinued_date:"Expiration date"},"124-update":{condition_type:"Condition",price_type:"Price"},"111-update":{condition_type:"Condition",price_type:"Price"},"23-update":{logo:"Seller logo"}}),n.conditionOperatorSpec={"==":"equals to","!=":"is not equal to",">":"is greater than","<":"is less than",">=":"is greater than or equal to","<=":"is less than or equal to"},n.addressTypeSpec={billing:"Billing",shipping:"Shipping"},$.extend(e.fields.translateChoices,{107:{address_type:n.addressTypeSpec},133:{availability:{"in stock":"In stock","out of stock":"Out of stock",preorder:"Preorder","available for order":"Available for order"}},109:{address_type:n.addressTypeSpec,type:{proportional:"Proportional (%)",fixed:"Fixed (Amount)"}},111:{condition_type:{weight:"weight",volume:"volume","weight*volume":"weight multiplied by volume",price:"net total"},condition_operator:n.conditionOperatorSpec,price_type:{fixed:"fixed",variable:"varied by"},price_operator:{weight:"weight multiplied by",volume:"volume multiplied by","weight*volume":"weight multiplied by volume multiplied by",price:"net total multiplied by"}},124:{condition_type:{price:"product subtotal",quantity:"product quantity"},condition_operator:n.conditionOperatorSpec},rules:{kind:{109:"Tax",126:"Discount",107:"Address",117:"Currency",108:"PayPal",113:"Carrier",114:"Stripe"}}}),$.extend(e.fields.emptyHelp,{"19-update":{addresses:"buyer/help/addresses.html"},"31-update":{_images:"catalog/help/images.html"},109:{carriers:"seller/help/carriers.html",product_categories:"seller/help/product_categories.html",locations:"seller/help/locations.html"},124:{product_categories:"seller/help/product_categories_line.html"},113:{lines:"seller/help/carrier_lines.html"},112:{locations:"seller/help/locations_line.html",prices:"seller/help/prices.html"},126:{lines:"seller/help/discount_lines.html"},134:{stocks:"catalog/product/help/stock_configurations.html"},107:{locations:"seller/help/locations.html"},28:{images:"catalog/product/help/images.html",variants:"catalog/product/help/variants.html",_instances:"catalog/product/help/instances.html"},27:{images:"catalog/product/help/images.html",variant_options:"catalog/product/help/variant_options.html"}}),e.fields.radioLabel||(e.fields.radioLabel={}),$.extend(e.fields.radioLabel,{pluginLocation:{falseLabel:"Applies to all locations except those listed in the Locations section",trueLabel:"Applies only to the locations listed in the Locations section"}}),$.extend(e.misc.text,{leaveUnsaved:"You have unsaved changes."}),$.extend(e.subheaders,{loginMethods:"Sign in identities",productInstances:"Variant configurations",catalogImages:"Images",catalogProducts:"Products",history:"History",record:"Log Entry",sellerPlugins:"Rules",stripeWithConfidence:"Sell with confidence"}),$.extend(e.emptyHelp,{orderSellerList:"seller/help/orders.html",cartSellerList:"seller/help/carts.html",orderBuyerList:"buyer/help/orders.html",cartBuyerList:"buyer/help/carts.html",catalogList:"catalog/help/list.html",cartMessages:"order/help/messages.html",sellerProfileCatalogList:"seller/help/profile_catalogs.html"}),$.extend(e.snackbar.messages,{changesSaved:"Changes saved.",cartUpdated:"Cart updated.",catalogPublished:"Catalog published.",catalogDiscontinued:"Catalog discontinued.",duplicationInProgressCatalog:"Catalog scheduled for duplication.",administered:"Administered.",identityDisconnected:"Identity disconnected.",identityTaken:"This identity is already connected to another MIRACLESTYLE account.",identityConnected:"Identity connected.",identityConnectionCanceled:"Connecting identity canceled.",failedGeneratingAuthorizaitonUrl:"Failed accessing identity, please try again.",identityConnectionFailed:"Connecting identity failed.",createVariantsFirst:"Create some variants first.",saveProductFirst:"Save product first.",provideProperValues:"Provide proper values in the form fields first!",uploadImagesFirst:'Navigate to the "Images" to upload and arrange catalog images first.',messangerDisabledWhenEmpty:"Messenger is disabled for empty shopping carts!",accessDenied:"Action denied! Your account is not authorized to perform this action.",noBuyer:"No buyer address. You did not provide any buyer information.",sellerProfileNotFound:'Navigate to the "Seller / Settings" to configure seller profile first.',productDuplicated:"Product duplicated.",catalogDuplicated:"Catalog duplicated.",errorWithTraceback:"Server errored with traceback.",actionFailedCheckForm:"Action failed! Inspect the form for errors.",orderPaymentSuccessProgress:"Order processing is in pogress.",orderPaymentSuccessProgressCanceled:"Payment canceled.",orderPaymentSuccessProgressCompleted:"Payment completed.",orderPaymentSuccessProgressRefunded:"Payment refunded.",orderPaymentSuccessProgressPending:"Payment pending.",orderPaymentSuccessProgressMismatched:"Payment mismatched.",sellerProhibtsAddress:"The seller prohibits one of the addresses that you have supplied.",productOutOfStock:"Product out of stock.",saveChangesFirst:"Save changes first.",loginSuccess:"Signed in.",loginFailed:"Sign in failed!",loggedOut:"Signed out.",loginCanceled:"Sign in canceled.",youAreNotSignedIn:"You are not signed in.",saveInProgress:"Please wait, save in progress.",orderNotFound:"This order does not exist.",catalogNotFound:"This catalog does not exist.",catalogProductNotFound:"This catalog product does not exist.",rejectedAccountAccess:"You rejected access to your account.",incorrectAccessToken:"Incorrect access token. Please try again.",takenByOtherAccount:"This identity is already connected to another MIRACLESTYLE account.",failedGettingEmail:"E-mail not provided by the provider.",incorrectLinkSettings:"Incorrect link settings.",failedAuthentication:"Failed authentication with the provider.",outOfStockLinesRemoved:"Some of the products on the order were out of stock and have been removed from the order.",invalidCsrf:"Invalid request. Please reload your browser.",orderPaymentNoPaymentMethodSupplied:"Payments are not admitted at this moment.",orderPaymentFailed:"An error occurred on the server.",orderPaymentInvalidNumber:"The card number is not a valid credit card number.",orderPaymentInvalidExpiryMonth:"The card's expiration month is invalid.",orderPaymentInvalidExpiryYear:"The card's expiration year is invalid.",orderPaymentInvalidCVC:"The card's security code is invalid.",orderPaymentIncorrectNumber:"The card number is incorrect.",orderPaymentExpiredCard:"The card has expired.",orderPaymentIncorrectCVC:"The card's security code is incorrect.",orderPaymentIncorrectZip:"The card's zip code failed validation.",orderPaymentCardDeclined:"The card was declined.",orderPaymentMissing:"There is no card on a customer that is being charged.",orderPaymentProcessingError:"An error occurred while processing the card.",orderPaymentCardSuccess:"Payment completed."}),$.extend(e.toolbar.titles,{seller:"Seller",edit31:"Catalog",add31:"Catalog",viewImages:"Images",viewProducts:"Products",editProduct:"Edit Product",addProduct:"Add Product",editPluginGroup:!1,viewStock:"Stock Configurations",editStock:!1,editStocks:"Edit Stock Configuration",addStocks:"Add Stock Configuration",settings:"Settings",addPlugins:"Add Rule",editPlugins:"Edit Rule",addVariants:"Add Variant",editVariants:"Edit Variant",home:"Home",about:"About",acceptable_use_policy:"Acceptable Use Policy",tos:"Terms of Service",support:"Support",copyright_policy:"Copyright & Trademark",privacy_policy:"Privacy Policy",buyer:"Buyer",carts:"Carts",orders:"Orders",catalogs:"Catalogs",addLines:"Add Line",viewAddresses:"Addresses",addAddresses:"Add Address",editAddresses:"Edit Address",addLocations:"Add Location",editLocations:"Edit Location",editLines:"Edit Line",addPrice:"Add Price",addPrices:"Add Price",editPrice:"Edit Price",viewInstances:"Variant Configurations",editInstances:"Edit Variant Configuration",addInstances:"Add Variant Configuration",account:"Account",admin:"Admin",users:"Accounts",aboutRules:"About Rules",sellerProfile:"Seller Profile",payWithConfidence:"Pay With Confidence"}),e.backendErrorHandling||(e.backendErrorHandling={})}]).run(["GLOBAL_CONFIG","currentAccount","models","$state","$timeout","snackbar",function(e,t,n,r,i,a){$.extend(e.backendErrorHandling,{sellerProfileNotFound:function(t){return t.not_found&&-1!==$.inArray("seller",t.not_found)?e.snackbar.messages.sellerProfileNotFound:!1},orderNotFound:function(t){return t.not_found||t.malformed_key?e.snackbar.messages.orderNotFound:!1},catalogNotFound:function(t){return t.not_found||t.malformed_key?e.snackbar.messages.catalogNotFound:!1},productOutOfStock:function(t){return t.plugin_error&&-1!==$.inArray("product_out_of_stock",t.plugin_error)?e.snackbar.messages.productOutOfStock:!1},internal_server_error:function(e){return"An error occurred on the server."},action_denied:function(){return"You do not have permission to perform this action."},not_found:function(e){return"Requested data "+e.join(", ")+" could not be found in the database."},invalid_csrf:function(){return e.snackbar.messages.invalidCsrf},invalid_image_type:"You have supplied incorrect type of image format.",invalid_model:"You have requested access to resource that does not exist,",invalid_action:"You have requested access to the action that does not exist.",required:function(e){return"Some values are missing: "+e.join(", ")+"."},connection_refused:function(){return"Failed to establish connection."},invalid_response:function(){return"Server failed to respond, please try again."},traceback:function(e){var t=$.parseHTML(e);return $(t).filter("pre").text()},transaction:function(e){return"timeout"===e?"Transaction was not completed due timeout. Please try again.":"failed"===e?"Transaction was not completed due failure. Please try again.":e}})}])}(),function(){"use strict";function e(e,t){function n(e){return angular.isDefined(e.href)||angular.isDefined(e.ngHref)}function r(e,t){return n(t)?'<a class="md-button" ng-transclude></a>':'<button class="md-button" ng-transclude></button>'}function i(r,i,a){var o=i[0];e.attachButtonBehavior(r,i);var s=o.textContent.trim();s||t.expect(i,"aria-label"),n(a)&&angular.isDefined(a.ngDisabled)&&r.$watch(a.ngDisabled,function(e){i.attr("tabindex",e?-1:0)})}return{restrict:"E",replace:!0,transclude:!0,template:r,link:i}}angular.module("material.components.button",["material.core"]).directive("mdButton",e),e.$inject=["$mdInkRipple","$mdAria"]}(),function(){"use strict";function e(e,t,n,r,i,a){function o(t,o){return o.type="checkbox",o.tabindex=o.tabindex||"0",t.attr("role",o.type),t.on("click",function(e){this.hasAttribute("disabled")&&e.stopImmediatePropagation()}),function(t,o,c,l){function u(e,n,r){c[e]&&t.$watch(c[e],function(e){r[e]&&o.attr(n,r[e])})}function d(e){var t=e.which||e.keyCode;(t===n.KEY_CODE.SPACE||t===n.KEY_CODE.ENTER)&&(e.preventDefault(),o.hasClass("md-focused")||o.addClass("md-focused"),p(e))}function p(e){o[0].hasAttribute("disabled")||(!function(){var t=c.ngChecked?c.checked:!l.$viewValue;l.$setViewValue(t,e&&e.type),l.$render()}(),t.$digest())}function f(){l.$viewValue?a.addClass(o,s):a.removeClass(o,s)}l=l||r.fakeNgModel(),c.ngChecked&&t.$watch(t.$eval.bind(t,c.ngChecked),l.$setViewValue.bind(l)),u("ngDisabled","tabindex",{"true":"-1","false":c.tabindex}),e.link.pre(t,{on:angular.noop,0:{}},c,[l]),t.mouseActive=!1,o.on("click",p).on("keypress",d).on("mousedown",function(){t.mouseActive=!0,i(function(){t.mouseActive=!1},100)}).on("focus",function(){t.mouseActive===!1&&o.addClass("md-focused")}).on("blur",function(){o.removeClass("md-focused")}),l.$render=f}}e=e[0];var s="md-checked";return{restrict:"E",transclude:!0,require:"?ngModel",template:'<div class="md-container list-primary-tile"><div class="avatar-small"><div><icon class="button-square" type="check_box"></icon><icon class="button-square" type="check_box_outline_blank"></icon></div></div></div><div ng-transclude class="md-label"></div>',compile:o}}angular.module("material.components.checkbox",["material.core"]).directive("mdCheckbox",e),e.$inject=["inputDirective","$mdAria","$mdConstant","$mdUtil","$timeout","$animate"]}(),function(){"use strict";function e(){function e(e,t){this.$scope=e,this.$element=t}return{restrict:"E",controller:["$scope","$element",e],link:function(e,n,r){n[0];e.$broadcast("$mdContentLoaded",n),t(n[0])}}}function t(e){angular.element(e).on("$md.pressdown",function(t){"t"===t.pointer.type&&(t.$materialScrollFixed||(t.$materialScrollFixed=!0,0===e.scrollTop?e.scrollTop=1:e.scrollHeight===e.scrollTop+e.offsetHeight&&(e.scrollTop-=1)))})}angular.module("material.components.content",["material.core"]).directive("mdContent",e).config(["markdownConverterProvider",function(e){e.config({extensions:["demo"]})}]),e.$inject=[]}(),function(){var e=function(e){return[{type:"output",filter:function(e){if(window._allow)return e;try{$.parseHTML(e)}catch(t){return""}var n=$("<div />").html(e),r=function(e){return e},i=function(e){var t=-1!==e.indexOf("%"),n=-1!==e.indexOf("px"),r="";return t&&(r="%"),n&&(r="px"),parseInt(e,10)+r},a={strong:!0,b:!0,hr:!0,ol:!0,blockquote:!0,kbd:!0,code:!0,i:!0,em:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,li:!0,div:!0,pre:!0,p:!0,br:!0,iframe:{width:i,height:i,src:r,allowfullscreen:function(){return""},frameborder:function(e){return parseInt(e,10)}}};return n.find("*").each(function(){var e=$(this),t=e.get(0).nodeName.toLowerCase(),n=a[t];n?$.each(this.attributes,function(){var t=angular.isObject(n)?n[this.name]:!1;t?e.attr(this.name,t(e.attr(this.name))):e.removeAttr(this.name)}):e.remove()}),n.html()}}]};"undefined"!=typeof window&&window.Showdown&&window.Showdown.extensions&&(window.Showdown.extensions.demo=e),"undefined"!=typeof module&&(module.exports=e)}(),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),r.jqueryui=!0;var i=e.target;if("mousemove"===t){var a=document.elementFromPoint(e.clientX,e.clientY);null!==a&&(i=a)}i.dispatchEvent(r)}}if(e.support.touch="ontouchend"in document||"onpointerdown"in document||"onMSPointerDown"in document,e.support.touch){var n,r,i,a,o,s,c,l,u,d=e.ui.mouse.prototype,p=d._mouseInit,f=d._mouseDestroy;d.state={},d._touchStart=function(e){s||(s=window.touchHelpers.getEventPoint,c=window.touchHelpers.updatePointerState,l=window.touchHelpers.makeStartPointer,u=window.touchHelpers.typesMatch);var d=this;if(!i&&d._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,d._startedMove=e.timeStamp,d._touchMoved=!1,n=e.originalEvent.touches[0].screenX,r=e.originalEvent.touches[0].screenY,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"),!a&&!d.state.isRunning)){d.state.isRunning=!0;var p=+Date.now();o&&!u(e,o)&&p-o.endTime<1500||(a=l(e))}},d._touchDistanceMet=function(e){return e.distance>=this.options.distance},d._touchMove=function(e){var o=this;if(a&&u(e,a)&&c(e,a),i){var s=e.originalEvent.touches[0].screenX,l=e.originalEvent.touches[0].screenY;if(n===s&&r===l)return void(o._touchMoved=!1);o._touchMoved=!0,t(e,"mousemove")}},d._touchEnd=function(e){var n=this;return a&&u(e,a)&&(c(e,a),a.endTime=+Date.now()),i?(t(e,"mouseup"),t(e,"mouseout")||e,(!n._touchMoved||!n._touchDistanceMet(a)&&n.state.isRunning)&&t(e,"click"),n._touchMoved=!1,i=!1,o=a,a=null,void(n.state.isRunning=!1)):(o=a,void(a=null))},d._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),msieversion()&&t.element.css("-ms-touch-action","none"),p.call(t)},d._mouseDestroy=function(){var t=this;t._touchMoved=!1,t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),f.call(t)}}}(jQuery),function(){"use strict";function e(e,t,n){function r(e){var t=s[e];angular.isUndefined(t)&&(t=s[e]=i(e));var n=c[t];return angular.isUndefined(n)&&(n=a(t)),n}function i(t){return e.MEDIA[t]||("("!==t.charAt(0)?"("+t+")":t)}function a(e){var t=n.matchMedia(e);return t.addListener(o),c[t.media]=!!t.matches}function o(){var e=this;t.$evalAsync(function(){c[e.media]=!!e.matches})}var s={},c={};return r}!function(){function e(e){e.decorator("$$rAF",["$delegate",t])}function t(e){return e.throttle=function(t){var n,r,i,a;return function(){n=arguments,a=this,i=t,r||(r=!0,e(function(){i.apply(a,n),r=!1}))}},e}function n(e,t){function n(e){return i?"webkit"+e.charAt(0).toUpperCase()+e.substring(1):e}function r(e){return i?"-webkit-"+e:e}var i=/webkit/i.test(t.vendorPrefix);return{KEY_CODE:{ENTER:13,ESCAPE:27,SPACE:32,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40},RAW_CSS:{TRANSFORM:r("transform"),TRANSFORMORIGIN:r("transformOrigin"),TRANSITION:r("transition"),TRANSITION_DURATION:r("transitionDuration"),ANIMATION_PLAY_STATE:r("animationPlayState"),ANIMATION_DURATION:r("animationDuration"),ANIMATION_NAME:r("animationName"),ANIMATION_TIMING:r("animationTimingFunction"),ANIMATION_DIRECTION:r("animationDirection")},CSS:{TRANSITIONEND:"transitionend"+(i?" webkitTransitionEnd":""),ANIMATIONEND:"animationend"+(i?" webkitAnimationEnd":""),TRANSFORM:n("transform"),TRANSFORMORIGIN:n("transformOrigin"),TRANSITION:n("transition"),TRANSITION_DURATION:n("transitionDuration"),ANIMATION_PLAY_STATE:n("animationPlayState"),ANIMATION_DURATION:n("animationDuration"),ANIMATION_NAME:n("animationName"),ANIMATION_TIMING:n("animationTimingFunction"),ANIMATION_DIRECTION:n("animationDirection")},MEDIA:{sm:"(max-width: 600px)","gt-sm":"(min-width: 600px)",md:"(min-width: 600px) and (max-width: 960px)","gt-md":"(min-width: 960px)",lg:"(min-width: 960px) and (max-width: 1200px)","gt-lg":"(min-width: 1200px)"}}}angular.module("material.core",[]).config(e),e.$inject=["$provide"],angular.module("material.core").factory("$mdConstant",n),n.$inject=["$$rAF","$sniffer"]}(),function(){function e(e,t){function n(){return[].concat(v)}function r(){return v.length}function i(e){return v.length&&e>-1&&e<v.length}function a(e){return e?i(d(e)+1):!1}function o(e){return e?i(d(e)-1):!1}function s(e){return i(e)?v[e]:null}function c(e,t){return v.filter(function(n){return n[e]===t})}function l(e,t){return e?(angular.isNumber(t)||(t=v.length),v.splice(t,0,e),d(e)):-1}function u(e){p(e)&&v.splice(d(e),1)}function d(e){return v.indexOf(e)}function p(e){return e&&d(e)>-1}function f(){return v.length?v[0]:null}function g(){return v.length?v[v.length-1]:null}function m(e,n,r,a){r=r||h;var o=d(n);if(!i(o))return null;var s=o+(e?-1:1),c=null;return i(s)?c=v[s]:t&&(c=e?g():f(),s=d(c)),null===c||s===a?null:(angular.isUndefined(a)&&(a=s),r(c)?c:m(e,c,r,a))}var h=function(){return!0};t=!!t;var v=e||[];return{items:n,count:r,inRange:i,contains:p,indexOf:d,itemAt:s,findBy:c,add:l,remove:u,first:f,last:g,next:angular.bind(null,m,!1),previous:angular.bind(null,m,!0),hasPrevious:o,hasNext:a}}angular.module("material.core").config(["$provide",function(t){t.decorator("$mdUtil",["$delegate",function(t){return t.iterator=e,t}])}])}(),angular.module("material.core").factory("$mdMedia",e),e.$inject=["$mdConstant","$rootScope","$window"],function(){var e=["0","0","0"];angular.module("material.core").factory("$mdUtil",["$document","$timeout",function(t,n){var r;return r={now:window.performance?angular.bind(window.performance,window.performance.now):Date.now,elementRect:function(e,t){var n=e[0];t=t||n.offsetParent||document.body,t=t[0]||t;var r=n.getBoundingClientRect(),i=t.getBoundingClientRect();return{left:r.left-i.left+t.scrollLeft,top:r.top-i.top+t.scrollTop,width:r.width,height:r.height}},fakeNgModel:function(){return{$fake:!0,$setViewValue:function(e){this.$viewValue=e,this.$render(e),this.$viewChangeListeners.forEach(function(e){e()})},$isEmpty:function(e){return 0===(""+e).length},$parsers:[],$formatters:[],$viewChangeListeners:[],$render:angular.noop}},debounce:function(e,t,r,i){var a;return function(){var o=r,s=Array.prototype.slice.call(arguments);n.cancel(a),a=n(function(){a=void 0,e.apply(o,s)},t||10,i)}},throttle:function(e,t){var n;return function(){var i=this,a=arguments,o=r.now();(!n||o-n>t)&&(e.apply(i,a),n=o)}},nextUid:function(){for(var t,n=e.length;n;){if(n--,t=e[n].charCodeAt(0),57==t)return e[n]="A",e.join("");if(90!=t)return e[n]=String.fromCharCode(t+1),e.join("");e[n]="0"}return e.unshift("0"),e.join("")},disconnectScope:function(e){if(e&&e.$root!==e&&!e.$$destroyed){var t=e.$parent;e.$$disconnected=!0,t.$$childHead===e&&(t.$$childHead=e.$$nextSibling),t.$$childTail===e&&(t.$$childTail=e.$$prevSibling),e.$$prevSibling&&(e.$$prevSibling.$$nextSibling=e.$$nextSibling),e.$$nextSibling&&(e.$$nextSibling.$$prevSibling=e.$$prevSibling),e.$$nextSibling=e.$$prevSibling=null}},reconnectScope:function(e){if(e&&e.$root!==e&&e.$$disconnected){var t=e,n=t.$parent;t.$$disconnected=!1,t.$$prevSibling=n.$$childTail,n.$$childHead?(n.$$childTail.$$nextSibling=t,n.$$childTail=t):n.$$childHead=n.$$childTail=t}},getClosest:function(e,t){t=t.toUpperCase();do if(e.nodeName===t)return e;while(e=e.parentNode);return null}}}]),angular.element.prototype.focus=angular.element.prototype.focus||function(){return this.length&&this[0].focus(),this},angular.element.prototype.blur=angular.element.prototype.blur||function(){return this.length&&this[0].blur(),this}}(),function(){function e(e,t,n){function r(e,t,n){var r=e[0];r.hasAttribute(t)||o(r,t)||(n=angular.isString(n)&&n.trim()||"",n.length&&e.attr(t,n))}function i(t,n,i){e(function(){r(t,n,i())})}function a(e,t){i(e,t,function(){return e.text().trim()})}function o(e,t){function r(e){var t=e.currentStyle?e.currentStyle:n.getComputedStyle(e);return"none"===t.display}var i=e.hasChildNodes(),a=!1;if(i)for(var o=e.childNodes,s=0;s<o.length;s++){var c=o[s];1===c.nodeType&&c.hasAttribute(t)&&(r(c)||(a=!0))}return a}return{expect:r,expectAsync:i,expectWithText:a}}angular.module("material.core").service("$mdAria",e),e.$inject=["$$rAF","$log","$window"]}(),function(){function e(e,t,n,r,i,a){this.compile=function(o){var s=o.templateUrl,c=o.template||"",l=o.controller,u=o.controllerAs,d=o.resolve||{},p=o.locals||{},f=o.transformTemplate||angular.identity,g=o.bindToController;return angular.forEach(d,function(e,t){d[t]=angular.isString(e)?n.get(e):n.invoke(e)}),angular.extend(d,p),d.$template=s?t.get(s,{cache:a}).then(function(e){return e.data}):e.when(c),e.all(d).then(function(e){var t=f(e.$template),n=angular.element("<div>").html(t.trim()).contents(),a=r(n);return{locals:e,element:n,link:function(t){if(e.$scope=t,l){var r=i(l,e);g&&angular.extend(r,e),n.data("$ngControllerController",r),n.children().data("$ngControllerController",r),u&&(t[u]=r)}return a(t)}}})}}angular.module("material.core").service("$mdCompiler",e),e.$inject=["$q","$http","$injector","$compile","$controller","$templateCache"]}(),function(e){function t(){}function n(e,t,n){function r(e){return function(t,n){n.distance<this.state.options.maxDistance&&!t.jqueryui&&this.dispatchEvent(t,e,n)}}function i(e,t,n){var r=f[t.replace(/^\$md./,"")];if(!r)throw new Error("Failed to register element with handler "+t+". Available handlers: "+Object.keys(f).join(", "));return r.registerElement(e,n)}function a(t,n){var r=new e(t);return angular.extend(r,n),f[t]=r,h}var c=navigator.userAgent||navigator.vendor||window.opera,d=c.match(/ipad|iphone|ipod/i),p=c.match(/android/i),m="undefined"!=typeof window.jQuery&&angular.element===window.jQuery,h={handler:a,register:i,isHijackingClicks:(d||p)&&!m&&!g};if(h.isHijackingClicks){var v=8;h.handler("click",{options:{maxDistance:v},onEnd:r("click")}),h.handler("focus",{options:{maxDistance:v},onEnd:function(e,t){function n(e){var t=["INPUT","SELECT","BUTTON","TEXTAREA","VIDEO","AUDIO"];return"-1"!=e.getAttribute("tabindex")&&!e.hasAttribute("DISABLED")&&(e.hasAttribute("tabindex")||e.hasAttribute("href")||-1!=t.indexOf(e.nodeName))}t.distance<this.state.options.maxDistance&&n(e.target)&&(this.dispatchEvent(e,"focus",t),e.target.focus())}}),h.handler("mouseup",{options:{maxDistance:v},onEnd:r("mouseup")}),h.handler("mousedown",{onStart:function(e){this.dispatchEvent(e,"mousedown")}})}return window.touchHelpers||(window.touchHelpers={}),window.touchHelpers.getEventPoint=u,window.touchHelpers.updatePointerState=l,window.touchHelpers.makeStartPointer=o,window.touchHelpers.typesMatch=s,h.handler("press",{onStart:function(e,t){this.dispatchEvent(e,"$md.pressdown")},onEnd:function(e,t){this.dispatchEvent(e,"$md.pressup")}}).handler("hold",{options:{maxDistance:6,delay:500},onCancel:function(){n.cancel(this.state.timeout)},onStart:function(e,t){return this.state.registeredParent?(this.state.pos={x:t.x,y:t.y},void(this.state.timeout=n(angular.bind(this,function(){this.dispatchEvent(e,"$md.hold"),this.cancel()}),this.state.options.delay,!1))):this.cancel()},onMove:function(e,t){e.preventDefault();var n=this.state.pos.x-t.x,r=this.state.pos.y-t.y;Math.sqrt(n*n+r*r)>this.options.maxDistance&&this.cancel()},onEnd:function(){this.onCancel()}}).handler("drag",{options:{minDistance:6,horizontal:!0,cancelMultiplier:1.5},onStart:function(e){this.state.registeredParent||this.cancel()},onMove:function(e,t){var n,r;e.preventDefault(),this.state.dragPointer?this.dispatchDragMove(e):(this.state.options.horizontal?(n=Math.abs(t.distanceX)>this.state.options.minDistance,r=Math.abs(t.distanceY)>this.state.options.minDistance*this.state.options.cancelMultiplier):(n=Math.abs(t.distanceY)>this.state.options.minDistance,r=Math.abs(t.distanceX)>this.state.options.minDistance*this.state.options.cancelMultiplier),n?(this.state.dragPointer=o(e),l(e,this.state.dragPointer),this.dispatchEvent(e,"$md.dragstart",this.state.dragPointer)):r&&this.cancel())},dispatchDragMove:t.throttle(function(e){this.state.isRunning&&(l(e,this.state.dragPointer),this.dispatchEvent(e,"$md.drag",this.state.dragPointer))}),onEnd:function(e,t){this.state.dragPointer&&(l(e,this.state.dragPointer),this.dispatchEvent(e,"$md.dragend",this.state.dragPointer))}}).handler("swipe",{options:{minVelocity:.65,minDistance:10},onEnd:function(e,t){if(Math.abs(t.velocityX)>this.state.options.minVelocity&&Math.abs(t.distanceX)>this.state.options.minDistance){var n="left"==t.directionX?"$md.swipeleft":"$md.swiperight";this.dispatchEvent(e,n)}}})}function r(e){this.name=e,this.state={}}function i(){function e(e,t,n){n=n||d;var r=new angular.element.Event(t);r.$material=!0,r.pointer=n,r.srcEvent=e,r.jqueryui=e.jqueryui,angular.extend(r,{clientX:n.x,clientY:n.y,screenX:n.x,screenY:n.y,pageX:n.x,pageY:n.y,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}),angular.element(n.target).trigger(r)}function t(e,t,n){n=n||d;var r;"click"===t||"mouseup"==t||"mousedown"==t?(r=document.createEvent("MouseEvents"),r.initMouseEvent(t,!0,!0,window,e.detail,n.x,n.y,n.x,n.y,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget||null)):(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!0,{})),r.$material=!0,r.pointer=n,r.srcEvent=e,r.jqueryui=e.jqueryui,n.target.dispatchEvent(r)}var n="undefined"!=typeof window.jQuery&&angular.element===window.jQuery;return r.prototype={options:{},dispatchEvent:n?e:t,onStart:angular.noop,onMove:angular.noop,onEnd:angular.noop,onCancel:angular.noop,start:function(e,t){if(!this.state.isRunning){var n=this.getNearestParent(e.target),r=n&&n.$mdGesture[this.name]||{};this.state={isRunning:!0,options:angular.extend({},this.options,r),registeredParent:n},this.onStart(e,t)}},move:function(e,t){this.state.isRunning&&this.onMove(e,t)},end:function(e,t){this.state.isRunning&&(this.onEnd(e,t),this.state.isRunning=!1)},cancel:function(e,t){this.onCancel(e,t),this.state={}},getNearestParent:function(e){for(var t=e;t;){if((t.$mdGesture||{})[this.name])return t;t=t.parentNode}return null},registerElement:function(e,t){function n(){delete e[0].$mdGesture[r.name],e.off("$destroy",n)}var r=this;return e[0].$mdGesture=e[0].$mdGesture||{},e[0].$mdGesture[this.name]=t||{},e.on("$destroy",n),n}},r}function a(e,t){function n(e){var t=!e.clientX&&!e.clientY;t||e.$material||e.isIonicTap||c(e)||(e.preventDefault(),e.stopPropagation())}function r(e){var t=0===e.clientX&&0===e.clientY;t||e.$material||e.isIonicTap||e.jqueryui||c(e)?(m=null,"label"==e.target.tagName.toLowerCase()&&(m={x:e.x,y:e.y})):(e.preventDefault(),e.stopPropagation(),m=null)}function i(e,n){var r;for(var i in f)r=f[i],r instanceof t&&("start"===e&&r.cancel(),r[e](n,d))}function a(e){if(!d){var t=+Date.now();p&&!s(e,p)&&t-p.endTime<1500||(d=o(e),i("start",e))}}function u(e){d&&s(e,d)&&(l(e,d),i("move",e))}function g(e){d&&s(e,d)&&(l(e,d),d.endTime=+Date.now(),i("end",e),p=d,d=null)}document.contains||(document.contains=function(e){return document.body.contains(e)}),!h&&e.isHijackingClicks&&(document.addEventListener("click",r,!0),document.addEventListener("mouseup",n,!0),document.addEventListener("mousedown",n,!0),document.addEventListener("focus",n,!0),
console.log("clickHijacker"),h=!0);var v="mousedown touchstart pointerdown",y="mousemove touchmove pointermove",$="mouseup mouseleave touchend touchcancel pointerup pointercancel";angular.element(document).on(v,a).on(y,u).on($,g).on("$$mdGestureReset",function(){p=d=null})}function o(e){var t=u(e),n={startTime:+Date.now(),target:e.target,type:e.type.charAt(0)};return n.startX=n.x=t.pageX,n.startY=n.y=t.pageY,n}function s(e,t){return e&&t&&e.type.charAt(0)===t.type}function c(e){return m&&m.x==e.x&&m.y==e.y}function l(e,t){var n=u(e),r=t.x=n.pageX,i=t.y=n.pageY;t.distanceX=r-t.startX,t.distanceY=i-t.startY,t.distance=Math.sqrt(t.distanceX*t.distanceX+t.distanceY*t.distanceY),t.directionX=t.distanceX>0?"right":t.distanceX<0?"left":"",t.directionY=t.distanceY>0?"up":t.distanceY<0?"down":"",t.duration=+Date.now()-t.startTime,t.velocityX=t.distanceX/t.duration,t.velocityY=t.distanceY/t.duration}function u(e){return e=e.originalEvent||e,e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0]||e}var d,p,f={},g=!1,m=null,h=!1;angular.module("material.core.gestures",[]).provider("$mdGesture",t).factory("$$MdGestureHandler",i).run(a),t.prototype={skipClickHijack:function(){return g=!0},$get:["$$MdGestureHandler","$$rAF","$timeout",function(e,t,r){return new n(e,t,r)}]},n.$inject=["$$MdGestureHandler","$$rAF","$timeout"],a.$inject=["$mdGesture","$$MdGestureHandler"]}(window.jQuery),function(){function e(){function e(e){function t(e){return a.optionsFactory=e.options,a.methods=(e.methods||[]).concat(i),o}function n(t,n){if(n=n||{},n.methods=n.methods||[],n.options=n.options||function(){return{}},/^cancel|hide|show$/.test(t))throw new Error("Preset '"+t+"' in "+e+" is reserved!");if(n.methods.indexOf("_options")>-1)throw new Error("Method '_options' in "+e+" is reserved!");return a.presets[t]={methods:n.methods.concat(i),optionsFactory:n.options,argOption:n.argOption},o}function r(t,n,r){function i(e){return e&&e._options&&(e=e._options),l.show(angular.extend({},c,e))}function o(t,n){var i={};return i[e]=u,r.invoke(t||function(){return n},{},i)}var s,c,l=t(),u={hide:l.hide,cancel:l.cancel,show:i};return s=a.methods||[],c=o(a.optionsFactory,{}),angular.forEach(a.presets,function(e,t){function n(e){this._options=angular.extend({},r,e)}var r=o(e.optionsFactory,{}),i=(e.methods||[]).concat(s);if(angular.extend(r,{$type:t}),angular.forEach(i,function(e){n.prototype[e]=function(t){return this._options[e]=t,this}}),e.argOption){var a="show"+t.charAt(0).toUpperCase()+t.slice(1);u[a]=function(e){var n=u[t](e);return u.show(n)}}u[t]=function(t){return arguments.length&&e.argOption&&!angular.isObject(t)&&!angular.isArray(t)?(new n)[e.argOption](t):new n(t)}}),u}var i=["onHide","onShow","onRemove"],a={presets:{}},o={setDefaults:t,addPreset:n,$get:r};return o.addPreset("build",{methods:["controller","controllerAs","resolve","template","templateUrl","themable","transformTemplate","parent"]}),r.$inject=["$$interimElement","$animate","$injector"],o}function t(e,t,n,r,i,a,o,s){function c(e){return e&&angular.isString(e)?e.replace(/\{\{/g,l).replace(/}}/g,u):e}var l=o.startSymbol(),u=o.endSymbol(),d="{{"===l&&"}}"===u,p=d?angular.identity:c;return function(){function o(e){e.zIndex=80+f.length;var t=new u(e);return f.unshift(t),t.show().then(function(){return t.deferred.promise})}function c(e,n){var r;return void 0!==n?(r=n,f.splice(f.indexOf(n),1)):r=f.shift(),r&&r.remove().then(function(){r.deferred.resolve(e)}),r?r.deferred.promise:t.when(e)}function l(e,n){var r;return void 0!==n?(r=n,f.splice(f.indexOf(n),1)):r=f.shift(),r&&r.remove().then(function(){r.deferred.reject(e)}),r?r.deferred.promise:t.reject(e)}function u(o){var c,l,u;return o=o||{},o=angular.extend({scope:o.scope||n.$new(o.isolateScope),onShow:function(e,t,n){return a.enter(t,n.parent)},onRemove:function(e,n,r){return n&&a.leave(n)||t.when()}},o),o.template&&(o.template=p(o.template)),c={options:o,deferred:t.defer(),show:function(){return s.compile(o).then(function(n){function a(){o.hideDelay&&(l=r(d.cancel,o.hideDelay))}angular.extend(n.locals,c.options),angular.isString(o.parent)?o.parent=angular.element(e[0].querySelector(o.parent)):o.parent||(o.parent=i.find("body"),o.parent.length||(o.parent=i)),u=n.link(o.scope),u.css("z-index",o.zIndex);var s=o.onShow(o.scope,u,o);return t.when(s).then(function(){(o.onComplete||angular.noop)(o.scope,u,o),a()})})},cancelTimeout:function(){l&&(r.cancel(l),l=void 0)},remove:function(){c.cancelTimeout();var e=o.onRemove(o.scope,u,o);return t.when(e).then(function(){o.scope.$destroy()})}},o.interimElement=c,o.stack=f,c}var d,f=[];return d={show:o,hide:c,cancel:l}}}return e.$get=t,t.$inject=["$document","$q","$rootScope","$timeout","$rootElement","$animate","$interpolate","$mdCompiler"],e}angular.module("material.core").provider("$$interimElement",e)}(),function(){function e(){function e(e){function t(e){return a.optionsFactory=e.options,a.methods=(e.methods||[]).concat(i),o}function n(t,n){if(n=n||{},n.methods=n.methods||[],n.options=n.options||function(){return{}},/^cancel|hide|show$/.test(t))throw new Error("Preset '"+t+"' in "+e+" is reserved!");if(n.methods.indexOf("_options")>-1)throw new Error("Method '_options' in "+e+" is reserved!");return a.presets[t]={methods:n.methods.concat(i),optionsFactory:n.options,argOption:n.argOption},o}function r(t,n,r){function i(e){return e&&e._options&&(e=e._options),l.show(angular.extend({},c,e))}function o(t,n){var i={};return i[e]=u,r.invoke(t||function(){return n},{},i)}var s,c,l=t(),u={hide:l.hide,cancel:l.cancel,show:i};return s=a.methods||[],c=o(a.optionsFactory,{}),angular.forEach(a.presets,function(e,t){function n(e){this._options=angular.extend({},r,e)}var r=o(e.optionsFactory,{}),i=(e.methods||[]).concat(s);if(angular.extend(r,{$type:t}),angular.forEach(i,function(e){n.prototype[e]=function(t){return this._options[e]=t,this}}),e.argOption){var a="show"+t.charAt(0).toUpperCase()+t.slice(1);u[a]=function(e){var n=u[t](e);return u.show(n)}}u[t]=function(t){return arguments.length&&e.argOption&&!angular.isObject(t)&&!angular.isArray(t)?(new n)[e.argOption](t):new n(t)}}),u}var i=["onHide","onShow","onRemove"],a={presets:{}},o={setDefaults:t,addPreset:n,$get:r};return o.addPreset("build",{methods:["controller","controllerAs","resolve","template","templateUrl","themable","transformTemplate","parent"]}),r.$inject=["$$interimStackableElement","$animate","$injector"],o}function t(e,t,n,r,i,a,o,s){function c(e){return e&&angular.isString(e)?e.replace(/\{\{/g,l).replace(/}}/g,u):e}var l=o.startSymbol(),u=o.endSymbol(),d="{{"===l&&"}}"===u,p=d?angular.identity:c;return function(){function o(e){e.zIndex=80+f.length;var t=new u(e);return f.unshift(t),t.show().then(function(){return t.deferred.promise})}function c(e,n){var r;return void 0!==n?(r=n,f.splice(f.indexOf(n),1)):r=f.shift(),r&&r.remove().then(function(){r.deferred.resolve(e)}),r?r.deferred.promise:t.when(e)}function l(e,n){var r;return void 0!==n?(r=n,f.splice(f.indexOf(n),1)):r=f.shift(),r&&r.remove().then(function(){r.deferred.reject(e)}),r?r.deferred.promise:t.reject(e)}function u(o){var c,l,u;return o=o||{},o=angular.extend({scope:o.scope||n.$new(o.isolateScope),onShow:function(e,t,n){return a.enter(t,n.parent)},onRemove:function(e,n,r){return n&&a.leave(n)||t.when()}},o),o.template&&(o.template=p(o.template)),c={options:o,deferred:t.defer(),show:function(){return s.compile(o).then(function(n){function a(){o.hideDelay&&(l=r(d.cancel,o.hideDelay))}angular.extend(n.locals,c.options),angular.isString(o.parent)?o.parent=angular.element(e[0].querySelector(o.parent)):o.parent||(o.parent=i.find("body"),o.parent.length||(o.parent=i)),u=n.link(o.scope),u.css("z-index",o.zIndex);var s=o.onShow(o.scope,u,o);return t.when(s).then(function(){(o.onComplete||angular.noop)(o.scope,u,o),a()})})},cancelTimeout:function(){l&&(r.cancel(l),l=void 0)},remove:function(){c.cancelTimeout();var e=o.onRemove(o.scope,u,o);return t.when(e).then(function(){o.scope.$destroy()})}},o.interimElement=c,o.stack=f,c}var d,f=[];return d={show:o,hide:c,cancel:l}}}return e.$get=t,t.$inject=["$document","$q","$rootScope","$timeout","$rootElement","$animate","$interpolate","$mdCompiler"],e}angular.module("material.core").provider("$$interimStackableElement",e)}(),function(){function e(e,t){function n(e){return e&&""!==e}var r,i=[],a={};return r={notFoundError:function(t){e.error("No instance found for handle",t)},getInstances:function(){return i},get:function(e){if(!n(e))return null;var t,r,a;for(t=0,r=i.length;r>t;t++)if(a=i[t],a.$$mdHandle===e)return a;return null},register:function(e,t){function n(){var t=i.indexOf(e);-1!==t&&i.splice(t,1)}function r(){var n=a[t];n&&(n.resolve(e),delete a[t])}return t?(e.$$mdHandle=t,i.push(e),r(),n):angular.noop},when:function(e){if(n(e)){var i=t.defer(),o=r.get(e);return o?i.resolve(o):a[e]=i,i.promise}return t.reject("Invalid `md-component-id` value.")}}}angular.module("material.core").factory("$mdComponentRegistry",e),e.$inject=["$log","$q"]}(),function(){function e(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")?!0:!1}function t(e,t){return{controller:angular.noop,link:function(t,n,r){r.hasOwnProperty("mdInkRippleCheckbox")?e.attachCheckboxBehavior(t,n):e.attachButtonBehavior(t,n)}}}function n(t,n,r,i,a){function o(e,t,n){return l(e,t,angular.extend({isFAB:t.hasClass("md-fab"),isMenuItem:t.hasClass("md-menu-item"),center:!1,dimBackground:!0},n))}function s(e,t,n){return l(e,t,angular.extend({center:!0,dimBackground:!1,fitRipple:!0},n))}function c(e,t,n){return l(e,t,angular.extend({center:!1,dimBackground:!0,outline:!0},n))}function l(t,i,o){function s(t){b&&clearTimeout(b),b=setTimeout(function(){c(t)},e()?90:0)}function c(e,t){if(l()){var r="ripple-animation",o={top:0,left:0},s=0,d=0;if(e.target&&(f=0,h=void 0,g=!1),u&&e.target){var p=$(e.target),y=!1;if(angular.forEach(u,function(e){(p.is(e)||p.parent().is(e))&&(y=!0)}),y)return}v=!0;var _={};_.style={top:"0",left:"0"};var b=angular.element('<div class="ripple-active"></div>');b.css(_.style),h?"ripple-dark"===h?(b.addClass("ripple-light"),h="ripple-light"):(b.addClass("ripple-dark"),h="ripple-dark"):i[0].hasAttribute("ripple-dark")?(b.addClass("ripple-dark"),g&&(h="ripple-dark")):i[0].hasAttribute("ripple-light")&&(b.addClass("ripple-light"),g&&(h="ripple-light")),i.find(".ripple-active").remove(),i.append(b);var w=i[0].hasAttribute("md-ink-ripple-action")||i[0].hasAttribute("ripple-action");if(w)_.style={top:"0px",left:"0px",height:i.outerWidth()+"px",width:i.outerWidth()+"px"},r+=" ripple-action";else if(i[0].hasAttribute("md-ink-ripple-switch"))_.style={top:"-14px",left:"-14px",height:"48px",width:"48px"};else{o=i[0].getBoundingClientRect(),d=o.width,s=o.height;var k=2*Math.round(Math.sqrt(d*d+s*s));k>2e3&&(k=2e3);var C=-(k/2);_.style={top:e.clientY-o.top,left:e.clientX-o.left,height:k,width:k,"margin-top":C,"margin-left":C}}b.css(_.style);var S=(new Date).getTime();n(function(){a(b,{addClass:r}).start().done(function(){b.removeClass(r);var e,n="infinite"===f;(n||f)&&t&&(n||(f-=1),e=(new Date).getTime()-S,setTimeout(function(){c({clientY:o.top+s/2,clientX:o.left+d/2},m)},m-e))})},0,!1)}}function l(){function e(e){var t=e&&e.hasAttribute&&e.hasAttribute("disabled");return t||(t=$(e).hasClass("md-ink-ripple-disabled")),t}var t=y.parentNode,n=t&&t.parentNode,r=n&&n.parentNode;return!(e(y)||e(t)||e(n)||e(r))}if(i.controller("mdNoInk"))return angular.noop;var u=i.attr("md-ink-ripple-ignore"),d=i.attr("md-ink-ripple-click")?"click":"$md.pressdown",p=t.$eval(i.attr("md-ink-ripple-pulsate-options"))||{},f=p.repeat||9,g=p.color||!1,m=p.speed||2e3,h=p.color?"ripple-dark":null;u=u?r(u)(t):void 0,o=angular.extend({colorElement:i,mousedown:!0,hover:!0,focus:!0,center:!1,mousedownPauseTime:150,dimBackground:!1,outline:!1,isFAB:!1,isMenuItem:!1,fitRipple:!1},o);var v=(i.controller("mdInkRipple")||{},i.attr("md-highlight"),!1),y=i[0],_=i.attr("md-ripple-size");switch(_){case"full":o.isFAB=!0;break;case"partial":o.isFAB=!1}return i.addClass("ripple-presence"),i.on(d,s),i.attr("md-ink-ripple-pulsate")&&t.$watch(i.attr("md-ink-ripple-pulsate"),function(e){if(e){var t=i[0].getBoundingClientRect();c({clientY:t.top+t.width/2,clientX:t.left+t.height/2},m)}}),function(){i.off(d,s),i.removeClass("ripple-presence")};var b}return{attachButtonBehavior:o,attachCheckboxBehavior:s,attachTabBehavior:c,attach:l}}function r(){return function(){return{controller:angular.noop}}}angular.module("material.core").factory("$mdInkRipple",n).directive("mdInkRipple",t).directive("mdNoInk",r()).directive("mdNoBar",r()).directive("mdNoStretch",r()),t.$inject=["$mdInkRipple","$parse"],n.$inject=["$window","$timeout","$parse","$$rAF","$animateCss"]}()}(),function(){function e(e){function t(e,t,n){}function n(t,n,r){var i=this;i.isErrorGetter=r.mdIsError&&e(r.mdIsError),i.element=n,i.setFocused=function(e){n.toggleClass("md-input-focused",!!e)},i.setHasValue=function(e){n.toggleClass("md-input-has-value",!!e)},i.setNoFloat=function(e){n.toggleClass("md-input-no-float",!!e)},i.setInvalid=function(e){n.toggleClass("md-input-invalid",!!e)},t.$watch(function(){return i.label&&i.input},function(e){e&&!i.label.attr("for")&&i.label.attr("for",i.input.attr("id"))})}return n.$inject=["$scope","$element","$attrs"],{restrict:"E",link:t,controller:n}}function t(){return{restrict:"E",require:"^?mdInputContainer",link:function(e,t,n,r){r&&(r.label=t,e.$on("$destroy",function(){r.label=null}))}}}function n(e,t,n,r){function i(t,n,r,i){function a(e){return s.setHasValue(!c.$isEmpty(e)),e}function o(){s.setHasValue(n.val().length>0||(n[0].validity||{}).badInput)}var s=i[0],c=i[1]||e.fakeNgModel(),l=angular.isDefined(r.readonly);if(s){if(s.input)throw new Error("<md-input-container> can only have *one* <input> or <textarea> child element!");s.input=n,n.addClass("md-input"),n.attr("id")||n.attr("id","input_"+e.nextUid());var u=s.isErrorGetter||function(){return c.$invalid&&(c.$dirty||c.$touched)};t.$watch(u,s.setInvalid),c.$parsers.push(a),c.$formatters.push(a),n.on("input",o),l||n.on("focus",function(e){s.setFocused(!0)}).on("blur",function(e){s.setFocused(!1),o()}),t.$on("$destroy",function(){s.setFocused(!1),s.setHasValue(!1),s.input=null})}}return{restrict:"E",require:["^?mdInputContainer","?ngModel"],link:i}}function r(e){function t(t,n,r,i){function a(e){return l.text((n.val()||e||"").length+"/"+o),e}var o,s=i[0],c=i[1],l=angular.element('<div class="md-char-counter">');r.$set("ngTrim","false"),c.element.append(l),s.$formatters.push(a),s.$viewChangeListeners.push(a),n.on("input keydown",function(){a()}),t.$watch(r.mdMaxlength,function(t){o=t,angular.isNumber(t)&&t>0?(l.parent().length||e.enter(l,c.element,angular.element(c.element[0].lastElementChild)),a()):e.leave(l)}),s.$validators["md-maxlength"]=function(e,t){return!angular.isNumber(o)||0>o?!0:(e||n.val()||t||"").length<=o}}return{restrict:"A",require:["ngModel","^mdInputContainer"],link:t}}function i(){function e(e,t,n,r){if(r&&!t[0].hasAttribute("native-placeholder")){var i=n.placeholder;t.removeAttr("placeholder"),r.element.append('<div class="md-placeholder">'+i+"</div>")}}return{restrict:"A",require:"^^?mdInputContainer",link:e}}angular.module("material.components.input",["material.core"]).directive("mdInputContainer",e).directive("label",t).directive("input",n).directive("textarea",n).directive("mdMaxlength",r).directive("placeholder",i),e.$inject=["$parse"],n.$inject=["$mdUtil","$window","$compile","$animate"],r.$inject=["$animate"]}(),function(){"use strict";function e(e,t){function n(n,r,i,a){function o(n){switch(n.keyCode){case t.KEY_CODE.LEFT_ARROW:case t.KEY_CODE.UP_ARROW:n.preventDefault(),s.selectPrevious();break;case t.KEY_CODE.RIGHT_ARROW:case t.KEY_CODE.DOWN_ARROW:n.preventDefault(),s.selectNext();break;case t.KEY_CODE.ENTER:var i=angular.element(e.getClosest(r[0],"form"));i.length>0&&i.triggerHandler("submit")}}var s=a[0],c=a[1]||e.fakeNgModel();s.init(c),r.attr({role:"radiogroup",tabIndex:r.attr("tabindex")||"0"}).on("keydown",o)}function r(e){this._radioButtonRenderFns=[],this.$element=e}function i(){return{init:function(e){this._ngModelCtrl=e,this._ngModelCtrl.$render=angular.bind(this,this.render)},add:function(e){this._radioButtonRenderFns.push(e)},remove:function(e){var t=this._radioButtonRenderFns.indexOf(e);-1!==t&&this._radioButtonRenderFns.splice(t,1)},render:function(){this._radioButtonRenderFns.forEach(function(e){e()})},setViewValue:function(e,t){this._ngModelCtrl.$setViewValue(e,t),this.render()},getViewValue:function(){return this._ngModelCtrl.$viewValue},selectNext:function(){return a(this.$element,1)},selectPrevious:function(){return a(this.$element,-1)},setActiveDescendant:function(e){this.$element.attr("aria-activedescendant",e)}}}function a(t,n){var r=e.iterator(Array.prototype.slice.call(t[0].querySelectorAll("md-radio-button")),!0);if(r.count()){var i=function(e){return!angular.element(e).attr("disabled")},a=t[0].querySelector("md-radio-button.md-checked"),o=r[0>n?"previous":"next"](a,i)||r.first();angular.element(o).triggerHandler("click")}}return r.prototype=i(),{restrict:"E",controller:["$element",r],require:["mdRadioGroup","?ngModel"],link:{pre:n}}}function t(e,t){function n(n,i,a,o){function s(e){i[0].hasAttribute("disabled")||n.$apply(function(){o.setViewValue(a.value,e&&e.type)})}function c(){var e=o.getViewValue()==a.value;e!==u&&(u=e,i.attr("aria-checked",e),e?(i.addClass(r),o.setActiveDescendant(i.attr("id"))):i.removeClass(r))}function l(n,r){function i(){return a.id||"radio_"+t.nextUid()}r.ariaId=i(),n.attr({id:r.ariaId,role:"radio","aria-checked":"false"}),e.expectWithText(n,"aria-label")}var u;l(i,n),o.add(c),a.$observe("value",c),i.on("click",s).on("$destroy",function(){o.remove(c)})}var r="md-checked";return{restrict:"E",require:"^mdRadioGroup",transclude:!0,template:'<div class="md-container list-primary-tile"><div class="avatar-small"><div><icon class="button-square" type="radio_button_checked"></icon><icon class="button-square" type="radio_button_unchecked"></icon></div></div></div><div ng-transclude class="md-label"></div>',link:n}}angular.module("material.components.radioButton",["material.core"]).directive("mdRadioGroup",e).directive("mdRadioButton",t),e.$inject=["$mdUtil","$mdConstant"],t.$inject=["$mdAria","$mdUtil"]}(),function(){"use strict";function e(e,t){return function(n){var r="SideNav '"+n+"' is not available!",i=e.get(n);return i||e.notFoundError(n),{isOpen:function(){return i&&i.isOpen()},isLockedOpen:function(){return i&&i.isLockedOpen()},toggle:function(){return i?i.toggle():t.reject(r)},open:function(){return i?i.open():t.reject(r)},close:function(){return i?i.close():t.reject(r)}}}}function t(e,t,n,r,i,a,o,s,c,l){function u(i,l,u,d){function p(e,t){i.isLockedOpen=e,e===t?l.toggleClass("md-locked-open",!!e):$animate[e?"addClass":"removeClass"](l,"md-locked-open"),k.toggleClass("md-locked-open",!!e)}function f(n){if(_)return void(_=!1);var r=(l.parent(),[]);k[n?"on":"off"]("click",function(t){var n=this;e(function(){h.apply(n,t)})}),c[n?"queue":"dequeue"](m),n&&(v=s[0].activeElement),l.before(k);var a=function(){i.isOpen&&l.focus(),$=!1,i.stateChanged&&i.stateChanged(i.isOpen)},u=function(){i.isOpen||k.remove()};return n?(l.removeClass("invisible out"),k.removeClass("out"),r.push(t(k,{addClass:"in"}).start().done(u)),r.push(t(l,{addClass:"in"}).start().done(a))):(l.removeClass("in"),k.removeClass("in"),r.push(t(k,{addClass:"out"}).start().done(u)),r.push(t(l,{addClass:"out"}).start().done(a))),y=o.all(r)}function g(t){if(i.isOpen==t||$)return o.when(!0);$=!0;var n=o.defer();return i.isOpen=t,e(function(){y.then(function(e){i.isOpen||(v&&v.focus(),v=null),n.resolve(e)})},0,!1),n.promise}function m(t){return e(function(){h(t)}),!0}function h(e){return e&&(e.preventDefault(),e.stopPropagation()),d.close()}var v=null,y=o.when(!0),$=!1,_=!i.isOpen,b=n(u.mdIsLockedOpen),w=function(){return b(i.$parent,{$media:r})},k=a('<md-backdrop class="md-sidenav-backdrop md-opaque fade">')(i);l.on("$destroy",d.destroy);l.css("width");i.$watch(w,p),i.$watch("isOpen",f),i.$on("$destroy",function(){}),d.$toggleOpen=g}return{restrict:"E",scope:{isOpen:"=?mdIsOpen",componentID:"=?mdComponentId",stateChanged:"=?mdStateChanged"},controller:"$mdSidenavController",compile:function(e){return e.addClass("md-closed slide drawer out invisible"),e.attr("tabIndex","-1"),u}}}function n(e,t,n,r,i,a){var o=this;o.$toggleOpen=function(){return i.when(e.isOpen)},o.isOpen=function(){return!!e.isOpen},o.isLockedOpen=function(){return!!e.isLockedOpen},o.open=function(){return o.$toggleOpen(!0)},o.close=function(){return o.$toggleOpen(!1)},o.toggle=function(){return o.$toggleOpen(!e.isOpen)},o.destroy=r.register(o,e.componentID||n.mdComponentId)}angular.module("material.components.sidenav",["material.core"]).factory("$mdSidenav",e).directive("mdSidenav",t).controller("$mdSidenavController",n).run(["helpers","$mdSidenav","$timeout","$q",function(e,t,n,r){e.sideNav||(e.sideNav={}),e.sideNav.setup=function(e,i,a){a||(a=[]),i+=_.uniqueId(),e.id=i,e.notRipplable=a,e.toggling=!1,e.close=function(){return e.toggle(void 0,"close")},e.open=function(){return e.toggle(void 0,"open")},e.get=function(){return t(e.id)},e.toggle=function(t,i){var a,o=e.get(),s=!1,c=r.defer(),l=c.promise;return e.toggling?(c.resolve(),l):t&&t.target&&(a=$(t.target),angular.forEach(e.notRipplable,function(e){(a.is(e)||a.parent().is(e))&&(s=!0)}),s)?(c.resolve(),l):(e.toggling=!0,n(function(){o[i||(o.isOpen()?"close":"open")]().then(function(){e.toggling=!1,c.resolve()})}),l)}}}]),e.$inject=["$mdComponentRegistry","$q"],t.$inject=["$timeout","$animateCss","$parse","$mdMedia","$mdConstant","$compile","$q","$document","mdContextualMonitor"],n.$inject=["$scope","$element","$attrs","$mdComponentRegistry","$q","$parse"]}(),function(){"use strict";function e(e,t){var n=[],r=!1,i=1,a=function(){return i+=1},o=function(){!n.length&&window.location.hash.length&&(window.location.hash="",i=1)},s=function(e){var t=n.pop(),r=t&&t(e);return!r&&t&&n.push(t),o(),r};return{dequeue:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),o()},queue:function(i){if(window.ENGINE.DESKTOP.ACTIVE){var o="context-monitor-",c=window.location.hash,l=a();r||(e.on("keyup",function(e){e.keyCode===t.KEY_CODE.ESCAPE&&(s(e)||e.preventDefault())}),$(window).bind("hashchange",function(e){var t,n=window.location.hash,r=parseInt(n.substr(o.length+1),10),i=parseInt(c.substr(o.length+1),10);(isNaN(r)||!isNaN(i)&&i>r)&&(t=!0),c=n,t&&(s()||e.preventDefault())}),r=!0),window.location.hash=o+l,n.push(i)}}}}function t(e){return{restrict:"E"}}function n(e){function t(e,t,n,r,i,a,o,s,c,l,u,d){function p(e){return"simple-dialog"}function f(e,t){}function g(t,n,i){function a(){var e=n[0].querySelector(".dialog-close");if(!e){var t=n[0].querySelectorAll(".md-actions button");e=t[t.length-1]}return angular.element(e)}i.parent=angular.element(i.parent),i.popInTarget=angular.element(i.popFrom);var o=a(),s=p(i),c=n.find(s);return h(c),i.disableScrollInfo=[],i.disableScroll||(i.disableScroll=[]),i.disableParentScroll&&i.disableScroll.push(i.parent),angular.forEach(i.disableScroll,function(e){i.disableScrollInfo.push({old:{"overflow-y":e.css("overflow-y"),"overflow-x":e.css("overflow-x")},element:e}),e.css("overflow","hidden"),e.css("overflow-wrap","normal"===e.css("overflow-wrap")?"break-word":"normal")}),i.hasBackdrop&&(i.backdrop=angular.element('<md-backdrop class="simple-dialog-backdrop" style="z-index: '+i.zIndex+'">'),r.enter(i.backdrop,i.parent)),c.css("z-index",i.zIndex+1),v(n,i).then(function(){i.rootElementKeyupCallback=function(){return 0===i.stack.indexOf(i.interimElement)&&e(function(){u.cancel("esc",i.interimElement)}),!0},d.queue(i.rootElementKeyupCallback),i.clickOutsideToClose&&(i.dialogClickOutsideCallback=function(t){t.target===i.backdrop[0]&&e(u.cancel)},i.backdrop.on("click",i.dialogClickOutsideCallback)),o.focus()})}function m(e,t,n){return n.clickOutsideToClose&&n.backdrop&&n.backdrop.off("click",n.dialogClickOutsideCallback),n.backdrop&&r.leave(n.backdrop),angular.forEach(n.disableScrollInfo,function(e){e.element.css(e.old),e.element.css("overflow-wrap","normal"===e.element.css("overflow-wrap")?"break-word":"normal")}),n.disableScrollInfo=[],a[0].removeEventListener("scroll",n.captureScroll,!0),d.dequeue(n.rootElementKeyupCallback),$(t,n).then(function(){n.scope.$destroy(),t.remove(),n.popInTarget&&n.popInTarget.focus()})}function h(e){e.attr({role:"dialog"});var t=e.find("md-content");0===t.length&&(t=e),i.expectAsync(e,"aria-label",function(){var e=t.text().split(/\s+/);return e.length>3&&(e=e.slice(0,3).concat("...")),e.join(" ")})}function v(e,t){f(e,t);var n,r,i=e.find(p(t)),a=t.parent,o=l.defer();return a.append(e),n=o.promise,r=n.then(function(){var e,n=l.defer(),r=n.promise;return t.onBeforeShow&&(e=t.onBeforeShow(i,t),e&&e.then)?e:(n.resolve(),r)}),o.resolve(),r}function y(e){function t(r){r.target===e[0]&&(e.off(s.CSS.TRANSITIONEND,t),n.resolve())}var n=l.defer();return e.on(s.CSS.TRANSITIONEND,t),n.promise}function $(e,t){f(e,t);var n,r,i=e.find(p(t));return t.onBeforeHide&&t.onBeforeHide(i,t),i.hasClass("fade")?(r=l.defer(),i.oneAnimationEnd(function(){r.resolve()}),i.removeClass("in").addClass("out"),n=r.promise):(n=y(i),n.then(function(){t.onAfterHide&&t.onAfterHide(i,t)}),i.removeClass("transition-in").addClass("transition-out"),setTimeout(function(){i.addClass("opacity-out")},50)),n}return{hasBackdrop:!0,isolateScope:!0,onShow:g,onRemove:m,clickOutsideToClose:!0,popFrom:null,disableParentScroll:!0,transformTemplate:function(e){return'<div class="simple-dialog-container">'+e+"</div>"}}}return t.$inject=["$timeout","$rootElement","$compile","$animate","$mdAria","$document","$mdUtil","$mdConstant","$$rAF","$q","$simpleDialog","mdContextualMonitor"],e("$simpleDialog").setDefaults({methods:["disableParentScroll","hasBackdrop","clickOutsideToClose","popFrom"],options:t})}angular.module("material.components.simpledialog",["material.core"]).factory("mdContextualMonitor",e).directive("simpleDialog",t).provider("$simpleDialog",n),e.$inject=["$rootElement","$mdConstant"],t.$inject=["$$rAF"],n.$inject=["$$interimElementProvider"]}(),function(){"use strict";var e=angular.module("material.components.swipe",[]);["SwipeLeft","SwipeRight"].forEach(function(t){var n="md"+t,r="$md."+t.toLowerCase();e.directive(n,["$parse",function(e){function t(t,i,a){var o=e(a[n]);i.on(r,function(e){t.$apply(function(){o(t,{$event:e})})})}return{restrict:"A",link:t}}])})}(),function(){"use strict";function e(e,t,n){return{restrict:"E",replace:!0,scope:{fid:"@?mdFid",label:"@?",value:"=ngModel"},compile:function(r,i){return n.warn("<md-text-float> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer"),angular.isUndefined(i.mdFid)&&(i.mdFid=e.nextUid()),{pre:function(e,n,r){var i=t(r.ngDisabled);e.isDisabled=function(){return i(e.$parent)},e.inputType=r.type||"text"}}},template:'<md-input-group tabindex="-1"> <label for="{{fid}}" >{{label}}</label> <md-input id="{{fid}}" ng-disabled="isDisabled()" ng-model="value" type="{{inputType}}"></md-input></md-input-group>'}}function t(e){return{restrict:"CE",controller:["$element",function(t){e.warn("<md-input-group> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer"),this.setFocused=function(e){t.toggleClass("md-input-focused",!!e)},this.setHasValue=function(e){t.toggleClass("md-input-has-value",e)}}]}}function n(e,t){return{restrict:"E",replace:!0,template:"<input >",require:["^?mdInputGroup","?ngModel"],link:function(e,n,r,i){function a(e){return e=angular.isUndefined(e)?n.val():e,angular.isDefined(e)&&null!==e&&""!==e.toString().trim()}if(i[0]){t.warn("<md-input> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer");var o=i[0],s=i[1];e.$watch(e.isDisabled,function(e){n.attr("aria-disabled",!!e),n.attr("tabindex",!!e)}),n.attr("type",r.type||n.parent().attr("type")||"text"),s&&s.$formatters.push(function(e){return o.setHasValue(a(e)),e}),n.on("input",function(){o.setHasValue(a())}).on("focus",function(e){o.setFocused(!0)}).on("blur",function(e){o.setFocused(!1),o.setHasValue(a())}),e.$on("$destroy",function(){o.setFocused(!1),o.setHasValue(!1)})}}}}angular.module("material.components.textField",["material.core"]).directive("mdInputGroup",t).directive("mdInput",n).directive("mdTextFloat",e),e.$inject=["$mdUtil","$parse","$log"],t.$inject=["$log"],n.$inject=["$mdUtil","$log"]}(),function(){"use strict";angular.module("app").factory("snackbar",["GLOBAL_CONFIG",function(e){var t={show:$.noop,hide:$.noop,showK:function(n,r){var i=e.snackbar.messages[n];return angular.isUndefined(i)&&(i=n),t.show($.extend({message:i},r))}};return e.debug&&(window._snackbar=t),t}]).directive("qsnackbar",["snackbar",function(e){return{link:function(t,n){var r=function(){e.hide()};n.on("click",r),t.$on("$destroy",function(){n.off("click",r)})}}}]).directive("ngClick",["snackbar",function(e){return{restrict:"A",priority:100,link:function(t,n,r){var i=function(){e.animating||e.hide()};n.on("click",i),t.$on("$destroy",function(){n.off("click",i)})}}}]).directive("snackbar",["snackbar","$timeout","$animate","$animateCss","$q",function(e,t,n,r,i){return{scope:!0,require:"snackbar",templateUrl:"core/snackbar/view.html",controller:["$scope",function(t){var r,a=function(){t.$$phase||t.$digest()};t.message="",t.size=1,t.element=null,e.animating=!1,e.hide=function(){var e=i.defer();return n.removeClass(t.element,"in"),t.element.hasClass("out")?e.resolve():(n.addClass(t.element,"out").then(function(){e.resolve()}),a()),e.promise},e.show=function(i){return angular.isObject(i)||(i={message:i}),t.message=i.message,i.hideAfter||(i.hideAfter=t.message.length/16*2e3+500),t.size=i.size,t.calculateSize=function(){return t.size?t.size:t.element.find(".brief").height()>16?2:1},a(),e.animating=!0,e.hide().then(function(){return n.removeClass(t.element,"out"),n.addClass(t.element,"in").then(function(){e.animating=!1,i.hideAfter&&(r&&clearTimeout(r),r=setTimeout(function(){e.hide()},i.hideAfter))})})}}],controller2:["$scope",function(t){var n,i=function(){t.$$phase||t.$digest()};t.message="",t.size=1,t.element=null,e.animating=!1,e.hide=function(){return t.element.removeClass("in"),r(t.element,{addClass:"out"}).start()},e.show=function(a){return angular.isObject(a)||(a={message:a}),t.message=a.message,a.hideAfter||(a.hideAfter=t.message.length/16*2e3+500),t.size=a.size,t.calculateSize=function(){return t.size?t.size:t.element.find(".brief").height()>16?2:1},e.hide().done(function(){return t.element.removeClass("out"),r(t.element,{addClass:"in"}).start().done(function(){a.hideAfter&&(n&&clearTimeout(n),n=setTimeout(function(){e.hide()},a.hideAfter),i())})})}}],link:function(e,t,n){e.element=t.find(".snackbar")}}}])}(),function(){"use strict";function e(e,t,n){return{restrict:"E",controller:angular.noop,link:function(r,i,a){function o(){function o(t,n){i.parent()[0]===n.parent()[0]&&(u&&u.off("scroll",g),n.on("scroll",g),n.attr("scroll-shrink","true"),u=n,e(s))}function s(){l=i.prop("offsetHeight"),u.css("margin-top",-l*f+"px"),c()}function c(e){var n=e?e.target.scrollTop:p;m(),d=Math.min(l/f,Math.max(0,d+n-p)),i.css(t.CSS.TRANSFORM,"translate3d(0,"+-d*f+"px,0)"),u.css(t.CSS.TRANSFORM,"translate3d(0,"+(l-d)*f+"px,0)"),p=n}var l,u,d=0,p=0,f=a.mdShrinkSpeedFactor||.5,g=e.throttle(c),m=n.debounce(s,5e3);r.$on("$mdContentLoaded",o)}angular.isDefined(a.mdScrollShrink)&&o()}}}angular.module("material.components.toolbar",["material.core","material.components.content"]).directive("mdToolbar",e).run(["helpers","GLOBAL_CONFIG",function(e,t){angular.isUndefined(e.toolbar)&&(e.toolbar={}),$.extend(e.toolbar,{title:function(e,n){
var r,i=t.toolbar.titles,a=[],o=i[e];return n||(n=" / "),angular.isDefined(o)?angular.isArray(o)?o.join(n):o:(r=angular.isArray(e)?e:e.split("."),angular.forEach(r,function(e,t){var n=i[e];n!==!1&&a.push(angular.isDefined(n)?n:e)}),a.length?a.join(n):e)},buildTitle:function(t){var n=[];return angular.forEach(t,function(e){n.push(e())}),e.toolbar.title(n.join("."))},makeTitle:function(e){return _.string.capitalize(_.string.camelize(e))}})}]),e.$inject=["$$rAF","$mdConstant","$mdUtil"]}(),function(){"use strict";angular.module("app").directive("actionDropdownList",function(){return{templateUrl:"core/action/dropdown_list.html",transclude:!0,replace:!0}}).directive("actionDropdown",["$simpleDialog","$$rAF","$mdConstant","underscoreTemplate","$timeout","$parse","$q","helpers","$animateCss",function(e,t,n,r,i,a,o,s,c){return{replace:!0,transclude:!0,templateUrl:"core/action/dropdown.html",scope:!0,link:function(t,n,r){var a={},s=t.$eval(r.template);s&&(a.opened=!1,a.open=function(e){a.opened||(a.opened=!0,i(function(){a.openSimpleDialog(e)}))},a.openSimpleDialog=function(i){e.show({templateUrl:s,popFrom:i.target,parent:n.parents(r.parent),onBeforeHide:function(e,t){$(window).off("resize",t.resize)},onBeforeShow:function(e,t){var i=o.defer(),s=i.promise,l=function(){var a=n;return t.resize=function(){var n=a.offset(),i=t.parent,o=parseInt(i.css("padding-top"),10)||24,s=parseInt(i.css("padding-bottom"),10)||24,c=n.top,l=n.left-(e.width()-a.outerWidth())-12,u=i.height()-(s+o),d=i.width()-e.width()-16;c=n.top,16>c&&(c=16),16>l&&(l=16),l>d&&(l=d),r.fixedPosition?"toolbar"===r.fixedPosition&&e.css({top:"8px",left:"auto",right:"8px"}):e.css({top:c,left:l}),e.height()>u&&e.height(u)},t.resize(),$(window).on("resize",t.resize),e.addClass("fade"),c(e,{addClass:"in"}).start().done(function(){n.addClass("opacity-in"),i.resolve()}),s};l(),e.on("click",a.close)},controller:["$scope",function(e){e.parent=t,e.$on("$destroy",function(){a.opened=!1})}]})},a.close=function(){e.hide()},t.dropdown=a)}}}]).directive("actionToolbar",function(){return{transclude:!0,replace:!0,scope:!0,templateUrl:"core/action/toolbar.html",link:function(e,t,n){e.spec=e.$eval(n.spec),e.$on("modalStateComplete",function(){e.spec=e.$eval(n.spec)})}}})}(),function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){function r(e,t,n){for(var r=e[n],i=t(r);n>0;){var a=Math.floor((n+1)/2)-1,o=e[a];if(i>=t(o))break;e[a]=r,e[n]=o,n=a}}function i(e,t,n){for(var r=e.length,i=e[n],a=t(i);;){var o=2*(n+1),s=o-1,c=null;if(r>s){var l=e[s],u=t(l);a>u&&(c=s)}if(r>o){var d=e[o],p=t(d);p<(null===c?a:t(e[s]))&&(c=o)}if(null===c)break;e[n]=e[c],e[c]=i,n=c}}function a(e){if(e&&!angular.isFunction(e))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");e=e||function(e){return e},this.weightFunc=e,this.heap=[]}function o(){this.$get=function(){return a}}a.prototype.push=function(e){this.heap.push(e),r(this.heap,this.weightFunc,this.heap.length-1)},a.prototype.peek=function(){return this.heap[0]},a.prototype.pop=function(){var e=this.heap[0],t=this.heap.pop();return this.heap.length>0&&(this.heap[0]=t,i(this.heap,this.weightFunc,0)),e},a.prototype.remove=function(e){for(var t=this.heap.length,n=0;t>n;n++)if(angular.equals(this.heap[n],e)){var a=this.heap[n],o=this.heap.pop();return n!==t-1&&(this.heap[n]=o,r(this.heap,this.weightFunc,n),i(this.heap,this.weightFunc,n)),a}return null},a.prototype.removeAll=function(){this.heap=[]},a.prototype.size=function(){return this.heap.length},t.exports={DSBinaryHeapProvider:o,DSBinaryHeap:a}},{}],2:[function(e,t,n){t.exports=function(){clearInterval(this.$$cacheFlushIntervalId),clearInterval(this.$$recycleFreqId),this.removeAll(),this.$$storage&&(this.$$storage.removeItem(this.$$prefix+".keys"),this.$$storage.removeItem(this.$$prefix)),this.$$storage=null,this.$$data=null,this.$$lruHeap=null,this.$$expiresHeap=null,this.$$prefix=null}},{}],3:[function(e,t,n){var r=e("../utils");t.exports=function(e,t){var n=this;if(angular.isArray(e)){var i=e,a=[];return angular.forEach(i,function(e){var r=n.get(e,t);null!==r&&void 0!==r&&a.push(r)}),a}if(e=r.stringifyNumber(e),!this.$$disabled){if(t=t||{},!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof e);if(t&&!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof t);if(t.onExpire&&!angular.isFunction(t.onExpire))throw angular.$$minErr("ng")("areq","Expected options.onExpire to be a function! Found: {0}.",typeof t.onExpire);var o;if(this.$$storage){var s=this.$$storage.getItem(this.$$prefix+".data."+e);if(!s)return;o=angular.fromJson(s)}else{if(!(e in this.$$data))return;o=this.$$data[e]}var c=o.value,l=(new Date).getTime();return this.$$storage?(this.$$lruHeap.remove({key:e,accessed:o.accessed}),o.accessed=l,this.$$lruHeap.push({key:e,accessed:l})):(this.$$lruHeap.remove(o),o.accessed=l,this.$$lruHeap.push(o)),"passive"===this.$$deleteOnExpire&&"expires"in o&&o.expires<l?(this.remove(e),this.$$onExpire?this.$$onExpire(e,o.value,t.onExpire):t.onExpire&&t.onExpire(e,o.value),c=void 0):this.$$storage&&this.$$storage.setItem(this.$$prefix+".data."+e,o),c}}},{"../utils":21}],4:[function(e,t,n){function r(e,t){if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected storageMode to be a string! Found: {0}.",typeof e);if("memory"!==e&&"localStorage"!==e&&"sessionStorage"!==e)throw angular.$$minErr("ng")("areq",'Expected storageMode to be "memory", "localStorage" or "sessionStorage"! Found: {0}.',e);var n=window.getLocalStorage();if(this.$$storageMode=e,t){if(!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected storageImpl to be an object! Found: {0}.",typeof t);if(!("setItem"in t&&"function"==typeof t.setItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "setItem(key, value)"! Found: {0}.',typeof t.setItem);if(!("getItem"in t&&"function"==typeof t.getItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "getItem(key)"! Found: {0}.',typeof t.getItem);if(!("removeItem"in t)||"function"!=typeof t.removeItem)throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "removeItem(key)"! Found: {0}.',typeof t.removeItem);this.$$storage=t}else if("localStorage"===this.$$storageMode)try{n.setItem("angular-cache","angular-cache"),n.removeItem("angular-cache"),this.$$storage=n}catch(r){delete this.$$storage,this.$$storageMode="memory"}else if("sessionStorage"===this.$$storageMode)try{sessionStorage.setItem("angular-cache","angular-cache"),sessionStorage.removeItem("angular-cache"),this.$$storage=sessionStorage}catch(r){delete this.$$storage,this.$$storageMode="memory"}}function i(e,t){if(e=e||{},t=!!t,!angular.isObject(e))throw angular.$$minErr("ng")("areq","Expected cacheOptions to be an object! Found: {0}.",typeof e);"disabled"in e?this.$$disabled=!!e.disabled:t&&delete this.$$disabled,"capacity"in e?this.setCapacity(e.capacity):t&&this.setCapacity(null),"deleteOnExpire"in e?this.setDeleteOnExpire(e.deleteOnExpire):t&&this.setDeleteOnExpire(null),"maxAge"in e?this.setMaxAge(e.maxAge):t&&this.setMaxAge(null),"recycleFreq"in e?this.setRecycleFreq(e.recycleFreq):t&&this.setRecycleFreq(null),"cacheFlushInterval"in e?this.setCacheFlushInterval(e.cacheFlushInterval):t&&this.setCacheFlushInterval(null),"onExpire"in e?this.setOnExpire(e.onExpire):t&&this.setOnExpire(null)}function a(e,t){this.$$data={},this.$$id=e,this.$$storage=null,this.$$expiresHeap=new s(function(e){return e.expires}),this.$$lruHeap=new s(function(e){return e.accessed}),t=t||{},"storageMode"in t&&r.apply(this,[t.storageMode,t.storageImpl]),"storagePrefix"in t&&(this.$$storagePrefix=t.storagePrefix),this.$$prefix=this.$$storagePrefix+e,i.apply(this,[t,!0])}var o=e("../defaults"),s=e("../DSBinaryHeap").DSBinaryHeap;for(var c in o.defaults)a.prototype["$$"+c]=o.defaults[c];a.prototype.setOptions=i,a.prototype.setCapacity=e("./setCapacity"),a.prototype.setDeleteOnExpire=e("./setDeleteOnExpire"),a.prototype.setMaxAge=e("./setMaxAge"),a.prototype.setRecycleFreq=e("./setRecycleFreq"),a.prototype.setCacheFlushInterval=e("./setCacheFlushInterval"),a.prototype.setOnExpire=e("./setOnExpire"),a.prototype.put=e("./put"),a.prototype.get=e("./get"),a.prototype.remove=e("./remove"),a.prototype.removeAll=e("./removeAll"),a.prototype.removeExpired=e("./removeExpired"),a.prototype.destroy=e("./destroy"),a.prototype.info=e("./info"),a.prototype.keySet=e("./keySet"),a.prototype.keys=e("./keys"),a.prototype.disable=function(){this.$$disabled=!0},a.prototype.enable=function(){delete this.$$disabled},a.prototype.touch=function(e){if(e){var t=this,n=this.get(e,{onExpire:function(e,n){t.put(e,n)}});n&&this.put(e,n)}else for(var r=this.keys(),i=0;i<r.length;i++)this.touch(r[i])},t.exports=a},{"../DSBinaryHeap":1,"../defaults":19,"./destroy":2,"./get":3,"./info":5,"./keySet":6,"./keys":7,"./put":8,"./remove":9,"./removeAll":10,"./removeExpired":11,"./setCacheFlushInterval":12,"./setCapacity":13,"./setDeleteOnExpire":14,"./setMaxAge":15,"./setOnExpire":16,"./setRecycleFreq":17}],5:[function(e,t,n){t.exports=function(e){if(e){var t;if(this.$$storage){var n=this.$$storage.getItem(this.$$prefix+".data."+e);return n?(t=angular.fromJson(n),{created:t.created,accessed:t.accessed,expires:t.expires,isExpired:(new Date).getTime()-t.created>this.$$maxAge}):void 0}return e in this.$$data?(t=this.$$data[e],{created:t.created,accessed:t.accessed,expires:t.expires,isExpired:(new Date).getTime()-t.created>this.$$maxAge}):void 0}return{id:this.$$id,capacity:this.$$capacity,maxAge:this.$$maxAge,deleteOnExpire:this.$$deleteOnExpire,onExpire:this.$$onExpire,cacheFlushInterval:this.$$cacheFlushInterval,recycleFreq:this.$$recycleFreq,storageMode:this.$$storageMode,storageImpl:this.$$storage,disabled:this.$$disabled,size:this.$$lruHeap&&this.$$lruHeap.size()||0}}},{}],6:[function(e,t,n){var r=e("../utils");t.exports=function(){if(this.$$storage){var e=this.$$storage.getItem(this.$$prefix+".keys"),t={};if(e)for(var n=angular.fromJson(e),i=0;i<n.length;i++)t[n[i]]=n[i];return t}return r.keySet(this.$$data)}},{"../utils":21}],7:[function(e,t,n){var r=e("../utils");t.exports=function(){if(this.$$storage){var e=this.$$storage.getItem(this.$$prefix+".keys");return e?angular.fromJson(e):[]}return r.keys(this.$$data)}},{"../utils":21}],8:[function(e,t,n){var r=e("../utils");t.exports=function(e,t){var n=this;if(!this.$$disabled&&null!==t&&void 0!==t){if(t&&t.then,!1)return void t.then(function(t){angular.isObject(t)&&"status"in t&&"data"in t?n.put(e,[t.status,t.data,t.headers(),t.statusText]):n.put(e,t)});if(e=r.stringifyNumber(e),!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof e);var i=(new Date).getTime(),a={key:e,value:t,created:i,accessed:i};if(a.expires=a.created+this.$$maxAge,this.$$storage){var o=this.$$storage.getItem(this.$$prefix+".keys"),s=o?angular.fromJson(o):[],c=this.$$storage.getItem(this.$$prefix+".data."+e);c&&this.remove(e),this.$$expiresHeap.push({key:e,expires:a.expires}),this.$$lruHeap.push({key:e,accessed:a.accessed}),this.$$storage.setItem(this.$$prefix+".data."+e,a);for(var l=!1,u=0;u<s.length;u++)if(s[u]===e){l=!0;break}l||s.push(e),this.$$storage.setItem(this.$$prefix+".keys",s)}else this.$$data[e]&&this.remove(e),this.$$expiresHeap.push(a),this.$$lruHeap.push(a),this.$$data[e]=a;return this.$$lruHeap.size()>this.$$capacity&&this.remove(this.$$lruHeap.peek().key),t}}},{"../utils":21}],9:[function(e,t,n){t.exports=function(e){if(!this.$$storage){var t=this.$$data[e]?this.$$data[e].value:void 0;return this.$$lruHeap.remove(this.$$data[e]),this.$$expiresHeap.remove(this.$$data[e]),this.$$data[e]=null,delete this.$$data[e],t}var n=this.$$storage.getItem(this.$$prefix+".data."+e);if(n){var r=angular.fromJson(n);this.$$lruHeap.remove({key:e,accessed:r.accessed}),this.$$expiresHeap.remove({key:e,expires:r.expires}),this.$$storage.removeItem(this.$$prefix+".data."+e);var i=this.$$storage.getItem(this.$$prefix+".keys"),a=i?angular.fromJson(i):[],o=a.indexOf(e);return o>=0&&a.splice(o,1),this.$$storage.setItem(this.$$prefix+".keys",a),r.value}}},{}],10:[function(e,t,n){t.exports=function(){if(this.$$storage){this.$$lruHeap.removeAll(),this.$$expiresHeap.removeAll();var e=this.$$storage.getItem(this.$$prefix+".keys");if(e)for(var t=angular.fromJson(e),n=0;n<t.length;n++)this.remove(t[n]);this.$$storage.setItem(this.$$prefix+".keys",[])}else{this.$$lruHeap.removeAll(),this.$$expiresHeap.removeAll();for(var r in this.$$data)this.$$data[r]=null;this.$$data={}}}},{}],11:[function(e,t,n){t.exports=function(){for(var e,t,n=(new Date).getTime(),r={};(t=this.$$expiresHeap.peek())&&t.expires<n;)r[t.key]=t.value?t.value:null,this.$$expiresHeap.pop();if(this.$$storage)for(e in r){var i=this.$$storage.getItem(this.$$prefix+".data."+e);i&&(r[e]=angular.fromJson(i).value,this.remove(e))}else for(e in r)this.remove(e);if(this.$$onExpire)for(e in r)this.$$onExpire(e,r[e]);return r}},{}],12:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$cacheFlushInterval;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be greater than zero! Found: {0}.",e);e!==this.$$cacheFlushInterval&&(this.$$cacheFlushInterval=e,clearInterval(this.$$cacheFlushIntervalId),function(e){e.$$cacheFlushIntervalId=setInterval(function(){e.removeAll()},e.$$cacheFlushInterval)}(this))}}},{}],13:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$capacity;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected capacity to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected capacity to be greater than zero! Found: {0}.",e);this.$$capacity=e}for(var t={};this.$$lruHeap.size()>this.$$capacity;)t[this.$$lruHeap.peek().key]=this.remove(this.$$lruHeap.peek().key);return t}},{}],14:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$deleteOnExpire;else{if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected deleteOnExpire to be a string! Found: {0}.",typeof e);if("none"!==e&&"passive"!==e&&"aggressive"!==e)throw angular.$$minErr("ng")("areq",'Expected deleteOnExpire to be "none", "passive" or "aggressive"! Found: {0}.',e);this.$$deleteOnExpire=e}this.setRecycleFreq(this.$$recycleFreq)}},{}],15:[function(e,t,n){var r=e("../utils");t.exports=function(e){if(null===e)delete this.$$maxAge;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected maxAge to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected maxAge to be greater than zero! Found: {0}.",e);this.$$maxAge=e}var t,n,i;if(this.$$expiresHeap.removeAll(),this.$$storage){var a=this.$$storage.getItem(this.$$prefix+".keys");for(n=a?angular.fromJson(a):[],t=0;t<n.length;t++){i=n[t];var o=this.$$storage.getItem(this.$$prefix+".data."+i);if(o){var s=angular.fromJson(o);s.expires=this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:s.created+this.$$maxAge,this.$$expiresHeap.push({key:i,expires:s.expires})}}}else for(n=r.keys(this.$$data),t=0;t<n.length;t++)i=n[t],this.$$data[i].expires=this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:this.$$data[i].created+this.$$maxAge,this.$$expiresHeap.push(this.$$data[i]);return"aggressive"===this.$$deleteOnExpire?this.removeExpired():{}}},{"../utils":21}],16:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$onExpire;else{if(!angular.isFunction(e))throw angular.$$minErr("ng")("areq","Expected onExpire to be a function! Found: {0}.",typeof e);this.$$onExpire=e}}},{}],17:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$recycleFreq;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected recycleFreq to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected recycleFreq to be greater than zero! Found: {0}.",e);this.$$recycleFreq=e}clearInterval(this.$$recycleFreqId),"aggressive"===this.$$deleteOnExpire?!function(e){e.$$recycleFreqId=setInterval(function(){e.removeExpired()},e.$$recycleFreq)}(this):delete this.$$recycleFreqId}},{}],18:[function(e,t,n){function r(){var e=new i.Config;this.version=o,this.setCacheDefaults=function(t){if(t=t||{},!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof t);for(var n in i.defaults)n in t&&(e[n]=t[n]);"disabled"in t&&(e.$$disabled=!!t.disabled)},this.$get=function(){function t(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}function n(t,n){if(t in s)throw angular.$$minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",t);if(!angular.isString(t))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof t);return s[t]=new a(t,angular.extend({},e,n)),s[t].destroy=function(){this.constructor.prototype.destroy.call(this),delete s[this.$$id]},s[t]}function r(e,t){return n(e,t)}var s={};return r.createCache=n,r.version=o,r.info=function(){for(var n=t(s),r={size:n.length,caches:{}},a=0;a<n.length;a++){var o=n[a];r.caches[o]=s[o].info()}var c=r.cacheDefaults=angular.extend({},e);for(var l in i.defaults)l in c||(c[l]=e["$$"+l]);return r},r.get=function(e){if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof e);return s[e]},r.keySet=function(){var e,t={};for(e in s)s.hasOwnProperty(e)&&(t[e]=e);return t},r.keys=function(){return t(s)},r.destroyAll=function(){for(var e in s)s[e].destroy();s={}},r.clearAll=function(){for(var e in s)s[e].removeAll()},r.enableAll=function(){for(var e in s)s[e].$$disabled=!1},r.disableAll=function(){for(var e in s)s[e].$$disabled=!0},r}}var i=e("../defaults"),a=e("../DSCache"),o="3.1.1";t.exports=r},{"../DSCache":4,"../defaults":19}],19:[function(e,t,n){function r(){}var i={capacity:Number.MAX_VALUE,maxAge:Number.MAX_VALUE,deleteOnExpire:"none",onExpire:null,cacheFlushInterval:null,recycleFreq:1e3,storageMode:"memory",storageImpl:null,disabled:!1,storagePrefix:"angular-cache.caches."};for(var a in i)r.prototype["$$"+a]=i[a];t.exports={Config:r,defaults:i}},{}],20:[function(e,t,n){!function(t,n,r){"use strict";n.$$minErr=n.$$minErr||function(e){return function(){var t,r,i=arguments[0],a="["+(e?e+":":"")+i+"] ",o=arguments[1],s=arguments,c=function(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e};for(t=a+o.replace(/\{\d+\}/g,function(e){var t,r=+e.slice(1,-1);return r+2<s.length?(t=s[r+2],"function"==typeof t?t.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof t?"undefined":"string"!=typeof t?n.toJson(t):t):e}),t=t+"\nhttp://errors.angularjs.org/"+n.version.full+"/"+(e?e+"/":"")+i,r=2;r<arguments.length;r++)t=t+(2==r?"?":"&")+"p"+(r-2)+"="+encodeURIComponent(c(arguments[r]));return new Error(t)}},n.module("app").provider("DSBinaryHeap",e("./DSBinaryHeap").DSBinaryHeapProvider),n.module("app").provider("DSCacheFactory",e("./DSCacheFactory"))}(window,window.angular)},{"./DSBinaryHeap":1,"./DSCacheFactory":18}],21:[function(e,t,n){t.exports={stringifyNumber:function(e){return e&&angular.isNumber(e)?e.toString():e},keySet:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n},keys:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}}},{}]},{},[20]),function(){"use strict";angular.module("app").service("dateParser",["$locale","orderByFilter",function(e,t){function n(e){var n=[],r=e.split("");return angular.forEach(i,function(t,i){var a=e.indexOf(i);if(a>-1){e=e.split(""),r[a]="("+t.regex+")",e[a]="$";for(var o=a+1,s=a+i.length;s>o;o++)r[o]="",e[o]="$";e=e.join(""),n.push({index:a,apply:t.apply})}}),{regex:new RegExp("^"+r.join("")+"$"),map:t(n,"index")}}function r(e,t,n){return 1===t&&n>28?29===n&&(e%4===0&&e%100!==0||e%400===0):3===t||5===t||8===t||10===t?31>n:!0}this.parsers={};var i={yyyy:{regex:"\\d{4}",apply:function(e){this.year=+e}},yy:{regex:"\\d{2}",apply:function(e){this.year=+e+2e3}},y:{regex:"\\d{1,4}",apply:function(e){this.year=+e}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1}},M:{regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(t,i){if(!angular.isString(t)||!i)return t;i=e.DATETIME_FORMATS[i]||i,this.parsers[i]||(this.parsers[i]=n(i));var a=this.parsers[i],o=a.regex,s=a.map,c=t.match(o);if(c&&c.length){for(var l,u={year:1900,month:0,date:1,hours:0},d=1,p=c.length;p>d;d++){var f=s[d-1];f.apply&&f.apply.call(u,c[d])}return r(u.year,u.month,u.date)&&(l=new Date(u.year,u.month,u.date,u.hours)),l}}}]).directive("renderModelAsHours",function(){return{require:"ngModel",link:function(e,t,n,r){r.$render=function(){var e=parseInt(r.$modelValue,10);return isNaN(e)?void t.val(r.$modelValue):(10>e&&(e="0"+e),void t.val(e))}}}}).directive("timeDatePicker",["$filter","$sce","$rootScope","$parse",function(e,t,n,r){var i;return i=e("date"),{restrict:"AE",replace:!0,scope:{_modelValue:"=ngModel"},require:"ngModel",templateUrl:"core/datetime/input.html",link:function(e,t,n,i){var a,o;return n.$observe("defaultMode",function(t){return e._mode=null!=t?t:"date"}),n.$observe("displayMode",function(t){return e._displayMode=t}),n.$observe("orientation",function(t){return e._verticalMode="true"===t}),n.$observe("displayTwentyfour",function(t){return e._hours24=null!=t&&t}),n.$observe("mindate",function(t){return null!=t&&angular.isDate(t)?e.restrictions.mindate=t:void 0}),n.$observe("maxdate",function(t){return null!=t&&angular.isDate(t)?e.restrictions.maxdate=t:void 0}),i.$render=function(){return e.setDate(i.$modelValue)},o=r(n.onSave),a=r(n.onCancel),e.save=function(){return e._modelValue=e.date,i.$setDirty(),o(e.$parent,{$value:e.date})},e.cancel=function(){return a(e.$parent,{}),i.$render()}},controller:["$scope",function(e){var n;return e.restrictions={mindate:void 0,maxdate:void 0},e.setDate=function(t){return e.date=null!=t?new Date(t):new Date,e.calendar._year=e.date.getFullYear(),e.calendar._month=e.date.getMonth(),e.clock._minutes=e.date.getMinutes(),e.clock._hours=e._hours24?e.date.getHours():e.date.getHours()%12,e._hours24||0!==e.clock._hours?void 0:e.clock._hours=12},e.display={fullTitle:function(){return i(e.date,"EEEE d MMMM yyyy, h:mm a")},title:function(){return"date"===e._mode?i(e.date,"date"===e._displayMode?"EEEE":"EEEE h:mm a"):i(e.date,"MMMM d yyyy")},"super":function(){return"date"===e._mode?i(e.date,"MMM"):""},main:function(){return t.trustAsHtml("date"===e._mode?i(e.date,"d"):""+i(e.date,"h:mm")+"<small>"+i(e.date,"a")+"</small>")},sub:function(){return"date"===e._mode?i(e.date,"yyyy"):i(e.date,"HH:mm")}},e.calendar={_month:0,_year:0,_months:function(){var e,t;for(t=[],n=e=0;11>=e;n=++e)t.push(i(new Date(0,n),"MMMM"));return t}(),offsetMargin:function(){return new Date(this._year,this._month).getDay()},isVisible:function(e){return new Date(this._year,this._month,e).getMonth()===this._month},"class":function(t){return null!=e.date&&new Date(this._year,this._month,t).getTime()===new Date(e.date.getTime()).setHours(0,0,0,0)?"selected":new Date(this._year,this._month,t).getTime()===(new Date).setHours(0,0,0,0)?"today":""},select:function(t){var n=e.date.setFullYear(this._year,this._month,t);return e.save(),n},monthChange:function(){return(null==this._year||isNaN(this._year))&&(this._year=(new Date).getFullYear()),e.date.setFullYear(this._year,this._month),e.date.getMonth()!==this._month?e.date.setDate(0):void 0},_incMonth:function(e){for(this._month+=e;this._month<0||this._month>11;)this._month<0?(this._month+=12,this._year--):(this._month-=12,this._year++);return this.monthChange()}},e.clock={_minutes:0,_hours:0,_incHours:function(t){var n=this._hours+t;return-1==n?n=e._hours24?23:12:(e._hours24?n>23:n>11)&&(n=0),this._hours=e._hours24?Math.max(0,Math.min(23,n)):Math.max(1,Math.min(12,n)),isNaN(this._hours)?this._hours=0:void 0},_incMinutes:function(e){var t=this._minutes+e;return-1==t?t=59:t>59&&(t=0),this._minutes=Math.max(0,Math.min(59,t)),isNaN(this._minutes)?this._minutes=0:void 0},setAM:function(t){return null==t&&(t=!this.isAM()),t&&!this.isAM()?e.date.setHours(e.date.getHours()-12):!t&&this.isAM()?e.date.setHours(e.date.getHours()+12):void 0},isAM:function(){return e.date.getHours()<12}},e.$watch("clock._minutes",function(t,n){if(null!=t&&t!==e.date.getMinutes()&&!isNaN(t)&&t>=0&&59>=t){var r=e.date.setMinutes(t);return r=e.date.setSeconds(0),e.save(),r}}),e.$watch("clock._hours",function(t){if(null!=t&&!isNaN(t)&&(e._hours24||(24===t?t=12:12===t?t=0:e.clock.isAM()||(t+=12)),t!==e.date.getHours())){var n=e.date.setHours(t);return e.save(),n}}),e.setNow=function(){return e.setDate()},e._mode="date",e.modeClass=function(){return null!=e._displayMode&&(e._mode=e._displayMode),""+(null!=e._verticalMode&&e._verticalMode?"vertical ":"")+("full"===e._displayMode?"full-mode":"time"===e._displayMode?"time-only":"date"===e._displayMode?"date-only":"date"===e._mode?"date-mode":"time-mode")},e.modeSwitch=function(){var t;return e._mode=null!=(t=e._displayMode)?t:"date"===e._mode?"time":"date"},e.modeSwitchText=function(){return"date"===e._mode?"Clock":"Calendar"}}]}}]).directive("timeDatePickerDialog",["$modal","dateFilter","dateParser","GLOBAL_CONFIG","$$rAF",function(e,t,n,r,i){return{require:["ngModel","^form","^?mdInputContainer"],link:function(a,o,s,c){var l,u=c[0],d=(c[1],c[2]),p=!1;u.$render=function(){o.find(".selected-item").text(t(u.$modelValue,r.date.format))},d.input=o,a.$watch(function(){return u.$invalid&&u.$touched},d.setInvalid),a.$on("$destroy",function(){d.setFocused(!1),d.setHasValue(!1),d.input=null}),o.on("click focus",function(t){o.attr("disabled")||(t.preventDefault(),p||(p=!0,i(function(){e.open({windowClass:"modal-medium datepicker-pop",popFrom:!1,inDirection:!1,outDirection:!1,fullScreen:!1,cantCloseWithBackdrop:!0,templateUrl:"core/datetime/popup.html",controller:["$scope",function(e){e.date=u.$modelValue;var t=e.$close;e.$close=function(){t()},e.select=function(){u.$setViewValue(e.date),u.$render(),e.$close()},e.$on("$destroy",function(){p=!1})}]})})))}),l=function(e){var t=function(){if(e){if(angular.isDate(e)&&!isNaN(e))return u.$setValidity("date",!0),e;if(angular.isString(e)){var t=n.parse(e,dateFormat)||new Date(e);return isNaN(t)?void u.$setValidity("date",!1):(u.$setValidity("date",!0),t)}return void u.$setValidity("date",!1)}return u.$setValidity("date",!0),null}();return d.setHasValue(t),t},u.$formatters.push(l),u.$parsers.unshift(l)}}}])}(),function(){"use strict";angular.module("app").directive("encrypted",function(){return{link:function(e,t,n){}}}).directive("repeatedText",["helpers",function(e){return{require:"ngModel",link:function(t,n,r,i){var a=function(t,n){var r=!1;try{"list"===n&&(t=e.splitLines(t),t=_.uniq(t)),"str"===n&&angular.isArray(t)&&(t=t.join("\n")),r=!0}catch(a){}return i.$setValidity("invalid",r),t},o=function(e){return a(e,"list")},s=function(e){return a(e,"str")};i.$parsers.push(o),i.$formatters.push(s)}}}]).directive("checkNumeric",function(){return{require:["ngModel","^form"],link:function(e,t,n,r){var i=function(e){var t=!isNaN(parseInt(e,10));return t||(t=!isNaN(parseFloat(e,10))),t},a="required"===t.attr("required");r[0].$parsers.unshift(function(e){var t,n=i(e);return a||n&&!angular.isUndefined(e)&&e.length&&e.replace(/[^0-9+.]/g,"")||(n=!0),r[0].$setValidity("checkNumeric",n),angular.isDefined(e)?(t=e.replace(/[^0-9+.]/g,""),t!==e&&(r[0].$setViewValue(t),r[0].$render()),t):n?e:void 0})}}}).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,n){return{require:"ngModel",restrict:"A, C",link:function(r,i,a,o){function s(){var e=v;f=u,_=getComputedStyle(u),angular.forEach(x,function(t){e+=t+":"+_.getPropertyValue(t)+";"}),$.setAttribute("style",e)}function c(){var t,n,i,a,o;f!==u&&s(),g||(g=!0,$.value=u.value+m,$.style.overflowY=u.style.overflowY,t=""===u.style.height?"auto":parseInt(u.style.height,10),n=getComputedStyle(u).getPropertyValue("width"),"px"===n.substr(n.length-2,2)&&(a=parseInt(n,10)-k.width,$.style.width=a+"px"),i=$.scrollHeight,i>E?(i=E,o="scroll"):A>i&&(i=A),i+=k.height,u.style.overflowY=o||"hidden",t!==i&&(u.style.height=i+"px",r.$emit("elastic:resize",d)),e(function(){g=!1},1,!1))}function l(){g=!1,c()}var u=i[0],d=i;if("TEXTAREA"===u.nodeName&&t.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var p=u.value;u.value="",u.value=p;var f,g,m=a.msdElastic?a.msdElastic.replace(/\\n/g,"\n"):n.append,h=angular.element(t),v="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",y=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+v+'"/>').data("elastic",!0),$=y[0],_=getComputedStyle(u),b=_.getPropertyValue("resize"),w="border-box"===_.getPropertyValue("box-sizing")||"border-box"===_.getPropertyValue("-moz-box-sizing")||"border-box"===_.getPropertyValue("-webkit-box-sizing"),k=w?{width:parseInt(_.getPropertyValue("border-right-width"),10)+parseInt(_.getPropertyValue("padding-right"),10)+parseInt(_.getPropertyValue("padding-left"),10)+parseInt(_.getPropertyValue("border-left-width"),10),height:parseInt(_.getPropertyValue("border-top-width"),10)+parseInt(_.getPropertyValue("padding-top"),10)+parseInt(_.getPropertyValue("padding-bottom"),10)+parseInt(_.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},C=parseInt(_.getPropertyValue("min-height"),10),S=parseInt(_.getPropertyValue("height"),10),A=Math.max(C,S)-k.height,E=parseInt(_.getPropertyValue("max-height"),10),x=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(E=E&&E>0?E:9e4,$.parentNode!==document.body&&angular.element(document.body).append($),d.css({resize:"none"===b||"vertical"===b?"none":"horizontal"}).data("elastic",!0),u.oninput="onpropertychange"in u&&"oninput"in u?u.onkeyup=c:c,h.bind("resize",l),r.$watch(function(){return o.$modelValue},function(e){l()}),r.$on("elastic:adjust",function(){s(),l()}),e(c),r.$on("$destroy",function(){y.remove(),h.unbind("resize",l)}))}}}}]).run(["formInputTypes","GLOBAL_CONFIG","helpers",function(e,t,n){$.extend(e,{_SelectBox:function(e){return angular.isDefined(e.config.ui.specifics.searchEnabled)||(e.config.ui.specifics.searchEnabled=e.config.choices.length<10?!1:!0),e.config.choices.length&&e.config.ui.specifics&&e.config.ui.specifics.translatedChoices!==!1&&(e.config.ui.specifics.translatedChoices=[],angular.forEach(e.config.choices,function(r){var i=angular.isObject(r),a=n.getProperty(t.fields.translateChoices,[e.config._maker_,e.config.code_name,i?r.name:r]);angular.isUndefined(a)&&(a=i?r.name:r),e.config.ui.specifics.translatedChoices.push({key:i?r.key:r,name:a})})),"select"},SpaceWithText:function(e){return"spacewithtext"},SuperStringEncryptedProperty:function(e){
return e.config.ui.attrs.encrypted=!0,this.SuperStringProperty(e)},SuperStringProperty:function(e){var t=e.config;return void 0===t.ui.attrs.type&&(t.ui.attrs.type="text"),t.choices?t.repeated?this._SuperStringRepeated(e):(void 0!==e.config.ui.attrs["repeated-text"]&&delete e.config.ui.attrs["repeated-text"],this._SelectBox(e)):t.repeated?(t.ui.attrs["repeated-text"]="",this.SuperTextProperty(e)):"string"},SuperFloatProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperStringProperty(e))},SuperIntegerProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperFloatProperty(e))},SuperDecimalProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperFloatProperty(e))},_SuperStringRepeated:function(e){var t={};return e.config.ui.specifics.select=t,e.config._groupable=!0,"select_multiple"},SuperTextProperty:function(e){return e.config.repeated&&(e.config.ui.attrs["repeated-text"]=""),(void 0===e.config.ui.specifics.autoGrow||e.config.ui.specifics.autoGrow)&&(e.config.ui.attrs["msd-elastic"]=""),"text"}})}])}(),function(){"use strict";angular.module("app").filter("humanized",["$filter",function(e){return function(t){var n=e("inflector"),r=n(t,"humanize");return r=r.toLowerCase(),_.string.capitalize(r)}}]).run(["helpers","modals","$modal","$q","GLOBAL_CONFIG","formInputTypes","snackbar",function(e,t,n,r,i,a,o){e.fields||(e.fields={}),e.form||(e.form={}),$.extend(e.fields,{isFieldset:function(e){return e.is_structured||_.string.contains(e.type,"KeyProperty")&&e.repeated||e.ui.fieldset},sorter:function(e,t){var n=parseInt(e.name,10),r=parseInt(t.name,10);return isNaN(n)&&(n=999999),isNaN(r)&&(r=999999),n-r},resolve:function(e){e.ui&&e.ui.defer&&e.ui.defer.resolve()},deferFormBuilderFields:function(e){var t,n=[],i=function(e){if(e.ui.group)angular.forEach(e.ui.group.fields,function(e){i(e)});else if(-1!==$.inArray(e.type,a.resolvable)){var t=r.defer();e.ui.defer=t,n.push(t.promise)}};return angular.forEach(e,function(e){angular.isArray(e)&&angular.forEach(e,function(e){i(e)})}),n.length||(t=r.defer(),t.resolve(),n=[t.promise]),r.all(n)},applyGlobalConfig:function(e){angular.isUndefined(e.ui.help)&&angular.isDefined(i.fields.help[e._maker_])&&(e.ui.help=i.fields.help[e._maker_][e.code_name]),angular.isUndefined(e.ui.emptyHelp)&&angular.isDefined(i.fields.emptyHelp[e._maker_])&&(e.ui.emptyHelp=i.fields.emptyHelp[e._maker_][e.code_name]),angular.isUndefined(e.ui.label)&&angular.isDefined(i.fields.label[e._maker_])&&(e.ui.label=i.fields.label[e._maker_][e.code_name])},utils:{attrs:function(e){var t=this.defaultAttrs(e),n=this.extraAttrs(e),r=[];return angular.extend(t,n),angular.forEach(t,function(e,t){r.push(t+(e?'="'+e+'"':""))}),r.join(" ")},defaultAttrs:function(t){var n,r={};return t.max_size&&(r["ng-maxlength"]="config.max_size"),void 0!==t.ui.pattern&&(r["ng-pattern"]=t.pattern),r["ng-required"]=angular.isString(t.required)?t.required:"config.required",r["ng-model"]=t.ui.args,r.placeholder=t.ui.placeholder,angular.isArray(t.ui.writable)?(n=t.ui.model+".ui.rule.field"+$.map(t.ui.writable,function(t){return"['"+e.addslashes(t)+"']"}).join("")+".writable",r["ng-disabled"]="!"+n,t.ui.writableCompiled=n):(r["ng-disabled"]="!"+t.ui.writable,t.ui.writableCompiled=t.ui.writable),r.readonly?delete r["ng-disabled"]:r.loading||(r.loading="!"+t.ui.writableCompiled),r},extraAttrs:function(e){return e.ui.attrs},label:function(e){var t="{{config.ui.label}}";return void 0===e.ui.label&&(t="{{config.ui.autoLabel|humanized}}"),t}}}),$.extend(e.form,{wakeUp:function(e,t,n){var r=!1;return angular.forEach(e,function(n){angular.isObject(n)&&n.hasOwnProperty("$valid")&&!n.$valid&&angular.isFunction(n.$setViewValue)&&(n.$setViewValue(void 0!==n.$viewValue?n.$viewValue:""),n.$setDirty(),n.$setTouched(),t&&e.$setDirty(),r=!0)}),r&&n&&o.showK("actionFailedCheckForm"),r},setDirty:function(){this.container&&this.container.form&&this.container.form.$setDirty()},setPristine:function(){this.container&&this.container.form&&this.container.form.$setPristine()},validate:function(){var t=this.container.form;return t.$valid?!0:(e.form.wakeUp(t,!1,!0),!1)},leave:function(e){var n=this.container.form;return n.$pristine?e():void t.confirm("discard",e)}})}]).directive("formBuilder",["$compile","underscoreTemplate","modelsMeta",function(e,t,n){return{restrict:"A",require:"^form",templateUrl:"core/fields/builder.html",scope:!0,transclude:!0,controller:["$scope","$element","$attrs",function(e,t,n){e.configurations=e.$eval(n.formBuilder)}]}}]).directive("formInput",["$compile","underscoreTemplate","formInputTypes","helpers","GLOBAL_CONFIG","$q","$timeout",function(e,t,n,r,i,a,o){var s=n,c=r.fields.utils;return{restrict:"A",require:"^form",scope:!0,transclude:!0,link:function(n,i,a,o){var l=function(){var l,u,d,p,f,g,m=n.$eval(a.formInput),h=null;if(!angular.isObject(m))return void console.warn("Config provided is not object for element: ",i);if(l=m.code_name,h=null!==m.verbose_name&&void 0!==m.verbose_name?m.verbose_name:l,!l)return void console.error("Your field config",m,"has no name defined defined. element: ",i);if(u={ui:{args:"args."+l,parentArgs:"args",rootScope:"rootScope",model:"entity",autoLabel:h,directiveScope:function(){return n},specifics:{},systemName:l,name:l,form:{root:o,field:function(){return this.root[u.ui.name]},hasErrors:function(){return this.field()?Object.keys(this.field().$error).length:!1},messages:function(){return this.field()?(this.field().$dirty&&this.hasErrors()?this.field().$error:!1)||u.ui:!1},shouldShowMessages:function(){return u.ui.hideMessages?!1:!0}},writable:[l],path:void 0,realPath:void 0,attrs:{}}},r.mergeDeep(m,u),u=m,angular.isFunction(u.ui.init)&&(g=u.ui.init,u.ui.init=void 0),u.ui.init||(u.ui.init={callbacks:[],add:function(e,t){var n=null;angular.forEach(this.callbacks,function(t,r){angular.isDefined(t[e])&&(n=t)}),null!==n?n[e]=t:(n={},n[e]=t,this.callbacks.push(n))}}),g&&u.ui.init.add("init",g),angular.isDefined(u.ui.path)||(u.ui.path=[l]),angular.isArray(u.ui.writable)&&(u.ui.writable=angular.copy(u.ui.path)),angular.isDefined(u.ui.realPath)||(u.ui.realPath=[l]),r.fields.applyGlobalConfig(u),void 0!==s[u.type]){if(f={config:u,element:i,scope:n,attrs:a},d=s[u.type](f),u.ui.compiled={attrs:c.attrs(u),label:c.label(u)},angular.forEach(u.ui.init.callbacks,function(e){angular.forEach(e,function(e){e(f)})}),u.ui.render===!1)return;p=t.get(angular.isDefined(u.ui.template)?u.ui.template:"core/fields/"+d+".html")({config:u}),n.config=u,i.html(p),e(i.contents())(n)}n.$on("$destroy",function(){u.ui.directiveScope=void 0,u.ui.form=void 0})};l()}}}]).directive("compatibilityMaker",["modelsUtil","currentAccount",function(e,t){return{restrict:"A",link:function(n,r,i,a){var o=function(){var a,o=n.$eval(i.compatibilityMaker);angular.isObject(o)&&(o._csrf=t._csrf),a=e.argumentsToJson(o),r.val(a)};n.$watch(i.compatibilityMaker,o),n.$on("ngUploadSubmit",o)}}}]).factory("formInputTypes",function(){var e={};return e.resolvable=[],e}).directive("fastNgChange",["$parse","$mdUtil",function(e,t){return{priority:1,link:function(n,r,i){var a=e(i.fastNgChange),o=r.val(),s=t.debounce(function(e){var t=r.val();o!==t&&(o=t,a(n,{$event:e}))},100,n,!0);r.on("change keydown",s),n.$on("$destroy",function(){r.off("change keydown",s)})}}}]).directive("fastNgModel",["$parse","$mdUtil",function(e,t){return{priority:-1,link:function(n,r,i){var a=e(i.fastNgModel),o=t.debounce(function(e){a.assign(n,r.val())},100,n,!0);r.on("keyup",o),n.$on("$destroy",function(){r.off("keyup",o)})}}}]).directive("form",["GLOBAL_CONFIG",function(e){var t=!1,n=[];return{require:"^form",link:function(r,i,a,o){if(!a.noLeaveCheck){var s;t||(t=!0,window.onbeforeunload=function(){var t=!1;return angular.forEach(n,function(e){t=e()}),t?e.misc.text.leaveUnsaved:void 0}),s=function(){return o.$dirty},n.push(s),r.$on("$destroy",function(){n.remove(s)})}}}}])}(),function(){"use strict";angular.module("app").directive("validFile",function(){return{require:"ngModel",link:function(e,t,n,r){t.bind("change",function(){e.$apply(function(){r.$setViewValue(t.val()),r.$render()})})}}}).directive("jsonOnly",function(){return{require:"ngModel",link:function(e,t,n,r){var i=function(e,t){var n=!1;try{e=angular[t](e),n=!0}catch(i){}return r.$setValidity("jsonOnly",n),e},a=function(e){return i(e,"fromJson")},o=function(e){return i(e,"toJson")};r.$parsers.push(a),r.$formatters.push(o)}}}).directive("generateUploadUrl",["endpoint","$rootScope",function(e,t){return{restrict:"A",require:"^form",link:function(t,n,r,i){var a=n,o=a.parents("form:first"),s=function(e){return n.parents("button[disabled]:first").length?(e.preventDefault(),!1):void 0},c=function(){return a.val()?void e.post("blob_upload_url","11",{upload_url:e.url}).then(function(e){o.attr("action",e.data.upload_url),i.$setDirty()}):!1},l=function(t,n){o.attr("action",e.url),a.val("")};return o.length?(n.on("change",c).on("click",s),t.$on("$destroy",function(){$(n).off("change",c)}),t.$on("ngUploadComplete",l),void t.$on("ngUploadError",c)):(console.error("Directive generateUploadUrl demands explicit <form> tag"),!1)}}}]).directive("submitIfFiles",["$parse","helpers",function(e,t){return{require:"^form",link:function(n,r,i,a){var o,s,c=r.parents("form:first"),l=e(i.submitIfFiles),u=e(i.submitIfFilesNoComplete),d=e(i.submitIf),p=e(i.submitNative),f=function(){var e,r,i=t.form.wakeUp(a,!0);return i&&(n.$$phase||n.$apply()),d&&!d(n)?!1:(r=p(n),o=c.find('input[type="file"]'),s=!1,o.length&&o.each(function(){return $(this).val()?(s=!0,!1):void 0}),r&&s?(c.trigger("submit"),!1):(e=l(n,{dontShowMessage:s}),e&&angular.isObject(e)&&e.then&&e.then(function(){return s?(c.trigger("submit"),!1):void u(n)}),void n.$apply()))};r.on("click",f),n.$on("$destroy",function(){r.off("click",f)})}}}]).directive("submitIfValid",["$parse",function(e){return{require:"^form",link:function(t,n,r,i){var a=n.parents("form:first"),o=e(r.submitIfValid),s=function(e){return o(t)&&a.submit(),e.preventDefault()};n.on("click",s),t.$on("$destroy",function(){n.off("click",s)})}}}]).directive("showNumberOfSelectedFiles",function(){return{restrict:"A",link:function(e,t,n){var r=t.parents(".fake-button:first"),i=r.find(n.showNumberOfSelectedFiles),a=i.text(),o=function(){setTimeout(function(){var e=t.prop("files");e&&e.length?(i.css("display","inline"),i.text(a.replace(":total",e.length))):i.hide()},200)};t.bind("change",o),o(),e.$on("ngUploadComplete",o),e.$on("ngUploadError",o),e.$on("$destroy",function(){t.unbind("change",o)})}}}).run(["formInputTypes","underscoreTemplate","$timeout","$parse","endpoint","modelsMeta","models","$q","$filter","$modal","helpers","errorHandling","modals","GLOBAL_CONFIG","snackbar",function(e,t,n,r,i,a,o,s,c,l,u,d,p,f,g){e.resolvable.extend(["SuperKeyProperty","SuperVirtualKeyProperty"]),$.extend(e,{SuperBooleanProperty:function(e){return e.config.required=!1,(!e.config.ui.specifics||angular.isUndefined(e.config.ui.specifics.type))&&(e.config.ui.specifics.type="checkbox"),"boolean"},SuperVirtualKeyProperty:function(e){return this.SuperKeyProperty(e)},_SuperKeyPropertyRepeated:function(e){var t={};return e.config.ui.specifics.select=t,"select_multiple"},SuperKeyProperty:function(e){if(e.config.searchable===!1)return u.fields.resolve(e.config),this.SuperStringProperty(e);var t,r,i,c,l=e.config,d="select_async",p={cache:{query:{24:!0,12:"all_countries",13:function(e){return e+"_all_regions"},17:function(e){return e+"_all_units"}},type:{12:"local",17:"local",24:"local",13:"local","default":"memory"}},grouping:{},view:{"default":function(e){return e?e.name:""}},finder:{},init:{13:function(e){e.scope.$watch(e.config.ui.parentArgs+".country",function(t,n){if(t!==n){var r=e.scope.$eval(e.config.ui.parentArgs);r.region=null,e.config.ui.specifics.entities.empty(),e.config.ui.specifics.initial()}})}},queryFilter:{24:function(e,t){return{search:{options:{limit:300},orders:[{operator:"asc",field:"name"}],filters:[{value:["indexable"],operator:"ALL_IN",field:"state"},{value:null,operator:"==",field:"parent_record"}]}}},17:function(e,t,n){var r={search:{filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}},i=r.search;if("uom"===l.code_name){if(n)return n("uom");i.filters.unshift({value:"Currency",field:"measurement",operator:"!="}),i.orders=[{field:"measurement",operator:"asc"},{field:"key",operator:"asc"}]}if("currency"===l.code_name){if(n)return n("currency");i.filters.push({value:"Currency",field:"measurement",operator:"=="})}return n?n("units"):r},13:function(t,n,r){var i=e.scope.$eval(e.config.ui.parentArgs);return i&&i.country?r?r(i.country):{search:{ancestor:i.country,filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}}:!1}}},f=o[l.kind],g={},m={},h=_.memoize(function(e){return void 0!==_.findWhere(l.ui.specifics.entities,{key:e})}),v=l.ui.specifics.override||{},y=l.kind?a.getActionArguments(l.kind,"search"):{},b=function(e){return l.ui.specifics.entities=e.data.entities,l.ui.specifics.entities},w=s.defer(),k=w.promise;return l.repeated&&(l.ui.fieldset=!0),l.ui.specifics.view=function(e){var t=p.view[l.kind];return t||(t=p.view["default"]),v.view&&(t=v.view),t(e)},t=p.init[l.kind],v.init&&(t=v.init),angular.isDefined(t)&&t(e),$.extend(g,l.ui.specifics.search),l.ui.specifics.search=g,angular.isFunction(l.ui.specifics.entities)&&(l.ui.specifics.getEntities=l.ui.specifics.entities,l.ui.specifics.entities=l.ui.specifics.entities()),angular.isUndefined(l.ui.specifics.entities)&&(l.ui.specifics.entities=[]),angular.isUndefined(l.ui.specifics.grouping)&&(l.ui.specifics.grouping=p.grouping[l.kind]),c=p.finder[l.kind],v.finder&&(c=v.finder),l.ui.specifics.search.ready=k,m.cache=p.cache.query[l.kind],m.cacheType=p.cache.type[l.kind]||p.cache.type["default"],v.cache&&angular.isDefined(v.cache.query)&&(m.cache=v.cache.query),angular.isFunction(m.cache)&&(m._getCache=m.cache),v.cache&&angular.isDefined(v.cache.type)&&(m.cacheType=v.cache.type),f&&!l.ui.specifics.getEntities&&f.actions.search?(l.ui.specifics.initial=function(){return r=p.queryFilter[l.kind],v.queryFilter&&(r=v.queryFilter),r?(i=r,r=i(null,y),angular.isFunction(m._getCache)&&(m.cache=i(null,y,m._getCache)),c&&(l.ui.specifics.search.find=function(e){return f.actions.search(i(e,y),m).then(function(e){var t=e.data.entities;angular.forEach(t,function(e){h(e.key)||l.ui.specifics.entities.push(e)})})}),l.ui.specifics.search.missing=function(e){var t,n=angular.isArray(e),r=!0;return null!==e&&void 0!==e&&e.length?(n?angular.forEach(n,function(e){h(e)&&(r=!1)}):r=h(e),r?(t=s.defer(),t.resolve(l.ui.specifics.entities),t.promise):f.actions.search({search:{keys:n?e:[e]}},m).then(function(t){var r=t.data.entities;return n?angular.forEach(r,function(e){h(e.key)||l.ui.specifics.entities.push(e)}):h(e)||l.ui.specifics.entities.unshift(t.data.entities[0]),l.ui.specifics.entities})):(t=s.defer(),t.resolve(),t.promise)}):r=y.search["default"],f.actions.search(r,m).then(b)},n(function(){l.ui.specifics.initial().then(function(){w.resolve()})})):l.ui.defer.resolve(),e.scope.$on("$destroy",function(){l.ui.specifics.entities=[],h.cache={}}),l.ui.specifics.async=!0,l.repeated&&(d=this._SuperKeyPropertyRepeated(e)),function(){var t,n=l.ui.specifics.select||l.ui.specifics.search;"24"===e.config.kind&&(n.init=function(e,n,r,i,a){var s=function(e){angular.forEach(e,function(e){e.leafname=_.last(e.name.split(" / "))})};e.afterClose=function(){e.product_categories.resetToTop()},e.openTemplate="core/select/product_categories.html",e.windowClass="category-modal",e.product_categories={children:[],mapped:{},top:[],isLeaf:function(e){return-1!==$.inArray("visible",e.state)},resetToTop:function(){e.product_categories.children=[],e.product_categories.mapped={}},next:function(t){var n={search:{options:{limit:300},orders:[{operator:"asc",field:"name"}],filters:[{value:["indexable"],operator:"ALL_IN",field:"state"},{value:null,operator:"==",field:"parent_record"}]}};n.search.filters[1].value=t.key,o[24].actions.search(n,m).then(function(n){var r=n.data.entities,i={item:t},a=e.product_categories.mapped[t.key];s(r),a&&(i=a),i.visible=!0,r.length?(i.items=r,e.product_categories.children.push(i),e.product_categories.mapped[t.key]=i):(e.select(t),e.product_categories.resetToTop())})},prev:function(t){var n=e.product_categories.children,r=!1;angular.forEach(n,function(e,n){e===t&&(e.visible=!1,0===n&&(r=!0))})}},t=p.queryFilter[l.kind](),t.search.options.limit=400,o[l.kind].actions.search(t,m).then(function(t){var n=t.data.entities;s(n),e.product_categories.top=n})})}(),d},SuperJsonProperty:function(e){return e.config.ui.attrs["json-only"]="",this.SuperTextProperty(e)},SuperDateTimeProperty:function(e){return e.config.ui.attrs["time-date-picker-dialog"]="",e.config.ui.attrs.readonly="true","datetime"}})}])}(),function(){"use strict";angular.module("app").run(["helpers","modals","$modal","GLOBAL_CONFIG","$q",function(e,t,n,r,i){$.extend(t,{fields:{remote:function(t,r,a){n.open({scope:t,templateUrl:"core/models/manage.html",controller:["$scope",function(n){var a,o=t.save,s=t.uploadComplete,c=!0;a=function(){return"view"+e.toolbar.makeTitle(r.code_name)},n.$stateHiddenLoading=!0,r.ui.specifics.readerDefer=i.defer(),r.ui.specifics.readerDefer.promise.then(function(){n.$stateHiddenLoading=!1,n.dialog.toolbar.hideSave=!1}),r._title_.push(a),n.dialog={templateBodyUrl:"core/models/manage_body_default.html",toolbar:{hideSave:!0}},n.parentContainer=n.container,n.container={},n.close=angular.bind(n,e.form.leave,function(){return n.formSetPristine(),n.$close()}),n.formSetDirty=angular.bind(n,e.form.setDirty),n.formSetPristine=angular.bind(n,e.form.setPristine),n.formBuilder={0:[r]},n.layouts={groups:[{label:!1}]},n.$on("itemDelete",function(){n.formSetDirty()}),n.$watch("parentContainer.form.$dirty",function(e,t){return c?void(c=!1):void(e?n.formSetDirty():n.formSetPristine())}),n.$watch("entity.id",function(){n.dialog.toolbar.title=e.toolbar.buildTitle(r._title_)}),n.save=function(e){var r=o.call(t,e);return r&&r.then(function(){n.formSetPristine()}),r},n.uploadComplete=function(e){s.call(t,e),n.formSetPristine()},n.$on("$destroy",function(){angular.isArray(r.ui.specifics.parentArgs)&&r.ui.specifics.parentArgs.empty(),r._title_.remove(a)})}]})}}})}]).run(["formInputTypes","underscoreTemplate","$timeout","$parse","endpoint","modelsMeta","models","$q","$filter","$modal","helpers","errorHandling","modals","GLOBAL_CONFIG","snackbar",function(e,t,n,r,i,a,o,s,c,l,u,d,p,f,g){$.extend(e,{SuperLocalStructuredProperty:function(d){var f,m,h,v,y,b,w=d.config,k=[],C=[],S=w.modelclass,A=_.toArray(S),E=!angular.isDefined(w.ui.specifics),x=[],I=u.callable(d.scope.formSetDirty),O={secondary:!0,perLine:1,clickable:!0,calculate:function(e,t){return parseInt(t,10)===parseInt(this.perLine,10)}};return w.ui.fieldset=!0,w.ui.specifics.toolbar||(w.ui.specifics.toolbar={}),w.ui.specifics.remoteOpts||(w.ui.specifics.remoteOpts={}),w.ui.specifics.sortMode=!0,A=A.sort(u.fields.sorter),(E||!w.ui.specifics.fields)&&(w.ui.specifics.fields=A,w.ui.specifics.sortFields&&(angular.forEach(w.ui.specifics.sortFields,function(e){x.push(_.findWhere(w.ui.specifics.fields,{code_name:e}))}),w.ui.specifics.fields=x)),!E&&w.ui.specifics.excludeFields&&(angular.forEach(w.ui.specifics.fields,function(e,t){-1===$.inArray(e.code_name,w.ui.specifics.excludeFields)&&C.push(e)}),w.ui.specifics.fields=C),f={fields:k,addNewText:"Add",addText:"{{config.ui.specifics.addNewText}}"},w.ui.specifics.listConfig&&$.extend(O,w.ui.specifics.listConfig),w.ui.specifics.listConfig=O,angular.forEach(f,function(e,t){void 0===w.ui.specifics[t]&&(w.ui.specifics[t]=e)}),w.ui.specifics.parentArgs=d.scope.$eval(w.ui.args),w.ui.specifics.entity=d.scope.$eval(w.ui.model),w.ui.specifics.rootScope=d.scope.$eval(w.ui.rootScope),w.ui.specifics.sortableOptions||(w.ui.specifics.sortableOptions={}),h={disabled:!1,cancel:"input,textarea,button,select,option,[disabled]",start:function(e,t){d.scope.$broadcast("itemOrderStarted")},axis:!1,distance:6,containment:!1,whatSortMeans:function(){p.alert("howToSort")},forcePlaceholderSize:!0,forceHelperSize:!0,handle:".sort-handle",tolerance:"pointer",helper:"clone",sort:function(e,t){var n,r,i=t.helper.width(),a=t.item.scope(),o=a.$eval(t.item.attr("current-item"));r=t.offset.left+i,i/2>r&&(n=!0),o&&(n?(t.helper.addClass("about-to-delete"),o._state="deleted"):(t.helper.removeClass("about-to-delete"),o._state=null)),d.scope.$broadcast("itemOrderSorting")},stop:function(e,t){var n;angular.forEach(w.ui.specifics.parentArgs,function(e,t){t=w.ui.specifics.parentArgs.length-1-t,("deleted"===e._state||e._sequence!==t)&&(n=!0),e._sequence=t,e.ui.access[e.ui.access.length-1]=t}),n&&d.scope.formSetDirty(),d.scope.$broadcast("itemOrderChanged"),d.scope.$apply()}},w.ui.specifics.setupSortableOptions&&(w.ui.specifics.sortableOptions=w.ui.specifics.setupSortableOptions()),$.extend(h,w.ui.specifics.sortableOptions),w.ui.specifics.sortableOptions=h,w.ui.init.add("checkDisabledStateForSortable",function(){var e=r(w.ui.writableCompiled+"");w.ui.specifics.sortableOptions.disabled=!e(d.scope)}),d.scope.$watch(w.ui.args,function(e,t){e!==t&&(w.ui.specifics.parentArgs=e)}),y=function(){w.ui.specifics.formBuilder=[],angular.forEach(w.ui.specifics.fields,function(e){var t=angular.copy(w.ui.writable);angular.isArray(t)&&t.push(e.ui.writableName?e.ui.writableName:e.code_name),e.ui.path=[],e.ui.path.extend(w.ui.path),e.ui.path.push(e.code_name),e.ui.realPath=[],e.ui.realPath.extend(w.ui.realPath),e.ui.realPath.push(e.code_name),angular.isDefined(e.ui.name)||(e.ui.name=w.ui.name+"."+e.code_name),e.ui.writable=t,w.ui.specifics.formBuilder.push(e)})},y(),angular.isUndefined(w.ui.specifics.toolbar.titleAdd)&&(w.ui.specifics.toolbar.titleAdd="add"+u.toolbar.makeTitle(w.code_name)),angular.isUndefined(w.ui.specifics.toolbar.titleEdit)&&(w.ui.specifics.toolbar.titleEdit="edit"+u.toolbar.makeTitle(w.code_name)),m=function(){w.ui.specifics.readerDefer&&w.ui.specifics.readerDefer.resolve()},w.ui.specifics.remote&&(b=w.ui.specifics.getRootArgs?w.ui.specifics.getRootArgs():w.ui.specifics.rootScope.args,w.repeated&&b.id&&d.scope.args.id?(w.ui.specifics.reader=o[b.action_model].reader({kind:b.action_model,key:b.key,args:b,access:w.ui.realPath,complete:function(e){angular.isArray(w.ui.specifics.parentArgs)&&w.ui.specifics.parentArgs.extend(e)}}),angular.isDefined(w.ui.specifics.readerSettings)&&w.ui.specifics.reader.state(w.ui.specifics.readerSettings),angular.isUndefined(w.ui.specifics.remoteAutoload)||w.ui.specifics.remoteAutoload?(angular.isArray(w.ui.specifics.parentArgs)&&w.ui.specifics.parentArgs.empty(),n(function(){w.ui.specifics.reader.load()["finally"](m)},100,!1)):m()):m()),w.repeated||w.ui.specifics.modal===!0?(w.ui.specifics.remove=function(e){e._state="deleted",d.scope.$emit("itemDelete",e),d.scope.$broadcast("itemDelete",e),I()},w.ui.specifics.manage=function(n,r,f){y(),f=u.alwaysObject(f),r=u.alwaysObject(r),w.ui.specifics.defaultArgs&&$.extend(r,w.ui.specifics.defaultArgs),l.open({popFrom:f&&f.target?u.clicks.realEventTarget(f.target):void 0,template:t.get(w.ui.specifics.templateUrl||"core/fields/manage_structured.html")({config:w}),inDirection:f.inDirection,outDirection:f.outDirection,controller:["$scope","modelsUtil",function(t,l){var m,h;t.$stateHiddenLoading=!0,t.config=w,t.isNew=n?!1:!0,t.container={action:i.url},h=function(){return w.ui.specifics.toolbar["title"+(t.isNew?"Add":"Edit")]},w._title_.push(h),t.$watch("isNew",function(){w.ui.specifics.toolbar.title=u.toolbar.buildTitle(w._title_)}),w.ui.specifics.remote||$.extend(w.ui.specifics.toolbar,{leftIcon:w.ui.specifics.cards?"close":"arrow_back",hideSave:!0,hideRight:!0}),t.$on("$destroy",function(){w._title_.remove(h),w.ui.specifics.remoteOpts={},w.ui.additionalRealPaths=null}),m=function(t){var i=w.ui.specifics.modal?0:w.ui.specifics.parentArgs?w.ui.specifics.parentArgs.length:0,f={0:[]},m={},h=[],y={},k=function(e,n){var r,i=[],a=t.isNew&&w.repeated;return angular.forEach(n,function(e,t){var n=parseInt(e,10);isNaN(n)||(e=0),i.push(e)}),a&&i.pop(),r=u.getProperty(e.data.entity,i),a&&r.length&&(r=_.findWhere(r,{_state:"created"})),r};angular.forEach(w.ui.specifics.formBuilder,function(e){m[e.code_name]=e}),w.ui.specifics.getScope=function(){return t},t.rootFormSetDirty=I,t.formSetDirty=angular.bind(t,u.form.setDirty),t.formSetPristine=angular.bind(t,u.form.setPristine),t.response=null,n?!w.ui.specifics.modal&&n.ui&&(i=_.last(n.ui.access)):(n={kind:w.modelclass_kind,_sequence:i},l.normalize(n,w.modelclass,w.ui.specifics.entity,w.code_name,i),angular.isDefined(r)&&$.extend(n,r)),angular.isDefined(n.ui)&&(n.ui.access=angular.copy(w.ui.realPath),w.ui.specifics.modal||n.ui.access.push(i)),t.layouts={groups:[{label:!1}]},t.formBuilder=f,t.liveArg=n,t.args=angular.copy(t.liveArg),t.parentArgs=w.ui.specifics.parentArgs,t.rootScope=w.ui.specifics.rootScope,t.entity=w.ui.specifics.entity,w.ui.specifics.remote?t.close=angular.bind(t,u.form.leave,function(){var e=t.$close();return w.ui.specifics.afterClose&&w.ui.specifics.afterClose(t),e}):(t.close=function(){if(!t.container.form.$dirty)return t.$close();var e=t.save();return e?e.then(function(){return t._close_=void 0,t.$close()}):p.confirm("discardWithFieldsRequired",t.$close)},t._close_=t.close),t.validateForm=angular.bind(t,u.form.validate),t.$on("$destroy",function(){w.ui.specifics.getScope=void 0}),w.ui.specifics.layoutConfig&&(delete f[0],t.layouts={groups:[]},angular.forEach(w.ui.specifics.layoutConfig,function(e,n){var r=m[e.fields[0]];t.layouts.groups.push({label:e.label||r.label||c("humanized")(r.code_name)})})),v=function(e){var t,n,r=w.ui.specifics.layoutConfig;for(n=r.length-1;n>=0;n--)if(-1!==$.inArray(e.code_name,r[n].fields)){t=n;break}return t},angular.forEach(w.ui.specifics.formBuilder,function(n){var r,a,o;return u.fields.applyGlobalConfig(n),n.ui.initialRealPath?n.ui.realPath=angular.copy(n.ui.initialRealPath):n.ui.initialRealPath=angular.copy(n.ui.realPath),n.ui.realPath.pop(),w.ui.specifics.modal||n.ui.realPath.push(i),n.ui.realPath.push(n.code_name),n.ui.groupBy?(n.ui.hideMessages=!0,y[n.ui.groupBy]||(r={ui:{group:{help:n.ui.groupHelp,label:n.ui.groupLabel,name:n.ui.groupBy,fields:[],messages:function(){var e={help:!0};return angular.forEach(r.ui.group.fields,function(t){t.ui.form.hasErrors()&&t.ui.form.field().$dirty&&(e=t.ui.form.messages())}),e},shouldShowMessages:function(){return!0}}}},y[n.ui.groupBy]=r,h.push(n.ui.groupBy),w.ui.specifics.layoutConfig?(o=v(n),angular.isDefined(f[o])||(f[o]=[]),f[o].push(r)):f[0].push(r)),void y[n.ui.groupBy].ui.group.fields.push(n)):w.ui.specifics.layoutConfig?(o=v(n),angular.isDefined(f[o])||(f[o]=[]),void f[o].push(n)):void(u.fields.isFieldset(n)&&e[n.type]?(a={label:n.ui.label||c("humanized")(n.code_name)},_.string.contains(n.type,"Remote")&&(a.include="core/misc/action.html",a.action=function(){var e=!0;n.ui.specifics&&n.ui.specifics.canOpen&&(e=n.ui.specifics.canOpen()),e&&p.fields.remote(t,n)}),t.layouts.groups.push(a),o=t.layouts.groups.length-1,angular.isDefined(f[o])||(f[o]=[]),f[o].push(n)):f[0].push(n))}),w.ui.specifics.remote?(t.rootArgs=b,t.setAction=function(e){t.sendRootArgs.action_id=e},t.sendRootArgs={},t.save=function(e){if(!t.validateForm())return!1;var r,i=function(){var e,n,r,i={},o=t.rootArgs,s=t.args.ui.access,c=[];o=angular.copy(o),u.setProperty(o,s,t.args),w.ui.additionalRealPaths&&angular.forEach(w.ui.additionalRealPaths,function(e){u.setProperty(o,e,t.args)}),t.sendRootArgs=o,angular.forEach(t.rootScope.config.fields,function(e){_.string.contains(e.type,"RemoteStructured")&&e.code_name!==t.args.ui.access[0]&&delete o[e.code_name]}),o.read_arguments=i,angular.forEach(s,function(t,n){if(!angular.isDefined(i[t])&&isNaN(parseInt(t,10))&&(i[t]={config:{}},i=i[t],c.push(t)),o=o[t],angular.isArray(o))e=o;else{var r,a,s=c.join(".");w.ui.specifics.remoteOpts.read&&w.ui.specifics.remoteOpts.read[s]&&(r=w.ui.specifics.remoteOpts.read[s]),angular.isDefined(e)&&(a=e.concat(),e.empty(),e.push(o),r&&r(a,e),a=null,e=void 0),null!==o.key&&angular.isDefined(o.key)&&(angular.isDefined(i.config.keys)||(i.config.keys=[]),i.config.keys.push(o.key))}}),(r=function(e,t){e&&e.key?(n=a.getFields(e.kind),angular.forEach(n,function(n){if(n.is_structured&&_.string.contains(n.type,"RemoteStructured")){var i=[],a={config:{keys:i}};n.repeated&&angular.forEach(e[n.code_name],function(e){e.key&&(i.push(e.key),r(e,a))}),t[n.code_name]=a}})):angular.isArray(e)&&angular.forEach(e,function(e){r(e,t)})})(o,i)};return i(),w.ui.specifics.beforeSave&&w.ui.specifics.beforeSave(t),r=o[t.sendRootArgs.action_model].actions[t.sendRootArgs.action_id](t.sendRootArgs,{activitySpinner:!0,disableUI:!0}),r.then(function(r){t.response=r;var a,o=angular.copy(t.args.ui.access);a=w.ui.specifics.remoteOpts.response?w.ui.specifics.remoteOpts.response(r):k(r,o),$.extend(t.args,a),t.args.ui.access=o,t.isNew&&(w.repeated&&t.parentArgs.unshift(t.args),t.isNew=!1),$.extend(n,t.args),i(),angular.isDefined(w.ui.specifics.afterSave)&&w.ui.specifics.afterSave(t),t.formSetPristine(),e||g.showK("changesSaved")},function(e){angular.isDefined(w.ui.specifics.afterSaveError)&&w.ui.specifics.afterSaveError(t,e)}),r},t.uploadStart=function(){t.activitySpinner.start()},t.uploadEnd=function(){t.activitySpinner.stop()},t.uploadComplete=function(e){t.response=e;var n=angular.copy(t.args.ui.access),r=k(e,n);$.extend(t.args,r),t.args.ui.access=n,angular.isDefined(w.ui.specifics.afterUploadComplete)&&w.ui.specifics.afterUploadComplete(t),t.formSetPristine(),g.showK("changesSaved")},t.noComplete=function(){angular.isDefined(w.ui.specifics.noComplete)&&w.ui.specifics.noComplete(t),t.formSetPristine()},t.uploadError=function(e){angular.isDefined(w.ui.specifics.afterUploadError)&&w.ui.specifics.afterUploadError(t,e),t.formSetPristine()}):t.save=function(){if(!t.validateForm())return!1;t.container.form.$dirty&&t.rootFormSetDirty();var e=null,n=s.defer(),r=n.promise,i=function(){var e=null,r=0;w.repeated&&(t.isNew?(t.parentArgs.unshift(t.args),t.isNew=!1,r=t.parentArgs.length-1,angular.forEach(t.parentArgs,function(e,t){t=r-t,e._sequence=t,e.sequence=t})):$.extend(t.liveArg,t.args)),angular.isFunction(w.ui.specifics.afterSave)&&(e=w.ui.specifics.afterSave(t,d)),e&&e.then?e.then(function(){t.formSetPristine(),n.resolve(),w.closeAfterSave&&t.close()}):(t.formSetPristine(),n.resolve(),w.closeAfterSave&&t.close())};return angular.isFunction(w.ui.specifics.beforeSave)&&(e=w.ui.specifics.beforeSave(t,d)),e&&e.then?e.then(i):i(),r},w.ui.specifics.scope&&$.extend(t,w.ui.specifics.scope),angular.isFunction(w.ui.specifics.init)&&w.ui.specifics.init(t),angular.forEach(w.ui.specifics.fields,function(e){e._title_=w._title_.concat()}),u.fields.deferFormBuilderFields(t.formBuilder).then(function(){t.$stateHiddenLoading=!1})},angular.isFunction(n)?t.$state.promise(n,function(e,t){n=t.arg,r=t.defaultArgs,f=t.modalSettings,m(e)}):t.$state.instant(function(){m(t)})}]})},angular.isUndefined(w.ui.specifics.create)&&(w.ui.specifics.create=w.ui.specifics.manage),d.scope.$on("$destroy",function(){w.ui.specifics.create=void 0,w.ui.specifics.sortableOptions={}})):w.ui.specifics.SingularCtrl=["$scope",function(e){e.args=w.ui.specifics.parentArgs,d.scope.$watchCollection(w.ui.args,function(t,n){$.extend(e.args,t)}),w.ui.specifics.getScope=function(){return e};var t=function(){return w.ui.specifics.toolbar.titleEdit};w._title_.push(t),angular.forEach(w.ui.specifics.fields,function(e){e._title_=w._title_.concat()}),e.$on("$destroy",function(){w._title_.remove(t),w.ui.specifics.getScope=void 0})}],"structured_"+(w.repeated?"repeated":"single")},_RemoteStructuredPropery:function(e){var t=e.config;t.ui.specifics.remote=!0},SuperStructuredProperty:function(e){return this.SuperLocalStructuredProperty(e)},SuperRemoteStructuredProperty:function(e){this._RemoteStructuredPropery(e);var t=this.SuperLocalStructuredProperty(e);

return t},SuperImageLocalStructuredProperty:function(e){return this.SuperLocalStructuredProperty(e),e.config.ui.specifics.displayImageConfig||(e.config.ui.specifics.displayImageConfig={size:360}),e.config.ui.specifics.sortableOptions||(e.config.ui.specifics.sortableOptions={}),$.extend(e.config.ui.specifics.sortableOptions,{axis:!1,containment:!1}),"image"},SuperImageStructuredProperty:function(e){return e.config.ui.specifics.sortableOptions||(e.config.ui.specifics.sortableOptions={}),$.extend(e.config.ui.specifics.sortableOptions,{axis:!1,containment:!1}),this.SuperImageLocalStructuredProperty(e)},SuperImageRemoteStructuredProperty:function(e){this._RemoteStructuredPropery(e);var t=this.SuperImageLocalStructuredProperty(e);return t}})}])}(),function(){"use strict";angular.module("app").run(["helpers",function(e){e.grid={calculate:function(e,t,n,r){var i,a,o,s,c,l,u=t-n,d=[];for(i=0;u>i&&(a=t-i,o=e/a,s=Math.floor(o),a=e/s,a>t&&(s+=1,a=e/s,n>a&&(s-=1,a=t)),c=Math.floor(a),l=Math.floor(e%(c*s)/2),c-=2*r,d=[c,s,l],!(o>4||1===s));i++);return d}},e.gridStacked={getHeight:function(e,t,n){n=2*n,t-=e.length*n;var r=0;return angular.forEach(e,function(e){r+=e.proportion}),t/r},setHeight:function(e,t){angular.forEach(e,function(e){e.width=t*e.proportion,e.height=t})},resize:function(e,t){this.setHeight(e,this.getHeight(e,t))},calculate:function(e,t,n,r){var i,a,o,s=0,c=t;e:for(;t.length>0;){for(i=1;i<t.length+1;++i)if(a=t.slice(0,i),o=this.getHeight(a,e,r),n>o){this.setHeight(a,o),s++,t=t.slice(i);continue e}this.setHeight(a,Math.min(n,o)),s++;break}return c}}}]).directive("gridStacked",["helpers","$timeout",function(e,t){return{link:function(n,r,i){var a=function(){var t=0,a=function(a){var o=r.width(),s=[],c=1;!o||a&&t===o||(angular.forEach(n.$eval(i.gridStacked),function(e){"deleted"!==e._state&&s.push(angular.copy(e))}),e.gridStacked.calculate(o,s,240,c),r.find(".grid-item").filter(function(){return"none"!==$(this).css("display")}).each(function(e){angular.isDefined(s[e])&&($(this).css({width:s[e].width,height:s[e].height}).addClass("visible"),$(this).find("img").css({height:s[e].height}))}))};a(),setTimeout(function(){a(!0)},50)};a=_.throttle(a,100),n.$on("modalResize",a),n.$on("itemOrderChanged",a),n.$on("itemOrderSorting",a),n.$on("ngRepeatEnd",a),n.$on("itemDelete",function(){t(a,0,!1)}),n.$watch(i.gridStacked+".length",function(){t(a,0,!1)})}}}]).directive("gridGenerator",["GLOBAL_CONFIG","helpers","$timeout",function(e,t,n){return{link:function(n,r,i){var a=n.$eval(i.gridGenerator)||{},o=a.margin||0,s=a.maxWidth||e.grid.maxWidth,c=a.minWidth||e.grid.minWidth,l=a.maxHeight||e.grid.maxHeight,u=a.fixedHeight,d=angular.isDefined(a.square)?a.square:!0,p=function(){if(r=$(r),r.length){var e,n=r,i=n.width();i&&(e=t.grid.calculate(i,s,c,o),(n.css("paddingLeft")!==e[2]||n.css("paddingRight")!==e[2])&&n.css({paddingRight:e[2],paddingLeft:e[2]}),n.find(".grid-item").filter(function(){return"none"!==$(this).css("display")}).each(function(){var n,r=u?u:t.newHeightByWidth(s,l,e[0]);(e[0]!==$(this).width()||$(this).height()!==r)&&(n=$(this).width(e[0]),d?n.height(e[0]):$(this).height(r)),$(this).addClass("visible")}))}};p=_.throttle(p,100),$(window).bind("resize",p),n.$on("ngRepeatEnd",p),n.$on("itemDelete",p),n.$watch(i.gridGeneratorItems+".length",p),n.$on("$destroy",function(){$(window).off("resize",p)})}}}]).directive("gridScale",["helpers","$timeout","GLOBAL_CONFIG",function(e,t,n){return{controller:["$scope","$element",function(t,n){var r=this,i=0;r.items=[],r.config={},r.columns=1,r.calc=[],r.getColumns=function(){var t=e.grid.calculate(n.width(),r.config.maxWidth,r.config.minWidth,r.config.margin);r.columns=t[1],r.calc=t},r.add=function(e){i+=1,r.items.push(e),r.calculate(e),i===r.columns&&(i=0)},r.remove=function(e){r.items.remove(e),r.resize()},r.calculate=function(e){if(r.columns<2&&n.width()>r.config.maxWidth)return e.css("width","calc((100%) - "+2*r.config.margin+"px)"),void n.css({marginLeft:r.calc[2],marginRight:r.calc[2]});if(n.css({marginLeft:"",marginRight:""}),r.columns){var t=100/r.columns;t>0&&e.css("width","calc(("+t+"%) - "+2*r.config.margin+"px)")}else e.css("width","")},r.resize=function(e){r.getColumns(),angular.forEach(r.items,function(e){r.calculate(e)})},r.resize=_.throttle(r.resize,100),$(window).on("resize",r.resize),t.$on("$destroy",function(){$(window).off("resize",r.resize)})}],link:function(e,t,r,i){$.extend(i.config,n.grid,e.$eval(r.gridScale)||{}),i.getColumns()}}}]).directive("gridScaleItem",["helpers",function(e){return{require:"^gridScale",link:function(e,t,n,r){var i=function(e,n){if(n){var r=n.parents("[grid-scale-item]:first");r.length&&r.get(0)===t.get(0)&&t.addClass("visible")}else t.addClass("visible")},a=e.$eval(n.gridScaleItem)||{};r.add(t),a.image?e.$on("displayImageLoaded",i):setTimeout(i,50),e.$on("$destroy",function(){r.remove(t)})}}}])}(),function(){"use strict";angular.module("app").run(["helpers","$mdConstant","GLOBAL_CONFIG",function(e,t,n){$.extend(e,{clicks:{realEventTarget:function(e){var t=$(e),n=t.parents(".grid-item:first"),r=t.parents(".card:first"),i=t.parents("button:first");return!t.hasClass("grid-item")&&n.length?n.get(0):r.length?r.get(0):i.length?i.get(0):e}},closestLargestNumber:function(e,t){var n=Math.max.apply(null,e),r=0;for(r=0;r<e.length;r++)e[r]>t&&e[r]<n&&(n=e[r]);return n},newWidthByHeight:function(e,t,n){var r;return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),r=n/t,e*r},newHeightByWidth:function(e,t,n){var r;return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),r=n/e,t*r},popup:{openCentered:function(e,t){if(window.ENGINE.CORDOVA.ACTIVE)return window.open(e,"_blank","location=yes");var n,r=$(window).width()/1.3,i=$(window).height()/1.3,a=screen.width/2-r/2,o=screen.height/2-i/2;return n=window.open(e,t,"scrollbars=1, width="+r+", height="+i+", top="+o+", left="+a),n.focus(),n}},url:{local:function(e){return window.ENGINE.CORDOVA.ACTIVE?window.cordova.file.applicationDirectory+"www/"+e:"/"+e},abs:function(e){return n.host+"/"+e},handleProtocol:function(e){return"https:"===document.location.protocol||"chrome-extension:"===document.location.protocol?e.replace("http://","https://"):e},urlsafe:function(e){return window.btoa(e).replace(new RegExp("=","g"),"-")},urlunsafe:function(e){return window.atob(e.replace(new RegExp("-","g"),"="))},jsonFromUrlsafe:function(t){return angular.fromJson(e.url.urlunsafe(t))},jsonToUrlsafe:function(t){return e.url.urlsafe(angular.toJson(t))},getQueryVariable:function(e,t){-1!==e.indexOf("#")&&(e=e.split("#")[0]);var n,r=e.split("?")[1],i=r.split("&"),a=0;for(a=0;a<i.length;a++)if(n=i[a].split("="),decodeURIComponent(n[0])===t)return decodeURIComponent(n[1])}}});var r=function(e,t,n){return $(this).on(e,function r(i){i.target===this&&("one"===t&&$(this).off(e,r),n.call(this,i))})};$.fn.animationEndOff=function(e){$(this).off(t.CSS.ANIMATIONEND,e)},$.fn.oneAnimationEnd=function(e){return r.call(this,t.CSS.ANIMATIONEND,"one",e)},$.fn.animationEnd=function(e){return r.call(this,t.CSS.ANIMATIONEND,"on",e)},$.fn.oneTransitionEnd=function(e){return r.call(this,t.CSS.TRANSITIONEND,"one",e)},$.fn.transitionEnd=function(e){return r.call(this,t.CSS.TRANSITIONEND,"on",e)},$.fn.transitionEndOff=function(e){$(this).off(t.CSS.TRANSITIONEND,e)}}]).directive("fillEmptySpace",function(){return{link:function(e,t,n){var r=function(){var e=parseInt(t.css("marginTop"),10);t.css("min-height",$(window).height()-e)};r(),$(window).on("resize",r),e.$on("$destroy",function(){$(window).off("resize",r)})}}}).directive("onEnter",["$parse","helpers","$mdConstant",function(e,t,n){return{link:function(r,i,a){var o=e(a.onEnter);i.on("keydown",function(e){t.responsive.isMobile()||t.responsive.isTablet()||i[0]!==e.target||e.keyCode!==n.KEY_CODE.ENTER||e.shiftKey||(e.preventDefault(),o(r,{$event:e}),$(this).val(""))})}}}]).directive("helpRender",function(){return{scope:{help:"=helpRender"},templateUrl:"core/misc/help_render.html",link:function(e,t,n){e.isTemplate=function(){return!angular.isArray(e.help)}}}}).directive("displayImage",["GLOBAL_CONFIG","helpers","$http",function(e,t,n){return{scope:{image:"=displayImage",config:"=displayImageConfig"},link:function(n,r,i){var a,o;n.config||(n.config={}),angular.isDefined(n.config.size)||(n.config.size=240),o=function(i,o){if(i!==o){var s=r,c=function(){s.css("visibility","inherit"),n.$emit("displayImageLoaded",s),s.off("load",c)},l=function(){var r=n.config.defaultImage;r||(r="defaultImage"),s.attr("src",t.url.local(e[r])),c(),s.off("error",l)};n.image&&n.image.serving_url?(a=t.url.handleProtocol(n.image.serving_url)+(n.config.size===!0?"":"=s"+n.config.size),s.on("load",c).on("error",l),s.attr("src",a)):setTimeout(function(){l(),c()},50)}},n.$watch("image.serving_url",o),o(!0,!1)}}}]).directive("loading",["$parse",function(e){return{link:function(t,n,r){angular.isDefined(r.loading)&&t.$watch(r.loading,function(e){e?n.attr("disabled","disabled"):n.removeAttr("disabled")});var i=function(e){return e.stopImmediatePropagation(),e.preventDefault(),!1},a=angular.isDefined(r.loading)?e(r.loading):function(){return!1};t.$on("disableUI",function(e,r){a(t)||(r===!0?(n.attr("disabled","disabled"),n.on("click",i)):(n.removeAttr("disabled"),n.off("click",i)))})}}}]).directive("onNgRepeatEnd",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){e.$last===!0&&e.$evalAsync(function(){e.$emit("ngRepeatEnd")})}}}]).directive("defaultFieldDisplay",["$compile",function(e){return{scope:{val:"=defaultFieldDisplay"},templateUrl:"buyer/address_display.html",controller:["$scope",function(e){e.notEmpty=function(e){return angular.isString(e)||angular.isNumber(e)}}]}}]).directive("draggableClick",["$parse","helpers",function(e,t){return{restrict:"A",link:function(t,n,r){var i=e(r.draggableClick),a=function(e,r){return n.attr("disabled")?void 0:n.hasClass("dragged")&&!r?void n.removeClass("dragged"):void t.$apply(function(){i(t,{$event:e})})};n.on("click",a),t.$on("$destroy",function(){n.off("click",a)})}}}]).directive("loadMoreButton",function(){return{restrict:"A",templateUrl:"core/misc/load_more_button.html",scope:{config:"=loadMoreButton"},link:function(e,t){e.$watch("config.firstLoad",function(e,n){if(e===!1||e===!0){var r=t.parents(".modal:first"),i=r.find("content-spinner").find(":first");if(!i.length){if(r.length)return;i=$("body content-spinner:first").find(":first")}e===!0?i.removeClass("ng-hide"):e===!1&&i.addClass("ng-hide")}})}}}).directive("autoloadOnVerticalScrollEnd",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){var i,a,o,s,c,l,u,d,p,f,g=!1,m=!1,h=!1;i=t.$eval(r.autoloadOnVerticalScrollEnd),f=function(){a=function(){var e=i.listen;if(e)e=$(i.listen||window);else{if(e=n.parents(".ui-view-wrapper:first"),e.length)return e;e=n.parents("md-content[md-scroll-y]:first"),n.hasClass("overflow-y")||n.hasClass("overflow-auto-y")?e=n:(e.length||(e=n.parents(".overflow-y:first")),e.length||(e=n.parents(".overflow-auto-y:first")))}return e}(),u=function(){e.cancel(p),p=e(function(){var e,t,n=a.get(0),r=n.scrollHeight,s=$(window).height()-56;e=i.reverse?n?a.scrollTop()<(i.top||8):!1:n?s>=r||s-r>-10:!1,a.length&&n&&(e?(t=o({},angular.noop),t?t.then(function(){i.reverse||u()})["finally"](function(){m=!1}):m=!1):m=!1)},800,!1)},d=function(){clearInterval(c),c=setInterval(function(){m||g||(m=!0,u())},2e3)},o=function(e,t){if(i.loader&&angular.isFunction(i.loader.load)){var n=i.loader.load();return n?(n.then(function(){t()}),n):(t(),!1)}},l={conditions:{"max-bottom":i.bottom||40},scrollElement:a.get(0),throttle:100,handler:o},i.reverse&&delete l.conditions,s=new Steady(l),i.reverse&&(s.addTracker("checkTop",function(){return a.scrollTop()<(i.top||40)}),s.addCondition("checkTop",!0)),t.$on("$destroy",function(){s&&(s.stop(),s=void 0),clearInterval(c),e.cancel(p)}),i.watch?t.$watchGroup(angular.isArray(i.watch)?i.watch:[i.watch],function(e,t){var n=function(){JSON.stringify(e)!==JSON.stringify(t)&&(u(),d())};i.watchTimeout?setTimeout(n,i.watchTimeout):n()}):(u(),d()),t.$watch(t.modalOptions?"modalOptions.overlay":"overlays",function(e,n){g=!1,void 0!==e&&(t.modalOptions?e!==t.overlays:e)&&(g=!0)})},t.$watch(function(){return r.autoloadOnVerticalScrollEnd&&i&&i.loader},function(t,n){t&&!h&&e(function(){h=!0,f()})})}}}]).directive("resizeChart",["helpers",function(e){return{priority:100,link:function(t,n,r){var i=function(){var t=$(n).width(),r=e.newHeightByWidth(640,260,t);$(n).height(r)};i(),t.$on("modalResize",i)}}}]).directive("listButton",function(){return{templateUrl:"core/misc/list_button.html",transclude:!0,replace:!0}}).directive("mdInkRippleList",["$mdInkRipple",function(e){return{link:function(t,n,r){e.attach(t,n,{dimBackground:!0,multiplier:.1,moveToCenter:!1})}}}]).directive("mdInkRippleAction",["$mdInkRipple",function(e){return{link:function(t,n,r){e.attachButtonBehavior(t,n,{dimBackground:!1})}}}]).directive("mdInkRippleFit",["$mdInkRipple",function(e){return{link:function(t,n,r){e.attachButtonBehavior(t,n,{dimBackground:!1,fitRipple:!0,moveToCenter:!1})}}}]).directive("icon",["$mdInkRipple",function(e){return{templateUrl:"core/misc/icon.html",replace:!0,transclude:!0,scope:!0,link:function(e,t,n){e.icon=n.type,e.color=n.color||"normal"}}}]).directive("contentListView",function(){return{scope:{val:"=contentListView"},templateUrl:"core/misc/content_list_view.html"}}).directive("sidenavItem",["$timeout","$mdSidenav",function(e,t){return{templateUrl:"core/misc/sidenav_item.html",transclude:!0,replace:!0}}]).filter("labelize",["GLOBAL_CONFIG","$log",function(e,t){return function(n,r){if(void 0===n)return n;angular.isUndefined(r)&&(r="default");var i,a=e.labels[r];return angular.isUndefined(a)?(t.warn("Group is not defined: "+r),n):(i=a[n],angular.isDefined(i)?i:(t.warn("Path for label not found: "+r+"."+n),n))}}]).filter("propsFilter",function(){return function(e,t){var n=[];return angular.isArray(e)?e.forEach(function(e){var r,i,a,o=!1,s=Object.keys(t);for(r=0;r<s.length;r++)if(i=s[r],a=t[i].toLowerCase(),-1!==e[i].toString().toLowerCase().indexOf(a)){o=!0;break}o&&n.push(e)}):n=e,n}}).filter("capitalize",function(){return function(e){return _.str.capitalize(e)}}).filter("output",["modelsMeta","outputTypes","$cacheFactory",function(e,t,n){var r=t,i=n("cacheFields"),a=function(t){return i.get(t)||i.put(t,e.getFields(t)),i.get(t)};return function(e,t,n){var i,o,s,c=e[t];if(e.kind&&(i=a(e.kind),o=i[t],angular.isDefined(o))){if(s=r[o.type],angular.isDefined(s))return s(c,o);if(c&&"object"==typeof c&&c.hasOwnProperty("name"))return c.name}return c}}]).filter("escape",function(){return function(e){return e?_.escape(e):e}}).filter("autobr",["helpers",function(e){return function(e){return angular.isString(e)?e.replace(/\n\r?/g,"<br />"):e}}]).filter("formatCurrency",["$injector","$locale",function(e,t){var n=e.get("$filter"),r=n("number"),i=t.NUMBER_FORMATS;return i.DEFAULT_PRECISION=angular.isUndefined(i.DEFAULT_PRECISION)?2:i.DEFAULT_PRECISION,function(e,t,n){if(n=angular.isDefined(n)?n:!0,e=parseFloat(e,10),!angular.isNumber(e)||isNaN(e))return"";var i,a,o,s,c,l,u,d=0>e;return e=Math.abs(e),i=r(e,t.digits),a="<"+i+">",o=t.symbol,n||(o=!1),o&&(s=d&&t.negative_currency_symbol_precedes||t.positive_currency_symbol_precedes,c=d&&t.negative_separate_by_space||t.positive_separate_by_space,a=s?o+(c?" ":"")+a:a+(c?" ":"")+o),l=d&&t.negative_sign_position||t.positive_sign_position,u=d&&t.negative_sign||t.positive_sign,u||(u=""),0===l?a="("+a+")":1===l?a=u+a:2===l?a+=u:a=3===l?a.replace("<",u):4===l?a.replace(">",u):u+a,a=a.replace("<","").replace(">","")}}]).filter("substr",function(){return function(e){return angular.isString(e)?String.prototype.substr.apply(e,Array.prototype.slice.call(arguments,1)):e}}).filter("nl2br",function(){return function(e){return void 0!==e?e.replace(/\n/g,"<br />"):void 0}}).filter("highlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n&&t?t.replace(new RegExp(e(n),"gi"),'<span class="ui-select-highlight">$&</span>'):t}}).factory("outputTypes",["dateFilter","GLOBAL_CONFIG","modelsMeta",function(e,t,n){var r={SuperDateTimeProperty:function(n,r){if(!n)return"None";var i=new Date(n),a=new Date,o=a.getYear()===i.getYear(),s=!1,c=!1,l=t.date.format;return o||(l="d MMM yyyy, HH:mm"),o&&(s=i.getMonth()===a.getMonth(),l="d MMM, HH:mm"),s&&o&&i.getDate()===a.getDate()&&(c=!0,l="HH:mm"),e(i,l)}};return r}]).factory("searchBuilder",["modelsMeta","GLOBAL_CONFIG",function(e,t){var n=function(){var n={kind:null,hide:!1,filters:{},indexes:[],indexID:null,fields:{indexID:{type:"SuperStringProperty",choices:[],code_name:"indexID",required:!0,ui:{args:"search.indexID",label:t.fields.label.search.indexID,specifics:{translatedChoices:!1},writable:!0,attrs:{"ng-change":"search.makeFilters()"}}},ancestor:{type:"SuperStringProperty",code_name:"ancestor",required:"search.indexes[search.indexID].ancestor",ui:{args:"search.send.ancestor",label:t.fields.label.search.ancestor,writable:!0}},filters:[],orders:[]},mapIndexes:function(e){angular.forEach(e,function(e,t){e._index=t})},formatSearchFilter:function(e){var t,n="";return e&&angular.isObject(e)?(e.ancestor&&!e.filters&&(n+="Ancestor and "),e.filters&&(n+="Filter by ",e.ancestor&&(n+="ancestor and "),t=$.map(e.filters,function(e){return e[0]}),n+=t.join(" and "),e.orders&&(n+=" and ")),e.orders&&(n+=" order by "+$.map(e.orders,function(e){return e[0]}).join(", ")),n):e},resetFilters:function(){this.send.filters=[],this.send.orders=[],delete this.send.ancestor},changeKindUI:function(){this.changeKind(),this.setSearch(this.kind,void 0),this.makeFilters()},changeKind:function(){var t,n,r=e.getActionArguments(this.kind,"search"),i=this;if(r){try{t=r.search,this.default_send=t["default"]}catch(a){}t?this.hide=!1:(this.hide=!0,t={}),n=t.cfg,this.cfg=n,this.send.kind=this.kind,this.filters=n.filters||{},this.indexes=n.indexes||[],this.indexID=null,this.mapIndexes(n.indexes),i.fields.indexID.choices=[],angular.forEach(n.indexes,function(e){var t={key:e._index,name:i.formatSearchFilter(e)};i.fields.indexID.choices.push(t)})}},changeOrderBy:function(e){e.field=this.indexes[this.indexID].orders[e._index][0]},makeFilters:function(e){var n,r,i,a=this;angular.isDefined(e)||(e=!0),e&&this.resetFilters(),a.fields.filters=[],a.fields.orders=[],n=a.indexes[a.indexID],angular.forEach(n.filters,function(n,o){r=a.filters[n[0]],r.required="search.indexID != null && search.send.filters.length",r.code_name="filter_"+n[0],r.ui={args:"search.send.filters['"+o+"'].value",writable:!0},e&&a.send.filters.push({field:n[0],operator:n[1][0],value:r["default"]?r["default"]:"",_index:o}),i={type:"SuperStringProperty",choices:n[1],code_name:"op_"+o,required:r.required,ui:{label:t.fields.label.search.operator,writable:!0,args:"search.send.filters['"+o+"'].operator"}},a.fields.filters.push([i,r])}),angular.forEach(n.orders,function(t,n){e&&a.send.orders.push({field:t[0],operator:t[1][0],_index:n}),r={type:"SuperStringProperty",choices:t[1],code_name:"order_by_"+t[0],required:"search.indexID != null && search.send.filters.length",ui:{writable:!0,args:"search.send.orders['"+n+"'].operator"}},a.fields.orders.push(r)}),n.orders||(a.send.orders=[])},discoverIndexID:function(){var e=this,t=this.send.filters,n=this.send.ancestor,r=this.send.orders;angular.forEach(this.indexes,function(i,a){if(!(n&&!i.ancestor||!n&&i.ancestor)){var o=!0,s=0,c=0;i.filters&&(o=!1,t&&t.length&&(angular.forEach(i.filters,function(e){var n=_.findWhere(t,{field:e[0]});n&&-1!==$.inArray(n.operator,e[1])&&(s+=1)}),t.length===s&&i.filters.length===t.length&&(o=!0,e.indexID=a))),angular.forEach(i.orders,function(e,t){var n=_.findWhere(r,{field:e[0]});o&&n&&-1!==$.inArray(n.operator,e[1])&&(c+=1,n._index=t)}),o&&i.orders&&c===r.length&&i.orders.length===r.length&&(e.indexID=a)}})},setSearch:function(t,n){if(void 0===t||null===t)return void(this.hide=!0);this.kind!==t&&(this.kind=t,this.changeKind(),this.resetFilters());var r=e.getActionArguments(this.kind,"search"),i=null;if(r){try{i=r.search}catch(a){}i&&(void 0===n&&i["default"]?this.send=i["default"]:n&&(this.send=n),this.discoverIndexID(),this.makeFilters(!1))}else this.hide=!0},doSearch:function(){throw new Error("Not implemented")},submitSearch:function(){this.doSearch()},send:{filters:[],orders:[]}};return n};return{create:n}}]).factory("channelApi",["GLOBAL_CONFIG",function(e){var t={instances:{},create:function(e){if(!t.instances[e]){var n;n={callbacks:{},events:{},signals:[],socket:null,afterOnclose:[],onclose:function(e){this.afterOnclose.unshift(e)},channel:new goog.appengine.Channel(e),open:function(e){var t=this,n=[],r=function(){angular.forEach(n,function(e){e()}),!t.signals.length&&t.socket&&t.socket.close()};return angular.forEach(e,function(e,r){n.push(t[r](e))}),null!==t.socket?r:(t.socket=t.channel.open(t.events),t.socket.onclose=function(){angular.forEach(t.afterOnclose,function(e){e()})},r)},destroy:function(){delete t.instances[e]},queue:function(e,t){var n=this,r=_.uniqueId(),i=[t,r];return n.signals.push(r),n.callbacks[e].push(i),function(){n.signals.remove(r),n.callbacks[e].remove(i)}},dispatch:function(e,t){var n=this,r=[];angular.forEach(this.callbacks[e],function(e){return-1===$.inArray(e[1],n.signals)?void r.push(e):(t=_.toArray(t),t.push(function(){n.signals.remove(e[1])}),void e[0].apply(n.socket,t))}),r&&(angular.forEach(r,function(t){n.callbacks[e].remove(t)}),r=[]),n.signals.length||n.socket.close()}},angular.forEach(["onopen","onmessage","onerror"],function(e){n.callbacks[e]=[],n[e]=function(t){return this.queue(e,t)},n.events[e]=function(){n.dispatch(e,arguments)}}),n.afterOnclose.push(function(){n.destroy()}),t.instances[e]=n}return t.instances[e]}};return e.debug&&(window._channelApi=t),t}]).factory("channelNotifications",["channelApi","snackbar",function(e,t){var n={create:function(n,r){var i,a;return i=e.create(n),a=i.open({onmessage:function(e,n){if(n(),angular.isObject(e)&&e.data)try{var i=angular.fromJson(e.data);r?r(i):t.show(i.body)}catch(a){console.warn("channel callback could not execute, got error",a,"with data",e)}else console.warn("channel returned no parsable data, got",e)}}),[i,a]}};return n}]).directive("contentSpinner",function(){return{templateUrl:"core/misc/content_spinner.html",link:function(e,t){var n=function(){return t.find(":first")},r=function(){e.contentSpinner.requests<1&&n().addClass("ng-hide")},i=function(){n().removeClass("ng-hide")};e.contentSpinner.hide.push(r),e.contentSpinner.show.push(i),e.$on("$destroy",function(){e.contentSpinner.hide.remove(r),e.contentSpinner.show.remove(i)})}}}).directive("activitySpinner",["$animate",function(e){return{scope:!0,templateUrl:"core/misc/activity_spinner.html",link:function(e,t){e.raised=!0;var n=function(){return t.find(":first")},r=function(){return n().find(".progress:first")},i=function(){return r().find(".progress:first")},a=function(t){var a=r(),o=i();if(a.length){if(t)return a.removeClass("in").addClass("out"),void n().addClass("ng-hide");if(a.hasClass("out"))return;o.oneTransitionEnd(function(){e.activitySpinner.requests<1?(n().addClass("ng-hide"),a.removeClass("in out")):a.removeClass("out").addClass("in")}),a.addClass("out")}},o=function(){if(n().removeClass("ng-hide"),r().length){var e=r();e.hasClass("in")||setTimeout(function(){e.removeClass("out").addClass("in")},100)}};e.activitySpinner.hide.push(a),e.activitySpinner.show.push(o),e.$on("$destroy",function(){e.activitySpinner.hide.remove(a),e.activitySpinner.show.remove(o)})}}}]).directive("collapse",["$animate",function(e){return{link:function(t,n,r){function i(){n.removeClass("collapse").addClass("collapsing"),e.addClass(n,"in",{to:{height:n[0].scrollHeight+"px"}}).then(a)}function a(){n.removeClass("collapsing"),n.css({height:"auto"})}function o(){n.css({height:n[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing"),e.removeClass(n,"in",{to:{height:"0"}}).then(s)}function s(){n.css({height:"0"}),n.removeClass("collapsing"),n.addClass("collapse")}t.$watch(r.collapse,function(e){e?o():i()})}}}]).directive("nonBlockingNgClass",["$animate","$rootScope","$$rAF",function(e,t,n){return{link:function(e,r,i){var a={},o=$.now();e.$watch(function(){var t=!1,n=e.$eval(i.nonBlockingNgClass);return a&&angular.forEach(n,function(e,n){a[n]===e||t||(t=$.now()),a[n]=e}),t||o},function(a,o){a!==o&&angular.forEach(e.$eval(i.nonBlockingNgClass),function(e,i){t.$$postDigest(function(){n(function(){r[e?"addClass":"removeClass"](i)})})})})}}}]).directive("pollResults",["$rootScope","$timeout",function(e,t){return{scope:{config:"=pollResults"},templateUrl:"core/misc/load_more_card.html",link:function(t,n,r){var i,a=!1,o=t.config,s=!1,c=null,l=!1,u={},d={},p=function(e,n,r,i){d[e]||i||(d[e]={}),i&&d&&d[e]&&d[e].hasOwnProperty(n)&&delete d[e][n],!d[e]&&i&&delete d[e],i||(d[e][n]=!0),t.updaterDirty=Object.keys(d).length?!0:!1},f=function(){c&&clearTimeout(c),c=setTimeout(function(){return l||t.seeing?f():void o.loader.load({runLast:function(e){if(!s){var n=e?e.data.entities:!1;n&&(t.lastResults=n,t.lastResults.length!==t.config.results.length&&(t.newDirty=!0),angular.forEach(n,function(e){var n=_.findWhere(t.config.results,{key:e.key});u[e.key]||n?n&&t.config.comparator&&t.config.comparator(n,e,p):(t.dirty=!0,u[e.key]=!0,t.newDirty=!0)})),t.dirty=t.newDirty||t.updaterDirty,f()}}})},6e4)};t.thing=r.pollResultsThing,t.dirty=!1,t.seeNewItems=function(){t.seeing=!0,t.dirty=!1,t.updaterDirty=!1,t.newDirty=!1,t.config.results=t.lastResults,d={},t.seeing=!1},t.$watch(function(){return r.pollResults&&o&&o.loader},function(e){angular.isObject(e)&&!a&&(a=!0,f())}),i=e.$watch("overlays",function(e,t){l=e?!0:!1}),t.$on("$destroy",function(){s=!0,i()})}}}]).directive("whenReady",["$interpolate","$$rAF",function(e,t){return{restrict:"A",priority:Number.MIN_SAFE_INTEGER,link:function(n,r,i){function a(e){console.log("dialog",new Date),e.forEach(function(e){n.$eval(e)})}var o=i.whenReady.split(";"),s=!1,c=!1;0!==i.whenReady.trim().length&&(i.waitForInterpolation&&n.$eval(i.waitForInterpolation)&&(s=!0),i.readyCheck&&(c=!0),s||c?t(function l(){var u=!1,d=!1;u=s&&r.text().indexOf(e.startSymbol())>=0?!1:!0,d=c&&!n.$eval(i.readyCheck)?!1:!0,u&&d?a(o):t(l)}):a(o))}}}])}(),function(){"use strict";var e=function(e){var t=e.popFrom;return t?$(t):t},t=function(e){},n=function(e){},r=function(e,t){var n=e[0].getBoundingClientRect(),r=t[0].getBoundingClientRect(),i=e.width(),a=e.height(),o=t.width(),s=t.height(),c=o/i,l=1/c,u=s/a,d=1/u,p=-r.left+n.left+n.width/2-r.width/2,f=-r.top+n.top+n.height/2-r.height/2;return{top:f,left:p,scale:{x:l,y:d}}};angular.module("app").factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){var n;for(n=0;n<e.length;n++)if(t===e[n].key)return e[n]},keys:function(){var t,n=[];for(t=0;t<e.length;t++)n.push(e[t].key);return n},top:function(){return e[e.length-1]},remove:function(t){var n,r=-1;for(n=0;n<e.length;n++)if(t===e[n].key){r=n;break}return e.splice(r,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("modalBackdrop",["$timeout","$animateCss",function(e,t){return{restrict:"EA",replace:!0,templateUrl:"core/modal/backdrop.html",link:function(n,r,i){n.backdropClass=i.backdropClass||"",e(function(){t(r,{addClass:"in"}).start()},0,!1)}}}]).directive("modalWindow",["$modalStack","$timeout","$$rAF","$mdConstant","$q","$animate","$animateCss","animationGenerator","$rootScope",function(n,i,a,o,s,c,l,u,d){return{restrict:"EA",scope:{index:"@",animate:"=",modalOptions:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"core/modal/window.html"},link:function(n,s,c){var d,p=e(n.modalOptions);s.addClass(n.modalOptions.fullScreen?"":"modal-medium"),c.windowClass&&s.addClass(c.windowClass),n.size=c.size,n.$isRendered=!0,d=function(){var e,i,c,d,f,g,m,h=n.modalOptions.inDirection,v=h&&!p,y=p,b=!v&&!y,w=!n.modalOptions.fullScreen;v?e=function(){return s.addClass(h+" slide drawer visible"),l(s,{addClass:"in"})}:w&&(i=s.find(".modal-dialog"),d=i.width(),f=i.height(),n.modalOptions.resize=_.throttle(function(){var e,t,n=$(window).width()-80,r=$(window).height()-48,a=i.width(),o=i.height(),s=f>=r,c=d>=n;e=s||r>o&&s?r:"",t=c||n>a&&c?n:"",i.css("max-height",e),i.css("max-width",t)},100),n.modalOptions.resize(),$(window).on("resize",n.modalOptions.resize)),p?(c=r(p,s),g=u.single("pop-in","0% {top: "+c.top+"px; left: "+c.left+"px; "+o.RAW_CSS.TRANSFORM+": scale("+c.scale.x+", "+c.scale.y+"); }1% { opacity:1; }75% { top: 0px; left: 0px;}100% { top: 0px; left: 0px; "+o.RAW_CSS.TRANSFORM+": scale(1, 1);opacity:1;}"),e=function(){return a(function(){p.css("opacity",0)}),s.addClass("pop").data("animator",g),l(s,{addClass:g.className})}):b&&(e=function(){return s.addClass("fade"),l(s,{addClass:"in"})}),m=function(){s.addClass("visible rendered"),$(window).triggerHandler("modal.visible",[s]),n.modalOptions.opened=!0,n.$emit("modalOpened"),n.$broadcast("modalOpened"),n.$apply(),n.modalOptions.fullScreen&&t(s)},$(window).triggerHandler("modal.open",[s]),e().start().done(m)},c.$observe("modalRender",function(e){"true"===e&&i(d,50,!1)}),n.backdropClose=function(e){n.modalOptions.cantCloseWithBackdrop||e.target===e.currentTarget&&n.$parent.close()}}}}]).directive("modalTransclude",function(){return{link:function(e,t,n,r,i){i(e.$parent,function(e){t.empty(),t.append(e)})}}}).factory("$modalStack",["$timeout","$document","$compile","$rootScope","$$stackedMap","mdContextualMonitor","$mdConstant","$q","animationGenerator","$animateCss","$$rAF",function(t,i,a,o,s,c,l,u,d,p,f){function g(){return y.length()-1}function m(t,i,a){var o,s,c,u,f=e(i.modalOptions),g="in",m="out",h=t.data("animator");i.modalOptions.fullScreen&&n(t),f&&h&&(o=r(f,t),c=d.single("pop-out","0% { opacity:1;top: 0px; left: 0px; "+l.RAW_CSS.TRANSFORM+": scale(1, 1);}75% { top: 0px; left: 0px;}100% { opacity:1;top: "+o.top+"px; left: "+o.left+"px; "+l.RAW_CSS.TRANSFORM+": scale("+o.scale.x+", "+o.scale.y+"); }"),m=c.className,g=h.className),u=p(t,{removeClass:g,addClass:m}).start(),s=function(e){t.remove(),a&&a(),f&&f.css("opacity",1),t=void 0,h&&h.destroy(),c&&c.destroy()},u.done(s)}function h(e,t){var n=i.find("body").eq(0),r=y.get(e).value,a=r.backdropDomEl,s=r.backdropScope;y.remove(e),p(a,{removeClass:"in",addClass:"out"}).start().done(function(){a.remove(),s.$destroy(),r.backdropScope=void 0,r.backdropDomEl=void 0}),m(r.modalDomEl,r.modalScope,function(){r.modalScope.$destroy(),n.toggleClass(v,y.length()>0),o.overlays=y.length(),$(window).triggerHandler("modal.close"),t.resolve()})}var v="modal-open",y=s.createNew(),_={};return _.open=function(e,t){var n,r,s,l,u,d,p,f={deferred:t.deferred,modalScope:t.scope,backdrop:t.backdrop};y.add(e,f),t.scope.modalOptions={inDirection:t.inDirection,outDirection:t.outDirection,cantCloseWithBackdrop:angular.isUndefined(t.cantCloseWithBackdrop)?t.fullScreen:t.cantCloseWithBackdrop,popFrom:t.popFrom,fullScreen:t.fullScreen,noEscape:t.noEscape,opened:!1},s=i.find("body").eq(0),l=g(),r=o.$new(!0),r.index=l,u=angular.element('<div class="opaque" modal-backdrop></div>'),u.attr("backdrop-class",t.backdropClass),n=a(u)(r),s.append(n),f.backdropDomEl=n,f.backdropScope=r,p=angular.element("<div modal-window></div>"),p.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:y.length()-1,"modal-options":"modalOptions",animate:"animate",exiting:"exiting"}).html(t.content),d=a(p)(t.scope),y.top().value.modalDomEl=d,s.append(d),s.addClass(v),o.overlays=y.length(),t.scope.modalOptions.overlay=o.overlays,t.noEscape||(e.esc=function(t){var n=y.get(e);return t&&t.preventDefault(),n&&n.value&&n.value.modalScope&&n.value.modalScope._close_?n.value.modalScope._close_():(o.$apply(function(){return n&&n.value&&n.value.modalScope?n.value.modalScope.close():void _.dismiss(e,"escape key press")}),!0)},c.queue(e.esc))},_._dequeue=function(e,t){e&&e.value&&(e.value.modalScope.modalOptions.noEscape||c.dequeue(t.esc),
e.value.modalScope.modalOptions.resize&&$(window).off("resize",e.value.modalScope.modalOptions.resize))},_.close=function(e,t,n){n||(n="resolve");var r=y.get(e),i=u.defer();return _._dequeue(r,e),r?(r.value.deferred[n](t),h(e,i)):i.resolve(),i.promise},_.dismiss=function(e,t){return _.close(e,t,"reject")},_.dismissAll=function(e){for(var t=this.getTop();t;)this.dismiss(t.key,e),t=this.getTop()},_.getTop=function(){return y.top()},_}]).provider("$modal",function(){var e={options:{backdrop:!1,inDirection:"right",outDirection:"right",fullScreen:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,r,i,a,o,s){function c(e){return e.template?r.when(e.template):i.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:a}).then(function(e){return e.data})}function l(e){var n=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(r.when(t.invoke(e)))}),n}var u={};return u.open=function(t){var i=r.defer(),a=r.defer(),u={result:i.promise,opened:a.promise,close:function(e){return s.close(u,e)},dismiss:function(e){return s.dismiss(u,e)}};if(t=$.extend({},e.options,t),t.resolve=t.resolve||{},!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var d=r.all([c(t)].concat(l(t.resolve)));return d.then(function(e){var a=(t.scope||n).$new();a.$close=u.close,a.close=a.$close,a.$dismiss=u.dismiss,a.$state={completed:!1,errored:!1,using:!1,isCompleted:function(){return a.$state.completed||a.$state.using===!1},complete:function(){a.$state.completed=!0,a.$broadcast("modalStateComplete")},instant:function(e,t){return this.promise(function(){var e=r.defer();return setTimeout(function(){e.resolve()},100),e.promise},e,t)},promise:function(e,t,n){a.$state.using=!0,n||(n=function(){a.close()});var i=function(){return a.$state.completed?void 0:(angular.isFunction(e)&&(e=e()),angular.isArray(e)&&(e=r.all(e)),e.then(function(e){var r=t.call(a,a,e);return r&&r.then?r.then(a.$state.complete,n):a.$state.complete()},n))};return angular.isFunction(e)?void(a.$state.ready=i):i()}},a.$on("modalOpened",function(e){a.$state.ready&&a.$state.ready()});var c,l={},d=1;t.controller&&(l.$scope=a,l.$modalInstance=u,angular.forEach(t.resolve,function(t,n){l[n]=e[d++]}),c=o(t.controller,l),t.controllerAs&&(a[t.controllerAs]=c)),s.open(u,{scope:a,deferred:i,content:e[0],backdrop:t.backdrop,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,cantCloseWithBackdrop:t.cantCloseWithBackdrop,size:t.size,inDirection:t.inDirection,outDirection:t.outDirection,fullScreen:t.fullScreen,popFrom:t.popFrom,noEscape:t.noEscape})},function(e){i.reject(e)}),d.then(function(){a.resolve(!0)},function(){a.reject(!1)}),u},u}]};return e}).directive("fitInModal",function(){return{link:function(e,t,n){var r,i,a=function(n){var i,a=$(t).parents(".modal:first"),o=a.hasClass("rendered");r&&clearTimeout(r),i=function(){var t=a.find(".modal-dialog:first"),n=a.hasClass("modal-medium")?parseInt(-1===t.css("max-height").indexOf("%")?t.css("max-height"):0,10)||t.height():$(window).height();t.find(".fixed-height, .min-height, .max-height").each(function(){var e=n,r=t.find(".md-actions"),i=t.find("md-toolbar"),a="height";r.length&&(e-=r.outerHeight()),i.length&&(e-=i.outerHeight()),$(this).hasClass("min-height")&&(a="min-height"),$(this).hasClass("max-height")&&(a="max-height"),$(this).css(a,e)}),e.$broadcast("modalResize")},o?r=setTimeout(i,50):i()};i=_.throttle(a,100),$(window).bind("resize modal.open",i),e.$on("$destroy",function(){$(window).unbind("resize modal.open",i)}),e.$watch("$state.completed",function(e,t){e===!0&&e!==t&&a()})}}}).factory("modals",["$modal","$q","helpers","GLOBAL_CONFIG",function(e,t,n,r){var i={alert:function(e,t,n){return i.confirm(e,t,n,!0)},confirm:function(e,t,i,a){var o,s={message:e+" missing config, see core/config/config.js"};return angular.isFunction(t)?o={confirm:t}:angular.isObject(t)&&(o=t),angular.isDefined(i)&&(angular.isObject(i)?o=i:o.message=i),o=n.alwaysObject(o),n.extendDeep(s,o,r.modals[a?"alerts":"confirmations"][e]),s.noSecondary=a,s.confirm=function(){var e=this;return o.noAutoDismiss?o.confirm.call(e):(angular.isFunction(o.confirm)&&o.confirm.call(e),void this.dismiss().then(function(){}))},this.create(s,s.modal)},create:function(t,r){var i,a={message:""};return n.extendDeep(a,t),i={fullScreen:!1,inDirection:!1,outDirection:!1,cantCloseWithBackdrop:!0,templateUrl:"core/misc/confirm.html",controller:["$scope",function(e){var n=angular.isFunction(t)?t:t.ok||null;a.dismiss=function(){var t=e.$close();return t.then(function(){n&&n.call(e)}),t},angular.isObject(t)||(t={}),a.message&&!a.messages&&(a.messages=[a.message]),e.config=a,$.extend(e,a.scope),a.scope=void 0}]},$.extend(i,r),e.open(i)}};return r.debug&&(window._modals=i),i}]).directive("modalLoading",function(){return{templateUrl:"core/modal/loading.html"}})}(),function(){"use strict";angular.module("app").run(["modals","helpers","models","$modal","modelsMeta","snackbar",function(e,t,n,r,i,a){e.models||(e.models={}),e.models.sudo=function(e,o){var s={fullScreen:!1,popFrom:!1,inDirection:!1,outDirection:!1,templateUrl:null,cantCloseWithBackdrop:!0,controller:["$scope",function(r){var s=i.getActionArguments(e.kind,"sudo");r.args={},r.fields=s,angular.forEach(r.fields,function(t){$.extend(t.ui,{writable:!0,label:!1,attrs:{"native-placeholder":"","class":"full-width"}}),r.args[t.code_name]=e[t.code_name]}),r.fields.message.ui.placeholder="Write a message to the user!",r.fields.note.ui.placeholder="Write a note to the admins!",r.validateForm=angular.bind(r,t.form.validate),r.container={},r.config={},r.config.scroll=!0,r.config.dismiss=function(){return r.$close()},r.config.text={primary:"Ok"},r.config.confirm=function(){if(r.validateForm()){var i=n[e.kind].actions.sudo(r.args,{disableUI:!0});i.then(function(e){o.onConfirm&&o.onConfirm(e.data.entity),r.config.dismiss(),a.showK("administered")})}else t.form.wakeUp(r.container.form,!1,!0)}}]};$.extend(s,o),r.open(s)},t.models||(t.models={}),$.extend(t.models,{isEntityListEmpty:function(e,t){var n,r=!e||0===e.length;return r||(n=0,angular.forEach(e,function(e){var r=!1;t&&(r=-1!==$.inArray(e._state,t)),("deleted"===e._state||r)&&(n+=1)}),r=n===e.length),r}})}]).value("modelsInfo",{}).value("currentAccount",{}).factory("modelsMeta",["$injector","GLOBAL_CONFIG",function(e,t){var n={},r=function(e,t){angular.forEach(e,function(e,n){void 0===e.ui&&(e.ui={}),null===e.code_name&&(e.code_name=n),e._maker_=t,void 0!==e.modelclass&&r(e.modelclass,e.modelclass_kind)})};return n.friendlyActionName=function(e,t){var n,r,i=this.get(e);return void 0===i?void 0:(n=i.actions,angular.forEach(n,function(e){e.key===t&&(r=e.id)}),r)},n.getFields=function(e){if(!angular.isDefined(e))return void console.error("provided kind id is not acceptable, got: "+e);var t,n=this.get(e);return angular.isDefined(n)?(t=angular.copy(n.fields),r(t,e),t):void console.error("could not find meta info for kind "+e)},n.getDefaultActionArguments=function(e,t){var n=this.getActionArguments(e,t),r={};return angular.forEach(n.arguments,function(e){null!==e["default"]&&(r[e.code_name]=e["default"])}),r},n.getActionArguments=function(e,t){var n,i,a=this.get(e),o={};return angular.isDefined(a)?angular.isDefined(t)?(n=a.mapped_actions[t],angular.isDefined(n)?(i=angular.copy(n.arguments),r(i,e+"-"+t),i):void 0):(angular.forEach(a.mapped_actions,function(t){i=angular.copy(t.arguments),r(i,e+"-"+t.id),o[t.id]=i}),o):void 0},n.getActions=function(e){var t,n=this.get(e);return angular.isDefined(n)?(t=n.mapped_actions,angular.forEach(t,function(t){r(t.arguments,e+"-"+t.id)}),t):void 0},n.getName=function(e){var t=this.get(e);return angular.isDefined(t)?t.name:void console.error("model name not found for kind "+e)},n.get=function(t){var n,r=e.get("modelsInfo"),i=r[t],a={},o={};return void 0===i?void 0:(angular.forEach(i,function(e,t){"_actions"!==t&&"__name__"!==t&&(a[t]=e)}),angular.forEach(i._actions,function(e){o[e.id]=e}),n={actions:i._actions,mapped_actions:o,fields:a,name:i.__name__})},t.debug&&(window._modelsMeta=n),n}]).factory("ruleEngine",["modelsMeta",function(e){var t={run:function(t){var n={},r={},i=e.get(t.kind),a=t._action_permissions,o=t._field_permissions,s=i.actions,c={action:n,input:r,field:o},l=function(e){return a[s[e].id]},u=function(e){var t=l(e);return t.executable};return void 0===a?void 0:(angular.forEach(s,function(e,t){c.action[e.id]||(c.action[e.id]={}),c.action[e.id].executable=u(t),angular.forEach(e.arguments,function(t){var n=t.code_name;c.input[e.id]||(c.input[e.id]={}),c.input[e.id][n]=t})}),c)}};return t}]).factory("modelsUtil",["modelsMeta","ruleEngine","GLOBAL_CONFIG",function(e,t,n){var r={normalizeMultiple:function(e){angular.forEach(e,function(e){r.normalize(e)})},argumentsToJson:function(e,t){var n=["_field_permissions","_next_read_arguments","_read_arguments","_action_permissions","ui"];return JSON.stringify(e,function(e,t){var r,i=t;return angular.isObject(t)&&t.ui&&(r={},angular.forEach(t,function(e,t){-1===$.inArray(t,n)&&(r[t]=e)}),i=r),"string"==typeof e&&"$"===e.charAt(0)?i=void 0:t&&t.document&&t.location&&t.alert&&t.setInterval?i="$WINDOW":t&&document===t?i="$DOCUMENT":t&&t.$evalAsync&&t.$watch&&(i="$SCOPE"),i},t?"  ":null)},normalize:function(n,i,a,o,s,c){n.ui&&n.ui.normalized||(void 0===i&&(i=e.getFields(n.kind)),void 0===c&&(n.ui={},n.ui.normalized=!0,n.ui.access=[],o&&(n.ui.access.extend(a.ui.access),n.ui.access.push(o),void 0!==s&&n.ui.access.push(s)),void 0===a&&(n.ui.rule=t.run(n))),angular.forEach(i,function(e){var t=e["default"],i=n[e.code_name];"SuperDateTimeProperty"===e.type&&!t,e.repeated&&!angular.isArray(t)&&(t=[]),(void 0===i||null===i)&&null!==t&&void 0!==t&&(n[e.code_name]=t),"SuperDateTimeProperty"===e.type&&angular.isString(i)&&(n[e.code_name]=new Date(i)),e.is_structured&&(e.repeated?angular.forEach(i,function(t,i){r.normalize(t,e.modelclass,n,e.code_name,i)}):((void 0===i||null===i)&&e.required&&(i={kind:e.modelclass_kind},n[e.code_name]=i),void 0!==i&&null!==i&&r.normalize(i,e.modelclass,n,e.code_name,void 0,c)))}))}};return n.debug&&(window._modelsUtil=r),r}]).factory("modelsEditor",["$modal","endpoint","$q","helpers","modelsUtil","errorHandling","models","modelsMeta","$timeout","$filter","formInputTypes","recordBrowser","snackbar",function(e,t,n,r,i,a,o,s,c,l,u,d,p){var f={create:function(a){var f,g,m={showClose:!0,closeAfterSave:!1,action:"update",templateBodyUrl:"core/models/manage_body_default.html",scope:{},fields:[],init:angular.noop,getScope:null,defaultInit:angular.noop,defaultArgumentLoader:function(e){var t=angular.copy(e.entity),n=s.getActionArguments(e.config.kind,e.config.action),r={};return angular.forEach(n,function(e){var n=t[e.code_name];void 0===n&&null!==e["default"]&&void 0!==e["default"]&&(n=e["default"]),void 0!==n&&(r[e.code_name]=n)}),e.entity.key&&(r.key=t.key),e.entity.id&&(r.id=t.id),r.ui=t.ui,t._read_arguments&&(r.read_arguments=t._read_arguments),t._next_read_arguments&&(r._next_read_arguments=t._next_read_arguments),$.extend(r,e.withArgs),r.action_id=e.config.action,r.action_model=e.config.kind,r},argumentLoader:function(e){return this.defaultArgumentLoader(e)},defaultPrepareReadArguments:function(e){angular.isObject(e.args.read_arguments)||(e.args.read_arguments={});var t=e.args.read_arguments,n=function(e,t,n){if(angular.isArray(e)){var r=n[t];r||(r={config:{}}),r.config||(r.config={}),e&&angular.isObject(e[0])&&(r.config.keys=$.map(e,function(e){return e.key})),n[t]=r}};angular.forEach(e.args,function(e,r){n(e,r,t)})},prepareReadArguments:function(e){this.defaultPrepareReadArguments(e)}};return r.mergeDeep(a,m),!angular.isDefined(a.fields)&&angular.isDefined(a.kind)&&angular.isDefined(a.action)&&(a.fields=[],f=s.getActionArguments(a.kind,a.action),angular.forEach(f,function(e){angular.isDefined(a.excludeFields)&&-1!==$.inArray(e.code_name,a.excludeFields)||a.fields.push(e)})),a.keyedFields={},angular.forEach(a.fields,function(e){a.keyedFields[e.code_name]=e}),g={config:a,read:function(e,t,n){return void 0===t&&(t={key:e.key}),this.openPromise(function(){return o[a.kind].actions.read(t,n)},e,t)},prepare:function(e,t,n){return this.openPromise(function(){return o[a.kind].actions.prepare(t,n)},e,t)},openPromise:function(e,t,n){return this.open(t,n,e)},open:function(s,f,g){var m,h=e,v="open",y=n.defer(),_=y.promise;return m=function(e){var n,m,h="edit"+a.kind,v="add"+a.kind;e.config=a,e.container={action:t.url},e.$stateHiddenLoading=!0,e.dialog={toolbar:a.toolbar,templateBodyUrl:a.templateBodyUrl},e.entity=s,a.toolbar||(a.toolbar={}),angular.isUndefined(a.toolbar.titleEdit)&&(a.toolbar.titleEdit=h),angular.isUndefined(a.toolbar.titleAdd)&&(a.toolbar.titleAdd=v),n=function(){var t,n=e.dialog.toolbar;return e.entity.id?(angular.isDefined(n.titleEdit)&&(n.title=r.toolbar.title(n.titleEdit)),t=n.titleEdit):(angular.isDefined(n.titleAdd)&&(n.title=r.toolbar.title(n.titleAdd)),t=n.titleAdd),t},a._title_=[n],e.$watch("entity.id",n),n(),m=function(e){var t,n={},g=!1,m=function(){if(g||!e.entity.id)return!1;if(angular.isDefined(e.historyConfig)||(e.historyConfig=!1),e.historyConfig===!0)e.historyConfig={kind:a.kind,key:e.entity.key};else if(e.historyConfig===!1)return!1;g=!0;var t=e.args.ui.rule.field._records;e.historyConfig.key=e.entity.key,t&&t.visible&&e.layouts.groups.push(d.attach(e.historyConfig))};a.getScope=function(){return e},i.normalize(s),e.withArgs=f,e.args=a.argumentLoader(e),e.rootScope=e,e.formSetPristine=angular.bind(e,r.form.setPristine),e.formSetDirty=angular.bind(e,r.form.setDirty),e.validateForm=angular.bind(e,r.form.validate),e.setAction=function(t){e.args.action_id=t,a.action=t},e.save=function(t){if(!e.validateForm())return!1;a.prepareReadArguments(e);var n=o[a.kind].actions[e.args.action_id](e.args,{activitySpinner:!0,disableUI:!0});return n.then(function(n){$.extend(e.entity,n.data.entity);var r=a.argumentLoader(e);$.extend(e.args,r),m(),angular.isDefined(a.afterSave)&&a.afterSave(e),e.formSetPristine(),t||p.showK("changesSaved")},function(t){angular.isDefined(a.afterSaveError)&&a.afterSaveError(e,t)}),n},e.uploadStart=function(){e.activitySpinner.start()},e.uploadEnd=function(){e.activitySpinner.stop()},e.uploadComplete=function(t){$.extend(e.entity,t.data.entity);var n=a.argumentLoader(e);$.extend(e.args,n),m(),angular.isDefined(a.afterUploadComplete)&&a.afterUploadComplete(e),a.closeAfterSave&&c(function(){e.close()}),e.formSetPristine(),p.showK("changesSaved"),e.$$phase||e.$apply()},e.noComplete=function(){angular.isDefined(a.noComplete)&&a.noComplete(e)},e.uploadError=function(t){angular.isDefined(a.afterUploadError)&&a.afterUploadError(e,t)},e.close=angular.bind(e,r.form.leave,function(){e._close_=void 0;var t=e.$close();return a.afterClose&&a.afterClose(e),t}),e._close_=e.close,angular.forEach(a.fields,function(e){e._title_=a._title_.concat()}),angular.isDefined(a.scope)&&$.extend(e,a.scope),e.formBuilder={0:[]},angular.isDefined(e.layouts)?angular.forEach(e.layouts.groups,function(r,i){if(e.formBuilder[i]=[],angular.isDefined(r.fields))angular.forEach(r.fields,function(r){n[r]||(t=a.keyedFields[r],e.formBuilder[i].push(t),n[r]=1)});else{var o=!1;angular.forEach(a.fields,function(t){o||n[t.code_name]||(n[t.code_name]=1,t.is_structured&&(o=!0),e.formBuilder[i].push(t))})}}):(e.layouts={groups:[{label:!1}]},angular.forEach(a.fields,function(t){if(t.is_structured&&u[t.type]){t.ui.initialLabel||(t.ui.initialLabel=t.ui.label),e.layouts.groups.push({label:l("humanized")(t.ui.initialLabel||t.code_name)}),t.ui.label=!1;var n=e.layouts.groups.length-1;angular.isDefined(e.formBuilder[n])||(e.formBuilder[n]=[],e.formBuilder[n].push(t)),e.layouts.groups[0].disabled=!1}else e.formBuilder[0].push(t)})),e.$watch("dialog.toolbar.title",function(t){angular.isObject(e.historyConfig)&&(e.historyConfig.title=t)}),a.defaultInit(e),a.init(e),m(),e.$on("$destroy",function(){a.getScope=void 0}),y.resolve(e),r.fields.deferFormBuilderFields(e.formBuilder).then(function(){e.$stateHiddenLoading=!1})},angular.isFunction(g)?e.$state.promise(g,function(e,t){angular.isFunction(a.extractEntity)?$.extend(s,a.extractEntity(t)):$.extend(s,t.data.entity),m(e)}):e.$state.instant(function(){m(e)})},m.$inject=["$scope"],h[v]($.extend({templateUrl:"core/models/manage.html",controller:m},a.modalConfig)),_}}}};return f}]).factory("modelsConfig",function(){var e=[];return function(t){return t===!0?e:void e.push(t)}}).factory("models",["endpoint","modelsMeta","$injector","modelsConfig","helpers","$q","GLOBAL_CONFIG","$rootScope",function(e,t,n,r,i,a,o,s){var c={},l=function(n){var r={},a={kind:n,actions:{},getCacheKey:function(e){return this.kind+"_"+e},removeCache:function(t){return e.removeCache(this.getCacheKey(t))},getCache:function(t){return e.getCache(this.getCacheKey(t))},setCache:function(t,n){return e.setCache(this.getCacheKey(t),n)},get:function(e,t){return angular.isDefined(this.actions.search)?this.actions.search({search:{keys:[e]}},t):void console.error("get() relies on actions.search action. use actions.read() instead.")},paginate:function(e){var n=this,r={args:{search:{}},config:{}},a=t.getActionArguments(e.kind,"search"),o={loading:!1,more:null,cursor:null,firstLoad:angular.isDefined(e.firstLoad)?e.firstLoad:!0,loaded:!1,args:r.args,load:function(t){t=i.alwaysObject(t);var a;return t.runLast||!this.loading&&this.more!==!1?(r.args.search.options||(r.args.search.options={}),r.args.search.options.start_cursor=t.runLast?null:this.cursor,this.loading=!t.runLast,a=n.actions[r.action||"search"](r.args,r.config),a.error(function(n){return o.more=!1,e.error&&e.error(n),t.runLast?(t.runLast(n),n):n}).then(function(n){return i.endpoint.isResponseError(n)?(o.more=!1,e.error&&e.error(n),e.complete.call(this,n)):t.runLast?(t.runLast(n),n):(o.more=n.data.more,o.cursor=n.data.cursor,angular.isFunction(e.complete)?e.complete.call(this,n):n)})["finally"](function(e){o.loading=!1,o.firstLoad=!1,o.loaded=!0}),a):!1}};return r.args.search=a.search["default"],angular.isDefined(e.args)&&(i.merge(e.args,r.args),$.extend(r,e)),o},reader:function(e){if(!angular.isArray(e.access))return void console.error("path must be array, "+typeof e.access+" given");var t,n,r,a,o=this,s=function(e){return i.getProperty(e,t.join(".")+".config.more")},l=function(e){t=[],angular.forEach(e,function(e){isNaN(parseInt(e,10))&&t.push(e)})};return angular.isUndefined(e.next)&&(r={},a=e.args,e.next=r,angular.forEach(e.access,function(e,t){!angular.isDefined(r[e])&&isNaN(parseInt(e,10))&&(r[e]={config:{}},r=r[e]),a=a[e],angular.isUndefined(a)||null!==a.key&&angular.isDefined(a.key)&&(angular.isDefined(r.config.keys)||(r.config.keys=[]),r.config.keys.push(a.key))})),l(e.access),n={next:null,loading:!1,access:e.access,more:s(e.next),config:e,loaded:!1,firstLoad:angular.isDefined(e.firstLoad)?e.firstLoad:!0,previous:null,state:function(e){this.next=e.next,angular.isDefined(e.access)&&(this.access=e.access,l(this.access)),this.more=angular.isDefined(e.more)?e.more:s(this.next)},setNextReadArguments:function(e){this.next=e,this.more=s(this.next)},setAccess:function(e){this.access=e,l(e),this.more=s(this.next)},load:function(r){if(r=i.alwaysObject(r),angular.isUndefined(r.runLast)&&(this.more===!1||this.loading))return!1;var a,l,u,d=this,p=d.next;return p||(p=angular.copy(e.next)),this.more||(l=p,angular.forEach(t,function(e,t){angular.isUndefined(p[e])?p[e]={}:p=p[e]}),p=l),r.hideLoading||(this.loading=!0),u={key:e.key,read_arguments:p},r.runLast&&(u=n.previous||u),r.rpcOptions||(r.rpcOptions={}),a=e.read?e.read(p):(e.kind?c[e.kind]:o).actions.read(u,r.rpcOptions),n.previous=u,a["finally"](function(){n.loading=!1,n.loaded=!0,n.firstLoad=!1,r.runLastFinally&&r.runLastFinally()}),a.error(function(t){d.more=!1,e.error&&e.error(t)}),a.then(function(t){if(i.endpoint.isResponseError(t))return d.more=!1,e.error&&e.error(t),t;var n,a,o=[];return angular.forEach(d.access,function(e){isNaN(parseInt(e,10))||(e=0),o.push(e)}),n=i.getProperty(t.data.entity,o),r.runLast?(r.runLast(n),t):(angular.isFunction(e.complete)&&e.complete(n),a=t.data.entity._next_read_arguments,d.more=s(a),d.more&&(d.next=a),t)})}}}};return a.config=r,angular.forEach(t.getActions(n),function(i,o){a.actions[o]=function(i,a){var s,c=t.getDefaultActionArguments(n,o),l=angular.copy(r);return $.extend(c,i),angular.isDefined(a)&&(a.merge?$.extend(l,a):l=angular.copy(a)),s=r.cache,angular.isDefined(l)&&l.cache&&(s=l.cache),s===!0&&(s=n+"_"+o+"_"+window.btoa(angular.toJson(c))),angular.isDefined(s)&&s!==!1?(delete l.cache,e.cached(s,o,n,c,l)):e.post(o,n,c,l)}}),a};return c.initialized=!1,c.init=function(){if(c.initialized!==!0){var e,t=n.get("modelsInfo");angular.isDefined(t[0])&&(angular.forEach(t,function(e,t){c[t]=l(t)}),e=r(!0),angular.forEach(e,function(e){e(c)}),c.initialized=!0)}},o.debug&&(window._models=c),c}])}(),function(){"use strict";angular.module("app").factory("recordBrowser",["models","GLOBAL_CONFIG","$modal",function(e,t,n){return{attach:function(r){return{label:t.subheaders.history,include:"core/misc/action.html",action:function(){n.open({templateUrl:"core/models/manage.html",controller:["$scope",function(t){t.dialog={templateBodyUrl:"core/record/list.html",toolbar:{hideSave:!0,leftIcon:"arrow_back",title:r.title+" / History"}};var i={access:["_records"],key:r.key,next:{_records:{config:{more:!0,search:{orders:[{field:"logged",operator:"desc"}]}}}},complete:function(e){t.history.records.extend(e)}};$.extend(i,r.reader),t.history={records:[],reader:e[r.kind].reader(i),view:function(e){n.open({templateUrl:"core/models/manage.html",controller:["$scope",function(t){t.record=e,t.dialog={},t.dialog.templateBodyUrl="core/record/view_body.html",t.dialog.toolbar={hideSave:!0,leftIcon:"arrow_back",title:r.title+" / History / Log Entry"}}]})}},t.$state.promise(function(){return t.history.reader.load()},angular.noop)}]})}}}}}])}(),function(){"use strict";angular.module("app").directive("selectInputScrollToActive",["$timeout",function(e){return{link:function(t,n,r){t.$watch(function(){return t.$eval(r.selectInputScrollToActive)},function(t,r,i){e(function(){if(t){var e=n.parents(".fixed-height:first"),r=e.find(".list-row-is-active:first");if(!r.length)return;e.scrollTop(r.get(0).offsetTop)}},0,!1)})}}}]).directive("selectInputMultiple",["$timeout","underscoreTemplate","$q","$modal",function(e,t,n,r){return{require:["ngModel","^?form"],link:function(i,a,o,s){var c=s[0],l=s[1],u=i.$eval(o.grouping),d=i.$eval(o.items),p=i.$eval(o.view),f=i.$eval(o.listView),g=i.$eval(o.search),m=i.$eval(o.defer),h=function(){m&&m.resolve()},v=i.$eval(o.select),y=v&&v.init?v.init:null;v.getHash=function(e){return angular.isObject(e)?e.key:e},v.search=g,v.anyItems=0,v.async=!0,v.loading=!1,v.multiple=!0,v.items=[],v.find=function(e){if(null===e||void 0===e)return void h();var t,n,r=function(e){var t,n;return angular.isObject(v.items[0])?n=_.findWhere(v.items,{key:e}):(t=v.items.indexOf(e),-1!==t&&(n=v.items[t])),n};return v.multiple?(n=[],t=[],e&&e.length&&angular.forEach(e,function(e){var i=r(e);angular.isUndefined(i)?n.push(e):t.push(i)})):(t=r(e),angular.isUndefined(t)&&(n=e)),v.search&&v.search.ready?v.search.ready.then(function(){v.search.missing&&n&&n.length?v.search.missing(n).then(h,h):h()},h):h(),t},v.getActive=function(){return v.item=v.find(c.$modelValue),v.item},v.setItems=function(e){v.items=e,v.collectActive(),u&&(v.grouping=u(v.items)),v.anyItems=e.length},v.isSelected=function(e){var t=v.getHash(e);return v.multiple?-1!==$.inArray(t,c.$modelValue):c.$modelValue===t},v.remove=function(e){v.select(e)},v.anySelected=function(){var e=!0;return angular.forEach(v.multipleSelection,function(t){e||(e=t)}),e},v.multipleSelection={},v.multipleSelect=function(e,t){var n=v.getHash(e),r=t?v.multipleSelection[n]:!v.multipleSelection[n],i=c.$modelValue||[],a=-1!==$.inArray(n,c.$modelValue);v.multipleSelection[n]=r,angular.isArray(v.item)||(v.item=i),r?a||(i.push(n),v.item.push(e)):a&&(i.remove(n),v.item.remove(e)),c.$setViewValue(i),l.$setDirty(),v.close()},v.commitMultipleSelect=function(t){e(function(){v.multipleSelect(t,!0)},100)},v.collectActive=function(){angular.forEach(v.items,function(e){var t=v.getHash(e);angular.isUndefined(v.multipleSelection[t])&&-1!==$.inArray(t,c.$modelValue)&&(v.multipleSelection[t]=!0)})},v.isChecked=function(e){return v.multipleSelection[v.getHash(e)]},v.select=function(e){v.multipleSelect(e)},v.close=angular.noop,v.opened=!1,v.open=function(t){v.opened||(v.opened=!0,e(function(){v.openSimpleDialog(t)}))},v.openSimpleDialog=function(e){if(!a.attr("disabled")){v.search&&(v.search.query={});var i,o=a.parents(".modal:first").find(".modal-dialog:first");o.length||(o=a.parents("body:first")),i=t.get(v.openTemplate||"core/select/choices.html")({select:v}),r.open({template:t.get("core/select/single.html")().replace("{{content}}",i),targetEvent:e,parent:o,inDirection:!1,windowClass:"modal-medium-simple "+(v.windowClass||""),outDirection:!1,fullScreen:!1,backdrop:!0,controller:["$scope",function(e){var t=n.defer();t.resolve(),e.$state.promise(function(){return v.search&&v.search.ready?v.search.ready:t.promise},function(){e.select=v}),e.$on("$destroy",function(){v.opened=!1,v.close=angular.noop}),e.close=function(){e.$close().then(v.afterClose||angular.noop)},v.close=function(){e.close()}}]})}},p||(p=function(e){return angular.isObject(e)?e.name:e}),v.view=p,v.listView=f||p,c.$formatters.push(function(e){return v.collectActive(),v.item=v.find(e),e}),u&&(v.hasGrouping=!0,v.grouping=[]),v.setItems(d),i.$watchGroup([o.items+".length",o.items],function(t,n){(t[0]!==n[0]||t[1]!==n[1])&&(v.setItems(i.$eval(o.items)),v.getActive(),v.opened&&e(function(){$(window).triggerHandler("resize")},0,!1))}),y&&y(v,i,a,o,s)}}}]).directive("selectInput",["$simpleDialog","$$rAF","$mdConstant","underscoreTemplate","$timeout","$parse","helpers","$q","$modal",function(e,t,n,r,i,a,o,s,c){return{replace:!0,transclude:!0,require:["ngModel","^?mdInputContainer","^?form"],templateUrl:"core/select/input.html",scope:!0,link:function(o,l,u,d){var p,f=d[0],g=d[1],m=d[2],h=o.$eval(u.items),v=o.$eval(u.view),y=o.$eval(u.search),b=y&&y.init?y.init:null,w=o.$eval(u.multiple),k=o.$eval(u.async),C=o.$eval(u.grouping),S=o.$eval(u.listView),A=u.placeholder,E=o.$eval(u.defer),x={},I=function(){E&&E.resolve()},O=!1;g.input=l,p=function(e){var t=!f.$isEmpty(e);return angular.isArray(e)&&(t=0!==e.length),g.setHasValue(t),e},o.$watch(function(){return f.$invalid&&f.$touched},g.setInvalid),f.$parsers.push(p),f.$formatters.push(p),l.on("keyup",function(e){e.keyCode===n.KEY_CODE.ENTER&&x.open()}).on("click",function(e){O||x.open(),O=!1,e.preventDefault()}).on("blur",function(e){g.setFocused(!1)}),o.$on("$destroy",function(){g.setFocused(!1),g.setHasValue(!1),g.input=null}),x.getHash=function(e){return angular.isObject(e)?e.key:e},x.search=y,x.async=k,x.placeholder=A,x.loading=!1,x.multiple=w,x.items=[],x.find=function(e){if(null===e||void 0===e)return void I();var t,n,r=function(e){var t,n;return angular.isObject(x.items[0])?n=_.findWhere(x.items,{key:e}):(t=x.items.indexOf(e),-1!==t&&(n=x.items[t])),n};return x.multiple?(n=[],t=[],e&&e.length&&angular.forEach(e,function(e){var i=r(e);angular.isUndefined(i)?n.push(e):t.push(i)})):(t=r(e),angular.isUndefined(t)&&(n=e)),x.search&&x.search.ready?x.search.ready.then(function(){x.search.missing&&n&&n.length?x.search.missing(n).then(I,I):I()},I):I(),t},x.getActive=function(){return x.item=x.find(f.$modelValue),x.item},x.setItems=function(e){x.items=e,x.collectActive(),C&&(x.grouping=C(x.items))},x.isSelected=function(e){var t=x.getHash(e);return x.multiple?-1!==$.inArray(t,f.$modelValue):f.$modelValue===t},x.anyUnselected=function(){return!0},x.anySelected=function(){return!0},x.multipleSelection={},x.multipleSelect=function(e){var t=x.getHash(e),n=!x.multipleSelection[t],r=f.$modelValue||[],i=-1!==$.inArray(t,f.$modelValue);x.multipleSelection[t]=n,x.multiple||(angular.isArray(x.item)||(x.item=r),n?i||(r.push(t),x.item.push(e)):i&&(r.remove(t),x.item.remove(e)),f.$setViewValue(r),m.$setDirty(),p(r))},x.completeMultiSelection=function(){var e=[],t=[];angular.forEach(x.items,function(n){var r=x.getHash(n);x.multipleSelection[r]&&(e.push(r),t.push(n))}),f.$setViewValue(e),m.$setDirty(),p(e),x.item=t,x.close()},x.collectActive=function(){angular.forEach(x.items,function(e){var t=x.getHash(e);angular.isUndefined(x.multipleSelection[t])&&-1!==$.inArray(t,f.$modelValue)&&(x.multipleSelection[t]=!0)})},x.isChecked=function(e){return!1},x.select=function(e){var t=x.getHash(e);f.$setViewValue(t),x.item=e,x.close()},x.close=angular.noop,x.opened=!1,x.open=function(e){x.opened||(x.opened=!0,i(function(){x.openSimpleDialog(e)}))},x.openSimpleDialog=function(i){if(!l.attr("disabled")){x.search&&(x.search.query={}),x.multipleSelection={},x.collectActive();var o,u,d=l.parents(".modal:first").find(".modal-dialog:first");d.length||(d=l.parents("body:first")),o=r.get(x.openTemplate||"core/select/choices.html")({select:x}),u=o,(x.multiple||k)&&(u=r.get("core/select/single.html")().replace("{{content}}",o),i=void 0),(x.multiple||k?c.open:e.show)({template:u,popFrom:i?i.target:void 0,targetEvent:i,parent:d,inDirection:!1,windowClass:"modal-medium-simple "+(x.windowClass?x.windowClass:""),outDirection:!1,fullScreen:!1,backdrop:!0,disableScroll:[l.parents("md-content:first"),l.parents(".fixed-height:first")],onBeforeHide:function(e,t){$(window).off("resize",t.resize)},onBeforeShow:function(e,r){var i=s.defer(),o=i.promise,c=!1,u=e.find('[tabindex="2"]'),p=function(){var o=l.parents("md-input-container:first");r.resize=function(){var t,i,a,s,c,p,f,g=o.offset(),m=l.offset(),h=r.parent,v=h.offset(),y=k?24:16,$=k?24:16,_=r.parent.height(),b=e.find("md-content"),w=e.find(".list-row-is-active"),C=d.find("md-toolbar"),S=0;w.length?(i=w.offset(),p=i,c=w):(p=u.offset(),c=u),C.length&&(S=C.height()),t=v.top+y+S,f=_-($+y+S),e.width(o.width()),e.height()>_||b.prop("scrollHeight")>_||e.height()>f?e.css({top:t,left:m.left}).height(f):(e.css(m),a=w.length?m.top-i.top+w.height()/5:g.top-e.height()/2+y,a>t?(s=a+e.height(),s+24>_&&(a-=s-(_-24),t>a&&(a=t)),e.css("top",a)):e.css("top",t)),w.length&&!x.multiple&&b.scrollTop(b.scrollTop()-b.offset().top+w.offset().top),p&&e.css(n.CSS.TRANSFORMORIGIN,p.left+o.width()/2+"px "+(p.top+w.height()/2-b.scrollTop())+"px 0px")},r.resize(),$(window).on("resize",function(){setTimeout(r.resize,100)}),e.oneAnimationEnd(function(t){i.resolve(),c=e.find(".list-row-is-active:first"),c.length||(c=u),x.search?setTimeout(function(){e.find('input[type="search"]').focus()},100):c.focus(),e.addClass("opacity-in")}).on("keyup",function(t){if(c){var r=c,i=!1,o=-1;t.keyCode===n.KEY_CODE.DOWN_ARROW?(c=c.next(),i=!0):t.keyCode===n.KEY_CODE.UP_ARROW?(c=c.prev(),i=!0):t.keyCode===n.KEY_CODE.ENTER&&(c=e.find(".simple-dialog-option:focus"),c.length||(c=e.find(".list-row-is-active:first")),o=c.length?a(c.attr("item"))(c.scope()):x.items[0],o&&x.select(o)),!c.length&&i&&(c=r),i&&c.focus()}}),t(function(){e.addClass("fade in"),O=!1})};return t(p),o},controller:["$scope",function(t){var n=function(){x.close=function(){x.multiple||x.async?t.close():e.hide()},t.select=x},r=s.defer();r.resolve(),t.$state?t.$state.promise(function(){return x.search&&x.search.ready?x.search.ready:r.promise},n):n(),t.close=function(){t.$close().then(x.afterClose||angular.noop)},t.$on("$destroy",function(){x.opened=!1,g.setFocused(!1),l.focus()})}]})}},v||(v=function(e){return angular.isObject(e)?e.name:e}),x.view=v,x.listView=S||v,f.$formatters.push(function(e){return x.item=x.find(e),e}),x.isFilterMatch=function(e){if(!y)return!0;var t,n,r=x.getFindTerm(),i=x.search.query;return x.search.filterProp&&(i=i[x.search.filterProp]),!i||i.length<1?!0:(t=x.search.filterProp?e[x.search.filterProp]:e,n=-1!==t.toString().toLowerCase().indexOf(r))},x.getFindTerm=function(){return a(x.search.filterProp)(x.search.query)},C&&(x.hasGrouping=!0,x.grouping=[]),
x.setItems(h),o.$watchGroup([u.items+".length",u.items],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(x.setItems(o.$eval(u.items)),x.getActive(),x.opened&&i(function(){$(window).triggerHandler("resize")},0,!1))}),o.select=x,b&&b(x,o,l,u,d)}}}])}(),function(){"use strict";angular.module("app").directive("imageSlider",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(e,n,r){var i,a=t(r.imageSliderLoadMore),o=n.parent(".image-slider-outer:first"),s=!0,c=function(t,n){return s?(s=!1,void a(e,{callback:function(e,t){n(),s=t}})):!1},l=function(){var e=0,t=function(){return"none"!==$(this).css("display")};n.find(".image-slider-item").filter(t).each(function(){e+=$(this).width()}),n.width(Math.ceil(e)+n.find(".vertical-loader").filter(t).width())},u=function(){var t=o.parents(".fixed-height:first").height(),n=o.parents(".modal:first").find(".new-pricetag-bar");n.length&&(t-=n.outerHeight()),t&&(o.height(t),e.$broadcast("imageSliderResized",t))};u(),u=_.throttle(u,100),e.$on("modalResize",u),e.$on("reMeasureImageSlider",function(){u(),l()}),e.$on("readyImageSlider",function(){u(),l(),i=new Steady({throttle:200,scrollElement:o.get(0),handler:c}),i.addTracker("checkLeft",function(){if(a){var e,t,n=o.get(0);return n?(e=n.scrollWidth-n.clientWidth,t=e-o.scrollLeft(),300>t?!0:!1):void i.stop()}}),i.addCondition("checkLeft",!0),o.data("steady",i)}),e.$on("$destroy",function(){i&&(i.stop(),o.data("steady",void 0))})}}}]).directive("sliderImage",["$timeout","helpers","GLOBAL_CONFIG",function(e,t,n){return{restrict:"A",link:function(n,r,i){var a=n.$eval(i.sliderImage),o=function(){var e=r.parents(".modal:first").find(".new-pricetag-bar"),i=r.parents(".fixed-height:first").innerHeight()-window.SCROLLBAR_WIDTH-(e.length?e.outerHeight():0),o=i,s=Math.ceil(o*a.proportion),c=o>s?o:s,l=r.parents(".image-slider-item:first"),u=function(e,t){r.width(e).height(t),l.width(e).height(t),n.$emit("reMeasureImageSlider")},d=t.url.handleProtocol(a.serving_url)+"=s"+c,p=function(){n.$broadcast("readySingleImageSlider",l),r.off("load",p),r.css({width:"",height:""}),u(r[0].width,r[0].height)};r.on("load",p).attr("src",d),u(s,o)},s=function(){o(),n.$emit("reMeasureImageSlider")};e(function(){o(),n.$last&&n.$emit("readyImageSlider")}),n.$on("modalResize",s),n.$on("itemDelete",function(){e(s)})}}}])}(),function(){"use strict";angular.module("app").factory("social",["$modal","GLOBAL_CONFIG","helpers",function(e,t,n){var r={share:function(e,t,r,i,a){a=n.alwaysObject(a);var o=a.track;return e.share||(e.share={}),function(e){e.menu||(e.menu={},n.sideNav.setup(e.menu,"sharer"),e.menu.stateChanged=function(t,n){var r=e.menu.getTracker();t?r.openShareDrawer():r.closeShareDrawer()}),e.menu.getTracker=function(){return o},e.socials=[{name:"Facebook",key:"facebook",command:"https://www.facebook.com/sharer.php?u={u}",require:["u"]},{name:"Twitter",key:"twitter",command:"https://twitter.com/intent/tweet?text={text}&url={url}",require:["url","text"]},{name:"Pinterest",key:"pinterest",command:"https://www.pinterest.com/pin/create/button/?url={url}&media={media}&description={description}",require:["url","media","description"]},{name:"Reddit",key:"reddit",command:"https://www.reddit.com/submit?url={url}&title={title}",require:["url","title"]},{name:"Linkedin",key:"linkedin",command:"https://www.linkedin.com/shareArticle?url={url}&title={title}",require:["url","title"]},{name:"Google+",icon:"googleplus",key:"googleplus",command:"https://plus.google.com/share?url={url}",require:["url"]},{name:"Tumblr",key:"tumblr",command:"https://www.tumblr.com/share/link?url={url}&name={name}&description={description}",require:["url","name","description"]}],e.getIcon=function(e){return e.icon||e.name.toLowerCase()},e.share=function(e){var r=e.command;return angular.forEach(e.require,function(n){var i=t[e.key][n];angular.isUndefined(i)?(r=r.replace("&"+n+"={"+n+"}",""),r=r.replace("?"+n+"={"+n+"}","")):r=r.replace("{"+n+"}",encodeURIComponent(t[e.key][n]))}),n.popup.openCentered(r,"Share to "+e.name)},angular.isUndefined(i)&&(i={src:t.googleplus.url}),e.link={enabled:i,values:{url:angular.isObject(i)?i.src:i},fields:[{type:"SuperTextProperty",code_name:"url",ui:{label:!1,writable:!0,args:"share.link.values.url",parentArgs:"share.link.values",attrs:{readonly:"true",onclick:"this.select()","ng-focus":"share.track.focusShareLink()"}}}]},e.track=o,e.embed={enabled:r,values:{width:"100%",height:"100%",code:""},setCode:function(){if(!r)return"";var t=e.embed.values;return t.code='<iframe width="'+t.width+'" height="'+t.height+'" src="'+r.src+'" frameborder="0" allowfullscreen></iframe>',t.code},fields:[{type:"SuperStringProperty",code_name:"width",required:!0,ui:{writable:!0,args:"share.embed.values.width",parentArgs:"share.embed.values",attrs:{"ng-change":"share.embed.setCode()"}}},{type:"SuperStringProperty",code_name:"height",required:!0,ui:{writable:!0,args:"share.embed.values.height",parentArgs:"share.embed.values",attrs:{"ng-change":"share.embed.setCode()"}}},{type:"SuperTextProperty",code_name:"code",ui:{writable:!0,args:"share.embed.values.code",parentArgs:"share.embed.values",attrs:{readonly:"true",onclick:"this.select()","ng-focus":"share.track.focusShareEmbedCode()"}}}]},e.embed.setCode()}(e.share)}};return t.debug&&(window._social=r),r}])}(),angular.module("app").directive("uploadSubmit",["$parse",function(e){function t(e,n){e=angular.element(e);var r=e.parent();return n=n.toLowerCase(),r&&r[0].tagName.toLowerCase()===n?r:r?t(r,n):null}return{restrict:"AC",link:function(e,n,r){n.bind("click",function(e){if(e&&(e.preventDefault(),e.stopPropagation()),!n.attr("disabled")){var r=t(n,"form");r.triggerHandler("submit"),r[0].submit()}})}}}]).directive("ngUpload",["$log","$parse","$document","$rootScope","errorHandling","modelsUtil",function(e,t,n,r,i,a){function o(e){var t,r=n.find("head");return angular.forEach(r.find("meta"),function(n){n.getAttribute("name")===e&&(t=n)}),angular.element(t)}var s=1;return{require:"form",restrict:"AC",link:function(n,c,l,u){function d(e){n.$isUploading=e}function p(){w.unbind("load"),n.$$phase?d(!1):n.$apply(function(){d(!1)});var t,o=(w[0].contentDocument||w[0].contentWindow.document).body;try{t=angular.fromJson(o.innerText||o.textContent)}catch(s){t={errors:{invalid_response:t}},e.warn("Response is not valid JSON")}var c={content:{data:t}},l=t&&angular.isObject(t)&&!t.errors;b&&l&&(angular.isDefined(t.entities)?a.normalizeMultiple(t.entities):angular.isDefined(t.entity)&&a.normalize(t.entity)),l?n.$$phase?m(n,c):n.$apply(function(){m(n,c)}):n.$$phase?v(n,c):n.$apply(function(){v(n,c)}),r.disableUI(!1),l?n.$broadcast("ngUploadComplete",t):(i.snackbar(t.errors),n.$broadcast("ngUploadError",t)),n.$broadcast("ngUploadEnd"),y(n)}s++;var f=u,g={},m=l.ngUpload?t(l.ngUpload):angular.noop,h=l.ngUploadStart?t(l.ngUploadStart):angular.noop,v=l.ngUploadError?t(l.ngUploadError):angular.noop,y=l.ngUploadEnd?t(l.ngUploadEnd):angular.noop,$=l.ngUploadLoading?t(l.ngUploadLoading):null,_=n.$eval(l.ngUploadOptions)||{},b=angular.isDefined(_.normalize)?_.normalize:!0;l.hasOwnProperty("uploadOptionsConvertHidden")&&(g.convertHidden="false"!=l.uploadOptionsConvertHidden),l.hasOwnProperty("uploadOptionsEnableRailsCsrf")&&(g.enableRailsCsrf="false"!=l.uploadOptionsEnableRailsCsrf),l.hasOwnProperty("uploadOptionsBeforeSubmit")&&(g.beforeSubmit=t(l.uploadOptionsBeforeSubmit)),c.attr({target:"upload-iframe-"+s,method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});var w=({url:c.attr("action")},angular.element('<iframe name="upload-iframe-'+s+'" border="0" width="0" height="0" style="width:0px;height:0px;border:none;display:none">'));if(g.enableRailsCsrf){var k=angular.element("<input />");k.attr("class","upload-csrf-token"),k.attr("type","hidden"),k.attr("name",o("csrf-param").attr("content")),k.val(o("csrf-token").attr("content")),c.append(k)}c.after(w),d(!1),c.bind("submit",function(){return f&&f.$invalid?!1:g.beforeSubmit&&0==g.beforeSubmit(n,{})?!1:(h(n),n.$broadcast("ngUploadStart"),w.bind("load",p),g.convertHidden&&angular.forEach(c.find("input"),function(e){var t=angular.element(e);t.attr("ng-model")&&t.attr("type")&&"hidden"==t.attr("type")&&t.attr("value",n.$eval(t.attr("ng-model")))}),n.$$phase?($&&$(n),d(!0)):n.$apply(function(){$&&$(n),d(!0)}),n.$broadcast("ngUploadSubmit"),void setTimeout(function(){r.disableUI(!0)},100))})}}}]),function(){"use strict";angular.module("app").run(["helpers",function(e){e.responsive={isTouch:function(){return Modernizr.touch},isMobile:function(){return"visible"===$("#is-mobile").css("visibility")},isTablet:function(){return"visible"===$("#is-tablet").css("visibility")},isDesktop:function(){return!this.isMobile()},isLandscape:function(){return"visible"===$("#is-landscape").css("visibility")},isPortrait:function(){return!this.isLandscape()}}}])}(),function(){"use strict";var e=function(e,t){var n,r;return t.action_denied&&(n=!0,e.showK("accessDenied")),t.oauth2_error&&(r=t.oauth2_error[0],e.showK("no_email_provided"===r?"failedGettingEmail":"failed_access_token"===r?"incorrectAccessToken":"rejected_account_access"===r?"rejectedAccountAccess":"taken_by_other_account"===r?"takenByOtherAccount":"state_error"===r?"incorrectLinkSettings":"failedAuthentication"),n=!0),n};angular.module("app").constant("LOGIN_PROVIDERS",[{name:"Facebook",key:"2"},{name:"Google",icon:"googleplus",key:"1"},{name:"Linkedin",key:"3"}]).factory("mappedLoginProviders",["LOGIN_PROVIDERS",function(e){var t={};return angular.forEach(e,function(e,n){e.sequence=n,t[e.key]=e}),t}]).controller("LoginProviderConnectedController",["$scope","snackbar","currentAccount","models",function(e,t,n,r){r[11].manageModal(n,{fromRedirect:!0}).then(function(){t.showK("identityConnected")})}]).controller("AccountLoginStatusController",["$scope","$location","$state","snackbar",function(t,n,r,i){var a,o=n.search();return o.popup?void t.contentSpinner.start():void(o.success?r.go("home"):o.errors&&(a=angular.fromJson(o.errors),a&&e(i,a)))}]).controller("AccountManagementController",["$scope","currentAccount","models","modelsUtil",function(e,t,n,r){e.settings=function(){n[11].manageModal(t)},e.logout=function(){n[11].logout(t.key)}}]).filter("formatLoginProivider",["mappedLoginProviders",function(e){return function(t){var n=t.split("-"),r="";return n&&n[1]&&(r=e[n[1]].name),r}}]).run(["modelsConfig","channelApi","channelNotifications","currentAccount","$http","$state","endpoint","$window","modelsEditor","GLOBAL_CONFIG","modelsMeta","modelsUtil","$modal","helpers","modals","$q","mappedLoginProviders","LOGIN_PROVIDERS","snackbar",function(t,n,r,i,a,o,s,c,l,u,d,p,f,g,m,h,v,y,_){var b=function(e){return e.identity.split("-")[1]},w=function(e){return v[b(e)]};t(function(t){$.extend(t[11],{channel:function(){var e=this.actions.create_channel(void 0,{cache:"accountChannel",cacheType:"memory"},{activitySpinner:!0});return e.then(function(e){var t=e.data.token;return{token:t,channel:n.create(t)}})},channelNotifications:function(e){e=g.alwaysObject(e);var t=this.channel();return t.then(function(t){var n=t.token;return{token:n,channel:r.create(n,e.callback)}})},loginPopup:function(e,n,r,a,c,l){var u,d=g.popup.openCentered(e,n),p=o.href("login-status"),f=!1,m=!1,h=function(e){var n,o,h="";if(o=function(){s.removeCache(),f=!0,d.close()},l=l?function(){o()}:angular.noop,window.ENGINE.CORDOVA.ACTIVE&&(h=e.originalEvent.url),d.closed)return clearInterval(u),void(f||a());n=function(e){if(!m){if(e)return l(),c(e,o);m=!0,t[11].actions.current_account(void 0,{ignoreErrors:2}).then(function(e){var t=e.data.entity;t&&!t._is_guest&&($.extend(i,e.data.entity),l(),r(e,o))},function(e){l(),c(e,o)})["finally"](function(){m=!1})}};try{window.ENGINE.CORDOVA.ACTIVE||(h=d.document.URL),-1!==h.indexOf(p)&&(clearInterval(u),n(g.url.getQueryVariable(h,"errors")))}catch(v){v instanceof DOMException}};window.ENGINE.CORDOVA.ACTIVE?$(d).on("loadstart",h):u=window.setInterval(h,500)},adminManageModal:function(e,t){return this.manageModal(e,t)},login:function(n){n||(n=""),f.open({templateUrl:"account/login.html",inDirection:!1,windowClass:"modal-medium-simple",outDirection:!1,fullScreen:!1,backdrop:!0,controller:["$scope",function(n){n.$state.promise(function(){return a.post(o.engineHref("login",{provider:"1"}),{action_id:"login",action_model:"11",redirect_to:"popup"})},function(n,r){n.socials=y,n.getIcon=function(e){return e.icon||e.name.toLowerCase()},n.authorization_urls=r.data.authorization_urls,n.loginPopup=function(r){return t[11].loginPopup(n.authorization_urls[r.key],"Login with "+r.name,function(){_.showK("loginSuccess"),n.close()},function(){_.showK("loginCanceled")},function(t){var n=!1;t&&(n=e(_,angular.fromJson(t))),n||_.showK("loginFailed")})}})}]})},manageModal:function(n,r){r=g.alwaysObject(r);var i={kind:this.kind,templateBodyUrl:"account/manage_body.html",toolbar:{titleEdit:"account.settings",hideSave:!0},modalConfig:{popFrom:r.popFrom,inDirection:!1,outDirection:!1},extractEntity:function(e){var t=e[0].data.entity;return t._authorization_urls=e[1].data.authorization_urls,t},init:function(n){var r=n.entity,s=["state","ui.rule","created","updated"],c=function(e){angular.forEach(["args","entity"],function(t){g.update(n[t],e,s)})},l=function(){var e=angular.copy(v);n.identities=n.entity.identities.concat(),n.entity.identities.length||(n.entity._is_guest=!0),angular.forEach(n.identities,function(t){var n=b(t);e[n]&&delete e[n]}),angular.forEach(y,function(t){e[t.key]&&n.identities.push({identity:"0-"+t.key,associated:!1})}),n.identities.sort(function(e,t){return w(e).sequence-w(t).sequence})};l(),r.ui.rule.action.sudo.executable&&(i.toolbar.templateActionsUrl="account/manage_actions.html"),n.args.disassociate=[],n.maybeDisconnect=function(r){r.email&&void 0===r.associated?m.confirm("disconnectSignInMethod",function(){n.args.disassociate.push(r.identity),n.save().then(function(e){$.extend(n.entity,e.data.entity),l(),_.showK("identityDisconnected"),n.args.disassociate.empty()})}):m.confirm("connectSignInMethod",function(){var s=b(r);t[11].loginPopup(n.entity._authorization_urls[s],"Login with "+v[s].name,function(e,t){a.post(o.engineHref("login",{provider:"1"}),{action_id:"login",action_model:i.kind,redirect_to:"popup"}).then(function(r){$.extend(n.entity,e.data.entity),n.entity._authorization_urls=r.data.authorization_urls,l();var i=!1;angular.forEach(n.identities,function(e){i||void 0!==e.associated||b(e)!==s||(i=!0,_.showK("identityConnected"))}),i||_.showK("identityTaken"),t()})},function(e){_.showK("identityConnectionCanceled")},function(t,n){var r=!1;t&&(r=e(_,angular.fromJson(t))),r||_.showK("identityConnectionFailed"),n()},!1)})},n.actions.sudo=function(){m.models.sudo(r,{templateUrl:"account/administer.html",onConfirm:c})}},afterClose:function(){r.fromRedirect&&o.go("home")},scope:{historyConfig:!0,isAssociated:function(e){return-1===$.inArray(e.identity,this.args.disassociate)},setPrimary:function(e){this.container.form.$setDirty(),this.args.primary_identity=e.identity},disassociate:function(e){this.container.form.$setDirty(),this.isAssociated(e)?this.args.disassociate.push(e.identity):this.args.disassociate.remove(e.identity)},actions:{},layouts:{groups:[{label:!1},{label:u.subheaders.loginMethods}]}}};return l.create(i).openPromise(function(){return h.all([t[i.kind].actions.read({key:n.key}),a.post(o.engineHref("login",{provider:"1"}),{action_id:"login",action_model:i.kind,redirect_to:"popup"})])},n)},logout:function(e){var t=this;t.actions.logout({key:e},{disableUI:!0}).then(function(e){s.removeCache(),$.extend(i,e.data.entity),o.go("home"),_.showK("loggedOut")})}})})}])}(),function(){"use strict";angular.module("app").run(["currentAccount","helpers",function(e,t){t.location||(t.location={}),t.location.updateDefaults=function(e){}}]).controller("BuyerManagementController",["$scope","endpoint","currentAccount","models",function(e,t,n,r){e.settings=function(){r[19].manageModal(n.key,void 0,{inDirection:!1,outDirection:!1})}}]).controller("BuyOrdersController",["$scope","$timeout","modals","snackbar","modelsEditor","GLOBAL_CONFIG","modelsMeta","helpers","models","modelsUtil","$state",function(e,t,n,r,i,a,o,s,c,l,u){var d,p="buy-carts"===u.current.name||"buyer-cart-view"===u.current.name,f="buyer-cart-view"===u.current.name,g="buyer-order-view"===u.current.name,m="order-payment-canceled"===u.current.name,h="order-payment-success"===u.current.name,v=u.href(u.current.name,u.params),y=null,b=!1,w=null,k=10,C=function(){u.params.key&&(w&&t.cancel(w),w=t(function(){u.params.key&&c[34].actions.read({key:u.params.key}).then(function(e){d&&s.update(d,e.data.entity,["state","updated","payment_status","ui"]),e.data.entity.payment_status?r.showK("orderPaymentSuccessProgress"+e.data.entity.payment_status):C()},function(){k+=1,10>k&&C()})},3e4))},S={inDirection:!1,outDirection:!1,track:s.track.events.cartBuyerCarts,relativeUrl:v,afterClose:function(){var e="buy-orders";f&&(e="buy-carts"),u.go(e)}},A=function(e){d=e,m||g||f||C()},E=function(){b||(y&&clearTimeout(y),y=setTimeout(function(){var t={key:u.params.key},n=_.findWhere(e.search.results,t);return b=!0,n?e.view(n,!1,S):void c[34].manageModal(t,void 0,void 0,S).then(A)},300))};(m||h||g)&&(p=!1),S.cartModeRead=p,e.setPageToolbarTitle("buyer."+(p?"carts":"orders")),e.listHelp=p?a.emptyHelp.cartBuyerList:a.emptyHelp.orderBuyerList,e.search={results:[],loader:!1,loaded:!1,comparator:s.order.poolResultsComparator},e.$watch(function(){var t=!1;return e.search.results.iremove(function(e){var n=!e.id||"deleted"===e._state||"order"===e.state&&p;return t||(t=n),n}),t},angular.noop),e.view=function(t,n,r){c[19].current().then(function(e){return e.data.entity}).then(function(i){var a,o={cartMode:p,cartModeRead:p,events:{newOrder:function(t){e.search.results.push(t)}},popFrom:n?s.clicks.realEventTarget(n.target):!1},l=n===!1;r&&(o=r),l&&$.extend(o,r),o.relativeUrl=u.href("buyer-cart-view",{key:t.key}),o.track=o.track||s.track.events.cartBuyerCarts,a=c[34].manageModal(t,t._seller,i,o),a&&l&&a.then(A)})},c[19].current().then(function(t){var n=t.data.entity;e.search.loader=c[34].paginate({kind:"34",args:{search:{ancestor:n.key,filters:[{field:"state",operator:"IN",value:[p?"cart":"order"]}],orders:[{field:"updated",operator:"desc"}]}},config:{ignoreErrors:2},complete:function(t){var n=t.data.errors;n?n.buyer&&r.showK("noBuyer"):e.search.results.extend(t.data.entities),(m||h||f||g)&&E()}}),e.search.loader.load()})}]).directive("buyerAddressListView",function(){return{scope:{val:"=buyerAddressListView"},templateUrl:"buyer/address_list_view.html",controller:["$scope",function(e){e.notEmpty=function(e){return angular.isString(e)||angular.isNumber(e)}}]}}).run(["$window","modelsEditor","helpers","modelsMeta","$q","modelsConfig","currentAccount","endpoint",function(e,t,n,r,i,a,o,s){a(function(e){$.extend(e[19],{current:function(e){return e||(e={}),e.account=o.key,this.actions.read(e,{cache:this.getCacheKey("current"),cacheType:"memory"})},manageModalFieldsOrder:["country","region","city","postal_code","street","name"],manageModal:function(a,o,c){c||(c={});var l,u=r.getActionArguments(this.kind,"update"),d=this;$.extend(u.addresses.ui,{label:!1,specifics:{defaultArgs:n.location.updateDefaults({}),listView:"buyer-address-list-view",listConfig:{perLine:3},sortFields:d.manageModalFieldsOrder,beforeSave:function(t,n){var r,a=[],o=t.args;return!o.region||o._region&&o.region===o._region.key||(r=e[13].get(o.region,o.country),r.then(function(e){e&&(o._region=e)}),a.push(r)),!o.country||o._country&&o.country===o._country.key||(r=e[12].get(o.country),r.then(function(e){e&&(o._country=e)}),a.push(r)),a.length?i.all(a):!1}}}),l={fields:_.toArray(u),kind:this.kind,action:"update",modalConfig:c,afterSave:function(e){s.removeCache(d.getCacheKey("current")),angular.isDefined(o)&&o(e)},scope:{layouts:{groups:[{label:!1,fields:["addresses"]}]}},toolbar:{titleEdit:"buyer.viewAddresses",titleAdd:"buyer.viewAddresses"},excludeFields:["account","read_arguments"],argumentLoader:function(e){var t=this.defaultArgumentLoader(e);return t.account=a,t}},t.create(l).read({},{account:a})}})})}])}(),function(){"use strict";angular.module("app").controller("CatalogViewController",["$scope","$state","helpers","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,track:n.track.events.catalogLink,afterClose:function(){t.go("home")}})}]).controller("CatalogProductAddToCartController",["$scope","$state","helpers","models",function(e,t,n,r){var i="embed-catalog-product-add-to-cart"===t.current.name;e.site.toolbar.hidden=!0,r[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,hideClose:i,autoAddToCart:!0,noEscape:i,afterClose:i?void 0:function(){t.go("home")},track:n.track.events.catalogLink,productLink:!0,variantSignatureAsDicts:n.url.jsonFromUrlsafe(t.params.variant),autoAddToCartQuantity:t.params.quantity,loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}]).controller("CatalogProductVariantViewController",["$scope","$state","helpers","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,link:!0,productLink:!0,track:n.track.events.catalogLinkByProduct,variantSignatureAsDicts:n.url.jsonFromUrlsafe(t.params.variant),afterClose:function(){t.go("home")},loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}]).controller("CatalogProductViewController",["$scope","helpers","$state","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[31].viewModal(n.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,productLink:!0,track:t.track.events.catalogLinkByProduct,afterClose:function(){n.go("home")},loadProduct:{image:n.params.image_id,id:n.params.pricetag_id}})}]).controller("CatalogOrderViewController",["$scope","helpers","$state","models",function(e,t,n,r){var i="embed-catalog-order-view"===n.current.name;e.site.toolbar.hidden=!0,r[31].viewModal(n.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,openCart:!0,track:t.track.events.catalogLink,afterClose:function(){n.go("home")},hideClose:i,noEscape:i})}]).controller("EmbedCatalogViewController",["$scope","$state","helpers","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,noEscape:!0,hideClose:!0,track:n.track.events.catalogEmbed})}]).controller("EmbedCatalogProductViewController",["$scope","helpers","$state","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[31].viewModal(n.params.key,{popFrom:void 0,hideClose:!0,noEscape:!0,noEscapeOnProduct:!0,inDirection:!1,outDirection:!1,track:t.track.events.catalogEmbed,loadProduct:{image:n.params.image_id,id:n.params.pricetag_id}})}]).controller("EmbedCatalogProductVariantViewController",["$scope","$state","helpers","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[31].viewModal(t.params.key,{popFrom:void 0,hideClose:!0,noEscape:!0,noEscapeOnProduct:!0,inDirection:!1,outDirection:!1,track:n.track.events.catalogEmbed,variantSignatureAsDicts:n.url.jsonFromUrlsafe(t.params.variant),loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}])}(),function(){"use strict";angular.module("app").directive("trackIfProductView",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){var i;t.$watch(r.trackIfProductView,function(t,r){i||angular.isObject(t)&&e(function(){n.find('[data-pricetag-id="'+t.image+"-"+t.id+'"]').click(),i=!0},100)})}}}]).directive("catalogReady",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){function i(){e(function(){t.$eval(r.catalogReady+" = true;")},200)}n.transitionEnd(i),t.$on("$destroy",function(){n.transitionEndOff(i)})}}}]).directive("catalogNewPricetag",["$parse",function(e){return{restrict:"A",link:function(t,n,r){var i=e(r.catalogNewPricetag);n.on("click",function(e){var r=n.offset(),a=e.pageX-r.left,o=e.pageY-r.top,s=n.parents(".image-slider-item:first"),c=s.width(),l=s.height();t.$apply(function(){i(t,{config:{position_left:a,position_top:o,image_width:c,image_height:l}})})})}}}]).directive("catalogPricetagPosition",["$timeout","models",function(e,t){return{link:function(n,r,i){var a=n.$eval(i.catalogPricetagPosition),o=function(e){var n,i=$(r).parents(".image-slider-item:first"),o=i.height(),s=36;n=t[31].calculatePricetagPosition(a.position_top,a.position_left,a.image_width,a.image_height,i.width(),o),n[0]<0?n[0]=0:n[0]>o-s&&(n[0]=o-s),a._position_top=n[0],a._position_left=n[1],$(r).css({top:a._position_top,left:a._position_left,visibility:"visible"})},s=[];o=_.throttle(o,100),e(o,0,!1),n.$on("modalResize",o),n.$on("resizePricetags",function(e,t){t?t.key===a.key&&(a.position_top=t.position_top,a.position_left=t.position_left,o()):o()}),angular.forEach(["state","key","position_left","position_top","_position_left","_position_top"],function(e){s.push(i.catalogPricetagPosition+"."+e)}),n.$watch(function(){return!0},o)}}}]).directive("productInstanceCardView",["GLOBAL_CONFIG",function(e){return{scope:{val:"=productInstanceCardView"},templateUrl:"catalog/product/instance_card_view.html",link:function(e){e.showVariantLabel=function(e){return e.split(":")[0]},e.showVariantValue=function(e){var t=e.split(":");return t.slice(1,t.length).join(":")}}}}]).directive("productStockConfigurationCardView",["GLOBAL_CONFIG",function(e){return{scope:{val:"=productStockConfigurationCardView"},templateUrl:"catalog/product/stock_configuration_card_view.html",link:function(t){t.showVariantLabel=function(e){return _.keys(e)[0]},t.showVariantValue=function(e){var t=_.values(e)[0];return"***Any***"===t?"Any":t},t.showMainLabel=function(t){return e.fields.translateChoices[133].availability[t]}}}}])}(),function(){"use strict";angular.module("app").run(["modelsEditor","modelsMeta","modelsConfig","currentAccount","$modal","modals","helpers","$q","GLOBAL_CONFIG","$mdSidenav","$timeout","$state","snackbar","social",function(e,t,n,r,i,a,o,s,c,l,u,d,p,f){n(function(n){var r=function(e,t){t||(t=0);var n=e.modelclass;angular.forEach(n,function(n){if(n.ui.realPath){var i=e.ui.realPath.concat();i.push(n.code_name),n.ui.realPath=i,n.ui.initialRealPath=i,n.modelclass&&r(n,t+1)}})};$.extend(n[31],{adminManageModal:function(e,t){return this.manageModal(e,void 0,t)},manageModal:function(s,l,u){l=l||angular.noop,u=o.alwaysObject(u);var d=t.getActionArguments("31","update"),f=!angular.isDefined(s),g=function(e){e.setAction("catalog_upload_images"),e.dialog.toolbar.templateActionsUrl="catalog/manage_actions.html"},m=function(e){e.setAction("update")},h=function(e){m(e)},v={kind:this.kind,action:f?"create":"update",modalConfig:u,fields:_.toArray(d),toolbar:{templateActionsUrl:f?!1:"catalog/manage_actions.html",titleEdit:"edit31",titleAdd:"add31"},afterSave:g,afterSaveError:g,afterUploadComplete:m,afterUploadError:m,init:function(e){$.extend(d._images.ui,{label:!1,specifics:{setupSortableOptions:function(){return{stop:function(){if(d._images.ui.specifics.parentArgs.length){var e,t=d._images.ui.specifics.parentArgs[0].sequence,n=d._images.ui.directiveScope();angular.forEach(d._images.ui.specifics.parentArgs,function(n,r){r=t-r,(n.sequence!==r||"deleted"===n._state)&&(e=!0),n.sequence=r,n.ui.access[n.ui.access.length-1]=r}),e&&n.formSetDirty(),n.$broadcast("itemOrderChanged"),n.$apply()}}}}}});var t=["state","ui.rule","created","updated"],r=function(n){angular.forEach(["args","entity"],function(r){o.update(e[r],n,t)})};e.dequeueChannel=[],e.$on("$destroy",function(){angular.forEach(e.dequeueChannel,function(e){e()})}),e.$watch("entity.id",function(t){t&&l(e.entity)}),e.actions={publish:function(){a.confirm("publishCatalog",function(){n[31].actions.publish({key:e.entity.key},{activitySpinner:!0,disableUI:!0}).then(function(e){p.showK("catalogPublished"),r(e.data.entity)})})},discontinue:function(){a.confirm("discontinueCatalog",function(){n[31].actions.discontinue({key:e.entity.key},{activitySpinner:!0,disableUI:!0}).then(function(t){p.showK("catalogDiscontinued"),r(t.data.entity),e.close()})})},duplicate:function(){a.confirm("duplicateCatalog",function(){n[11].channelNotifications({callback:function(e){n[31].actions.read({key:e.catalog_key,read_arguments:{cover:{}}}).then(function(e){p.showK("catalogDuplicated"),l(e.data.entity)})}}).then(function(t){n[31].actions.catalog_duplicate({key:e.entity.key,channel:t.token},{activitySpinner:!0,disableUI:!0})})})},sudo:function(){a.models.sudo(e.entity,{templateUrl:"catalog/administer.html",onConfirm:r})}}},noComplete:h,scope:{historyConfig:!0,addProducts:function(){var e=this;i.open({templateUrl:"core/models/manage.html",windowClass:"no-overflow",controller:["$scope","$timeout",function(t,i){var s,l,u,f,g,m=angular.copy(e.args.ui.access),h=function(){return"viewProducts"};m.push(d._images.code_name),t.rootScope=e.rootScope,t.config=e.rootScope.config,t.entity=e.entity,t.args=angular.copy(e.args),t.dialog={templateBodyUrl:"catalog/manage_products.html",toolbar:{hideSave:!0}},t.dequeueChannel=[],t.$on("$destroy",function(){angular.forEach(t.dequeueChannel,function(e){e()})}),t.imagesLoaded=!1,t.container={},t.formSetPristine=angular.bind(t,o.form.setPristine),t.formSetDirty=angular.bind(t,o.form.setDirty),t.validateForm=angular.bind(t,o.form.validate),t.fieldProduct=d._images.modelclass.pricetags.modelclass._product,t.args._images=[],t.config._title_.push(h),t.$on("$destroy",function(){t.config._title_.remove(h),d._images._title_.remove(h),d._images.modelclass.pricetags._title_.remove(h),d._images.modelclass.pricetags.modelclass._product._title_.remove(h)}),d._images._title_=t.config._title_.concat(),d._images.modelclass.pricetags._title_=d._images._title_.concat(),t.fieldProduct._title_=d._images._title_.concat(),t.dialog.toolbar.title=o.toolbar.buildTitle(t.config._title_),t.trackPricetags=function(e){return e.key?e.key:"new"+_.uniqueId()},s=n[31].reader({key:t.args.key,next:{_images:{}},access:m,complete:function(e){t.args._images.extend(e),i(function(){t.imagesLoaded=!0},300)}}),u=t.fieldProduct.modelclass._instances.modelclass.variant_options,u.ui.specifics||(u.ui.specifics={}),u.ui.specifics.checkboxes=!0,u.ui.fieldset=!0,u.ui.specifics||(u.ui.specifics={}),u.ui.specifics.listView=function(e){return angular.isObject(e)?e.full:e},u.ui.specifics.grouping=function(e){var t=[],n={};return angular.forEach(e,function(e){var r=e.split(": "),i=n[r[0]];i||(i={label:r[0],items:[]},n[r[0]]=i,t.push(i)),i.items.push({name:r[1],key:e,full:e})}),t},f=function(e,n){e.pricetags.push(n);var r=_.findWhere(t.rootScope.args._images,{key:e.key});r&&r.pricetags.push(n)},g=function(e,n){angular.isDefined(n._destroy)&&n._destroy(),e.pricetags.remove(n);var r=_.findWhere(t.rootScope.args._images,{key:e.key});r&&r.pricetags.iremove(function(e){return e.key===n.key})},t.$stateHiddenLoading=!0,t.$on("modalOpened",function(){s.load()["finally"](function(){t.$stateHiddenLoading=!1,t.dialog.toolbar.hideSave=!1})}),t.onStart=function(e,n,r,i){$(n.helper).addClass("dragged"),$(n.helper).find("a").addClass("dragged"),angular.isUndefined(i._image)&&(i._image=t.args._images.indexOf(r)),t.syncStop()},t.onDrag=function(e,t,n,r){},t.droppableOptions={accept:".catalog-new-pricetag",tolerance:"pointer",cancel:"input,textarea,button,select,option,[disabled]"},t.draggableOptions={containment:".image-slider-outer",distance:6,cancel:"input,textarea,button,select,option,[disabled]"},t.newPricetagDraggableOptions={revert:function(e){if(!e)return!0;var n=t.container.form.$dirty;return n&&p.showK("saveChangesFirst"),n},distance:10,helper:"clone",stop:function(e){$(e.target).removeClass("activated")},start:function(e,t){$(e.target).addClass("activated")}},t.onStop=function(e,n,r,i){if(setTimeout(function(){$(n.helper).removeClass("dragged"),$(n.helper).find("a").removeClass("dragged")},350),"deleted"!==i._state){var a,o,s=$(e.target).parents(".image-slider-item:first"),c=$(e.target),l=parseFloat(c.css("left"),10),u=c.width(),d=s.width(),p=d-(u+l),g=t.args._images.indexOf(r),m=0,h=0;o=function(e){
var r,o,u,p,v,y=0,b=parseFloat($(n.helper).css("top"),10);for(a=s,m=e?d:0;;)if(e){if(g+=1,a=a.next(),m+=a.width(),m>l){u=a,r=t.args._images[g],v=l-(h||d);break}if(g>1e4)break;h=m}else{if(g-=1,a=a.prev(),y+=a.width(),m-=a.width(),l>m){u=a,r=t.args._images[g],v=y+l;break}if(0>g)break}r&&(i._state="deleted",c.addClass("ng-hide"),o=_.findWhere(r.pricetags,{key:i.key}),o&&(i=o),i.image_width=u.width(),i.image_height=u.height(),i.position_left=v,i.position_top=b,i._position_left=v,i._position_top=b,angular.isUndefined(o)?(p=angular.copy(i),p._state=null,p._must_save=!0,angular.isUndefined(i._image)&&(p._image=g),f(r,p)):o._state=null)},i.position_top=n.position.top,i.position_left=n.position.left,i.image_width=s.width(),i.image_height=s.height(),i._position_top=i.position_top,i._position_left=i.position_left,t.formSetDirty(),3.3>p+u?o(!0):-8.5>l&&o(),t.$$phase||t.$apply(),t.$broadcast("resizePricetags",i)}},t.onDrop=function(e,n,r){if(!t.container.form.$dirty){var a=$(e.target),o=a.offset(),s=n.offset,c=s.top-o.top+6,l=s.left-o.left+4,u=$('<div style="visibility:hidden;"></div>'),d={position_top:c,position_left:l,_image:t.args._images.indexOf(r),image_width:a.width(),image_height:a.height()};u.css({top:c,position:"absolute",left:l,width:n.draggable.width(),height:n.draggable.height()}),u.appendTo(a),d._destroy=function(){i(function(){u.remove()},2e3,!1)},t.createProduct(r,d,u)}},t.imagesReader=s,s.showLoaderAlways=!0,t.loadMoreImages=function(e){var t=s.load();t?t.then(function(t){e.call(this,t,s.more)}):e.call(this,void 0,s.more)},l=function(e,n){t.image=e,t.pricetag=n},t.loadingManageProduct=!1,t.lastManageProduct=null,t.manageProduct=function(e,n,r){var i=t.syncScheduleNext||t.syncLoading,a=t.container.form.$dirty;return i||a?void p.showK("saveChangesFirst"):t.realManageProduct(e,n,r)},t.realManageProduct=function(e,i,a){if(!t.loadingManageProduct){t.loadingManageProduct=!0,l(e,i);var o=function(){return n[31].actions.read({key:t.entity.key,read_arguments:{_images:{config:{keys:[e.key]},pricetags:{config:{keys:[i.key]},_product:{}}}}}).then(function(n){var a=n.data.entity,o=t.args._images.indexOf(e),s=a._images[0].pricetags[0]._product,c=!1,l=_.findIndex(e.pricetags,function(e){return e.key===i.key}),u=["_images",o,"pricetags",l,"_product"];return t.fieldProduct.ui.specifics.toolbar||(t.fieldProduct.ui.specifics.toolbar={}),c=t.entity.ui.rule.action.catalog_pricetag_duplicate.executable||t.entity.ui.rule.field._images.pricetags.writable,t.fieldProduct.ui.specifics.toolbar.templateActionsUrl=c?"catalog/product/manage_actions.html":void 0,i._product=s,s._stock||(s._stock={stocks:[]}),s.ui.access=u,t.fieldProduct.ui.realPath=u,r(t.fieldProduct),{arg:s,defaultArgs:void 0}})["finally"](function(){t.loadingManageProduct=!1})};t.fieldProduct.ui.specifics.manage(o,void 0,{target:$(a.target).hasClass("catalog-pricetag")?a.target:$(a.target).parents(".catalog-pricetag:first").get(0)})}},t.howToDrag=function(e){a.alert("howToDropPricetag")},t.createProduct=function(e,n,i){var a=t.args._images.indexOf(e),o={_sequence:e.pricetags.length,image_height:n.image_height,image_width:n.image_width,position_left:n.position_left,position_top:n.position_top,_position_left:n.position_left,_position_top:n.position_top,value:{},_destroy:n._destroy,_product:{_stock:{stocks:[]}},ui:{access:["_images",a,"pricetags",e.pricetags.length]}};f(e,o),l(e,o),t.fieldProduct.ui.specifics.toolbar.templateActionsUrl=!1,t.fieldProduct.ui.realPath=["_images",a,"pricetags",e.pricetags.length-1,"_product"],r(t.fieldProduct),t.fieldProduct.ui.specifics.create(void 0,o._product,{target:i})},$.extend(t.fieldProduct.ui,{init:function(e){e.config.ui.specifics.remove=function(e,n){t.pricetag._state="deleted",t.formSetDirty(),n()}},args:"pricetag._product",parentArgs:"pricetag",path:["_images","pricetags","_product"],render:!1,label:!1,specifics:{remoteAutoload:!1,modal:!0,removeConfirm:function(e,n){a.confirm("removePricetagConfirm",function(){t.pricetag._state="deleted",t.formSetDirty(),i(function(){n().then(function(){i(function(){t.save()})})})})},beforeSave:function(e){e.setAction("update");var t=_.last(e.sendRootArgs._images[0].pricetags);t.value={name:e.args.name,price:e.args.unit_price}},templateFooterUrl:"catalog/product/manage_footer.html",getRootArgs:function(){return t.args},afterClose:function(e){t.pricetag._product=null,e.args.key||g(t.image,t.pricetag)},afterSave:function(e){e.setAction("product_upload_images");var n=e.response.data.entity._images[0].pricetags[0];t.fieldProduct.ui.specifics.toolbar.templateActionsUrl="catalog/product/manage_actions.html",$.extend(t.pricetag,n)},afterUploadComplete:function(e){e.setAction("update")},noComplete:function(e){e.setAction("update")},duplicate:function(){a.confirm("duplicateCatalogPricetag",function(){n[11].channelNotifications({callback:function(e){n[31].actions.read({key:e.catalog_key,read_arguments:{_images:{config:{keys:[e.image_key]},pricetags:{config:{keys:[e.pricetag_key]}}}}}).then(function(n){var r=_.findWhere(t.args._images,{key:e.image_key});r&&angular.forEach(n.data.entity._images[0].pricetags,function(t,n){_.findWhere(r.pricetags,{key:e.pricetag_key})||r.pricetags.push(t)}),p.showK("productDuplicated")})}}).then(function(e){n[31].actions.catalog_pricetag_duplicate({key:t.entity.key,channel:e.token,read_arguments:{_images:{config:{keys:[t.image.key]},pricetags:{config:{keys:[t.pricetag.key]}}}}},{activitySpinner:!0,disableUI:!0})})})}}}),$.extend(t.fieldProduct.modelclass.images.ui,{name:"images"}),$.extend(t.fieldProduct.modelclass._instances.modelclass.images.ui,{name:"images"}),t.fieldProduct.modelclass.category.ui.specifics={search:{enabled:!0}},$.extend(t.fieldProduct.modelclass._stock.ui,{specifics:{canOpen:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args;return n.id?!0:(p.showK("saveProductFirst"),!1)}}}),$.extend(t.fieldProduct.modelclass._stock.modelclass.stocks.ui,{specifics:{cards:!0,cardView:"product-stock-configuration-card-view",init:function(e){var n,r=t.fieldProduct.ui.specifics.getScope().args.variants,i=e.formBuilder[0].pop(),a=[],o=0;e.formBuilder[0].empty(),e.variantCombination={},angular.forEach(r,function(t){if(!t.allow_custom_value){try{e.variantCombination[o]=_.values(e.args.variant_signature[o])[0]}catch(n){}var r=function(){var t=[];return angular.forEach(e.args.ui.access,function(e,n){angular.isNumber(e)||t.push("['"+e+"']")}),t.join("")}(),i={type:"SuperStringProperty",choices:function(){var e=t.options.concat(),n=[{key:"***Any***",name:"Any"}];return angular.forEach(e,function(e){n.push({key:e,name:e})}),n}(),code_name:"variant_choice_"+o,required:!0,ui:{writable:"entity.ui.rule.field"+r+".variant_signature.writable",label:t.name,help:t.description,args:"variantCombination["+o+"]",attrs:{"ng-change":"changeVariantCommit()"}}};a.push(i),e.formBuilder[0].push(i),o+=1}}),e.formBuilder[0].push(i),e.changeVariantCommit=function(){var t=0;angular.forEach(r,function(n){if(!n.allow_custom_value){var r={};r[n.name]=e.variantCombination[t],angular.isDefined(e.args.variant_signature[t])?e.args.variant_signature[t]=r:e.args.variant_signature.push(r),t+=1}})},n=e.save,e.save=function(){var t,r=JSON.stringify(e.args.variant_signature);return angular.forEach(e.parentArgs,function(e,n){JSON.stringify(e.variant_signature)===r&&(t=e)}),t&&($.extend(t,e.args),e.isNew=!1,e.liveArg=t),n()}}}}),$.extend(t.fieldProduct.modelclass._instances.ui,{label:c.subheaders.productInstances,path:["_images","pricetags"],specifics:{layoutConfig:[{label:c.fields.label[28].variant_options,fields:["variant_options"]},{label:"Details",fields:["code","description","unit_price","weight","volume"]},{fields:["images"]}],cards:!0,cardView:"product-instance-card-view",getRootArgs:function(){return t.args},beforeSave:function(e){e.setAction("update")},afterSave:function(e){e.setAction("product_instance_upload_images")},afterUploadComplete:function(e){e.setAction("update")},noComplete:function(e){e.setAction("update")},setupSortableOptions:function(){return{stop:function(){var e,n,r=t.fieldProduct.modelclass._instances,i=r.ui.directiveScope();r.ui.specifics.parentArgs.length&&(e=r.ui.specifics.parentArgs[0].sequence,angular.forEach(r.ui.specifics.parentArgs,function(t,r){r=e-r,(t.sequence!==r||"deleted"===t._state)&&(n=!0),t.sequence=r,t.ui.access[t.ui.access.length-1]=r}),n&&i.formSetDirty(),i.$broadcast("itemOrderChanged"),i.$apply())}}},canOpen:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args;return n.id?n.variants.length?!0:(p.showK("createVariantsFirst"),!1):(p.showK("saveProductFirst"),!1)},init:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args,r=t.fieldProduct.modelclass._instances.ui.specifics.getScope().args,i=[];angular.forEach(n.variants,function(e){e.allow_custom_value||angular.forEach(e.options,function(t){i.push(e.name+": "+t)})}),angular.forEach(r.variant_options,function(e){-1===$.inArray(e,i)&&i.push(e)}),u.choices=i},excludeFields:["created","sequence"]}}),$.extend(t.fieldProduct.modelclass.images.ui,{name:"images",specifics:{}}),$.extend(t.fieldProduct.modelclass.variants.ui,{specifics:{}}),t.fieldProduct.modelclass.uom.ui.specifics||(t.fieldProduct.modelclass.uom.ui.specifics={}),t.fieldProduct.modelclass.uom.ui.specifics.grouping=function(e){var t,n=[];return angular.forEach(e,function(e){t&&t.label!==e.measurement&&(t=null),t||(t={label:e.measurement,items:[]},n.push(t)),t.items.push(e)}),n},t.loadingSave=!1,t.save=function(r,i,a){if(t.loadingSave)return void p.showK("saveInProgress");var o,s=i?i.promise:void 0;return t.syncCancelDefer=i,t.loadingSave=!0,t.rootScope.config.prepareReadArguments(t),o=n[31].actions[t.args.action_id](t.args,{activitySpinner:!a,timeout:s,disableUI:!0}),o.then(function(n){if(!t.syncScheduleNext){$.extend(t.entity,n.data.entity);var i=t.rootScope.config.argumentLoader(t);$.extend(e.args,angular.copy(i)),$.extend(t.args,angular.copy(i)),t.formSetPristine()}r||p.showK("changesSaved")}),o["finally"](function(){t.loadingSave=!1}),o},t.close=angular.bind(t,o.form.leave,function(){t.$close()}),t.syncLoading=!1,t.syncID=null,t.syncScheduleNext=!1,t.syncStop=function(){clearTimeout(t.syncID)},t.syncStart=function(e){t.syncScheduleNext=!0,t.syncStop(),t.syncID=setTimeout(function(){t.sync(!1)},1e3)},t.sync=function(e){return t.syncLoading?void(t.syncScheduleNext=!0):(t.syncLoading=!0,t.syncScheduleNext=!1,void t.save(e).then(function(n){return t.syncLoading=!1,t.syncScheduleNext&&t.sync(e),n}))}}]})},layouts:{groups:[{label:!1,fields:["name"]},{label:c.subheaders.catalogImages,fields:["_images"],include:"core/misc/action.html",action:function(){var e=v.getScope();return o.form.wakeUp(e.container.form),e.container.form.$valid?void a.fields.remote(v.getScope(),d._images):void p.showK("provideProperValues")}},{label:c.subheaders.catalogProducts,include:"core/misc/action.html",fields:[],action:function(){var e=v.getScope();return e.entity.cover?void v.getScope().addProducts():void p.showK("uploadImagesFirst")}}]}}};f?n[23].current().then(function(t){e.create(v).prepare({},{seller:t.data.entity.key},{handleError:c.backendErrorHandling.sellerProfileNotFound})}):e.create(v).read(s,{key:s.key})}})})}])}(),function(){"use strict";angular.module("app").run(["modelsEditor","modelsMeta","modelsConfig","errorHandling","currentAccount","$modal","modals","helpers","$q","GLOBAL_CONFIG","$mdSidenav","$timeout","$state","snackbar","social",function(e,t,n,r,i,a,o,s,c,l,u,d,p,f,g){n(function(e){var t=[".catalog-close-button",".catalog-pricetag",".catalog-pricetag-link"];$.extend(e[31],{calculatePricetagPosition:function(e,t,n,r,i,a){var o=e/n*i,s=t/r*a;return[o,s]},previewModal:function(e,t){return t=s.alwaysObject(t),t.hideAddToCart=!0,this.viewModal(e,t)},viewProductModal:function(n,r,o,u,m){function h(e){return s.track.proxyLabelToEvents(m.track,e)}var v,y,b={_seller:{},_images:{config:{keys:[r]},pricetags:{config:{keys:[o]},_product:{_category:{}}}}},w=this,k=c.defer(),C=k.promise,S=function(){k.reject()};return m=s.alwaysObject(m),y=["$scope",function(a){a.hideAddToCart=!1,a.hideClose=m?m.hideClose:!1,k.resolve(),a.$state.promise(function(){return w.actions.read({key:n,read_arguments:b}).then(function(t){var n=t.data.entity,i=function(){var t={};return t.product=n._images[0].pricetags[0]._product,t.originalProduct=angular.copy(t.product),t.catalog=n,t.variants=[],t.variantSelection=[],t.currentVariation=[],t.urlsafeCurrentVariation=[],t.currentVariationPure=[],t.notInitialLoad=!1,angular.forEach(t.product.variants,function(e,n){var r=e.options[0];u&&(r=angular.isObject(u[n])?_.values(u[n])[0]:u[n]?e.options[u[n]]:e.options[0]),t.variants.push({name:e.name,options:e.options,option:r,description:e.description,allow_custom_value:e.allow_custom_value}),t.variantSelection.push({type:e.allow_custom_value?"SuperTextProperty":"SuperStringProperty",choices:e.allow_custom_value?null:e.options,code_name:"option_"+n,ui:{help:e.allow_custom_value?e.description:void 0,label:e.name,writable:!0,attrs:{"ng-change":"delayedChangeVariation("+(e.allow_custom_value?"true":"false")+")","ng-focus":"getTrack().focusProductCustomVariant()"},args:"variants["+n+"].option"}})}),t.changeVariationPromise=function(n,i){var a,s,l=[],u=!1;return t.currentVariation.empty(),t.urlsafeCurrentVariation.empty(),t.currentVariationPure.empty(),angular.forEach(t.variants,function(e){var n={};null===e.option&&(u=!0),n[e.name]=e.option,e.allow_custom_value?angular.isString(e.option)&&e.option.length||(e.option=""):(l.push(e.name+": "+e.option),t.currentVariationPure.push(n)),t.urlsafeCurrentVariation.push(e.allow_custom_value?null:e.options.indexOf(e.option)),t.currentVariation.push(n)}),l.length||(u=!0),u||n?(s=c.defer(),a=s.promise,s.resolve(n),a):e[31].actions.read({key:this.catalog.key,read_arguments:{_images:{config:{keys:[r]},pricetags:{config:{keys:[o]},_product:{_instances:{config:{search:{filters:[{field:"variant_options",operator:"ALL_IN",value:l}]}}}}}}}})},t}();return i.changeVariationPromise(void 0,!1).then(function(e){return{catalog:n,fakeScope:i,productResponse:e,response:t}})},S)},function(n,a){function o(){g.share(n,n.socialMeta,!1,void 0,{track:{openShareDrawer:v.openProductShareDrawer,closeShareDrawer:v.closeProductShareDrawer,focusShareLink:v.focusProductShareLink,focusShareEmbedCode:v.focusProductShareEmbedCode}})}function c(){function t(t){return n.order&&1===n.orderLineCount&&"0"===n.productManager.quantity.toString()?E():e[34].actions.update_line({buyer:t.data.entity.key,product:n.product.key,image:r,quantity:n.productManager.quantity,variant_signature:n.currentVariation},{disableUI:!0,handleError:l.backendErrorHandling.productOutOfStock})}function a(t){var r=0===t.data.entity._lines.length,i="current"+C,a=e[34].getCache(i);m.events&&m.events.addToCart&&m.events.addToCart.call(this,t,r),a?$.extend(a.data.entity,t.data.entity):e[34].setCache(i,t),n.productManager.quantity<1?(n.hasThisProduct=!1,n.productManager.quantity=1,n.disableUpdateCart=!n.isInStock,n.canAddToCart=n.isInStock,v.updateCartSuccess()):(n.hasThisProduct?v.updateCartSuccess():v.addToCartSuccess(),n.hasThisProduct=!0,n.disableUpdateCart=!0,n.canAddToCart=!0),r&&n.orderLineCount>1&&E(),n.orderLineCount=t.data.entity._lines.length,f.showK("cartUpdated")}function o(){n.hasThisProduct?v.updateCartFail():v.addToCartFail()}function c(){n.activitySpinner.stop()}if(i._is_guest)return void e[11].login(p.engineHref((m.hideCloseCatalog?"embed-":"")+"catalog-product-add-to-cart",{key:n.catalog.key,image_id:n.catalog._images[0].id,pricetag_id:n.catalog._images[0].pricetags[0].id,variant:s.url.jsonToUrlsafe(n.currentVariation),quantity:n.productManager.quantity}));if(m.autoAddToCart&&(n.productManager.quantity=m.autoAddToCartQuantity),!n.isInStock&&n.productManager.quantity>0)return void f.showK("productOutOfStock");if(!n.hasThisProduct&&n.productManager.quantity<1){n.container.form.$setDirty();var u=n.container.form.productQuantity;return u.$setViewValue(void 0!==u.$viewValue?u.$viewValue:""),u.$setDirty(),void u.$setValidity("required",!1)}n.activitySpinner.start(),e[19].current().then(t).then(a,o)["finally"](c)}function u(){var e=n.$close();return e.then(function(){v.closeProduct(),m.afterClose&&m.afterClose()}),e}function y(e,t){S()}function b(e){e?v.openProductDrawer():v.closeProductDrawer(),S(),o(),n.$apply()}var w,C,S,A,E,x,I=a.fakeScope,O=a.productResponse;n.variantMenu={},n.productMenu={},n.productManager={},s.sideNav.setup(n.productMenu,"right_product_sidenav",t),s.sideNav.setup(n.variantMenu,"right_variantMenu_sidenav",t),$.extend(n,I),S=function(){if(!n.product)return void(n.socialMeta={});var e=(m.hideCloseCatalog?"embed-":"")+"catalog-product-"+(n.currentVariation.length?"variant-":"")+"view",t=function(t){return p.engineHref(e,{key:n.catalog.key,image_id:n.catalog._images[0].id,pricetag_id:n.catalog._images[0].pricetags[0].id,variant:s.url.jsonToUrlsafe(n.urlsafeCurrentVariation)},{absolute:t})},r=t(!0),i=function(e){return n.product.images&&n.product.images.length?s.url.handleProtocol(n.product.images[0].serving_url+"=s"+(e||"600")):void 0};x=t(!1),n.socialMeta={facebook:{u:r},twitter:{url:r,text:"Product - "+n.product.name},pinterest:{url:r,media:i(600),description:"Share on pinterest"},googleplus:{url:r},reddit:{url:r,title:n.product.name},linkedin:{url:r,title:n.product.name},tumblr:{url:r,name:n.product.name}},v=h(x)},S(),E=function(){return e[34].actions["delete"]({key:n.order.key},{disableUI:!0}).then(function(t){var r="current"+C,i=e[34].getCache(r);return i?$.extend(i.data.entity,t.data.entity):e[34].setCache(r,t),n.order=void 0,n.orderLineCount=0,m.orderKey=void 0,t})},o(),n.variantChooser={},n.displayShare=function(){o(),n.share.menu.open()},n.setupVariantChooser=function(e,t){e.indice=t,n.variantChooser=e,n.variantMenu.open()},n.completeVariantChooser=function(e){n.variantChooser.option=e,n.variantMenu.close(),n.changeVariation(),v.changeProductVariantOption()},n.resetVariation=function(){n.resetVariantProduct(),n.variationApplied=!1,angular.forEach(n.variants,function(e){e.option=null})},n.resetVariantProduct=function(){$.extend(n.product,n.originalProduct),n.productInstance=null},n.variationApplied=!1,n.canAddToCart=!0,n.hasThisProduct=!1,n.disableUpdateCart=!1,n.productManager.quantity=0,n.isInStock=!1,n.quantityIncrement=!1,n.stockText="",C=m.sellerKey||n.catalog._seller.key,n.cartProductQuantity=function(){n.productManager.quantity=0,n.hasThisProduct=!1,n.disableUpdateCart=!1,n.orderLineCount=0,i._is_guest?(n.productManager.quantity=1,n.isInStock=n.getAvailability(!0),n.stockText=n.getAvailability(),n.quantityIncrement=n.isInStock):e[34].current(C).then(function(e){var t=e.data.entity;n.order=t,t.id?(n.orderLineCount=t._lines.length,angular.forEach(t._lines,function(e,t){e.product._reference.parent.id===n.product.parent.id&&e.product._reference.id===n.product.id&&angular.toJson(n.currentVariation)===angular.toJson(e.product.variant_signature)&&(n.productManager.quantity=parseInt(e.product.quantity,10),n.productManager.quantity>0&&(n.hasThisProduct=!0,n.disableUpdateCart=!0))}),n.canAddToCart=t.ui.rule.action.update_line.executable):n.canAddToCart=!0,n.isInStock=n.getAvailability(!0),n.stockText=n.getAvailability(),n.quantityIncrement=n.isInStock,n.canAddToCart&&!n.hasThisProduct&&(n.canAddToCart=n.isInStock),n.hasThisProduct||n.canAddToCart||(n.disableUpdateCart=!0),n.productManager.quantity||(n.productManager.quantity=1)})},w=function(e){if(e===!0)return e;var t,r,i=["images","code","unit_price","weight","volume","description"];try{t=e.data.entity._images[0].pricetags[0]._product}catch(a){}t&&(r=t._instances[0]),n.resetVariantProduct(),r&&(n.productInstance=r,angular.forEach(i,function(e){var t=r[e];null!==t&&t.length&&void 0!==t&&(n.product[e]=t)})),n.variationApplied=!0},n.getTrack=function(){return v},n.delayedChangeVariation=function(e){A&&d.cancel(A),A=d(function(){A=null,n.changeVariation(e),v.changeProductVariantOption()},500,!1)},n.changeVariation=function(e){n.changeVariationPromise(e).then(w).then(n.cartProductQuantity)},w(O),n.$watch(function(){return i._is_guest},function(e,t){n.cartProductQuantity()}),n.spotQuantity=function(){n.hasThisProduct&&!n.isInStock?n.disableUpdateCart=n.productManager.quantity>0?!0:!1:n.canAddToCart||(n.disableUpdateCart=!0),v.changeProductQuantity()},n.increaseQuantity=function(){n.disableUpdateCart=!1,n.productManager.quantity=parseInt(n.productManager.quantity,10)+1,n.spotQuantity()},n.decreaseQuantity=function(){0!==parseInt(n.productManager.quantity,10)&&(n.disableUpdateCart=!1,n.productManager.quantity=parseInt(n.productManager.quantity,10)-1,n.spotQuantity())},n.changedQuantity=function(){n.disableUpdateCart=!1,n.spotQuantity()},n.getAvailability=function(e){var t,r=n.product._stock,i="in stock",a=JSON.stringify(n.currentVariationPure);return r&&r.stocks.length?(angular.forEach(r.stocks,function(e){var r=!1;r=n.currentVariationPure.length?a===JSON.stringify(e.variant_signature):!e.variant_signature.length,!t&&r&&(i=e.availability,t=!0)}),t||angular.forEach(r.stocks,function(e){if(!t){var r=[];angular.forEach(n.currentVariationPure,function(n,i){if(!t){var a,o,s;try{o=e.variant_signature[i],a=JSON.stringify(o),n=JSON.stringify(n),s=n===a||"***Any***"===_.values(o)[0]}catch(c){return}r.push(s?!0:!1)}}),_.without(r,!0).length||(i=e.availability,t=!0)}}),e?"out of stock"!==i:l.fields.translateChoices[133].availability[i]):l.fields.translateChoices[133].availability[i]},n.addToCart=c,m.autoAddToCart&&d(function(){n.addToCart(),m.autoAddToCart=!1}),n.close=u,n.notInitialLoad=!0,n.$watch("product.id",y),k.resolve(),v.openProduct(),n.productMenu.stateChanged=b},S)}],a.open({templateUrl:"catalog/product/view.html",windowClass:"no-overflow",popFrom:m.popFrom,noEscape:m.noEscape,controller:y}).opened["catch"](S),C},viewModal:function(n,o){var c,l,u,m=this;u=["$scope",function(a){a.hideClose=o.hideClose,a.$state.promise(function(){return m.actions.read({key:n,read_arguments:{_seller:{},_images:{pricetags:{}}}},{ignoreErrors:2})},function(n,a){if(n.close=function(){var e=n.$close();return e.then(function(){o.afterClose&&o.afterClose(),c&&c.closeCatalog()}),e},a){var u=a.data.errors;if(u)return void(u.not_found||u.malformed_key?n.notFound=!0:(n.close(),r.snackbar(u)))}var h=a.data.entity;if(!h._images.length)return void(n.noImages=!0);n.catalogMenu={},s.sideNav.setup(n.catalogMenu,"right_catalog_sidenav",t),n.catalog=h,n.catalog.action_model="31",n.logoImageConfig={size:560};var v,y,b,w=function(e){return p.engineHref("catalog-view",{key:n.catalog.key},{absolute:e})},k=w(!1),C=w(!0),S=p.engineHref("embed-catalog-view",{key:n.catalog.key},{absolute:!0});y=angular.copy(n.catalog.ui.access),y.push("_images"),v=e[31].reader({firstLoad:!1,key:n.catalog.key,next:{_images:n.catalog._next_read_arguments._images},access:y,complete:function(e){n.catalog._images.extend(e),c.loadMoreCatalogImages()}}),v.showLoaderAlways=!0,c=s.track.proxyLabelToEvents(o.track||s.track.noop.catalogHome,k),l=s.track.proxyLabelToEvents(c.seller,k),n.imagesReader=v,n.socialMeta={facebook:{u:C},twitter:{url:C,text:"Catalog - "+n.catalog.name},pinterest:{url:C,media:s.url.handleProtocol(n.catalog._images[0].serving_url+"=s600"),description:"Share on pinterest"},googleplus:{url:C},reddit:{url:C,title:n.catalog.name},linkedin:{url:C,title:n.catalog.name},tumblr:{url:C,name:n.catalog.name}},g.share(n,n.socialMeta,{src:S},void 0,{track:{openShareDrawer:c.openCatalogShareDrawer,closeShareDrawer:c.closeCatalogShareDrawer,focusShareLink:c.focusCatalogShareLink,focusShareEmbedCode:c.focusCatalogShareEmbedCode}}),n.displayShare=function(){n.share.menu.open()},n.loadMoreImages=function(e){var t=v.load();t?t.then(function(){e.call(this,a,v.more)}):e.call(this,void 0,v.more)},n.displayCart=function(){var t=function(e){return p[e]((o.hideClose?"embed-":"")+"catalog-order-view",{key:n.catalog.key})},r=t("engineHref");return i._is_guest?void e[11].login(r):void e[19].current().then(function(r){e[34].manageModal(void 0,n.catalog._seller,r.data.entity,{cartMode:!0,cartModeRead:!0,relativeUrl:t("href"),track:c.cart})})},o.openCart&&d(function(){n.displayCart()}),n.loadingProduct=!1,n.viewProduct=function(e,t,r){var i=r.target,a=(o.productLink,$(i).parents(".catalog-pricetag:first"));a.length&&(i=a.get(0)),o.productLink=!1,n.loadingProduct=!0,m.viewProductModal(n.catalog.key,e.key,t.key,o.variantSignatureAsDicts,{popFrom:i,hideClose:o.hideCloseOnProduct,hideCloseCatalog:o.hideClose,noEscapeCatalog:o.noEscape,noEscape:o.noEscapeOnProduct,autoAddToCart:o.variantSignatureAsDicts&&o.autoAddToCart?!0:!1,autoAddToCartQuantity:o.autoAddToCartQuantity,afterClose:o.afterCloseProduct,track:c.product})["finally"](function(){n.loadingProduct=!1}),o.variantSignatureAsDicts=null},n.openSellerDetails=function(){n.sellerDetails.menu.open()},n.maybeLoadProduct=null,o.loadProduct&&(b=function(){var e=[];if(angular.forEach(n.catalog._images,function(t){t.id.toString()===o.loadProduct.image.toString()&&(n.maybeLoadProduct=o.loadProduct,e=t.pricetags)}),n.maybeLoadProduct)_.findWhere(e,{id:o.loadProduct.id})||f.showK("catalogProductNotFound");else{var t=v.load();t&&t.then(b)}})(),c.openCatalog(),n.sellerDetails=e[23].makeSellerDetails(n.catalog._seller),n.sellerDetails.getTrack=function(){return l}})}],a.open({templateUrl:"catalog/view.html",windowClass:"no-overflow",popFrom:o.popFrom,inDirection:o.inDirection,outDirection:o.outDirection,noEscape:o.noEscape,controller:u})}})})}])}(),function(){"use strict";angular.module("app").controller("RootController",["$scope","$mdSidenav","$timeout",function(e,t,n){}]).directive("closeMasterMenu",["$mdSidenav","$timeout","$parse",function(e,t,n){return{link:function(e,t,r){var i=n(r.closeMasterMenu);t.on("click",function(t){e.site.toolbar.menu.close().then(function(){i&&(e.$$phase?i(e,{$event:t}):e.$apply(function(){i(e,{$event:t})}))})})}}}]).directive("toolbarPaddingControl",["$timeout",function(e){return{restrict:"A",controller:["$scope","$element",function(e,t){var n=this;n.recalculate=function(){var e=t.find(".md-toolbar-item.md-breadcrumb"),n=0,r=t.find(".md-toolbar-item.md-tools.actions-right");r.length&&(n=r.outerWidth()),n||(n=16),e.css("padding-right",n)}}],link:function(t,n,r,i){e(i.recalculate,0,!1)}}}]).directive("toolbarPaddingControlElement",["$timeout",function(e){return{restrict:"A",require:"^toolbarPaddingControl",link:function(t,n,r,i){e(i.recalculate,0,!1),t.$on("$destroy",function(){e(i.recalculate,100,!1)})}}}]).directive("homeSplash",["$animateCss",function(e){return{restrict:"A",link:function(t,n,r){n.addClass("fade"),e(n,{addClass:"out"}).start().done(function(){n.addClass("ng-hide")})}}}]).controller("LoginLinksController",["$scope","models",function(e,t){e.login=function(){t[11].login()}}]).run(["$rootScope","GLOBAL_CONFIG","currentAccount","helpers",function(e,t,n,r){e.site={title:"",toolbar:{hideRight:!0,hideLeft:!1,title:"",menu:{}}},e.contentSpinner={hide:[],show:[],requests:0,last:null,stop:function(){if(this.requests-=1,this.hide){var e=this.hide.length-1;angular.forEach(this.hide,function(t,n){n===e?t():t(!0)})}},start:function(){this.requests+=1;var e=this.hide.length-1;angular.forEach(this.hide,function(t,n){n!==e&&t()}),this.show&&(_.last(this.show)||angular.noop)()}},e.activitySpinner=angular.copy(e.contentSpinner),e.currentAccount=n,e.GLOBAL_CONFIG=t,e.JSON=JSON,e.helpers=r,e.setPageTitle=function(t,n){e.site.title=r.toolbar.title(t),n||(e.site.toolbar.title=e.site.title)},e.setPageToolbarTitle=function(t,n){e.site.toolbar.title=r.toolbar.title(t),n||(e.site.title=e.site.toolbar.title)},e.$on("$stateChangeStart",function(){e.site.toolbar.hideRight=!0,e.site.toolbar.actionRight=void 0,e.site.toolbar.hidden=!1}),r.sideNav.setup(e.site.toolbar.menu,"left")}]).controller("AboutController",["$scope","helpers",function(e,t){e.socials=[{name:"Facebook",key:"facebook",command:"https://www.facebook.com/themiraclestyle/"}],e.share=function(e){return e.command},e.getIcon=function(e){return e.icon||e.name.toLowerCase()},e.setPageToolbarTitle("about")}]).factory("guide",["GLOBAL_CONFIG","$modal","models","errorHandling","$state","helpers",function(e,t,n,r,i,a){function o(o){o=a.alwaysObject(o);var s,c=e.guideKey;s=["$scope",function(e){e.$state.promise(function(){return n[31].actions.read({key:c,read_arguments:{_seller:{},_images:{config:{search:{options:{limit:5e4}}}}}},{ignoreErrors:2})},function(e,t){var n,a;return t&&(n=t.data.errors)?void(n.not_found||n.malformed_key?(e.close(),i.go("home"),e.notFound=!0):(e.close(),r.snackbar(n))):(a=t.data.entity,a._images.length?(e.close=function(){o.homepage?$.cookie("sawguide",1,{expires:30}):i.go("home"),e.$close()},void(e.catalog=a)):void(e.noImages=!0))})}],t.open({templateUrl:"home/guide.html",windowClass:"no-overflow",controller:s,inDirection:!1,outDirection:!1})}return{open:o}}]).controller("QuickGuideController",["$scope","guide","$timeout",function(e,t,n){e.site.toolbar.hidden=!0,n(function(){t.open()},300)}]).controller("HomePageController",["$scope","currentAccount","guide","$timeout","models","modals","$state","$stateParams","helpers","$q","modelsMeta",function(e,t,n,r,i,a,o,s,c,l,u){var d={search:{filters:[{field:"state",operator:"IN",value:["indexed"]}],orders:[{field:"published_date",operator:"desc"}]}},p=l.defer(),f=p.promise;e.setPageToolbarTitle("home"),e.sellerDetails=!1,e.viewProfile=function(e,t){i[23].viewProfileModal(e,{popFrom:t.target})},e.view=function(e,t){i[31].viewModal(e,{popFrom:c.clicks.realEventTarget(t.target),track:c.track.events.catalogHome})},s.key&&(e.sellerMode=!0,e.setPageToolbarTitle("sellerProfile"),d.search.filters=[{field:"seller_account_key",operator:"IN",value:s.key}],i[23].actions.read({account:s.key,read_arguments:{_content:{}}}).then(function(t){e.sellerDetails=i[23].makeSellerDetails(t.data.entity)}),e.site.toolbar.hideRight=!1,e.site.toolbar.actionRight=function(){e.sellerDetails.menu.open()}),p.resolve(),e.search={results:[],loader:i[31].paginate({kind:"31",args:d,config:{normalizeEntity:!1},action:"search",complete:function(t){var n=t.data.entities;e.search.results.extend(n)}})},f.then(function(){e.search.loader.load()}),!$.cookie("sawguide")&&t._is_guest&&r(function(){n.open({homepage:!0})},300)}])}(),function(){"use strict";angular.module("app").run(["modelsConfig","helpers","modelsMeta",function(e,t,n){e(function(e){e[12].config.cache=!0,e[12].all=function(e){return e=t.alwaysObject(e),$.extend(e,{cache:"all_countries",cacheType:"local"}),this.actions.search({orders:[{operator:"asc",field:"name"}],filters:[{operator:"==",field:"active",value:!0}]},e)},e[12].get=function(e,t){return this.all(t).then(function(t){return _.findWhere(t.data.entities,{key:e})})};var n=e[13].get;e[13].all=function(e,n){return n=t.alwaysObject(n),$.extend(n,{cache:e+"_all_regions",cacheType:"local"}),this.actions.search({search:{ancestor:e,filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}},n)},e[13].get=function(e,t,r){return t?this.all(t,r).then(function(t){return _.findWhere(t.data.entities,{key:e})}):n.apply(this,arguments)}})}])}(),function(){"use strict";angular.module("app").run(["helpers",function(e){e.order||(e.order={}),e.order.poolResultsComparator=function(e,t,n){var r=!1,i=!1;!e.updated&&t.updated&&(r=!0),e.updated&&t.updated&&e.updated.getTime()!==t.updated.getTime()&&(r=!0),r?n(e.key,"updated",t.updated):n(e.key,"updated",null,!0),e._tracker!==t._tracker&&(e._tracker&&t._tracker&&(e._tracker.buyer!==t._tracker.buyer||t._tracker.seller!==e._tracker.seller)&&(n(e.key,"_tracker",t._tracker),i=!0),(e._tracker&&!t._tracker||!e._tracker&&t._tracker)&&(n(e.key,"_tracker",t._tracker),i=!0),i||n(e.key,"_tracker",null,!0))}}]).directive("alwaysScrollToBottom",["$timeout",function(e){return{link:function(t,n,r){var i=function(){n.scrollTop(n[0].scrollHeight)};t.$watchGroup(t.$eval(r.alwaysScrollToBottom),function(t,n){JSON.stringify(t)!==JSON.stringify(n)&&e(i,300,0)})}}}]).directive("validateCardNumber",function(){
return{require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){var t=window.Stripe.card.validateCardNumber(e);return r.$setValidity("invalid_card_number",t),t?e:void 0}),r.$formatters.unshift(function(e){var t=window.Stripe.card.validateCardNumber(e);return r.$setValidity("invalid_card_number",t),e})}}}).directive("validateCvc",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){var t=window.Stripe.card.validateCVC(e);return r.$setValidity("invalid_card_cvc",t),t?e:void 0}),r.$formatters.unshift(function(e){var t=window.Stripe.card.validateCVC(e);return r.$setValidity("invalid_card_cvc",t),e})}}}).directive("validateCardDate",function(){return{require:"^validateCardDate",controller:function(){this.models={}},link:function(e,t,n,r){var i=r.models;e.$watchGroup([n.year,n.month],function(e,t){var n=window.Stripe.card.validateExpiry(r.models.month.$modelValue,r.models.year.$modelValue);angular.forEach(i,function(e,t){e.$setValidity("invalid_card_date",n)})})}}}).directive("validateCardDateItem",function(){return{require:["^validateCardDate","ngModel"],link:function(e,t,n,r){var i=r[1],a=r[0];a.models[n.validateCardDateItem]=i,e.$on("$destroy",function(){delete a.models[n.validateCardDateItem]})}}}).directive("orderWentUp",["$timeout",function(e){return{link:function(e,t,n){var r=function(){t.hasClass("in")&&e.$eval(n.orderWentUp)};t.transitionEnd(r),e.$on("$destroy",function(){t.transitionEndOff(r)})}}}]).filter("displayTaxes",function(){return function(e){var t="";return e&&(t=$.map(e,function(e){return e.name}).join(", ")),t}}).run(["modelsMeta","modelsConfig","$sce","GLOBAL_CONFIG","$modal","modals","snackbar","$state","helpers","endpoint","$q","$filter","currentAccount","$mdSidenav","$timeout",function(e,t,n,r,i,a,o,s,c,l,u,d,p,f,g){function m(t){var n={current:function(e,n){var r=this;return t[19].current().then(function(t){var i=t.data.entity;return r.actions.view_order({buyer:i.key,seller:e},$.extend({cache:r.getCacheKey("current"+e),cacheType:"memory"},n))})},adminManageModal:function(e,t){return t=c.alwaysObject(t),this.manageModal(e,e._seller,void 0,$.extend({sellerMode:!0},t))},manageModal:function(n,s,l,d){d=c.alwaysObject(d),d.events=c.alwaysObject(d.events);var m,h,v,y,b=this,w=d.cartMode,k=d.cartModeRead,C=d.sellerMode,S=u.defer(),A=S.promise;return m=w?{buyer:l.key,seller:s.key,read_arguments:{_seller:{_content:{}},_messages:{_agent:{}}}}:{key:n.key,read_arguments:{_lines:{config:{limit:0}},_seller:{_content:{}},_messages:{_agent:{}}}},v=["$scope",function(l){l.dialog={toolbar:{title:n&&n.state&&"cart"!==n.state||!k?"Order":"Cart",templateRight:"order/toolbar_actions.html"}},l.$state.promise(function(){return t[34].actions[w?"view_order":"read"](m,{ignoreErrors:2})},function(l,u){if(l.messages={toggle:function(e){o.showK("messangerDisabledWhenEmpty")}},l.close=function(e){if(e!==!0&&l.messages&&l.messages.logMessages&&l.messages.logMessages.length)return void a.confirm("discard",function(){l.close(!0)});var t=l.$close();return t.then(d.afterClose||angular.noop),y&&y.closeCart(),t},u){var m=u.data.errors;if(m&&(m.not_found||m.malformed_key))return void(l.notFound=k===!0?1:2)}u.data.entity._seller&&(s=u.data.entity._seller);var h={customPlaceholder:null,spawnAddress:null,updateLiveEntity:function(e,t){t=c.alwaysObject(t);var n=l.order._messages,r=l.order._lines;$.extend(l.order,e.data.entity),t.deleted?(r=[],l.order._messages=[]):l.order._messages=n,t.noLines&&(l.order._lines=r),e.data.line_deleted_out_of_stock&&e.data.line_deleted_out_of_stock.length&&(angular.forEach(l.order._lines.concat(),function(t,n){-1!==$.inArray(t.key,e.data.line_deleted_out_of_stock)&&l.order._lines.remove(t)}),o.showK("outOfStockLinesRemoved")),r=null},reactOnStateChange:function(e){c.update(l.order,e.data.entity,["state","ui"]),h.reactOnUpdate()},reactOnUpdate:function(){n&&$.extend(n,l.order),b.removeCache("current"+s.key)},logMessageAction:e.getActionArguments("34","log_message"),orderUpdateFields:e.getActionArguments("34","update"),billingAddressFields:[],shippingAddressFields:[],sorter:function(e,n){var r=t[19].manageModalFieldsOrder.indexOf(e.code_name),i=t[19].manageModalFieldsOrder.indexOf(n.code_name);return-1===r&&(r=99999),r-i}};angular.forEach(h.orderUpdateFields.shipping_address.modelclass,function(e){$.extend(e.ui,{args:"addresses.shipping."+e.code_name,parentArgs:"addresses.shipping",writable:!0,writableCompiled:"true",name:"supplier_"+e.code_name}),h.shippingAddressFields.push(e)}),angular.forEach(h.orderUpdateFields.billing_address.modelclass,function(e){$.extend(e.ui,{args:"addresses.billing."+e.code_name,parentArgs:"addresses.billing",writable:!0,writableCompiled:"true",name:"supplier_"+e.code_name}),e.required=e.required?"!addresses.sameAsShipping":!1,h.billingAddressFields.push(e)}),h.billingAddressFields.sort(h.sorter),h.shippingAddressFields.sort(h.sorter),$.extend(h.logMessageAction.message.ui,{label:!1,args:"messages.draft.message",parentArgs:"messages.draft",writable:"order.ui.rule.action.log_message.executable || !order.id",placeholder:"Type a message here",attrs:{"native-placeholder":"","class":"primary","min-length":"1","on-enter":"messages.logMessage()"}}),l.dialog={toolbar:{templateRight:"order/toolbar_actions.html"}},l.$watch("order.state",function(e,t){var n="Cart";"order"===e&&(n="Order"),l.dialog.toolbar.title=n}),l.today=new Date,l.writable=!0,l.stage={checkout:null,time:500,animating:0,finishedAnimating:1,isAnimating:function(e){return l.stage.finishedAnimating===e},endAnimation:function(e){g(function(){l.stage.finishedAnimating=e,l.stage.animating=-1},l.stage.time)},current:1,out:[],canShowPay:function(){return null===l.order.payment_status&&l.order.parent.parent.key===p.key},isOut:function(e){return-1!==$.inArray(e,l.stage.out)},toCheckout:function(){l.stage.animating=2,l.stage.out.push(1),l.stage.current=2,c.fields.deferFormBuilderFields({0:_.toArray(h.orderUpdateFields.shipping_address.modelclass),1:_.toArray(h.orderUpdateFields.billing_address.modelclass)}).then(function(){l.addresses.finalizeFields=!0}),y.proceedToCheckoutSuccess()},toDeliveryMethod:function(){var e=l.addresses.form.shipping.$valid,t={shipping_address:l.addresses.shipping};l.addresses.sameAsShipping?t.billing_address=l.addresses.shipping:(e=e&&l.addresses.form.billing.$valid,t.billing_address=l.addresses.billing),e?l.cmd.order.update(t,{disableUI:!0}).then(function(e){return c.endpoint.isResponseError(e)?void y.selectShippingMethodFail():(l.stage.animating=3,l.stage.out.push(2),l.stage.current=3,void y.selectShippingMethodSuccess())},function(){y.selectShippingMethodFail()}):(c.form.wakeUp(l.addresses.form.shipping),l.addresses.sameAsShipping||c.form.wakeUp(l.addresses.form.billing),y.selectShippingMethodFail(),o.showK("actionFailedCheckForm"))},toReviewOrder:function(){l.carrier.form.$valid?l.cmd.order.update({carrier:l.carrier.selected},{disableUI:!0}).then(function(){l.stage.animating=4,l.stage.out.push(3),l.stage.current=4,y.reviewCartSuccess()},function(){y.reviewCartFail()}):(c.form.wakeUp(l.carrier.form,!1,!0),y.reviewCartFail())},toPayWithCreditCard:function(){l.stage.animating=5,l.stage.out.push(4),l.stage.current=5,y.payWithCardSuccess()},complete:function(){l.stage.out=[],l.stage.current=1}},l.logoImageConfig={size:280},h.spawnAddress=function(e){return e?(e._spawned=!0,e=angular.copy(e),e.country=null,e.kind="14",delete e.key,e.region=null,t[12].all().then(function(n){return e.country=_.findWhere(n.data.entities,{id:e.country_code.toLowerCase()}).key,t[13].actions.search({search:{keys:[[["12",e.country_code.toLowerCase(),"13",e.region_code.toLowerCase()]]]}},{cache:!0}).then(function(t){e.region=t.data.entities[0].key})}),e):e},l.cmd={},l.container={},l.cartMode=w,l.cartModeRead=w,l.sellerMode=C,l.order=u.data.entity,y=c.track.proxyLabelToEvents(d.track||c.track.noop.cartBuyerCarts,d.relativeUrl),l.seller=s,l.currentAccount=p,l.addresses={finalizeFields:!1,sameAsShipping:!0,form:{},shipping:h.spawnAddress(l.order.shipping_address)||{},billing:h.spawnAddress(l.order.billing_address)||{},browse:function(e){var n=l;i.open({inDirection:!1,windowClass:"modal-medium-simple",outDirection:!1,fullScreen:!1,backdrop:!0,templateUrl:"order/browse_addresses.html",controller:["$scope",function(r){r.$state.promise(function(){return t[19].current()},function(r,i){r.addresses=i.data.entity.addresses,r.select=function(t){var i=function(){angular.forEach(t,function(t,r){n.addresses[e][r]=t})};i(),r.$close().then(function(){g(i,100)}),"billing"===e?y.useSavedAddressForBilling():y.useSavedAddressForShipping()},r.manage=function(){t[19].manageModal(i.data.entity.parent.key,function(e){r.addresses=e.args.addresses},{inDirection:!1,outDirection:!1})}})}]})},fields:{shipping:h.shippingAddressFields,billing:h.billingAddressFields,sameAsShipping:{type:"SuperBooleanProperty",code_name:"sameAsShipping",ui:{writable:!0,parentArgs:"addresses",args:"addresses.sameAsShipping",specifics:{type:"checkbox"}}}}},l.addresses.shipping._spawned||c.location.updateDefaults(l.addresses.shipping),l.addresses.billing._spawned||c.location.updateDefaults(l.addresses.billing),l.payment={method:l.order.payment_method},l.carrier={selected:l.order.carrier?l.order.carrier.reference:null,available:u.data.carriers||[],form:null},l.format={variantVisible:function(e){var t=l.format.variantValue(e);return angular.isString(t)&&t.length?!0:!1},variantLabel:function(e){return Object.keys(e)[0]},variantValue:function(e){return e[l.format.variantLabel(e)]}},l.order._messages&&l.order._messages.length&&l.order._messages.reverse(),l.messages={sentQueue:0,isToday:function(e){return e.created?l.today.getDay()===e.created.getDay()&&l.today.getMonth()===e.created.getMonth():!1},reader:l.order.id?t[34].reader({key:l.order.key,next:{_messages:angular.copy(l.order._next_read_arguments._messages)},access:["_messages"],complete:function(e){l.order._messages.prepend(e)}}):{},toggling:!1,open:!1,stateChanged:function(e){g(function(){l.messages.sync.toggle(e)},2e3,0),e?y.openMessages():y.closeMessages(),l.order.ui.rule.action.see_messages.executable&&t[34].actions.see_messages({key:l.order.key}).then(function(){l.order._tracker=null,h.reactOnUpdate()})},seen:!1,sync:{timer:null,active:!1,stop:function(){this.active=!1,this.loading=!1,clearTimeout(this.timer)},start:function(){l.order.id&&l.order._lines.length&&(this.active=!0,this.run())},toggle:function(e){e?this.start():this.stop()},loading:!1,run:function(){var e=this;!this.loading&&this.active&&(clearTimeout(this.timer),this.loading=!0,this.timer=setTimeout(function(){t[34].actions.read({key:l.order.key,read_arguments:{_messages:{_agent:{}}}}).then(function(e){var t={},n=!1,r=e.data.entity._messages;angular.forEach(l.order._messages,function(e,n){t[e.key]=e}),angular.forEach(r,function(e){t[e.key]?$.extend(t[e.key],e):(l.order._messages.push(e),n=!0)}),n&&l.messages.forceReflow()})["finally"](function(){e.loading=!1,e.timer=null,e.run()})},1e4))}},draft:{message:null,key:l.order.key},field:h.logMessageAction.message,nav:function(){return f(l.messages.sidebarID)},sent:!1,resendMaybe:function(e){if(e._failed){e._failed=!1;var n=angular.copy(e);return n.key=l.order.key,n.message=n.body,t[34].actions.log_message(n).then(function(t){return l.messages.forceReflow(),t.data.entity?($.extend(e,t.data.entity._messages[0]),h.reactOnStateChange(t),t):void 0},function(){e._failed=!0})}},send:function(e,n,r){var i=r||angular.copy(l.messages.draft),a=r||$.extend(i,{body:i.message}),o=function(e){if(e.data.entity){var t=a.created;return $.extend(a,e.data.entity._messages[0]),a.created=t,a._failed=!1,h.reactOnStateChange(e),y.sendMessageSuccess(),e}},s=function(){a._failed=!0,y.sendMessageFail()};return r||(l.messages.draft.message="",a.created=new Date,l.order._messages.push(a)),l.container.messages.$setSubmitted(!0),l.container.messages.$setPristine(!0),l.messages.forceReflow(),i.key=l.order.key,a.key=l.order.key,n?a:t[34].actions[e](i).then(o,s)},forceReflow:function(){l.messages.sent=(new Date).getTime()},sidebarID:"messages"+_.uniqueId(),logMessages:[],logMessage:function(){var e=this;if(!l.order._lines.length)return void o.showK("messangerDisabledWhenEmpty");if(void 0!==l.messages.draft.message&&l.messages.draft.message.length){if(l.container.messages.$valid){l.messages.sentQueue+=1,l.messages.sync.stop();var t,n,r=function(){if(l.messages.logMessages.length){var e=l.messages.logMessages.shift();e()}l.messages.sentQueue-=1,l.messages.sentQueue||(l.messages.sync.start(),l.messages.sentQueue=0)};if(l.messages.logMessages.length>0)return n=e.send("log_message",!0),l.messages.logMessages.push(function(){var t=e.send("log_message",!1,n);t["finally"](r)}),t;t=this.send("log_message");var i=function(){};return l.messages.logMessages.push(i),t["finally"](function(){l.messages.logMessages.remove(i),r.apply(this,arguments)}),t}c.form.wakeUp(l.container.messages,!1,!0)}},close:function(){return l.message.toggle(!0)},toggle:function(e){if(!l.order._lines.length)return void o.showK("messangerDisabledWhenEmpty");if(!l.messages.toggling){var t=l.messages.nav(),n=t.isOpen();l.messages.toggling=!0,e===!0&&(n=!0),g(function(){t[n?"close":"open"]().then(function(){l.messages.toggling=!1,l.messages.open=!n,l.messages.forceReflow()})})}}},l.cmd.order={scheduleUpdatePromise:null,scheduleNext:!0,scheduleLoading:!1,scheduleUpdate:function(e,t){var n=this;return n.scheduleLoading?n.scheduleNext=[e,t]:(n.scheduleLoading=!0,n.scheduleNext=null,n.scheduleUpdatePromise=n.update(e,t).then(function(e){return n.scheduleLoading=!1,n.scheduleNext?n.scheduleUpdate.apply(n,n.scheduleNext):e})),n.scheduleUpdatePromise},update:function(e,n){n=c.alwaysObject(n);var r,i,a={key:l.order.key,payment_method:l.payment.method,_lines:l.order._lines};return $.extend(a,e),r=function(){var e=!0;return angular.forEach(l.order._lines,function(t){("deleted"!==t._state||"0"!==t.product.quantity.toString())&&(e=!1)}),e?l.cmd.order["delete"](!1,!0):!1},i=r(),i?i:t[34].actions.update(a,{ignoreErrors:2,activitySpinner:!n.noLoader,disableUI:angular.isDefined(n.disableUI)?n.disableUI:!0}).then(function(e){var t=e.data.errors;return t?(t.plugin_error&&-1!==$.inArray("invalid_address",t.plugin_error)&&o.showK("sellerProhibtsAddress"),e):(h.updateLiveEntity(e,n),h.reactOnUpdate(),l.carrier.available=e.data.carriers,l.carrier.selected=e.data.entity.carrier?e.data.entity.carrier.reference:null,r(),e)})},showNetTotalAmount:function(){var e=parseFloat(l.order.untaxed_amount,10);return 1===l.stage.current?(l.order.carrier&&l.order.carrier.subtotal&&(e-=parseFloat(l.order.carrier.subtotal,10)),e):e},showTotalAmount:function(){var e=parseFloat(l.order.total_amount,10);return 1===l.stage.current?(l.order.carrier&&l.order.carrier.subtotal&&(e-=parseFloat(l.order.carrier.subtotal,10)),l.order.tax_amount&&(e-=parseFloat(l.order.tax_amount,10)),e):e},"delete":function(e,n){var r,i=function(){r=!0;var e=t[34].actions["delete"]({key:l.order.key},{activitySpinner:!0,disableUI:!0});return e.then(function(e){h.updateLiveEntity(e),h.reactOnUpdate(),o.showK("cartUpdated")}),e};return n?i():(y.initiateEmptyCart(),void a.confirm("delete"+(e?"Cart":"Order"),function(){i(),y.confirmEmptyCart()}).result.then(function(){r||y.cancelEmptyCart()}))}},l.$watch("order._state",function(e){"deleted"===e&&(l.stage.out=[],l.stage.current=1)}),l.cmd.line={view:function(e,n){var r=e.product._reference;t[31].viewProductModal(r.parent.parent.parent.key,r.parent.parent.key,r.pricetag.key,e.product.variant_signature,{popFrom:c.clicks.realEventTarget(n.target),sellerKey:s.key,track:y.product,events:{addToCart:function(e,t){h.updateLiveEntity.call(l,e,{deleted:t}),h.reactOnUpdate()}}})},remove:function(e){e.quantity=0,e._state="deleted"}},l.cmd.seller={view:function(){l.sellerDetails.menu.open()}},l.sellerDetails=t[23].makeSellerDetails(l.seller),l.lineDrag={options:{disabled:!1,cancel:"input,textarea,button,select,option,[disabled]",axis:"x",handle:".sort-handle",distance:10,stop:function(e,t){l.$apply()}},whatSortMeans:function(){a.alert("howToDeleteDragging")},onStart:function(e,t,n){$(t.helper).find(".sort-handle").addClass("dragged")},onDrag:function(e,t,n){var r,i,a=t.helper.width();i=t.offset.left+a,a/2>i&&(r=!0),n&&(r?t.helper.addClass("about-to-delete"):t.helper.removeClass("about-to-delete"))},onStop:function(e,t,n){t.helper.hasClass("about-to-delete")?t.helper.animate({left:2*t.helper.width()*-1},function(){g(function(){n.product.quantity="0",n._state="deleted",t.helper.hide(),l.cmd.order.scheduleUpdate(void 0,{noLines:!0,disableUI:!0}).then(function(e){e&&e.then||o.showK("cartUpdated"),y.removeLineSuccess()},function(){n._state=null,y.removeLineFail()})})}):t.helper.animate(t.originalPosition,function(){t.helper.attr("style","")})}},function(){"order"===l.order.state&&(l.stage.out.extend([1,2,3]),l.stage.current=4,l.stage.checkout=1)}(),l.$watch("order._lines.length",function(e,t){l.notFound=1>e?1:void 0,g(function(){$(window).triggerHandler("resize")},100,!1)}),l.$on("$destroy",function(){l.messages.sync.stop()}),l.sellerDetails.stateChanged=function(e){e?y.openSellerDrawer():y.closeSellerDrawer()},l.sellerDetails.getTrack=function(){return c.track.proxyLabelToEvents(y.seller,d.relativeUrl)},l.$watch("order.key",function(e,t){e!==t&&d.events.newOrder&&d.events.newOrder(l.order)}),l.stripe={args:{},pay:function(){function e(e,n){n.error?(l.disableUI(!1),o.show(n.error.message),y.payFail()):t[34].actions.pay({key:l.order.key,token:n.id},{activitySpinner:!0,disableUI:!0}).then(function(e){h.updateLiveEntity(e),h.reactOnUpdate(),o.showK("orderPaymentCardSuccess"),l.stage.animating=6,l.stage.out.push(5),l.stage.current=6,l.stage.checkout=1,y.paySuccess()},function(e){y.payFail(),e&&e.data.errors&&e.data.errors.plugin_error&&(-1!==$.inArray("no_payment_method_supplied",e.data.errors.plugin_error)&&o.showK("orderPaymentNoPaymentMethodSupplied"),-1!==$.inArray("payment_failed",e.data.errors.plugin_error)&&o.showK("orderPaymentFailed"),-1!==$.inArray("invalid_number",e.data.errors.plugin_error)&&o.showK("orderPaymentInvalidNumber"),-1!==$.inArray("invalid_expiry_month",e.data.errors.plugin_error)&&o.showK("orderPaymentInvalidExpiryMonth"),-1!==$.inArray("invalid_expiry_year",e.data.errors.plugin_error)&&o.showK("orderPaymentInvalidExpiryYear"),-1!==$.inArray("invalid_cvc",e.data.errors.plugin_error)&&o.showK("orderPaymentInvalidCVC"),-1!==$.inArray("incorrect_number",e.data.errors.plugin_error)&&o.showK("orderPaymentIncorrectNumber"),-1!==$.inArray("expired_card",e.data.errors.plugin_error)&&o.showK("orderPaymentExpiredCard"),-1!==$.inArray("incorrect_cvc",e.data.errors.plugin_error)&&o.showK("orderPaymentIncorrectCVC"),-1!==$.inArray("incorrect_zip",e.data.errors.plugin_error)&&o.showK("orderPaymentIncorrectZip"),-1!==$.inArray("card_declined",e.data.errors.plugin_error)&&o.showK("orderPaymentCardDeclined"),-1!==$.inArray("missing",e.data.errors.plugin_error)&&o.showK("orderPaymentMissing"),-1!==$.inArray("processing_error",e.data.errors.plugin_error)&&o.showK("orderPaymentProcessingError"))})}return window.Stripe.setPublishableKey(l.seller._stripe_publishable_key),l.stripe.form.$valid?(l.disableUI(!0),void window.Stripe.card.createToken({number:l.stripe.args.card_number,cvc:l.stripe.args.cvc,exp_month:l.stripe.args.card_exp_1,exp_year:l.stripe.args.card_exp_2},e)):c.form.wakeUp(l.stripe.form)},payWithConfidence:function(){i.open({templateUrl:"core/models/manage.html",controller:["$scope",function(e){e.dialog={},e.dialog.templateBodyUrl="order/pay_with_confidence.html",e.dialog.toolbar={hideSave:!0,leftIcon:"arrow_back",title:r.toolbar.titles.payWithConfidence}}]})},fields:{cc:{_maker_:"order",type:"SuperStringProperty",code_name:"card_number",required:!0,ui:{args:"stripe.args.card_number",writable:!0,attrs:{"validate-card-number":!0}}},exp1:{_maker_:"order",type:"SuperStringProperty",code_name:"card_exp_1",required:!0,ui:{attrs:{"validate-card-date-item":"month"},hideMessages:!0,label:!1,args:"stripe.args.card_exp_1",writable:!0}},exp2:{_maker_:"order",type:"SuperStringProperty",code_name:"card_exp_2",required:!0,ui:{attrs:{"validate-card-date-item":"year"},hideMessages:!0,label:!1,args:"stripe.args.card_exp_2",writable:!0}},cvc:{_maker_:"order",type:"SuperStringProperty",code_name:"cvc",required:!0,ui:{attrs:{"validate-cvc":!0},args:"stripe.args.cvc",writable:!0}}},expires:{messages:function(){var e={help:!0};return angular.forEach([l.stripe.fields.exp1,l.stripe.fields.exp2],function(t){t.ui.form.hasErrors()&&t.ui.form.field().$dirty&&(e=t.ui.form.messages())}),e},shouldShowMessages:function(){return!0}}},y.openCart(),S.resolve(l.order)})}],h={templateUrl:"order/view.html",controller:v},$.extend(h,d),i.open(h),A}};$.extend(t[34],n)}t(m)}])}(),function(){"use strict";var e=function(e){return angular.isString(e)||angular.isNumber(e)};angular.module("app").controller("SellerInfo",["$scope","$state","$stateParams","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[23].viewProfileModal(n.key,{inDirection:!1,outDirection:!1,afterClose:function(){t.go("home")}})}]).controller("SellerEmbedInfo",["$scope","$stateParams","$state","models",function(e,t,n,r){e.site.toolbar.hidden=!0,r[23].viewProfileModal(t.key,{hideClose:!0,inDirection:!1,outDirection:!1})}]).directive("addressRuleLocationListView",function(){return{scope:{val:"=addressRuleLocationListView"},templateUrl:"seller/address_rule_location_list_view.html",controller:["$scope",function(t){t.notEmpty=e,t.postalCodes=function(e){return e.join(", ")}}]}}).directive("defaultLineListView",function(){return{scope:{val:"=defaultLineListView"},templateUrl:"seller/default_line_list_view.html"}}).directive("carrierLineRuleListView",function(){return{scope:{val:"=carrierLineRuleListView"},templateUrl:"seller/carrier_line_rule_list_view.html",controller:["$scope",function(t){t.notEmpty=e}]}}).controller("SellerManagementController",["$scope","endpoint","currentAccount","models",function(e,t,n,r){e.settings=function(){r[23].manageModal(n.key)}}]).controller("SellCatalogsController",["$scope","modals","helpers","currentAccount","modelsEditor","modelsMeta","snackbar","models","modelsUtil","$rootScope",function(e,t,n,r,i,a,o,s,c,l){e.setPageToolbarTitle("seller.catalogs");var u=function(t){if(t.key){var n=_.findWhere(e.search.results,{key:t.key});n?$.extend(n,t):e.search.results.unshift(t)}};e.$watch(function(){var t=!1;return e.search.results.iremove(function(e){var n=!e.id||"discontinued"===e.state;return t||(t=n),n}),t},angular.noop),e.create=function(e){s[31].manageModal(void 0,u,{popFrom:n.clicks.realEventTarget(e.target)})},e.preview=function(e,t){s[31].previewModal(e,{popFrom:n.clicks.realEventTarget(t.target),track:n.track.events.catalogSellerCatalogs})},e.manage=function(e,t){s[31].manageModal(e,u,{popFrom:n.clicks.realEventTarget(t.target)})},e.search={results:[],loader:{}},s[23].current().then(function(t){var n=t.data.entity;e.search.loader=s[31].paginate({kind:"31",args:{search:{ancestor:n.key,filters:[{field:"state",operator:"IN",value:["draft","published","indexed"]}],orders:[{field:"created",operator:"desc"},{field:"key",operator:"desc"}]}},complete:function(t){e.search.results.extend(t.data.entities)}}),e.search.loader.load()})}]).controller("SellOrdersController",["$scope","modals","modelsEditor","snackbar","helpers","currentAccount","GLOBAL_CONFIG","modelsMeta","models","modelsUtil","$state",function(e,t,n,r,i,a,o,s,c,l,u){var d="sell-carts"===u.current.name,p=_.string.startsWith(u.current.name,"seller-"),f=null,g=!1,m={inDirection:!1,outDirection:!1,track:i.track.noop.cartBuyerCarts,afterClose:function(){u.go("sell-orders")}},h=function(){g||(f&&clearTimeout(f),f=setTimeout(function(){var t={key:u.params.key},n=_.findWhere(e.search.results,t);return g=!0,n?e.view(n,!1,m):void c[34].manageModal(t,void 0,void 0,m)},300))};e.setPageToolbarTitle("seller."+(d?"carts":"orders")),e.listHelp=d?o.emptyHelp.cartSellerList:o.emptyHelp.orderSellerList,e.search={results:[],loader:{},loaded:!1,comparator:i.order.poolResultsComparator},e.$watch(function(){var t=!1;return e.search.results.iremove(function(e){var n=!e.id||"deleted"===e._state||"order"===e.state&&d;return t||(t=n),n}),t},angular.noop),e.view=function(t,n,r){var a={sellerMode:d,events:{newOrder:function(t){e.search.results.push(t)}},track:i.track.noop.cartBuyerCarts,popFrom:i.clicks.realEventTarget(n.target)};r&&(a=r),c[34].manageModal(t,t._seller,void 0,a)},c[23].current().then(function(t){var n=t.data.entity;e.search.loader=c[34].paginate({kind:"34",args:{search:{filters:[{field:"seller_reference",operator:"==",value:n.key}],orders:[{field:"updated",operator:"desc"}]}},config:{ignoreErrors:2},complete:function(t){var n=t.data.errors;n||e.search.results.extend(t.data.entities),p&&h()}}),e.search.loader.load()})}]).run(["modelsConfig","modelsMeta","modelsEditor","formInputTypes","underscoreTemplate","$state","$stateParams","$modal","modals","social","helpers","$q","$timeout","currentAccount","$filter","dateFilter","GLOBAL_CONFIG","snackbar",function(e,t,n,r,i,a,o,s,c,l,u,d,p,f,g,m,h,v){var y=function(e){var t=h.fields.translateChoices.rules.kind[e];return angular.isDefined(t)?t:e};e(function(e){r.SuperPluginStorageProperty=function(n){var a=n.config,o=a.kinds,l=u.callable(n.scope.formSetDirty),f=function(){return{listView:"default-line-list-view",listConfig:{perLine:2}}},m=function(){return{ui:{specifics:{type:"radio",trueLabel:h.fields.radioLabel.pluginLocation.trueLabel,falseLabel:h.fields.radioLabel.pluginLocation.falseLabel}}}},v=function(e,t,n){return{ui:{groupBy:e,groupHelp:n,groupLabel:t,label:!1}}},b=function(){return{listView:"address-rule-location-list-view",sortFields:["country","region","postal_codes"],listConfig:{calculate:function(e,t){var n=0;return angular.forEach(["country","region","postal_codes"],function(t){var r=e[t];r&&r.length&&(n+=1)}),n===t}},beforeSave:function(t,n){var r,i=[],a=t.args;return!a.region||a._region&&a.region===a._region.key||(r=e[13].get(a.region,a.country),r.then(function(e){e&&(a._region=e)}),i.push(r)),!a.country||a._country&&a.country===a._country.key||(r=e[12].get(a.country),r.then(function(e){e&&(a._country=e)}),i.push(r)),i.length?d.all(i):!1}}},w={aboutPlugins:function(){s.open({templateUrl:"core/models/manage.html",controller:["$scope",function(e){e.dialog={templateBodyUrl:"seller/help/plugins.html",toolbar:{hideSave:!0,hideRight:!0,leftIcon:"arrow_back",title:u.toolbar.title("seller.settings.aboutRules")}},e.$state.instant(function(){e.appear=!0})}]})},setupSortableOptions:function(){return{disabled:!1,start:function(e,t){n.scope.$broadcast("itemOrderStarted")},cancel:"input,textarea,button,select,option,[disabled]",distance:6,axis:!1,containment:!1,whatSortMeans:function(){c.alert("howToSort")},handle:".sort-handle",tolerance:"pointer",helper:"clone",sort:function(e,t){var r,i,a=t.helper.width(),o=t.item.scope(),s=o.$eval(t.item.attr("current-item"));i=t.offset.left+a,a/2>i&&(r=!0),s&&(r?(t.helper.addClass("about-to-delete"),s._state="deleted",n.scope.formSetDirty()):(t.helper.removeClass("about-to-delete"),s._state=null)),n.scope.$broadcast("itemOrderSorting")},stop:function(e,t){var r;angular.forEach(a.ui.specifics.parentArgs,function(e,t){t=a.ui.specifics.parentArgs.length-1-t,(e._sequence!==t||"deleted"===e._state)&&(r=!0),e._sequence=t,e.ui&&(e.ui.access[e.ui.access.length-1]=t)}),r&&n.scope.formSetDirty(),n.scope.$broadcast("itemOrderChanged"),n.scope.$apply()}}},pluginFieldOverrides:{113:{lines:{ui:{specifics:f()},modelclass:{prices:{ui:{specifics:{toolbar:{titleEdit:"editPrice",titleAdd:"addPrice"},listView:"carrier-line-rule-list-view",listConfig:{perLine:2}}},modelclass:{condition_type:v("conditional",h.fields.label["111-update"].condition_type,h.fields.help["111-update"].condition_type),condition_operator:v("conditional"),condition_value:v("conditional"),price_type:v("price",h.fields.label["111-update"].price_type,h.fields.help["111-update"].price_type),price_operator:u.extendDeep(v("price"),{ui:{active:"args.price_type !== 'fixed'"}}),price_value:v("price")}},exclusion:m(),locations:{ui:{specifics:b()}}}}},114:{spacetext:{ui:{label:h.subheaders.stripeWithConfidence,text:"seller/help/stripe.html"}}},107:{exclusion:m(),locations:{ui:{specifics:b()}}},126:{lines:{ui:{specifics:f()},modelclass:{product_categories:{ui:{specifics:{search:{enabled:!0}}}},condition_type:v("conditional",h.fields.label["124-update"].condition_type,h.fields.help["124-update"].condition_type),condition_operator:v("conditional"),condition_value:v("conditional")}}},109:{product_categories:{ui:{specifics:{search:{enabled:!0}}}},carriers:{ui:{specifics:{checkboxes:!0,entities:function(){return a.ui.specifics.parentArgs?$.map(a.ui.specifics.parentArgs,function(e){return e.active&&"113"===e.kind?{key:e.key,name:e.name}:void 0}):[]}}}},exclusion:m(),locations:{ui:{specifics:b()}}}},showType:y,kind:void 0,selectKinds:{type:"SuperStringProperty",_maker_:"rules",choices:o,required:!0,ui:{args:"info.kind",label:h.fields.label.plugins.kind,attrs:{"ng-change":"setNewArg()"},writable:!0},code_name:"kind"},remove:function(e){e._state="deleted",n.scope.$emit("itemDelete",e),n.scope.$broadcast("itemDelete",e),l()},create:function(){return this.manage()},manage:function(e){angular.isDefined(a.ui.specifics.templateUrl)||(a.ui.specifics.templateUrl="core/fields/manage_structured.html"),s.open({template:i.get(a.ui.specifics.templateUrl)({config:a}),controller:["$scope","modelsUtil",function(i,o){var s,f=function(){i.layouts={groups:[{label:!1}]},i.formBuilder={0:[a.ui.specifics.selectKinds]}},m=function(e,t){var n=w.pluginFieldOverrides[e];return angular.isDefined(n)&&angular.isDefined(n[t])?angular.copy(n[t]):{}};a.ui.specifics.toolbar={leftIcon:"arrow_back",hideSave:!0,hideRight:!0},angular.isUndefined(a.ui.specifics.toolbar.titleAdd)&&(a.ui.specifics.toolbar.titleAdd="add"+u.toolbar.makeTitle(a.code_name)),angular.isUndefined(a.ui.specifics.toolbar.titleEdit)&&(a.ui.specifics.toolbar.titleEdit="edit"+u.toolbar.makeTitle(a.code_name)),s=function(){return a.ui.specifics.toolbar["title"+(i.isNew?"Add":"Edit")]},a._title_.push(s),i.isNew=!1,e?o.normalize(e,void 0,a.ui.specifics.entity,a.code_name,a.ui.specifics.parentArgs.length):(e={},i.isNew=!0),i.$watch("isNew",function(){a.ui.specifics.toolbar.title=u.toolbar.buildTitle(a._title_)}),i.info={build:!0},i.$stateHiddenLoading=!0,i.container={},i.config=a,i.$on("$destroy",function(){a._title_.remove(s),a.ui.specifics.getScope=void 0}),i.$state.instant(function(){i.setNewArg=function(){0!==i.info.kind&&i.args.kind!==i.info.kind&&(e={kind:i.info.kind},o.normalize(e,void 0,a.ui.specifics.entity,a.code_name,a.ui.specifics.parentArgs.length,!1),i.isNew=!0,i.args=e,i.getFormBuilder(),i.info.build=!1,p(function(){i.info.build=!0,i.$apply()},100))},f(),i.getFormBuilder=function(){f();var e=i.info.kind,n=t.getFields(e),o=0,s=!1;n=_.toArray(n),"114"===e&&(angular.forEach(n,function(e,t){e.name=(2*parseInt(e.name,10)).toString()}),n.push({type:"SpaceWithText",name:"5",code_name:"spacetext",ui:{}}),n.push({_maker_:"114",type:"SuperStringProperty",name:2*n.length+1,code_name:"webhook_endpoint",required:!1,ui:{attrs:{onclick:"this.select()"}}}),i.args.webhook_endpoint=u.url.abs("api/order/notify/stripe")),n.sort(u.fields.sorter),a.ui.specifics.fields=n,angular.forEach(n,function(t){u.fields.applyGlobalConfig(t),t._title_=a._title_.concat(),t.ui.name="plugin."+t.code_name,t.ui.writable=!0;var n,o=m(e,t.code_name);o&&u.extendDeep(t,o),u.fields.isFieldset(t)&&r[t.type]?(i.layouts.groups.push({label:t.ui.label||g("humanized")(t.code_name),disabled:!1,open:!1}),t.ui.label=!1,n=i.layouts.groups.length-1,angular.isDefined(i.formBuilder[n])||(i.formBuilder[n]=[],i.formBuilder[n].push(t)),i.layouts.groups[0].disabled=!1):i.formBuilder[0].push(t)}),angular.forEach(i.layouts.groups,function(e,t){i.formBuilder[t].length&&(o+=1),s===!1&&(i.formBuilder[t].length?(e.open=!0,s=e):e.open=!1)}),1===o&&(s.disabled=!0),
i.$stateHiddenLoading=!0,u.fields.deferFormBuilderFields(i.formBuilder).then(function(){i.$stateHiddenLoading=!1})},i.args=angular.copy(e),i.parentArgs=a.ui.specifics.parentArgs,i.entity=a.ui.specifics.entity,i.rootFormSetDirty=l,i.formSetDirty=angular.bind(i,u.form.setDirty),i.formSetPristine=angular.bind(i,u.form.setPristine),i.validateForm=angular.bind(i,u.form.validate),i.args&&i.args.kind?(i.info.kind=i.args.kind,i.getFormBuilder()):i.$stateHiddenLoading=!1,i.close=function(){if(!i.container.form.$dirty)return i.$close();var e=i.save();return e?e.then(function(){return i._close_=void 0,i.$close()}):c.confirm("discardWithFieldsRequired",i.$close)},i._close_=i.close,i.save=function(){var t,r,o=d.defer(),s=o.promise;if(i.validateForm()&&i.info.kind)return angular.isFunction(a.ui.specifics.beforeSave)&&a.ui.specifics.beforeSave(i,n),r=function(){var t=null,r=0;i.isNew?(i.parentArgs.unshift(i.args),i.isNew=!1,r=i.parentArgs.length,angular.forEach(i.parentArgs,function(e,t){t=r-t,e._sequence=t})):$.extend(e,i.args),angular.isFunction(a.ui.specifics.afterSave)&&(t=a.ui.specifics.afterSave(i,n)),t&&t.then?t.then(function(){o.resolve()}):o.resolve()},i.container.form.$dirty&&l(),t&&t.then?t.then(r):r(),i.isNew=!1,s}})}]})}};return a.ui.specifics.parentArgs=n.scope.$eval(a.ui.args),a.ui.specifics.entity=n.scope.$eval(a.ui.model),n.scope.$watch(a.ui.args,function(e,t){e!==t&&(a.ui.specifics.parentArgs=e)}),angular.forEach(w,function(e,t){void 0===a.ui.specifics[t]&&(a.ui.specifics[t]=e)}),a.ui.specifics.setupSortableOptions&&(a.ui.specifics.sortableOptions=a.ui.specifics.setupSortableOptions()),"plugins"}}),e(function(e){var r={_content:{documents:{}},_plugin_group:{}};$.extend(e[23],{makeSellerDetails:function(e,t){t=u.alwaysObject(t);t.removedOrAdded;return function(t){var n=a.engineHref("seller-info",{key:e.parent.key},{absolute:!0}),r=(a.engineHref("embed-seller-info",{key:e.parent.key},{absolute:!0}),u.url.handleProtocol(e.logo.serving_url));return t.seller=e,t.menu={},u.sideNav.setup(t.menu,"right_seller_details"),t.socialMeta={facebook:{u:n},twitter:{url:n,text:t.seller.name},pinterest:{url:n,media:r,description:t.seller.name},googleplus:{url:n},reddit:{url:n,title:t.seller.name},linkedin:{url:n,title:t.seller.name},tumblr:{url:n,name:t.seller.name}},t.viewContent=function(e){var n=t.getTrack();n.openSellerContent(),s.open({templateUrl:"core/misc/content_view.html",controller:["$scope",function(t){t.$state.instant(function(){t.plainText=!0,t.content=e}),t.close=function(){n.closeSellerContent(),t.$close()}}]})},t}({})},current:function(e){return e||(e={}),e.account=f.key,this.actions.read(e,{cache:"currentSeller",cacheType:"memory"})},manageModal:function(e){var i,a=t.getActionArguments(this.kind,"update");a._plugin_group.ui.label=!1,$.extend(a._plugin_group.modelclass.plugins.ui,{label:!1}),a.logo.ui.specifics={displayImageConfig:{size:240,defaultImage:"defaultLogo"}},i={kind:this.kind,action:"update",fields:_.toArray(a),toolbar:{submitNative:!0,titleEdit:"seller.settings",titleAdd:"seller.settings"},modalConfig:{inDirection:!1,outDirection:!1},excludeFields:["account","read_arguments"],argumentLoader:function(t){var n=this.defaultArgumentLoader(t);return n.account=e,n.read_arguments=r,n},scope:{layouts:{groups:[{label:!1,fields:["name","logo"]},{label:h.subheaders.sellerPlugins,fields:["_plugin_group"]}]}}},n.create(i).read({},{account:e,read_arguments:r})}})})}])}(),function(){"use strict";angular.module("app").controller("AdminListController",["$scope","models","$stateParams","GLOBAL_CONFIG","searchBuilder","$state","helpers",function(e,t,n,r,i,a,o){var s=n.kind,c=null,l={},u=r.admin.listViewDirective[s];try{c=o.url.jsonFromUrlsafe(n.query),c.search.t&&delete c.search.t,l=c}catch(d){}e.config={titles:r.admin.listTitles,kind:s},e.maybeTemplate=u===!0?"admin/list_view/"+s+".html":u,e.setPageToolbarTitle("admin."+e.config.titles[s]),e.manage=function(e,n){t[s].adminManageModal(e,{popFrom:o.clicks.realEventTarget(n.target)})},e.search=i.create(),$.extend(e.search,{doSearch:function(){this.send.t=(new Date).getTime(),a.go("admin-list",{kind:this.kind,query:o.url.jsonToUrlsafe({search:this.send})})},results:[],loader:t[s].paginate({args:l,kind:s,complete:function(t){e.search.results.extend(t.data.entities)}})}),e.search.kind=s,c||(c=e.search.loader.args),e.search.changeKindUI(),c&&e.search.setSearch(s,c.search),e.search.loader.load()}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","GLOBAL_CONFIG",function(e,t){e.state("home",{url:"/",templateUrl:"home/index.html",controller:"HomePageController"}).state("catalog-view",{url:"/catalog/:key",controller:"CatalogViewController",template:""}).state("catalog-product-add-to-cart",{url:"/catalog/:key/product-add-to-cart/:image_id/:pricetag_id/:variant/:quantity",controller:"CatalogProductAddToCartController",template:""}).state("embed-catalog-product-add-to-cart",{url:"/embed/catalog/:key/product-add-to-cart/:image_id/:pricetag_id/:variant/:quantity",controller:"CatalogProductAddToCartController",template:""}).state("catalog-order-view",{url:"/catalog/:key/order/view",controller:"CatalogOrderViewController",template:""}).state("embed-catalog-order-view",{url:"/embed/catalog/:key/order/view",controller:"CatalogOrderViewController",template:""}).state("catalog-product-view",{url:"/catalog/:key/product/:image_id/:pricetag_id",controller:"CatalogProductViewController",template:""}).state("catalog-product-variant-view",{url:"/catalog/:key/product/:image_id/:pricetag_id/:variant",controller:"CatalogProductVariantViewController",template:""}).state("embed-catalog-view",{url:"/embed/catalog/:key",controller:"EmbedCatalogViewController",template:""}).state("embed-catalog-product-variant-view",{url:"/embed/catalog/:key/product/:image_id/:pricetag_id/:variant",controller:"EmbedCatalogProductVariantViewController",template:""}).state("embed-catalog-product-view",{url:"/embed/catalog/:key/product/:image_id/:pricetag_id",controller:"EmbedCatalogProductViewController",template:""}).state("sell-catalogs",{url:"/seller/catalogs",controller:"SellCatalogsController",templateUrl:"catalog/list.html"}).state("sell-orders",{url:"/seller/orders",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("sell-carts",{url:"/seller/carts",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("buy-orders",{url:"/buyer/orders",controller:"BuyOrdersController",templateUrl:"order/list.html"}).state("buy-carts",{url:"/buyer/carts",controller:"BuyOrdersController",templateUrl:"buyer/carts.html"}).state("login",{url:"/api/account/login/:provider",template:""}).state("login-provider-connected",{url:"/login_provider_connected/:provider",controller:"LoginProviderConnectedController",template:""}).state("order-payment-canceled",{url:"/order/payment/canceled/:key",controller:"BuyOrdersController",templateUrl:"order/list.html"}).state("order-payment-success",{url:"/order/payment/success/:key",controller:"BuyOrdersController",templateUrl:"order/list.html"}).state("seller-order-view",{url:"/seller/order/:key",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("seller-cart-view",{url:"/seller/cart/:key",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("buyer-order-view",{url:"/buyer/order/:key",controller:"BuyOrdersController",templateUrl:"order/list.html"}).state("buyer-cart-view",{url:"/buyer/cart/:key",controller:"BuyOrdersController",templateUrl:"buyer/carts.html"}).state("login-status",{url:"/login/status",template:"",controller:"AccountLoginStatusController"}).state("order-notify",{url:"/api/order/notify/:method",template:""}).state("about",{url:"/about",controller:"AboutController",templateUrl:"home/about.html"}).state("tos",{url:"/tos",title:"tos",templateUrl:"home/tos.html"}).state("support",{url:"/support",title:"support",templateUrl:"home/support.html"}).state("acceptable_use_policy",{url:"/acceptable_use_policy",title:"acceptable_use_policy",templateUrl:"home/acceptable_use_policy.html"}).state("privacy_policy",{url:"/privacy_policy",title:"privacy_policy",templateUrl:"home/privacy_policy.html"}).state("copyright_policy",{url:"/copyright_policy",title:"copyright_policy",templateUrl:"home/copyright_policy.html"}).state("guide",{url:"/guide",title:"Guide",template:"",controller:"QuickGuideController"}).state("admin-list",{url:"/admin/list/:kind/:query",templateUrl:function(e){var n,r="admin/list.html";return void 0!==e.kind&&(n=t.admin.listTemplates[e.kind],n&&n.templateUrl&&(r=n.templateUrl)),r},controller:"AdminListController"})}]).run(["$rootScope","modelsInfo","$state","endpoint","helpers","models","currentAccount","GLOBAL_CONFIG","modelsUtil","$animate",function(e,t,n,r,i,a,o,s,c,l){angular.forEach(s.tracker,function(e,t){var n=angular.copy(e);angular.forEach(e,function(t,r){(!angular.isObject(t)||angular.isArray(t))&&(e[r]=function(){var e=_.toArray(arguments),n=[];n.extend(t),n.extend(e),i.track.event.apply(i.tracker,n)},n[r]=function(){var e=_.toArray(arguments),n=[];n.extend(t),n.extend(e),s.debug&&console.log("No tracking instruction, but would track",n)})}),i.track.events[t]=e,i.track.noop[t]=n}),e.disableUI=function(t){e.disableUIState=t,e.$broadcast("disableUI",t)},e.overlays=0,n.engineHref=function(){var e=n.href.apply(n,arguments);return window.ENGINE.DESKTOP.ACTIVE?e:s.host+e},window.ENGINE.TRACK_ERRORS=function(e,t,n,r){var a=e+" "+t+" "+r.filename+":  "+r.lineno;i.track.event("JavaScript Error",a)},window.onerror=window.ENGINE.TRACK_ERRORS,e.$on("$stateChangeSuccess",function(t,r,a,o,s){if(r.title&&e.setPageToolbarTitle(r.title),window.getTracker()){var c=n.href(r,a);i.track.pageview(c)}}),$.extend(t,window.MODELS_META),$.extend(o,window.CURRENT_ACCOUNT),c.normalize(o),a.init(),s.debug||(delete window.MODELS_META,delete window.CURRENT_ACCOUNT)}])}();