window.ng||(window.ng=function(e){return e}),function(){function e(e){var t,i,r,a,o,s;for(r=e.length,i=0,t="";r>i;){if(a=255&e.charCodeAt(i++),i==r){t+=n.charAt(a>>2),t+=n.charAt((3&a)<<4),t+="==";break}if(o=e.charCodeAt(i++),i==r){t+=n.charAt(a>>2),t+=n.charAt((3&a)<<4|(240&o)>>4),t+=n.charAt((15&o)<<2),t+="=";break}s=e.charCodeAt(i++),t+=n.charAt(a>>2),t+=n.charAt((3&a)<<4|(240&o)>>4),t+=n.charAt((15&o)<<2|(192&s)>>6),t+=n.charAt(63&s)}return t}function t(e){var t,n,r,a,o,s,c;for(s=e.length,o=0,c="";s>o;){do t=i[255&e.charCodeAt(o++)];while(s>o&&-1==t);if(-1==t)break;do n=i[255&e.charCodeAt(o++)];while(s>o&&-1==n);if(-1==n)break;c+=String.fromCharCode(t<<2|(48&n)>>4);do{if(r=255&e.charCodeAt(o++),61==r)return c;r=i[r]}while(s>o&&-1==r);if(-1==r)break;c+=String.fromCharCode((15&n)<<4|(60&r)>>2);do{if(a=255&e.charCodeAt(o++),61==a)return c;a=i[H4]}while(s>o&&-1==a);if(-1==a)break;c+=String.fromCharCode((3&r)<<6|a)}return c}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);window.btoa||(window.btoa=e),window.atob||(window.atob=t)}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0===r)return-1;var a=+t||0;if(Math.abs(a)===1/0&&(a=0),a>=r)return-1;for(n=Math.max(a>=0?a:r-Math.abs(a),0);r>n;){if(n in i&&i[n]===e)return n;n++}return-1}),function(){"use strict";Array.prototype.iremove=function(e){for(var t=this.length;t--;)e(this[t],t)&&this.splice(t,1)},Array.prototype.remove=function(e){var t=this.indexOf(e);return-1!==t&&this.splice(t,1),this},Array.prototype.empty=function(e){return this.splice(0,this.length),this},Array.prototype.contains=function(e,t){if(angular.isArray(e)){var n=[];return angular.forEach(e,function(t){n.push(this.indexOf(e)>-1)}),t?_.all(n):_.some(n)}return this.indexOf(e)>-1},Array.prototype.equals=function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0,n=this.length;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},Array.prototype.compare=function(e){if(!e)return!1;if(this.length!==e.length)return!1;var t,n=this.length;for(t=0;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].compare(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},Array.prototype.prepend=function(e){var t=this;angular.forEach(e,function(e){t.unshift(e)})},Array.prototype.extend=function(e){var t=this;angular.forEach(e,function(e){t.push(e)})}}(),function(){"use strict";window.console||(window.console={}),angular.forEach(["log","error","trace","debug","info"],function(e){window.console[e]||(window.console[e]=angular.noop)});var e=window.location.protocol+"//"+window.location.host,t={debug:!0,host:e,modules:["config","ngAnimate","ngMessages","ui.router","ui.sortable","ui.inflector","ngSanitize","ngDragDrop","timer","googlechart","btford.markdown","material.core","material.core.gestures","material.components.button","material.components.checkbox","material.components.content","material.components.simpledialog","material.components.input","material.components.radioButton","material.components.sidenav","material.components.swipe","material.components.textField","material.components.toolbar"],api:{endpoint:{path:e+"/api/endpoint"},modelsMeta:"/api/model_meta"},date:{format:"yyyy-MM-dd HH:mm:ss"},toolbar:{titles:{}},snackbar:{messages:{}},subheaders:{},fields:{help:{},label:{},translateChoices:{},emptyHelp:{}},sellerPluginName:{},labels:{},modals:{confirmations:{},alerts:{}},defaultImage:"http://placehold.it/240x100",defaultLogo:"http://placehold.it/240x100",defaultCatalogCover:"http://placehold.it/240x240",grid:{maxWidth:240,minWidth:180,maxHeight:360,margin:1},emptyHelp:{},imageSizes:_.range(50,1650,50),social:{facebook:{id:"125702284258635"}},admin:{listTemplates:{},menu:[{name:"Accounts",kind:11},{name:"Catalogs",kind:31},{name:"Orders",kind:"34"}],listViewDirective:{31:!0,11:!0,34:!0},listTitles:{31:"catalogs",11:"users",34:"orders"}}};t.debug&&(window._GLOBAL_CONFIG=t),angular.module("config",["ng"]).constant("GLOBAL_CONFIG",t).config(["$httpProvider","$locationProvider",function(e,t){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",t.hashPrefix("!"),t.html5Mode(!0)}]),angular.module("app",t.modules)}(),$(function(){"use strict";var e=$("<div>").css({height:1,overflow:"scroll"}).appendTo("body"),t=$("<div>").css({height:2}).appendTo(e);window.SCROLLBAR_WIDTH=e.width()-t.width(),Modernizr.touch&&(window.SCROLLBAR_WIDTH=0),e.remove()}),function(){"use strict";angular.element(document).ready(function(){var e=function(){var e=confirm("Could not start application. Reload your browser and try again?");e&&window.location.reload(!0)},t=angular.injector(["config"]),n=t.get("$http"),i=t.get("$q"),r=t.get("GLOBAL_CONFIG"),a=[n.get(r.api.modelsMeta),n.get(r.api.endpoint.path+"?action_id=current_account&action_model=11")];i.all(a).then(function(t){var n=t[0].data,i=t[1].data;window.MODELS_META=n,window.CURRENT_ACCOUNT=i.entity,n&&n.errors||i&&i.errors?e():angular.bootstrap(document,["app"],{strictDi:!window.DEBUG})},e)})}(),function(){"use strict";angular.module("app").factory("errorHandling",["$modal","modals",function(e,t){var n={action_denied:function(e){return"You do not have permission to perform this action."},not_found:function(e){return"Requested data "+e.join(", ")+" could not be found in database."},invalid_image_type:"You have supplied incorrect type of image format.",invalid_model:"You have requested access to resource that does not exist,",invalid_action:"You have requested access to the action that does not exist.",required:function(e){return"Some values are missing: "+e.join(", ")+"."},traceback:function(e){var t=$.parseHTML(e);return $(t).filter("pre").text()},transaction:function(e){return"timeout"===e?"Transaction was not completed due timeout. Please try again.":"failed"===e?"Transaction was not completed due failure. Please try again.":e}},i={translate:function(e,t){var i=n[e];return angular.isString(i)?i:angular.isFunction(i)?i(t):t},modal:function(e){t.alert(null,{title:"Error while performing an action",templateUrl:"core/misc/errors.html",text:{primary:"Got it"},errors:function(){var t=[];return angular.forEach(e,function(e,n){t.push([n,i.translate(n,e)])}),t}()})}};return i}]).factory("helpers",["GLOBAL_CONFIG",function(e){var t={callable:function(e){return angular.isFunction(e)?e:angular.noop},alwaysObject:function(e){return angular.isObject(e)?e:{}},splitLines:function(e){return e.match(/[^\r\n]+/g)},addslashes:function(e){return e.toString().replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},resolveDefaults:function(e,n){return n=t.alwaysObject(n),angular.forEach(e,function(e,t){angular.isUndefined(n[t])||(n[t]=e)}),n},setProperty:function(e,t,n){var i,r,a=t;return angular.isArray(t)||(t=t.split("."),a=t),r=_.last(a),a=a.slice(0,a.length-1),a.length?(i=this.getProperty(e,a),void(i[r]=n)):void(e[t.join("")]=n)},forceSetProperty:function(e,t,n){var i,r,a=e;return angular.isArray(t)||(t=t.split(".")),1===t.length?void(e[t.join("")]=n):void angular.forEach(t,function(e,o){i=a,a=a[e],r=o===t.length-1,angular.isUndefined(a)&&!r&&(a={},i[e]=a),r&&(i[e]=n)})},getProperty:function(e,t,n){var i=t;return angular.isArray(i)||(i=t.split(".")),angular.forEach(i,function(t){try{e=e[t]}catch(i){return n}}),angular.isUndefined(e)?n:e},extendDeep:function(e){return angular.forEach(arguments,function(n){n!==e&&angular.forEach(n,function(n,i){e[i]&&angular.isObject(e[i])?t.extendDeep(e[i],n):e[i]=n})}),e},extend:function(e){return angular.forEach(arguments,function(t){t!==e&&angular.forEach(t,function(t,n){e[n]=t})}),e},merge:function(e){return angular.forEach(arguments,function(t){t!==e&&angular.forEach(t,function(t,n){angular.isDefined(e[n])||(e[n]=t)})}),e},mergeDeep:function(e){return angular.forEach(arguments,function(n){n!==e&&angular.forEach(n,function(n,i){e[i]&&angular.isObject(e[i])?t.mergeDeep(e[i],n):angular.isDefined(e[i])||(e[i]=n)})}),e},update:function(e,n,i){angular.isDefined(i)?angular.forEach(i,function(i){var r=t.getProperty(n,i);t.setProperty(e,i,r)}):$.extend(e,n)}};return e.debug&&(window._helpers=t),t}]).factory("endpoint",["$http","generalLocalCache","GLOBAL_CONFIG","helpers","modelsUtil","$rootScope","$q","$cacheFactory","$injector",function(e,t,n,i,r,a,o,s,c){var l,u=s("endpointOnlyInMemory"),d=function(e){return void 0===e||"local"===e?t:"memory"===e?u:void console.error("Invalid type of cache provided: "+e)},f=function(e,t,n,r){return r=i.alwaysObject(r),n=i.alwaysObject(n),[angular.extend({action_model:t,action_id:e},n),r]},p="endpoint_",g=[];return g.push(u),g.push(t),l={getCache:function(e){var t=null;return angular.forEach(g,function(n){t||(t=n.get(p+e))}),t},removeCache:function(e){return angular.isDefined(e)?angular.isArray(e)?(angular.forEach(e,function(e){l.removeCache(e)}),!0):void angular.forEach(g,function(t){t.remove(p+e)}):(angular.forEach(g,function(e){e.removeAll()}),!0)},url:n.api.endpoint.path,cached:function(e,t,n,i,r){var a,s,c=d(r?r.cacheType:void 0),u=p+e,f=c.get(u),g=f&&angular.isFunction(f.then);return g?f:void 0===f?(s=l[r.method?r.method.toLowerCase():"post"](t,n,i,r),s.then(function(e){c.put(u,e)},function(){c.remove(u)}),c.put(u,s),s):(a=o.defer(),s=a.promise,a.resolve(f),s)},post:function(t,n,i,a){var o,s=f(t,n,i,a),c={method:"POST",url:l.url};return s[0]=r.argumentsToJson(s[0]),s[1]&&angular.isString(s[1].cache)?(o=s[1].cache,s[1].cache=!1,l.cached(o,t,n,i,s[1])):(angular.extend(c,s[1]),c.data=s[0],e(c))},get:function(t,n,i,a){var o,s=f(t,n,i,a),c={params:s[0]},u={method:"GET",url:l.url};return s[0]=r.argumentsToJson(s[0]),$.extend(c,s[1]),angular.extend(u,c),u&&angular.isString(u.cache)?(o=u.cache,u.cache=!1,l.cached(o,t,n,i,c)):e(u)}},n.debug&&(window._endpoint=l),l}]).factory("generalLocalCache",["DSCacheFactory","$cacheFactory",function(e,t){function n(e,t){return t&&(t.value&&angular.isFunction(t.value.then)||angular.isObject(t.value)&&void 0!==t.value[s])?o:angular.toJson(t)}var i,r,a=t("localStoragePolyfillInMemory"),o="___undefined___",s="___in_memory_only___";return i={getItem:function(e){var t=a.get(e);return t&&angular.isObject(t)&&void 0!==t[s]&&(t=t[s]),void 0===t&&(t=localStorage.getItem(e)),t!==o?t:void 0},setItem:function(e,t){var i;a.put(e,t),t=n(e,t);try{i=localStorage.setItem(e,t)}catch(r){}return i},removeItem:function(e){return a.remove(e),localStorage.removeItem(e)}},r=e("generalCache",{storageMode:"localStorage",storageImpl:i}),r.inMemory=function(e){var t={};return t[s]=e,t},r}]).run(["$http","generalLocalCache",function(e,t){e.defaults.cache=t}]).config(["$httpProvider",function(e){e.interceptors.push(["$rootScope","$q","$injector",function(e,t,n){var i=function(i){var r,a=i.data,o=void 0===i.config.normalizeEntity||i.config.normalizeEntity,s=n.get("errorHandling"),c=n.get("modelsUtil"),l=function(){e.$broadcast("disableUI",!1)},u=void 0===i.config.disableUI||i.config.disableUI===!0;if(!i.config.ignoreErrors){if(i.status>200)return s.modal(angular.isString(i.data)?{traceback:i.data}:i.data.errors),u&&l(),t.reject(i);if(a&&a.errors&&(s.modal(i.data.errors),r=void 0===i.config.rejectOnErrors||i.config.rejectOnErrors===!0,a.errors.action_denied&&(r=!0),r&&u))return l(),t.reject(i)}return o&&a&&(angular.isDefined(a.entities)?c.normalizeMultiple(a.entities):angular.isDefined(a.entity)&&c.normalize(a.entity)),u&&l(),i||t.when(i)};return{response:i,responseError:i,request:function(n){var i=void 0===n.disableUI||n.disableUI===!0;return i&&e.$broadcast("disableUI",!0),n||t.when(n)}}}])}]).factory("underscoreTemplate",["$templateCache",function(e){return{get:function(t){return _.template(e.get(t))}}}]).factory("animationGenerator",function(){var e={classNamePrefix:"tmp-",prefix:function(e){return(/WebKit/.test(navigator.userAgent)?"-webkit-":"")+e},compile:function(t){var n="";return angular.forEach(t,function(t,i){n+=e.prefix(i)+": "+t+";\n"}),n},make:function(t,n){var i="@"+e.prefix("keyframes")+" "+t+" {\n";return i+=n,i+="\n} ."+e.classNamePrefix+t+"{"+e.prefix("animation-name")+":"+t+";}"},single:function(t,n){var i=_.uniqueId(),r="temporary-animator"+i,a=$("#"+r);return t+=i,a.length||(a=$("<style/>").attr("id",r),a.appendTo("head")),a.text(e.make(t,n)),{name:t,className:e.classNamePrefix+t,destroy:function(){a.remove()}}}};return e})}(),function(){"use strict";angular.module("app").config(["GLOBAL_CONFIG",function(e){var t={};$.extend(e.modals.confirmations,{discardWithFieldsRequired:{title:"Discard changes?",message:"There are some invalid changes on the form you are trying to leave. If you discard them, the changes will not be applied and will be lost permanently.",text:{primary:"Discard"}},disconnectSignInMethod:{title:"Disconnect this method?",message:"If this is the only sign in method connected to your Miraclestyle account, you will permanently lose access to the account and all of it's data once this action is completed!",text:{primary:"Disconnect"}},connectSignInMethod:{title:"Connect this method?",message:"If this sign in method is already connected to another Miraclestyle account you will have to disconnect it before you proceed with this acction!",text:{primary:"Connect"}},discard:{title:"Discard unsaved changes?",message:"There are some unsaved changes on the form you are trying to close. If you discard them, the changes will be lost permanently, and the form will revert to previously saved state.",text:{primary:"Discard"}},maybeLogout:{title:"Confirm Logout",message:"Are you sure you want to logout?",text:{primary:"Logout"}},cancelOrder:{title:"Reset shopping cart?",message:"This cart will be emptied and all of its settings will be lost after completing this action.",text:{primary:"Reset"}},toCheckout:{title:"Review shopping cart?",message:"You won't be able to update this cart while reviewing it. However, you will be able to reset the cart, or place an order by making a payment.",text:{primary:"Review"}},publishCatalog:{title:"Publish catalog?",message:'Published catalog is accessible to the general public until it expires or is discontinued. With exception of a product "Availability" field, published catalog cannot be edited. However, published catalog can be duplicated and duplicate will initially be in draft state ready for editing. You will be notified once this action is completed.',text:{primary:"Publish"}},discontinueCatalog:{title:"Discontinue catalog?",message:"Discontinued catalog is not accessible to the general public, and will eventually be entirely removed from the Miraclestyle. However, products of discontinued catalog will remain accessible for the next 180 days to those who have purchased them. Discontinued catalog cannot be edited or duplicated. You will be notified once this action is completed.",text:{primary:"Discontinue"}},duplicateCatalog:{title:"Schedule duplication?",message:"Duplication can take a while to complete! You will be notified once this action is completed.",text:{primary:"Schedule"}},sellerProfileNotFound:{title:"No seller information provided",message:"You must configure your seller profile in order to do this.",text:{primary:"Configure"}}}),t.gotit={primary:"Got it"},$.extend(e.modals.alerts,{forbidden:{title:"Action Denied",message:"Action you tried to perform is forbidden for this account.",text:t.gotit},noBuyer:{title:"Buyer address required",message:"You did not provide any buyer information.",text:t.gotit},howToSort:{title:"How to use this action",messages:["Reorder the item by dragging it within its group.","Remove the item by dragging it outside the left edge of the screen."],text:t.gotit},howToDeleteLine:{title:"How to use this action",message:"Remove the item by dragging it outside the left edge of the screen.",text:t.gotit},howToDropPricetag:{title:"How to use this action",messages:['Add new product to the catalog by dragging the "Add" tag to a catalog image. While dragging, it is preferable to aim the tag dot for the image area that shows the product that the tag will link to. Add one tag per product per catalog.',"Reposition a tag by dragging it within images area.",'Click a tag to open the "Edit Product" form while editing the catalog.',"Click a tag to open the product view while viewing the catalog."],text:t.gotit}}),$.extend(e.labels,{order:{checkout:"Checkout",completed:"Completed",cart:"Cart",canceled:"Canceled",sudo:"Administered",review:"Review",reported:"Reported",positive:"Positive",negative:"Negative",neutral:"Neutral",revision:"Review"}}),$.extend(e.fields.help,{"124-update":{condition_type:"Condition under which this price applies.",price_type:"Price formula that calculates the price."},106:{postal_codes:"Range of postal codes this location affects. Specify one postal code per line."},108:{reciever_email:"Primary email address of your PayPal account.",business:'Email address on which you want to receive your PayPal payments. This value will be the same as "Receiver Email" in case that you have only one email address associated with your PayPal account.'},109:{carriers:"Carriers, if any, to which this rule applies.",product_categories:"Product categories to which this rule applies.",product_codes:"Specific product codes to which this rule applies. Specify one product code per line.",address_type:"Buyer address type this rule applies to."},124:{product_categories:"Product categories to which this rule applies.",product_codes:"Specific product codes to which this rule applies. Specify one product code per line."},117:{currency:"Currency you accept, and your product prices are expressed in."},"111-update":{condition_type:"Condition under which this price applies.",price_type:"Price formula that calculates the price."},"23-update":{name:"Name of the brand, company, or store that you own or represent.",logo:"Click on the logo above to upload logo image of the brand, company, or store that you own or represent. Logo must be of 2.4:1 aspect ratio, preferably 2400 pixels wide and 1000 pixels high."},14:{name:"Recipient's full name, or business name."},107:{address_type:"Buyer address type this rule applies to."},"31-update":{discontinue_date:"Date when this catalog will be automatically discontinued and become unavailable to the general public."},26:{name:"Name of the variant input control that will be visible on the product view.",options:"Options that will be available for selection on the variant input control. Specify one option per line.",description:"Brief description visible beneath the variant input control.",allow_custom_value:"If enabled, options defined above will be ignored, and buyers will be able to supply custom value in variant input control."}}),$.extend(e.fields.label,{search:{indexID:"Search Options",ancestor:"Ancestor",operator:"Operator"},plugins:{kind:"Rule"},28:{uom:"Unit Of Measurement",weight_uom:"Weight Unit Of Measurement",volume_uom:"Volume Unit Of Measurement"},27:{uom:"Unit Of Measurement",weight_uom:"Weight Unit Of Measurement",volume_uom:"Volume Unit Of Measurement"},112:{rules:"Prices"},124:{discount_value:"Discount (%)"},"31-update":{discontinue_date:"Expiration Date"},"124-update":{condition_type:"Condition",price_type:"Price"},"111-update":{condition_type:"Condition",price_type:"Price"},"23-update":{logo:"Seller Logo"},"18-update":{notify:"E-mail me when a catalog is published or discontinued by the seller that I'm following."}}),t.conditionOperatorSpec={"<=":"is less than or equals to",">=":"is greater than or equals to","==":"equals to","<":"less than",">":"greater than"},t.addressTypeSpec={shipping:"Shipping",billing:"Billing"},$.extend(e.fields.translateChoices,{107:{address_type:t.addressTypeSpec},109:{address_type:t.addressTypeSpec,type:{percent:"Proportional (%)",fixed:"Fixed (Amount)"}},111:{condition_operator:t.conditionOperatorSpec,price_operator:{weight:"weight multiplied by",quantity:"quantity multiplied by","weight*volume":"weight multiplied by volume multiplied by",volume:"volume multiplied by",price:"price multiplied by"}},124:{condition_operator:t.conditionOperatorSpec},rules:{kind:{109:"Tax",126:"Discount",107:"Address",117:"Currency",108:"PayPal",113:"Carrier"}}}),$.extend(e.fields.emptyHelp,{"19-update":{addresses:"buyer/help/addresses.html"},"31-update":{_images:"catalog/help/images.html"},28:{images:"catalog/product/help/images.html",contents:"catalog/product/help/contents.html",variants:"catalog/product/help/variants.html",_instances:"catalog/product/help/instances.html"},27:{images:"catalog/product/help/images.html",contents:"catalog/product/help/contents.html"},21:{documents:"seller/help/contents.html"}}),e.fields.radioLabel||(e.fields.radioLabel={}),$.extend(e.fields.radioLabel,{pluginLocation:{trueLabel:"Applies to all locations except to those listed in the Locations section.",falseLabel:"Applies only to the locations listed in the Locations section."}}),$.extend(e.subheaders,{loginMethods:"Login Methods",productInstances:"Variant Configurations",catalogImages:"Images",catalogProducts:"Products",collectionSeller:"Sellers",history:"History",sellerContents:"Contents",sellerPlugins:"Rules"}),$.extend(e.emptyHelp,{orderSellerList:"seller/help/orders.html",cartSellerList:"seller/help/carts.html",orderBuyerList:"buyer/help/orders.html",cartBuyerList:"buyer/help/carts.html",catalogList:"catalog/help/list.html",cart:"order/help/empty.html",following:"collection/help/sellers.html"}),$.extend(e.snackbar.messages,{changesSaved:"Changes saved.",cartUpdated:"Cart updated.",catalogPublished:"Catalog published.",catalogDiscontinued:"Catalog discontinued.",duplicationInProgressCatalog:"Catalog scheduled for duplication.",administered:"Administered.",identityDisconnected:"Identity disconnected.",identityConnected:"Identity connected.",createVariantsFirst:"Create some variants first.",saveProductFirst:"Save product first.",provideProperValues:"Provide proper values in the form fields first!",uploadImagesFirst:'Use "Images" dialog to upload and arrange catalog images first.',messangerDisabledWhenEmpty:"Messenger is disabled for empty shopping carts!",feedbackReviewed:"Feedback reviewed.",feedbackReported:"Feedback reported.",feedbackLeft:"Feedback left."}),$.extend(e.toolbar.titles,{seller:"Seller",edit31:"Edit Catalog",add31:"Create Catalog",viewImages:"Images",viewProducts:"Products",editProduct:"Edit Product",addProduct:"Add Product",editPluginGroup:!1,settings:"Settings",addPlugins:"Add Rule",editPlugins:"Edit Rule",addVariants:"Add Variant",editVariants:"Edit Variant",home:"Home",buyer:"Buyer",carts:"Carts",orders:"Orders",catalogs:"Catalogs",addLines:"Add Line",edit18:"Following",viewAddresses:"Addresses",addAddresses:"Add Address",editAddresses:"Edit Address",addLocations:"Add Locations",editLines:"Edit Lines",addPrice:"Add Price",editPrice:"Edit Price",viewInstances:"Variant Configurations",editInstances:"Edit Variant Configuration",addInstances:"Add Variant Configuration",addContents:"Add Content",editContents:"Edit Content",account:"Account",admin:"Admin",users:"Users",aboutRules:"About Rules"})}])}(),function(){"use strict";function e(e,t){function n(e){return angular.isDefined(e.href)||angular.isDefined(e.ngHref)}function i(e,t){return n(t)?'<a class="md-button" ng-transclude></a>':'<button class="md-button" ng-transclude></button>'}function r(i,r,a){var o=r[0];e.attachButtonBehavior(i,r);var s=o.textContent.trim();s||t.expect(r,"aria-label"),n(a)&&angular.isDefined(a.ngDisabled)&&i.$watch(a.ngDisabled,function(e){r.attr("tabindex",e?-1:0)})}return{restrict:"E",replace:!0,transclude:!0,template:i,link:r}}angular.module("material.components.button",["material.core"]).directive("mdButton",e),e.$inject=["$mdInkRipple","$mdAria"]}(),function(){"use strict";function e(e,t,n,i){function r(r,o){return o.type="checkbox",o.tabIndex=0,r.attr("role",o.type),function(r,o,s,c){function l(e){e.which===n.KEY_CODE.SPACE&&(e.preventDefault(),u(e))}function u(e){o[0].hasAttribute("disabled")||r.$apply(function(){f=!f,c.$setViewValue(f,e&&e.type),c.$render()})}function d(){f=c.$viewValue,f?o.addClass(a):o.removeClass(a)}c=c||i.fakeNgModel();var f=!1;t.expectWithText(o,"aria-label"),e.link.pre(r,{on:angular.noop,0:{}},s,[c]),o.on("click",u).on("keypress",l),c.$render=d}}e=e[0];var a="md-checked";return{restrict:"E",transclude:!0,require:"?ngModel",template:'<div class="md-container list-primary-tile"><div class="avatar-small"><div><icon class="button-square" type="toggle.check-box"></icon><icon class="button-square" type="toggle.check-box-outline-blank"></icon></div></div></div><div ng-transclude class="md-label"></div>',compile:r}}angular.module("material.components.checkbox",["material.core"]).directive("mdCheckbox",e),e.$inject=["inputDirective","$mdAria","$mdConstant","$mdUtil"]}(),function(){"use strict";function e(){function e(e,t){this.$scope=e,this.$element=t}return{restrict:"E",controller:["$scope","$element",e],link:function(e,n,i){n[0];e.$broadcast("$mdContentLoaded",n),t(n[0])}}}function t(e){angular.element(e).on("$md.pressdown",function(t){"t"===t.pointer.type&&(t.$materialScrollFixed||(t.$materialScrollFixed=!0,0===e.scrollTop?e.scrollTop=1:e.scrollHeight===e.scrollTop+e.offsetHeight&&(e.scrollTop-=1)))})}angular.module("material.components.content",["material.core"]).directive("mdContent",e).config(["markdownConverterProvider",function(e){e.config({extensions:["demo"]})}]),e.$inject=[]}(),function(){var e=function(e){return[{type:"output",filter:function(e){if(window._allow)return e;try{$.parseHTML(e)}catch(t){return""}var n=$("<div />").html(e),i=function(e){return e},r=function(e){var t=-1!==e.indexOf("%"),n=-1!==e.indexOf("px"),i="";return t&&(i="%"),n&&(i="px"),parseInt(e,10)+i},a={strong:!0,b:!0,hr:!0,ol:!0,blockquote:!0,kbd:!0,code:!0,i:!0,em:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,li:!0,div:!0,pre:!0,p:!0,br:!0,iframe:{width:r,height:r,src:i,allowfullscreen:function(){return""},frameborder:function(e){return parseInt(e,10)}}};return n.find("*").each(function(){var e=$(this),t=e.get(0).nodeName.toLowerCase(),n=a[t];n?$.each(this.attributes,function(){var t=angular.isObject(n)?n[this.name]:!1;t?e.attr(this.name,t(e.attr(this.name))):e.removeAttr(this.name)}):e.remove()}),n.html()}}]};"undefined"!=typeof window&&window.Showdown&&window.Showdown.extensions&&(window.Showdown.extensions.demo=e),"undefined"!=typeof module&&(module.exports=e)}(),function(){"use strict";function e(e,t,n){function i(e){var t=s[e];angular.isUndefined(t)&&(t=s[e]=r(e));var n=c[t];return angular.isUndefined(n)&&(n=a(t)),n}function r(t){return e.MEDIA[t]||("("!==t.charAt(0)?"("+t+")":t)}function a(e){var t=n.matchMedia(e);return t.addListener(o),c[t.media]=!!t.matches}function o(){var e=this;t.$evalAsync(function(){c[e.media]=!!e.matches})}var s={},c={};return i}!function(){function e(e){e.decorator("$$rAF",["$delegate",t])}function t(e){return e.throttle=function(t){var n,i,r,a;return function(){n=arguments,a=this,r=t,i||(i=!0,e(function(){r.apply(a,n),i=!1}))}},e}function n(e,t){function n(e){return r?"webkit"+e.charAt(0).toUpperCase()+e.substring(1):e}function i(e){return r?"-webkit-"+e:e}var r=/webkit/i.test(t.vendorPrefix);return{KEY_CODE:{ENTER:13,ESCAPE:27,SPACE:32,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40},RAW_CSS:{TRANSFORM:i("transform"),TRANSFORMORIGIN:i("transformOrigin"),TRANSITION:i("transition"),TRANSITION_DURATION:i("transitionDuration"),ANIMATION_PLAY_STATE:i("animationPlayState"),ANIMATION_DURATION:i("animationDuration"),ANIMATION_NAME:i("animationName"),ANIMATION_TIMING:i("animationTimingFunction"),ANIMATION_DIRECTION:i("animationDirection")},CSS:{TRANSITIONEND:"transitionend"+(r?" webkitTransitionEnd":""),ANIMATIONEND:"animationend"+(r?" webkitAnimationEnd":""),TRANSFORM:n("transform"),TRANSFORMORIGIN:n("transformOrigin"),TRANSITION:n("transition"),TRANSITION_DURATION:n("transitionDuration"),ANIMATION_PLAY_STATE:n("animationPlayState"),ANIMATION_DURATION:n("animationDuration"),ANIMATION_NAME:n("animationName"),ANIMATION_TIMING:n("animationTimingFunction"),ANIMATION_DIRECTION:n("animationDirection")},MEDIA:{sm:"(max-width: 600px)","gt-sm":"(min-width: 600px)",md:"(min-width: 600px) and (max-width: 960px)","gt-md":"(min-width: 960px)",lg:"(min-width: 960px) and (max-width: 1200px)","gt-lg":"(min-width: 1200px)"}}}angular.module("material.core",[]).config(e),e.$inject=["$provide"],angular.module("material.core").factory("$mdConstant",n),n.$inject=["$$rAF","$sniffer"]}(),function(){function e(e,t){function n(){return[].concat(v)}function i(){return v.length}function r(e){return v.length&&e>-1&&e<v.length}function a(e){return e?r(d(e)+1):!1}function o(e){return e?r(d(e)-1):!1}function s(e){return r(e)?v[e]:null}function c(e,t){return v.filter(function(n){return n[e]===t})}function l(e,t){return e?(angular.isNumber(t)||(t=v.length),v.splice(t,0,e),d(e)):-1}function u(e){f(e)&&v.splice(d(e),1)}function d(e){return v.indexOf(e)}function f(e){return e&&d(e)>-1}function p(){return v.length?v[0]:null}function g(){return v.length?v[v.length-1]:null}function m(e,n,i,a){i=i||h;var o=d(n);if(!r(o))return null;var s=o+(e?-1:1),c=null;return r(s)?c=v[s]:t&&(c=e?g():p(),s=d(c)),null===c||s===a?null:(angular.isUndefined(a)&&(a=s),i(c)?c:m(e,c,i,a))}var h=function(){return!0};t=!!t;var v=e||[];return{items:n,count:i,inRange:r,contains:f,indexOf:d,itemAt:s,findBy:c,add:l,remove:u,first:p,last:g,next:angular.bind(null,m,!1),previous:angular.bind(null,m,!0),hasPrevious:o,hasNext:a}}angular.module("material.core").config(["$provide",function(t){t.decorator("$mdUtil",["$delegate",function(t){return t.iterator=e,t}])}])}(),angular.module("material.core").factory("$mdMedia",e),e.$inject=["$mdConstant","$rootScope","$window"],function(){var e=["0","0","0"];angular.module("material.core").factory("$mdUtil",["$document","$timeout",function(t,n){var i;return i={now:window.performance?angular.bind(window.performance,window.performance.now):Date.now,elementRect:function(e,t){var n=e[0];t=t||n.offsetParent||document.body,t=t[0]||t;var i=n.getBoundingClientRect(),r=t.getBoundingClientRect();return{left:i.left-r.left+t.scrollLeft,top:i.top-r.top+t.scrollTop,width:i.width,height:i.height}},fakeNgModel:function(){return{$fake:!0,$setViewValue:function(e){this.$viewValue=e,this.$render(e),this.$viewChangeListeners.forEach(function(e){e()})},$isEmpty:function(e){return 0===(""+e).length},$parsers:[],$formatters:[],$viewChangeListeners:[],$render:angular.noop}},debounce:function(e,t,i,r){var a;return function(){var o=i,s=Array.prototype.slice.call(arguments);n.cancel(a),a=n(function(){a=void 0,e.apply(o,s)},t||10,r)}},throttle:function(e,t){var n;return function(){var r=this,a=arguments,o=i.now();(!n||o-n>t)&&(e.apply(r,a),n=o)}},nextUid:function(){for(var t,n=e.length;n;){if(n--,t=e[n].charCodeAt(0),57==t)return e[n]="A",e.join("");if(90!=t)return e[n]=String.fromCharCode(t+1),e.join("");e[n]="0"}return e.unshift("0"),e.join("")},disconnectScope:function(e){if(e&&e.$root!==e&&!e.$$destroyed){var t=e.$parent;e.$$disconnected=!0,t.$$childHead===e&&(t.$$childHead=e.$$nextSibling),t.$$childTail===e&&(t.$$childTail=e.$$prevSibling),e.$$prevSibling&&(e.$$prevSibling.$$nextSibling=e.$$nextSibling),e.$$nextSibling&&(e.$$nextSibling.$$prevSibling=e.$$prevSibling),e.$$nextSibling=e.$$prevSibling=null}},reconnectScope:function(e){if(e&&e.$root!==e&&e.$$disconnected){var t=e,n=t.$parent;t.$$disconnected=!1,t.$$prevSibling=n.$$childTail,n.$$childHead?(n.$$childTail.$$nextSibling=t,n.$$childTail=t):n.$$childHead=n.$$childTail=t}},getClosest:function(e,t){t=t.toUpperCase();

do if(e.nodeName===t)return e;while(e=e.parentNode);return null}}}]),angular.element.prototype.focus=angular.element.prototype.focus||function(){return this.length&&this[0].focus(),this},angular.element.prototype.blur=angular.element.prototype.blur||function(){return this.length&&this[0].blur(),this}}(),function(){function e(e,t,n){function i(e,t,n){var i=e[0];i.hasAttribute(t)||o(i,t)||(n=angular.isString(n)&&n.trim()||"",n.length&&e.attr(t,n))}function r(t,n,r){e(function(){i(t,n,r())})}function a(e,t){r(e,t,function(){return e.text().trim()})}function o(e,t){function i(e){var t=e.currentStyle?e.currentStyle:n.getComputedStyle(e);return"none"===t.display}var r=e.hasChildNodes(),a=!1;if(r)for(var o=e.childNodes,s=0;s<o.length;s++){var c=o[s];1===c.nodeType&&c.hasAttribute(t)&&(i(c)||(a=!0))}return a}return{expect:i,expectAsync:r,expectWithText:a}}angular.module("material.core").service("$mdAria",e),e.$inject=["$$rAF","$log","$window"]}(),function(){function e(e,t,n,i,r,a){this.compile=function(o){var s=o.templateUrl,c=o.template||"",l=o.controller,u=o.controllerAs,d=o.resolve||{},f=o.locals||{},p=o.transformTemplate||angular.identity,g=o.bindToController;return angular.forEach(d,function(e,t){d[t]=angular.isString(e)?n.get(e):n.invoke(e)}),angular.extend(d,f),d.$template=s?t.get(s,{cache:a}).then(function(e){return e.data}):e.when(c),e.all(d).then(function(e){var t=p(e.$template),n=angular.element("<div>").html(t.trim()).contents(),a=i(n);return{locals:e,element:n,link:function(t){if(e.$scope=t,l){var i=r(l,e);g&&angular.extend(i,e),n.data("$ngControllerController",i),n.children().data("$ngControllerController",i),u&&(t[u]=i)}return a(t)}}})}}angular.module("material.core").service("$mdCompiler",e),e.$inject=["$q","$http","$injector","$compile","$controller","$templateCache"]}(),function(e){function t(){}function n(t,n,i){function r(e,t,n){var i=f[t.replace(/^\$md./,"")];if(!i)throw new Error("Failed to register element with handler "+t+". Available handlers: "+Object.keys(f).join(", "));return i.registerElement(e,n)}function a(e,n){var i=new t(e);return angular.extend(i,n),f[e]=i,d}var s=navigator.userAgent||navigator.vendor||window.opera,l=s.match(/ipad|iphone|ipod/i),u=s.match(/android/i),d={handler:a,register:r,isHijackingClicks:(l||u)&&!e&&!p};return d.isHijackingClicks&&d.handler("click",{options:{maxDistance:6},onEnd:function(e,t){t.distance<this.state.options.maxDistance&&this.dispatchEvent(e,"click")}}),d.handler("press",{onStart:function(e,t){this.dispatchEvent(e,"$md.pressdown")},onEnd:function(e,t){this.dispatchEvent(e,"$md.pressup")}}).handler("hold",{options:{maxDistance:6,delay:500},onCancel:function(){i.cancel(this.state.timeout)},onStart:function(e,t){return this.state.registeredParent?(this.state.pos={x:t.x,y:t.y},void(this.state.timeout=i(angular.bind(this,function(){this.dispatchEvent(e,"$md.hold"),this.cancel()}),this.state.options.delay,!1))):this.cancel()},onMove:function(e,t){e.preventDefault();var n=this.state.pos.x-t.x,i=this.state.pos.y-t.y;Math.sqrt(n*n+i*i)>this.options.maxDistance&&this.cancel()},onEnd:function(){this.onCancel()}}).handler("drag",{options:{minDistance:6,horizontal:!0,cancelMultiplier:1.5},onStart:function(e){this.state.registeredParent||this.cancel()},onMove:function(e,t){var n,i;e.preventDefault(),this.state.dragPointer?this.dispatchDragMove(e):(this.state.options.horizontal?(n=Math.abs(t.distanceX)>this.state.options.minDistance,i=Math.abs(t.distanceY)>this.state.options.minDistance*this.state.options.cancelMultiplier):(n=Math.abs(t.distanceY)>this.state.options.minDistance,i=Math.abs(t.distanceX)>this.state.options.minDistance*this.state.options.cancelMultiplier),n?(this.state.dragPointer=o(e),c(e,this.state.dragPointer),this.dispatchEvent(e,"$md.dragstart",this.state.dragPointer)):i&&this.cancel())},dispatchDragMove:n.throttle(function(e){this.state.isRunning&&(c(e,this.state.dragPointer),this.dispatchEvent(e,"$md.drag",this.state.dragPointer))}),onEnd:function(e,t){this.state.dragPointer&&(c(e,this.state.dragPointer),this.dispatchEvent(e,"$md.dragend",this.state.dragPointer))}}).handler("swipe",{options:{minVelocity:.65,minDistance:10},onEnd:function(e,t){if(Math.abs(t.velocityX)>this.state.options.minVelocity&&Math.abs(t.distanceX)>this.state.options.minDistance){var n="left"==t.directionX?"$md.swipeleft":"$md.swiperight";this.dispatchEvent(e,n)}}})}function i(e){this.name=e,this.state={}}function r(t){function n(e,t,n){n=n||u;var i=new angular.element.Event(t);i.$material=!0,i.pointer=n,i.srcEvent=e,angular.extend(i,{clientX:n.x,clientY:n.y,screenX:n.x,screenY:n.y,pageX:n.x,pageY:n.y,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}),angular.element(n.target).trigger(i)}function r(e,t,n){n=n||u;var i;"click"===t?(i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,window,e.detail,n.x,n.y,n.x,n.y,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget||null)):(i=document.createEvent("CustomEvent"),i.initCustomEvent(t,!0,!0,{})),i.$material=!0,i.pointer=n,i.srcEvent=e,n.target.dispatchEvent(i)}var a="undefined"!=typeof e&&angular.element===e;return i.prototype={options:{},dispatchEvent:a?n:r,onStart:angular.noop,onMove:angular.noop,onEnd:angular.noop,onCancel:angular.noop,start:function(e,t){if(!this.state.isRunning){var n=this.getNearestParent(e.target),i=n&&n.$mdGesture[this.name]||{};this.state={isRunning:!0,options:angular.extend({},this.options,i),registeredParent:n},this.onStart(e,t)}},move:function(e,t){this.state.isRunning&&this.onMove(e,t)},end:function(e,t){this.state.isRunning&&(this.onEnd(e,t),this.state.isRunning=!1)},cancel:function(e,t){this.onCancel(e,t),this.state={}},getNearestParent:function(e){for(var t=e;t;){if((t.$mdGesture||{})[this.name])return t;t=t.parentNode}return null},registerElement:function(e,t){function n(){delete e[0].$mdGesture[i.name],e.off("$destroy",n)}var i=this;return e[0].$mdGesture=e[0].$mdGesture||{},e[0].$mdGesture[this.name]=t||{},e.on("$destroy",n),n}},i}function a(e,t){function n(e,n){var i;for(var r in f)i=f[r],i instanceof t&&("start"===e&&i.cancel(),i[e](n,u))}function i(e){if(!u){var t=+Date.now();d&&!s(e,d)&&t-d.endTime<1500||(u=o(e),n("start",e))}}function r(e){u&&s(e,u)&&(c(e,u),n("move",e))}function a(e){u&&s(e,u)&&(c(e,u),u.endTime=+Date.now(),n("end",e),d=u,u=null)}document.contains||(document.contains=function(e){return document.body.contains(e)}),!g&&e.isHijackingClicks&&(document.addEventListener("click",function(e){var t=0===e.clientX&&0===e.clientY;t||e.$material||(e.preventDefault(),e.stopPropagation())},!0),g=!0);var l="mousedown touchstart pointerdown",p="mousemove touchmove pointermove",m="mouseup mouseleave touchend touchcancel pointerup pointercancel";angular.element(document).on(l,i).on(p,r).on(m,a).on("$$mdGestureReset",function(){d=u=null})}function o(e){var t=l(e),n={startTime:+Date.now(),target:e.target,type:e.type.charAt(0)};return n.startX=n.x=t.pageX,n.startY=n.y=t.pageY,n}function s(e,t){return e&&t&&e.type.charAt(0)===t.type}function c(e,t){var n=l(e),i=t.x=n.pageX,r=t.y=n.pageY;t.distanceX=i-t.startX,t.distanceY=r-t.startY,t.distance=Math.sqrt(t.distanceX*t.distanceX+t.distanceY*t.distanceY),t.directionX=t.distanceX>0?"right":t.distanceX<0?"left":"",t.directionY=t.distanceY>0?"up":t.distanceY<0?"down":"",t.duration=+Date.now()-t.startTime,t.velocityX=t.distanceX/t.duration,t.velocityY=t.distanceY/t.duration}function l(e){return e=e.originalEvent||e,e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0]||e}var u,d,f={},p=!1,g=!1;angular.module("material.core.gestures",[]).provider("$mdGesture",t).factory("$$MdGestureHandler",["$$rAF",r]).run(["$mdGesture","$$MdGestureHandler",a]),t.prototype={skipClickHijack:function(){return p=!0},$get:["$$MdGestureHandler","$$rAF","$timeout",function(e,t,i){return new n(e,t,i)}]}}(window.jQuery),function(){function e(){function e(e){function t(e){return a.optionsFactory=e.options,a.methods=(e.methods||[]).concat(r),o}function n(t,n){if(n=n||{},n.methods=n.methods||[],n.options=n.options||function(){return{}},/^cancel|hide|show$/.test(t))throw new Error("Preset '"+t+"' in "+e+" is reserved!");if(n.methods.indexOf("_options")>-1)throw new Error("Method '_options' in "+e+" is reserved!");return a.presets[t]={methods:n.methods.concat(r),optionsFactory:n.options,argOption:n.argOption},o}function i(t,n,i){function r(e){return e&&e._options&&(e=e._options),l.show(angular.extend({},c,e))}function o(t,n){var r={};return r[e]=u,i.invoke(t||function(){return n},{},r)}var s,c,l=t(),u={hide:l.hide,cancel:l.cancel,show:r};return s=a.methods||[],c=o(a.optionsFactory,{}),angular.forEach(a.presets,function(e,t){function n(e){this._options=angular.extend({},i,e)}var i=o(e.optionsFactory,{}),r=(e.methods||[]).concat(s);if(angular.extend(i,{$type:t}),angular.forEach(r,function(e){n.prototype[e]=function(t){return this._options[e]=t,this}}),e.argOption){var a="show"+t.charAt(0).toUpperCase()+t.slice(1);u[a]=function(e){var n=u[t](e);return u.show(n)}}u[t]=function(t){return arguments.length&&e.argOption&&!angular.isObject(t)&&!angular.isArray(t)?(new n)[e.argOption](t):new n(t)}}),u}var r=["onHide","onShow","onRemove"],a={presets:{}},o={setDefaults:t,addPreset:n,$get:i};return o.addPreset("build",{methods:["controller","controllerAs","resolve","template","templateUrl","themable","transformTemplate","parent"]}),i.$inject=["$$interimElement","$animate","$injector"],o}function t(e,t,n,i,r,a,o,s){function c(e){return e&&angular.isString(e)?e.replace(/\{\{/g,l).replace(/}}/g,u):e}var l=o.startSymbol(),u=o.endSymbol(),d="{{"===l&&"}}"===u,f=d?angular.identity:c;return function(){function o(e){e.zIndex=80+p.length;var t=new u(e);return p.unshift(t),t.show().then(function(){return t.deferred.promise})}function c(e,n){var i;return void 0!==n?(i=n,p.splice(p.indexOf(n),1)):i=p.shift(),i&&i.remove().then(function(){i.deferred.resolve(e)}),i?i.deferred.promise:t.when(e)}function l(e,n){var i;return void 0!==n?(i=n,p.splice(p.indexOf(n),1)):i=p.shift(),i&&i.remove().then(function(){i.deferred.reject(e)}),i?i.deferred.promise:t.reject(e)}function u(o){var c,l,u;return o=o||{},o=angular.extend({scope:o.scope||n.$new(o.isolateScope),onShow:function(e,t,n){return a.enter(t,n.parent)},onRemove:function(e,n,i){return n&&a.leave(n)||t.when()}},o),o.template&&(o.template=f(o.template)),c={options:o,deferred:t.defer(),show:function(){return s.compile(o).then(function(n){function a(){o.hideDelay&&(l=i(d.cancel,o.hideDelay))}angular.extend(n.locals,c.options),angular.isString(o.parent)?o.parent=angular.element(e[0].querySelector(o.parent)):o.parent||(o.parent=r.find("body"),o.parent.length||(o.parent=r)),u=n.link(o.scope),u.css("z-index",o.zIndex);var s=o.onShow(o.scope,u,o);return t.when(s).then(function(){(o.onComplete||angular.noop)(o.scope,u,o),a()})})},cancelTimeout:function(){l&&(i.cancel(l),l=void 0)},remove:function(){c.cancelTimeout();var e=o.onRemove(o.scope,u,o);return t.when(e).then(function(){o.scope.$destroy()})}},o.interimElement=c,o.stack=p,c}var d,p=[];return d={show:o,hide:c,cancel:l}}}return e.$get=t,t.$inject=["$document","$q","$rootScope","$timeout","$rootElement","$animate","$interpolate","$mdCompiler"],e}angular.module("material.core").provider("$$interimElement",e)}(),function(){function e(){function e(e){function t(e){return a.optionsFactory=e.options,a.methods=(e.methods||[]).concat(r),o}function n(t,n){if(n=n||{},n.methods=n.methods||[],n.options=n.options||function(){return{}},/^cancel|hide|show$/.test(t))throw new Error("Preset '"+t+"' in "+e+" is reserved!");if(n.methods.indexOf("_options")>-1)throw new Error("Method '_options' in "+e+" is reserved!");return a.presets[t]={methods:n.methods.concat(r),optionsFactory:n.options,argOption:n.argOption},o}function i(t,n,i){function r(e){return e&&e._options&&(e=e._options),l.show(angular.extend({},c,e))}function o(t,n){var r={};return r[e]=u,i.invoke(t||function(){return n},{},r)}var s,c,l=t(),u={hide:l.hide,cancel:l.cancel,show:r};return s=a.methods||[],c=o(a.optionsFactory,{}),angular.forEach(a.presets,function(e,t){function n(e){this._options=angular.extend({},i,e)}var i=o(e.optionsFactory,{}),r=(e.methods||[]).concat(s);if(angular.extend(i,{$type:t}),angular.forEach(r,function(e){n.prototype[e]=function(t){return this._options[e]=t,this}}),e.argOption){var a="show"+t.charAt(0).toUpperCase()+t.slice(1);u[a]=function(e){var n=u[t](e);return u.show(n)}}u[t]=function(t){return arguments.length&&e.argOption&&!angular.isObject(t)&&!angular.isArray(t)?(new n)[e.argOption](t):new n(t)}}),u}var r=["onHide","onShow","onRemove"],a={presets:{}},o={setDefaults:t,addPreset:n,$get:i};return o.addPreset("build",{methods:["controller","controllerAs","resolve","template","templateUrl","themable","transformTemplate","parent"]}),i.$inject=["$$interimStackableElement","$animate","$injector"],o}function t(e,t,n,i,r,a,o,s){function c(e){return e&&angular.isString(e)?e.replace(/\{\{/g,l).replace(/}}/g,u):e}var l=o.startSymbol(),u=o.endSymbol(),d="{{"===l&&"}}"===u,f=d?angular.identity:c;return function(){function o(e){e.zIndex=80+p.length;var t=new u(e);return p.unshift(t),t.show().then(function(){return t.deferred.promise})}function c(e,n){var i;return void 0!==n?(i=n,p.splice(p.indexOf(n),1)):i=p.shift(),i&&i.remove().then(function(){i.deferred.resolve(e)}),i?i.deferred.promise:t.when(e)}function l(e,n){var i;return void 0!==n?(i=n,p.splice(p.indexOf(n),1)):i=p.shift(),i&&i.remove().then(function(){i.deferred.reject(e)}),i?i.deferred.promise:t.reject(e)}function u(o){var c,l,u;return o=o||{},o=angular.extend({scope:o.scope||n.$new(o.isolateScope),onShow:function(e,t,n){return a.enter(t,n.parent)},onRemove:function(e,n,i){return n&&a.leave(n)||t.when()}},o),o.template&&(o.template=f(o.template)),c={options:o,deferred:t.defer(),show:function(){return s.compile(o).then(function(n){function a(){o.hideDelay&&(l=i(d.cancel,o.hideDelay))}angular.extend(n.locals,c.options),angular.isString(o.parent)?o.parent=angular.element(e[0].querySelector(o.parent)):o.parent||(o.parent=r.find("body"),o.parent.length||(o.parent=r)),u=n.link(o.scope),u.css("z-index",o.zIndex);var s=o.onShow(o.scope,u,o);return t.when(s).then(function(){(o.onComplete||angular.noop)(o.scope,u,o),a()})})},cancelTimeout:function(){l&&(i.cancel(l),l=void 0)},remove:function(){c.cancelTimeout();var e=o.onRemove(o.scope,u,o);return t.when(e).then(function(){o.scope.$destroy()})}},o.interimElement=c,o.stack=p,c}var d,p=[];return d={show:o,hide:c,cancel:l}}}return e.$get=t,t.$inject=["$document","$q","$rootScope","$timeout","$rootElement","$animate","$interpolate","$mdCompiler"],e}angular.module("material.core").provider("$$interimStackableElement",e)}(),function(){function e(e,t){function n(e){return e&&""!==e}var i,r=[],a={};return i={notFoundError:function(t){e.error("No instance found for handle",t)},getInstances:function(){return r},get:function(e){if(!n(e))return null;var t,i,a;for(t=0,i=r.length;i>t;t++)if(a=r[t],a.$$mdHandle===e)return a;return null},register:function(e,t){function n(){var t=r.indexOf(e);-1!==t&&r.splice(t,1)}function i(){var n=a[t];n&&(n.resolve(e),delete a[t])}return t?(e.$$mdHandle=t,r.push(e),i(),n):angular.noop},when:function(e){if(n(e)){var r=t.defer(),o=i.get(e);return o?r.resolve(o):a[e]=r,r.promise}return t.reject("Invalid `md-component-id` value.")}}}angular.module("material.core").factory("$mdComponentRegistry",e),e.$inject=["$log","$q"]}(),function(){function e(e,t){return{controller:angular.noop,link:function(t,n,i){i.hasOwnProperty("mdInkRippleCheckbox")?e.attachCheckboxBehavior(t,n):e.attachButtonBehavior(t,n)}}}function t(e,t,n){function i(e,t,n){return o(e,t,angular.extend({isFAB:t.hasClass("md-fab"),isMenuItem:t.hasClass("md-menu-item"),center:!1,dimBackground:!0},n))}function r(e,t,n){return o(e,t,angular.extend({center:!0,dimBackground:!1,fitRipple:!0},n))}function a(e,t,n){return o(e,t,angular.extend({center:!1,dimBackground:!0,outline:!0},n))}function o(e,i,r){function a(e){if(o()){var n="ripple-animation";if(s&&e.target){var r=$(e.target),a=!1;if(angular.forEach(s,function(e){(r.is(e)||r.parent().is(e))&&(a=!0)}),a)return}c=!0;var l={};l.style={top:"0",left:"0"};var u=angular.element('<div class="ripple-active"></div>');u.css(l.style),i[0].hasAttribute("ripple-dark")?u.addClass("ripple-dark"):i[0].hasAttribute("ripple-light")&&u.addClass("ripple-light"),i.append(u);var d=i[0].hasAttribute("md-ink-ripple-action")||i[0].hasAttribute("ripple-action");if(d)l.style={top:"0px",left:"0px",height:i.outerWidth()+"px",width:i.outerWidth()+"px"},n+=" ripple-action";else if(i[0].hasAttribute("md-ink-ripple-switch"))l.style={top:"-14px",left:"-14px",height:"48px",width:"48px"};else{var f=i.width(),p=i.height(),g=i[0].getBoundingClientRect(),m=2*Math.round(Math.sqrt(f*f+p*p));m>2e3&&(m=2e3);var h=-(m/2);l.style={top:e.clientY-g.top,left:e.clientX-g.left,height:m,width:m,"margin-top":h,"margin-left":h}}u.css(l.style),t(function(){u.addClass(n),u.oneAnimationEnd(function(){u.remove()})},0,!1)}}function o(){function e(e){return e&&e.hasAttribute&&e.hasAttribute("disabled")}var t=l.parentNode,n=t&&t.parentNode,i=n&&n.parentNode;return!(e(l)||e(t)||e(n)||e(i))}if(i.controller("mdNoInk"))return angular.noop;var s=i.attr("md-ink-ripple-ignore");s=s?n(s)(e):void 0,r=angular.extend({colorElement:i,mousedown:!0,hover:!0,focus:!0,center:!1,mousedownPauseTime:150,dimBackground:!1,outline:!1,isFAB:!1,isMenuItem:!1,fitRipple:!1},r);var c=(i.controller("mdInkRipple")||{},i.attr("md-highlight"),!1),l=i[0],u=i.attr("md-ripple-size");switch(u){case"full":r.isFAB=!0;break;case"partial":r.isFAB=!1}return i.addClass("ripple-presence"),r.mousedown&&i.on("$md.pressdown",a),function(){i.off("$md.pressdown",a),i.removeClass("ripple-presence")}}return{attachButtonBehavior:i,attachCheckboxBehavior:r,attachTabBehavior:a,attach:o}}function n(){return function(){return{controller:angular.noop}}}angular.module("material.core").factory("$mdInkRipple",t).directive("mdInkRipple",e).directive("mdNoInk",n()).directive("mdNoBar",n()).directive("mdNoStretch",n()),e.$inject=["$mdInkRipple","$parse"],t.$inject=["$window","$timeout","$parse"]}()}(),function(){function e(e){function t(e,t,n){}function n(t,n,i){var r=this;r.isErrorGetter=i.mdIsError&&e(i.mdIsError),r.element=n,r.setFocused=function(e){n.toggleClass("md-input-focused",!!e)},r.setHasValue=function(e){n.toggleClass("md-input-has-value",!!e)},r.setNoFloat=function(e){n.toggleClass("md-input-no-float",!!e)},r.setInvalid=function(e){n.toggleClass("md-input-invalid",!!e)},t.$watch(function(){return r.label&&r.input},function(e){e&&!r.label.attr("for")&&r.label.attr("for",r.input.attr("id"))})}return n.$inject=["$scope","$element","$attrs"],{restrict:"E",link:t,controller:n}}function t(){return{restrict:"E",require:"^?mdInputContainer",link:function(e,t,n,i){i&&(i.label=t,e.$on("$destroy",function(){i.label=null}))}}}function n(e,t,n,i){function r(t,n,i,r){function a(e){return s.setHasValue(!c.$isEmpty(e)),e}function o(){s.setHasValue(n.val().length>0||(n[0].validity||{}).badInput)}var s=r[0],c=r[1]||e.fakeNgModel(),l=angular.isDefined(i.readonly);if(s){if(s.input)throw new Error("<md-input-container> can only have *one* <input> or <textarea> child element!");s.input=n,n.addClass("md-input"),n.attr("id")||n.attr("id","input_"+e.nextUid());var u=s.isErrorGetter||function(){return c.$invalid&&(c.$dirty||c.$touched)};t.$watch(u,s.setInvalid),c.$parsers.push(a),c.$formatters.push(a),n.on("input",o),l||n.on("focus",function(e){s.setFocused(!0)}).on("blur",function(e){s.setFocused(!1),o()}),t.$on("$destroy",function(){s.setFocused(!1),s.setHasValue(!1),s.input=null})}}return{restrict:"E",require:["^?mdInputContainer","?ngModel"],link:r}}function i(e){function t(t,n,i,r){function a(e){return l.text((n.val()||e||"").length+"/"+o),e}var o,s=r[0],c=r[1],l=angular.element('<div class="md-char-counter">');i.$set("ngTrim","false"),c.element.append(l),s.$formatters.push(a),s.$viewChangeListeners.push(a),n.on("input keydown",function(){a()}),t.$watch(i.mdMaxlength,function(t){o=t,angular.isNumber(t)&&t>0?(l.parent().length||e.enter(l,c.element,angular.element(c.element[0].lastElementChild)),a()):e.leave(l)}),s.$validators["md-maxlength"]=function(e,t){return!angular.isNumber(o)||0>o?!0:(e||n.val()||t||"").length<=o}}return{restrict:"A",require:["ngModel","^mdInputContainer"],link:t}}function r(){function e(e,t,n,i){if(i&&!t[0].hasAttribute("native-placeholder")){var r=n.placeholder;t.removeAttr("placeholder"),i.element.append('<div class="md-placeholder">'+r+"</div>")}}return{restrict:"A",require:"^^?mdInputContainer",link:e}}angular.module("material.components.input",["material.core"]).directive("mdInputContainer",e).directive("label",t).directive("input",n).directive("textarea",n).directive("mdMaxlength",i).directive("placeholder",r),e.$inject=["$parse"],n.$inject=["$mdUtil","$window","$compile","$animate"],i.$inject=["$animate"]}(),function(){"use strict";function e(e,t){function n(n,i,r,a){function o(n){switch(n.keyCode){case t.KEY_CODE.LEFT_ARROW:case t.KEY_CODE.UP_ARROW:n.preventDefault(),s.selectPrevious();break;case t.KEY_CODE.RIGHT_ARROW:case t.KEY_CODE.DOWN_ARROW:n.preventDefault(),s.selectNext();break;case t.KEY_CODE.ENTER:var r=angular.element(e.getClosest(i[0],"form"));r.length>0&&r.triggerHandler("submit")}}var s=a[0],c=a[1]||e.fakeNgModel();s.init(c),i.attr({role:"radiogroup",tabIndex:i.attr("tabindex")||"0"}).on("keydown",o)}function i(e){this._radioButtonRenderFns=[],this.$element=e}function r(){return{init:function(e){this._ngModelCtrl=e,this._ngModelCtrl.$render=angular.bind(this,this.render)},add:function(e){this._radioButtonRenderFns.push(e)},remove:function(e){var t=this._radioButtonRenderFns.indexOf(e);-1!==t&&this._radioButtonRenderFns.splice(t,1)},render:function(){this._radioButtonRenderFns.forEach(function(e){e()})},setViewValue:function(e,t){this._ngModelCtrl.$setViewValue(e,t),this.render()},getViewValue:function(){return this._ngModelCtrl.$viewValue},selectNext:function(){return a(this.$element,1)},selectPrevious:function(){return a(this.$element,-1)},setActiveDescendant:function(e){this.$element.attr("aria-activedescendant",e)}}}function a(t,n){var i=e.iterator(Array.prototype.slice.call(t[0].querySelectorAll("md-radio-button")),!0);if(i.count()){var r=function(e){return!angular.element(e).attr("disabled")},a=t[0].querySelector("md-radio-button.md-checked"),o=i[0>n?"previous":"next"](a,r)||i.first();angular.element(o).triggerHandler("click")}}return i.prototype=r(),{restrict:"E",controller:["$element",i],require:["mdRadioGroup","?ngModel"],link:{pre:n}}}function t(e,t){function n(n,r,a,o){function s(e){r[0].hasAttribute("disabled")||n.$apply(function(){o.setViewValue(a.value,e&&e.type)})}function c(){var e=o.getViewValue()==a.value;e!==u&&(u=e,r.attr("aria-checked",e),e?(r.addClass(i),o.setActiveDescendant(r.attr("id"))):r.removeClass(i))}function l(n,i){function r(){return a.id||"radio_"+t.nextUid()}i.ariaId=r(),n.attr({id:i.ariaId,role:"radio","aria-checked":"false"}),e.expectWithText(n,"aria-label")}var u;l(r,n),o.add(c),a.$observe("value",c),r.on("click",s).on("$destroy",function(){o.remove(c)})}var i="md-checked";return{restrict:"E",require:"^mdRadioGroup",transclude:!0,template:'<div class="md-container list-primary-tile"><div class="avatar-small"><div><icon class="button-square" type="toggle.radio-button-on"></icon><icon class="button-square" type="toggle.radio-button-off"></icon></div></div></div><div ng-transclude class="md-label"></div>',link:n}}angular.module("material.components.radioButton",["material.core"]).directive("mdRadioGroup",e).directive("mdRadioButton",t),e.$inject=["$mdUtil","$mdConstant"],t.$inject=["$mdAria","$mdUtil"]}(),function(){"use strict";function e(e,t){return function(n){var i="SideNav '"+n+"' is not available!",r=e.get(n);return r||e.notFoundError(n),{isOpen:function(){return r&&r.isOpen()},isLockedOpen:function(){return r&&r.isLockedOpen()},toggle:function(){return r?r.toggle():t.reject(i)},open:function(){return r?r.open():t.reject(i)},close:function(){return r?r.close():t.reject(i)}}}}function t(e,t,n,i,r,a,o,s,c){function l(r,l,u,d){function f(e,n){r.isLockedOpen=e,e===n?l.toggleClass("md-locked-open",!!e):t[e?"addClass":"removeClass"](l,"md-locked-open"),x.toggleClass("md-locked-open",!!e)}function p(n){if(_)return void(_=!1);var i=(l.parent(),[]);x[n?"on":"off"]("click",function(t){var n=this;e(function(){h.apply(n,t)})}),c[n?"queue":"dequeue"](m),n&&(v=s[0].activeElement),l.before(x);var a=function(){r.isOpen&&l.focus(),b=!1},u=function(){r.isOpen||x.remove()};return n?(l.removeClass("invisible out"),x.removeClass("out"),i.push(t.addClass(x,"in").then(u)),i.push(t.addClass(l,"in").then(a))):(l.removeClass("in"),x.removeClass("in"),i.push(t.addClass(x,"out").then(u)),i.push(t.addClass(l,"out").then(a))),y=o.all(i)}function g(t){if(r.isOpen==t||b)return o.when(!0);b=!0;var n=o.defer();return r.isOpen=t,e(function(){y.then(function(e){r.isOpen||(v&&v.focus(),v=null),t&&C(),n.resolve(e)})},0,!1),n.promise}function m(t){return e(function(){h(t)}),!0}function h(e){return e&&(e.preventDefault(),e.stopPropagation()),d.close()}var v=null,y=o.when(!0),b=!1,_=!0,w=n(u.mdIsLockedOpen),k=function(){return w(r.$parent,{$media:i})},x=a('<md-backdrop class="md-sidenav-backdrop md-opaque fade">')(r);l.on("$destroy",d.destroy);var A=l.css("width"),C=function(){var e=$(window).width()-56;return e>A?void l.css({width:"","min-width":""}):void(l.width()>e&&l.css({width:e,"min-width":e}))};C(),r.$watch(k,f),r.$watch("isOpen",p),r.$on("$destroy",function(){$(window).off("resize",C)}),d.$toggleOpen=g}return{restrict:"E",scope:{isOpen:"=?mdIsOpen",componentID:"=?mdComponentId"},controller:"$mdSidenavController",compile:function(e){return e.addClass("md-closed slide drawer out invisible"),e.attr("tabIndex","-1"),l}}}function n(e,t,n,i,r,a){var o=this;o.$toggleOpen=function(){return r.when(e.isOpen)},o.isOpen=function(){return!!e.isOpen},o.isLockedOpen=function(){return!!e.isLockedOpen},o.open=function(){return o.$toggleOpen(!0)},o.close=function(){return o.$toggleOpen(!1)},o.toggle=function(){return o.$toggleOpen(!e.isOpen)},o.destroy=i.register(o,e.componentID||n.mdComponentId)}angular.module("material.components.sidenav",["material.core"]).factory("$mdSidenav",e).directive("mdSidenav",t).controller("$mdSidenavController",n),e.$inject=["$mdComponentRegistry","$q"],t.$inject=["$timeout","$animate","$parse","$mdMedia","$mdConstant","$compile","$q","$document","mdContextualMonitor"],n.$inject=["$scope","$element","$attrs","$mdComponentRegistry","$q","$parse"]}(),function(){"use strict";function e(e,t){var n=[],i=!1,r=1,a=function(){return r+=1},o=function(){!n.length&&window.location.hash.length&&(window.location.hash="",r=1)},s=function(e){var t=n.pop(),i=t&&t(e);return!i&&t&&n.push(t),o(),i};return{dequeue:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),o()},queue:function(r){var o="context-monitor-",c=window.location.hash,l=a();i||(e.on("keyup",function(e){e.keyCode===t.KEY_CODE.ESCAPE&&(s(e)||e.preventDefault())}),$(window).bind("hashchange",function(e){var t,n=window.location.hash,i=parseInt(n.substr(o.length+1),10),r=parseInt(c.substr(o.length+1),10);(isNaN(i)||!isNaN(r)&&r>i)&&(t=!0),c=n,t&&(s()||e.preventDefault())}),i=!0),window.location.hash=o+l,n.push(r)}}}function t(e){return{restrict:"E"}}function n(e){function t(e,t,n,i,r,a,o,s,c,l,u,d){function f(e){return"simple-dialog"}function p(e,t){}function g(t,n,r){function a(){var e=n[0].querySelector(".dialog-close");if(!e){var t=n[0].querySelectorAll(".md-actions button");e=t[t.length-1]}return angular.element(e)}r.parent=angular.element(r.parent),r.popInTarget=angular.element(r.popFrom);var o=a(),s=f(r),c=n.find(s);return h(c),r.disableScrollInfo=[],r.disableScroll||(r.disableScroll=[]),r.disableParentScroll&&r.disableScroll.push(r.parent),angular.forEach(r.disableScroll,function(e){r.disableScrollInfo.push({old:{"overflow-y":e.css("overflow-y"),"overflow-x":e.css("overflow-x")},element:e}),e.css("overflow","hidden"),e.css("overflow-wrap","normal"===e.css("overflow-wrap")?"break-word":"normal")}),r.hasBackdrop&&(r.backdrop=angular.element('<md-backdrop class="simple-dialog-backdrop" style="z-index: '+r.zIndex+'">'),i.enter(r.backdrop,r.parent)),c.css("z-index",r.zIndex+1),v(n,r).then(function(){r.rootElementKeyupCallback=function(){return 0===r.stack.indexOf(r.interimElement)&&e(function(){u.cancel("esc",r.interimElement)}),!0},d.queue(r.rootElementKeyupCallback),r.clickOutsideToClose&&(r.dialogClickOutsideCallback=function(t){t.target===r.backdrop[0]&&e(u.cancel)},r.backdrop.on("click",r.dialogClickOutsideCallback)),o.focus()})}function m(e,t,n){return n.clickOutsideToClose&&n.backdrop&&n.backdrop.off("click",n.dialogClickOutsideCallback),n.backdrop&&i.leave(n.backdrop),angular.forEach(n.disableScrollInfo,function(e){e.element.css(e.old),e.element.css("overflow-wrap","normal"===e.element.css("overflow-wrap")?"break-word":"normal")}),n.disableScrollInfo=[],a[0].removeEventListener("scroll",n.captureScroll,!0),d.dequeue(n.rootElementKeyupCallback),$(t,n).then(function(){n.scope.$destroy(),t.remove(),n.popInTarget&&n.popInTarget.focus()})}function h(e){e.attr({role:"dialog"});var t=e.find("md-content");0===t.length&&(t=e),r.expectAsync(e,"aria-label",function(){var e=t.text().split(/\s+/);return e.length>3&&(e=e.slice(0,3).concat("...")),e.join(" ")})}function v(e,t){p(e,t);var n,i,r=e.find(f(t)),a=t.parent,o=l.defer();return a.append(e),n=o.promise,i=n.then(function(){var e,n=l.defer(),i=n.promise;return t.onBeforeShow&&(e=t.onBeforeShow(r,t),e&&e.then)?e:(n.resolve(),i)}),o.resolve(),i}function y(e){function t(i){i.target===e[0]&&(e.off(s.CSS.TRANSITIONEND,t),n.resolve())}var n=l.defer();return e.on(s.CSS.TRANSITIONEND,t),n.promise}function $(e,t){p(e,t);var n,i,r=e.find(f(t));return t.onBeforeHide&&t.onBeforeHide(r,t),r.hasClass("fade")?(i=l.defer(),r.oneAnimationEnd(function(){i.resolve()}),r.removeClass("in").addClass("out"),n=i.promise):(n=y(r),n.then(function(){t.onAfterHide&&t.onAfterHide(r,t)}),r.removeClass("transition-in").addClass("transition-out"),setTimeout(function(){r.addClass("opacity-out")},50)),n}return{hasBackdrop:!0,isolateScope:!0,onShow:g,onRemove:m,clickOutsideToClose:!0,popFrom:null,disableParentScroll:!0,transformTemplate:function(e){return'<div class="simple-dialog-container">'+e+"</div>"}}}return t.$inject=["$timeout","$rootElement","$compile","$animate","$mdAria","$document","$mdUtil","$mdConstant","$$rAF","$q","$simpleDialog","mdContextualMonitor"],e("$simpleDialog").setDefaults({methods:["disableParentScroll","hasBackdrop","clickOutsideToClose","popFrom"],options:t})}angular.module("material.components.simpledialog",["material.core"]).factory("mdContextualMonitor",e).directive("simpleDialog",t).provider("$simpleDialog",n),e.$inject=["$rootElement","$mdConstant"],t.$inject=["$$rAF"],n.$inject=["$$interimElementProvider"]}(),function(){"use strict";var e=angular.module("material.components.swipe",[]);["SwipeLeft","SwipeRight"].forEach(function(t){var n="md"+t,i="$md."+t.toLowerCase();e.directive(n,["$parse",function(e){function t(t,r,a){var o=e(a[n]);r.on(i,function(e){t.$apply(function(){o(t,{$event:e})})})}return{restrict:"A",link:t}}])})}(),function(){"use strict";function e(e,t,n){return{restrict:"E",replace:!0,scope:{fid:"@?mdFid",label:"@?",value:"=ngModel"},compile:function(i,r){return n.warn("<md-text-float> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer"),angular.isUndefined(r.mdFid)&&(r.mdFid=e.nextUid()),{pre:function(e,n,i){var r=t(i.ngDisabled);e.isDisabled=function(){return r(e.$parent)},e.inputType=i.type||"text"}}},template:'<md-input-group tabindex="-1"> <label for="{{fid}}" >{{label}}</label> <md-input id="{{fid}}" ng-disabled="isDisabled()" ng-model="value" type="{{inputType}}"></md-input></md-input-group>'
}}function t(e){return{restrict:"CE",controller:["$element",function(t){e.warn("<md-input-group> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer"),this.setFocused=function(e){t.toggleClass("md-input-focused",!!e)},this.setHasValue=function(e){t.toggleClass("md-input-has-value",e)}}]}}function n(e,t){return{restrict:"E",replace:!0,template:"<input >",require:["^?mdInputGroup","?ngModel"],link:function(e,n,i,r){function a(e){return e=angular.isUndefined(e)?n.val():e,angular.isDefined(e)&&null!==e&&""!==e.toString().trim()}if(r[0]){t.warn("<md-input> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer");var o=r[0],s=r[1];e.$watch(e.isDisabled,function(e){n.attr("aria-disabled",!!e),n.attr("tabindex",!!e)}),n.attr("type",i.type||n.parent().attr("type")||"text"),s&&s.$formatters.push(function(e){return o.setHasValue(a(e)),e}),n.on("input",function(){o.setHasValue(a())}).on("focus",function(e){o.setFocused(!0)}).on("blur",function(e){o.setFocused(!1),o.setHasValue(a())}),e.$on("$destroy",function(){o.setFocused(!1),o.setHasValue(!1)})}}}}angular.module("material.components.textField",["material.core"]).directive("mdInputGroup",t).directive("mdInput",n).directive("mdTextFloat",e),e.$inject=["$mdUtil","$parse","$log"],t.$inject=["$log"],n.$inject=["$mdUtil","$log"]}(),function(){"use strict";angular.module("app").factory("snackbar",["GLOBAL_CONFIG",function(e){var t={show:$.noop,hide:$.noop,showK:function(n){var i=e.snackbar.messages[n];return angular.isUndefined(i)&&(i=n),t.show(i)}};return e.debug&&(window._snackbar=t),t}]).directive("qsnackbar",["snackbar",function(e){return{link:function(t,n){var i=function(){e.hide()};n.on("click",i),t.$on("$destroy",function(){n.off("click",i)})}}}]).directive("ngClick",["snackbar",function(e){return{restrict:"A",priority:100,link:function(t,n,i){var r=function(){e.hide()};n.on("click",r),t.$on("$destroy",function(){n.off("click",r)})}}}]).directive("snackbar",["snackbar","$timeout","$animate","$q",function(e,t,n,i){return{scope:!0,require:"snackbar",templateUrl:"core/snackbar/view.html",controller:["$scope",function(t){var r,a=function(){t.$$phase||t.$digest()};t.message="",t.size=1,t.element=null,e.hide=function(){var e=i.defer();return t.element.removeClass("in"),t.element.hasClass("out")?e.resolve():(n.addClass(t.element,"out").then(function(){e.resolve()}),a()),e.promise},e.show=function(i){return angular.isObject(i)||(i={message:i}),t.message=i.message,i.size||(i.size=1),i.hideAfter||(i.hideAfter=t.message.length/16*1e3+500),t.size=i.size,a(),e.hide().then(function(){return n.removeClass(t.element,"out"),n.addClass(t.element,"in").then(function(){i.hideAfter&&(r&&clearTimeout(r),r=setTimeout(function(){e.hide()},i.hideAfter))})})}}],link:function(e,t,n){e.element=t.find(".snackbar")}}}])}(),function(){"use strict";function e(e,t,n){return{restrict:"E",controller:angular.noop,link:function(i,r,a){function o(){function o(t,n){r.parent()[0]===n.parent()[0]&&(u&&u.off("scroll",g),n.on("scroll",g),n.attr("scroll-shrink","true"),u=n,e(s))}function s(){l=r.prop("offsetHeight"),u.css("margin-top",-l*p+"px"),c()}function c(e){var n=e?e.target.scrollTop:f;m(),d=Math.min(l/p,Math.max(0,d+n-f)),r.css(t.CSS.TRANSFORM,"translate3d(0,"+-d*p+"px,0)"),u.css(t.CSS.TRANSFORM,"translate3d(0,"+(l-d)*p+"px,0)"),f=n}var l,u,d=0,f=0,p=a.mdShrinkSpeedFactor||.5,g=e.throttle(c),m=n.debounce(s,5e3);i.$on("$mdContentLoaded",o)}angular.isDefined(a.mdScrollShrink)&&o()}}}angular.module("material.components.toolbar",["material.core","material.components.content"]).directive("mdToolbar",e).run(["helpers","GLOBAL_CONFIG",function(e,t){angular.isUndefined(e.toolbar)&&(e.toolbar={}),$.extend(e.toolbar,{title:function(e,n){var i,r=t.toolbar.titles,a=[],o=r[e];return n||(n=" / "),angular.isDefined(o)?angular.isArray(o)?o.join(n):o:(i=angular.isArray(e)?e:e.split("."),angular.forEach(i,function(e,t){var n=r[e];n!==!1&&a.push(angular.isDefined(n)?n:e)}),a.length?a.join(n):e)},buildTitle:function(t){var n=[];return angular.forEach(t,function(e){n.push(e())}),e.toolbar.title(n.join("."))},makeTitle:function(e){return _.string.capitalize(_.string.camelize(e))}})}]),e.$inject=["$$rAF","$mdConstant","$mdUtil"]}(),function(){"use strict";angular.module("app").directive("actionDropdownList",function(){return{templateUrl:"core/action/dropdown_list.html",transclude:!0,replace:!0}}).directive("actionDropdown",["$simpleDialog","$$rAF","$mdConstant","underscoreTemplate","$timeout","$parse","$q","helpers",function(e,t,n,i,r,a,o,s){return{replace:!0,transclude:!0,templateUrl:"core/action/dropdown.html",scope:!0,link:function(n,i,a){var s={},c=n.$eval(a.template);c&&(s.opened=!1,s.open=function(e){s.opened||(s.opened=!0,r(function(){s.openSimpleDialog(e)}))},s.openSimpleDialog=function(r){e.show({templateUrl:c,popFrom:r.target,parent:i.parents(a.parent),onBeforeHide:function(e,t){$(window).off("resize",t.resize)},onBeforeShow:function(e,n){var r=o.defer(),a=r.promise,c=function(){var o=i;return n.resize=function(){var t=o.offset(),i=n.parent,r=parseInt(i.css("padding-top"),10)||24,a=parseInt(i.css("padding-bottom"),10)||24,s=t.top,c=t.left-(e.width()-o.outerWidth())-12,l=i.height()-(a+r),u=i.width()-e.width()-16;s=t.top,16>s&&(s=16),16>c&&(c=16),c>u&&(c=u),e.css({top:s,left:c}),e.height()>l&&e.height(l)},n.resize(),$(window).on("resize",n.resize),t(function(){e.addClass("fade in")}),e.oneAnimationEnd(function(){i.addClass("opacity-in"),r.resolve()}),a};t(c),e.on("click",s.close)},controller:["$scope",function(e){e.parent=n,e.$on("$destroy",function(){s.opened=!1})}]})},s.close=function(){e.hide()},n.dropdown=s)}}}]).directive("actionToolbar",function(){return{transclude:!0,replace:!0,scope:!0,templateUrl:"core/action/toolbar.html",link:function(e,t,n){e.spec=e.$eval(n.spec)}}})}(),function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){function i(e,t,n){for(var i=e[n],r=t(i);n>0;){var a=Math.floor((n+1)/2)-1,o=e[a];if(r>=t(o))break;e[a]=i,e[n]=o,n=a}}function r(e,t,n){for(var i=e.length,r=e[n],a=t(r);;){var o=2*(n+1),s=o-1,c=null;if(i>s){var l=e[s],u=t(l);a>u&&(c=s)}if(i>o){var d=e[o],f=t(d);f<(null===c?a:t(e[s]))&&(c=o)}if(null===c)break;e[n]=e[c],e[c]=r,n=c}}function a(e){if(e&&!angular.isFunction(e))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");e=e||function(e){return e},this.weightFunc=e,this.heap=[]}function o(){this.$get=function(){return a}}a.prototype.push=function(e){this.heap.push(e),i(this.heap,this.weightFunc,this.heap.length-1)},a.prototype.peek=function(){return this.heap[0]},a.prototype.pop=function(){var e=this.heap[0],t=this.heap.pop();return this.heap.length>0&&(this.heap[0]=t,r(this.heap,this.weightFunc,0)),e},a.prototype.remove=function(e){for(var t=this.heap.length,n=0;t>n;n++)if(angular.equals(this.heap[n],e)){var a=this.heap[n],o=this.heap.pop();return n!==t-1&&(this.heap[n]=o,i(this.heap,this.weightFunc,n),r(this.heap,this.weightFunc,n)),a}return null},a.prototype.removeAll=function(){this.heap=[]},a.prototype.size=function(){return this.heap.length},t.exports={DSBinaryHeapProvider:o,DSBinaryHeap:a}},{}],2:[function(e,t,n){t.exports=function(){clearInterval(this.$$cacheFlushIntervalId),clearInterval(this.$$recycleFreqId),this.removeAll(),this.$$storage&&(this.$$storage.removeItem(this.$$prefix+".keys"),this.$$storage.removeItem(this.$$prefix)),this.$$storage=null,this.$$data=null,this.$$lruHeap=null,this.$$expiresHeap=null,this.$$prefix=null}},{}],3:[function(e,t,n){var i=e("../utils");t.exports=function(e,t){var n=this;if(angular.isArray(e)){var r=e,a=[];return angular.forEach(r,function(e){var i=n.get(e,t);null!==i&&void 0!==i&&a.push(i)}),a}if(e=i.stringifyNumber(e),!this.$$disabled){if(t=t||{},!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof e);if(t&&!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof t);if(t.onExpire&&!angular.isFunction(t.onExpire))throw angular.$$minErr("ng")("areq","Expected options.onExpire to be a function! Found: {0}.",typeof t.onExpire);var o;if(this.$$storage){var s=this.$$storage.getItem(this.$$prefix+".data."+e);if(!s)return;o=angular.fromJson(s)}else{if(!(e in this.$$data))return;o=this.$$data[e]}var c=o.value,l=(new Date).getTime();return this.$$storage?(this.$$lruHeap.remove({key:e,accessed:o.accessed}),o.accessed=l,this.$$lruHeap.push({key:e,accessed:l})):(this.$$lruHeap.remove(o),o.accessed=l,this.$$lruHeap.push(o)),"passive"===this.$$deleteOnExpire&&"expires"in o&&o.expires<l?(this.remove(e),this.$$onExpire?this.$$onExpire(e,o.value,t.onExpire):t.onExpire&&t.onExpire(e,o.value),c=void 0):this.$$storage&&this.$$storage.setItem(this.$$prefix+".data."+e,o),c}}},{"../utils":21}],4:[function(e,t,n){function i(e,t){if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected storageMode to be a string! Found: {0}.",typeof e);if("memory"!==e&&"localStorage"!==e&&"sessionStorage"!==e)throw angular.$$minErr("ng")("areq",'Expected storageMode to be "memory", "localStorage" or "sessionStorage"! Found: {0}.',e);if(this.$$storageMode=e,t){if(!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected storageImpl to be an object! Found: {0}.",typeof t);if(!("setItem"in t&&"function"==typeof t.setItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "setItem(key, value)"! Found: {0}.',typeof t.setItem);if(!("getItem"in t&&"function"==typeof t.getItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "getItem(key)"! Found: {0}.',typeof t.getItem);if(!("removeItem"in t)||"function"!=typeof t.removeItem)throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "removeItem(key)"! Found: {0}.',typeof t.removeItem);this.$$storage=t}else if("localStorage"===this.$$storageMode)try{localStorage.setItem("angular-cache","angular-cache"),localStorage.removeItem("angular-cache"),this.$$storage=localStorage}catch(n){delete this.$$storage,this.$$storageMode="memory"}else if("sessionStorage"===this.$$storageMode)try{sessionStorage.setItem("angular-cache","angular-cache"),sessionStorage.removeItem("angular-cache"),this.$$storage=sessionStorage}catch(n){delete this.$$storage,this.$$storageMode="memory"}}function r(e,t){if(e=e||{},t=!!t,!angular.isObject(e))throw angular.$$minErr("ng")("areq","Expected cacheOptions to be an object! Found: {0}.",typeof e);"disabled"in e?this.$$disabled=!!e.disabled:t&&delete this.$$disabled,"capacity"in e?this.setCapacity(e.capacity):t&&this.setCapacity(null),"deleteOnExpire"in e?this.setDeleteOnExpire(e.deleteOnExpire):t&&this.setDeleteOnExpire(null),"maxAge"in e?this.setMaxAge(e.maxAge):t&&this.setMaxAge(null),"recycleFreq"in e?this.setRecycleFreq(e.recycleFreq):t&&this.setRecycleFreq(null),"cacheFlushInterval"in e?this.setCacheFlushInterval(e.cacheFlushInterval):t&&this.setCacheFlushInterval(null),"onExpire"in e?this.setOnExpire(e.onExpire):t&&this.setOnExpire(null)}function a(e,t){this.$$data={},this.$$id=e,this.$$storage=null,this.$$expiresHeap=new s(function(e){return e.expires}),this.$$lruHeap=new s(function(e){return e.accessed}),t=t||{},"storageMode"in t&&i.apply(this,[t.storageMode,t.storageImpl]),"storagePrefix"in t&&(this.$$storagePrefix=t.storagePrefix),this.$$prefix=this.$$storagePrefix+e,r.apply(this,[t,!0])}var o=e("../defaults"),s=e("../DSBinaryHeap").DSBinaryHeap;for(var c in o.defaults)a.prototype["$$"+c]=o.defaults[c];a.prototype.setOptions=r,a.prototype.setCapacity=e("./setCapacity"),a.prototype.setDeleteOnExpire=e("./setDeleteOnExpire"),a.prototype.setMaxAge=e("./setMaxAge"),a.prototype.setRecycleFreq=e("./setRecycleFreq"),a.prototype.setCacheFlushInterval=e("./setCacheFlushInterval"),a.prototype.setOnExpire=e("./setOnExpire"),a.prototype.put=e("./put"),a.prototype.get=e("./get"),a.prototype.remove=e("./remove"),a.prototype.removeAll=e("./removeAll"),a.prototype.removeExpired=e("./removeExpired"),a.prototype.destroy=e("./destroy"),a.prototype.info=e("./info"),a.prototype.keySet=e("./keySet"),a.prototype.keys=e("./keys"),a.prototype.disable=function(){this.$$disabled=!0},a.prototype.enable=function(){delete this.$$disabled},a.prototype.touch=function(e){if(e){var t=this,n=this.get(e,{onExpire:function(e,n){t.put(e,n)}});n&&this.put(e,n)}else for(var i=this.keys(),r=0;r<i.length;r++)this.touch(i[r])},t.exports=a},{"../DSBinaryHeap":1,"../defaults":19,"./destroy":2,"./get":3,"./info":5,"./keySet":6,"./keys":7,"./put":8,"./remove":9,"./removeAll":10,"./removeExpired":11,"./setCacheFlushInterval":12,"./setCapacity":13,"./setDeleteOnExpire":14,"./setMaxAge":15,"./setOnExpire":16,"./setRecycleFreq":17}],5:[function(e,t,n){t.exports=function(e){if(e){var t;if(this.$$storage){var n=this.$$storage.getItem(this.$$prefix+".data."+e);return n?(t=angular.fromJson(n),{created:t.created,accessed:t.accessed,expires:t.expires,isExpired:(new Date).getTime()-t.created>this.$$maxAge}):void 0}return e in this.$$data?(t=this.$$data[e],{created:t.created,accessed:t.accessed,expires:t.expires,isExpired:(new Date).getTime()-t.created>this.$$maxAge}):void 0}return{id:this.$$id,capacity:this.$$capacity,maxAge:this.$$maxAge,deleteOnExpire:this.$$deleteOnExpire,onExpire:this.$$onExpire,cacheFlushInterval:this.$$cacheFlushInterval,recycleFreq:this.$$recycleFreq,storageMode:this.$$storageMode,storageImpl:this.$$storage,disabled:this.$$disabled,size:this.$$lruHeap&&this.$$lruHeap.size()||0}}},{}],6:[function(e,t,n){var i=e("../utils");t.exports=function(){if(this.$$storage){var e=this.$$storage.getItem(this.$$prefix+".keys"),t={};if(e)for(var n=angular.fromJson(e),r=0;r<n.length;r++)t[n[r]]=n[r];return t}return i.keySet(this.$$data)}},{"../utils":21}],7:[function(e,t,n){var i=e("../utils");t.exports=function(){if(this.$$storage){var e=this.$$storage.getItem(this.$$prefix+".keys");return e?angular.fromJson(e):[]}return i.keys(this.$$data)}},{"../utils":21}],8:[function(e,t,n){var i=e("../utils");t.exports=function(e,t){var n=this;if(!this.$$disabled&&null!==t&&void 0!==t){if(t&&t.then,!1)return void t.then(function(t){angular.isObject(t)&&"status"in t&&"data"in t?n.put(e,[t.status,t.data,t.headers(),t.statusText]):n.put(e,t)});if(e=i.stringifyNumber(e),!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof e);var r=(new Date).getTime(),a={key:e,value:t,created:r,accessed:r};if(a.expires=a.created+this.$$maxAge,this.$$storage){var o=this.$$storage.getItem(this.$$prefix+".keys"),s=o?angular.fromJson(o):[],c=this.$$storage.getItem(this.$$prefix+".data."+e);c&&this.remove(e),this.$$expiresHeap.push({key:e,expires:a.expires}),this.$$lruHeap.push({key:e,accessed:a.accessed}),this.$$storage.setItem(this.$$prefix+".data."+e,a);for(var l=!1,u=0;u<s.length;u++)if(s[u]===e){l=!0;break}l||s.push(e),this.$$storage.setItem(this.$$prefix+".keys",s)}else this.$$data[e]&&this.remove(e),this.$$expiresHeap.push(a),this.$$lruHeap.push(a),this.$$data[e]=a;return this.$$lruHeap.size()>this.$$capacity&&this.remove(this.$$lruHeap.peek().key),t}}},{"../utils":21}],9:[function(e,t,n){t.exports=function(e){if(!this.$$storage){var t=this.$$data[e]?this.$$data[e].value:void 0;return this.$$lruHeap.remove(this.$$data[e]),this.$$expiresHeap.remove(this.$$data[e]),this.$$data[e]=null,delete this.$$data[e],t}var n=this.$$storage.getItem(this.$$prefix+".data."+e);if(n){var i=angular.fromJson(n);this.$$lruHeap.remove({key:e,accessed:i.accessed}),this.$$expiresHeap.remove({key:e,expires:i.expires}),this.$$storage.removeItem(this.$$prefix+".data."+e);var r=this.$$storage.getItem(this.$$prefix+".keys"),a=r?angular.fromJson(r):[],o=a.indexOf(e);return o>=0&&a.splice(o,1),this.$$storage.setItem(this.$$prefix+".keys",a),i.value}}},{}],10:[function(e,t,n){t.exports=function(){if(this.$$storage){this.$$lruHeap.removeAll(),this.$$expiresHeap.removeAll();var e=this.$$storage.getItem(this.$$prefix+".keys");if(e)for(var t=angular.fromJson(e),n=0;n<t.length;n++)this.remove(t[n]);this.$$storage.setItem(this.$$prefix+".keys",[])}else{this.$$lruHeap.removeAll(),this.$$expiresHeap.removeAll();for(var i in this.$$data)this.$$data[i]=null;this.$$data={}}}},{}],11:[function(e,t,n){t.exports=function(){for(var e,t,n=(new Date).getTime(),i={};(t=this.$$expiresHeap.peek())&&t.expires<n;)i[t.key]=t.value?t.value:null,this.$$expiresHeap.pop();if(this.$$storage)for(e in i){var r=this.$$storage.getItem(this.$$prefix+".data."+e);r&&(i[e]=angular.fromJson(r).value,this.remove(e))}else for(e in i)this.remove(e);if(this.$$onExpire)for(e in i)this.$$onExpire(e,i[e]);return i}},{}],12:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$cacheFlushInterval;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be greater than zero! Found: {0}.",e);e!==this.$$cacheFlushInterval&&(this.$$cacheFlushInterval=e,clearInterval(this.$$cacheFlushIntervalId),function(e){e.$$cacheFlushIntervalId=setInterval(function(){e.removeAll()},e.$$cacheFlushInterval)}(this))}}},{}],13:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$capacity;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected capacity to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected capacity to be greater than zero! Found: {0}.",e);this.$$capacity=e}for(var t={};this.$$lruHeap.size()>this.$$capacity;)t[this.$$lruHeap.peek().key]=this.remove(this.$$lruHeap.peek().key);return t}},{}],14:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$deleteOnExpire;else{if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected deleteOnExpire to be a string! Found: {0}.",typeof e);if("none"!==e&&"passive"!==e&&"aggressive"!==e)throw angular.$$minErr("ng")("areq",'Expected deleteOnExpire to be "none", "passive" or "aggressive"! Found: {0}.',e);this.$$deleteOnExpire=e}this.setRecycleFreq(this.$$recycleFreq)}},{}],15:[function(e,t,n){var i=e("../utils");t.exports=function(e){if(null===e)delete this.$$maxAge;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected maxAge to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected maxAge to be greater than zero! Found: {0}.",e);this.$$maxAge=e}var t,n,r;if(this.$$expiresHeap.removeAll(),this.$$storage){var a=this.$$storage.getItem(this.$$prefix+".keys");for(n=a?angular.fromJson(a):[],t=0;t<n.length;t++){r=n[t];var o=this.$$storage.getItem(this.$$prefix+".data."+r);if(o){var s=angular.fromJson(o);s.expires=this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:s.created+this.$$maxAge,this.$$expiresHeap.push({key:r,expires:s.expires})}}}else for(n=i.keys(this.$$data),t=0;t<n.length;t++)r=n[t],this.$$data[r].expires=this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:this.$$data[r].created+this.$$maxAge,this.$$expiresHeap.push(this.$$data[r]);return"aggressive"===this.$$deleteOnExpire?this.removeExpired():{}}},{"../utils":21}],16:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$onExpire;else{if(!angular.isFunction(e))throw angular.$$minErr("ng")("areq","Expected onExpire to be a function! Found: {0}.",typeof e);this.$$onExpire=e}}},{}],17:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$recycleFreq;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected recycleFreq to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected recycleFreq to be greater than zero! Found: {0}.",e);this.$$recycleFreq=e}clearInterval(this.$$recycleFreqId),"aggressive"===this.$$deleteOnExpire?!function(e){e.$$recycleFreqId=setInterval(function(){e.removeExpired()},e.$$recycleFreq)}(this):delete this.$$recycleFreqId}},{}],18:[function(e,t,n){function i(){var e=new r.Config;this.version=o,this.setCacheDefaults=function(t){if(t=t||{},!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof t);for(var n in r.defaults)n in t&&(e[n]=t[n]);"disabled"in t&&(e.$$disabled=!!t.disabled)},this.$get=function(){function t(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}function n(t,n){if(t in s)throw angular.$$minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",t);if(!angular.isString(t))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof t);return s[t]=new a(t,angular.extend({},e,n)),s[t].destroy=function(){this.constructor.prototype.destroy.call(this),delete s[this.$$id]},s[t]}function i(e,t){return n(e,t)}var s={};return i.createCache=n,i.version=o,i.info=function(){for(var n=t(s),i={size:n.length,caches:{}},a=0;a<n.length;a++){var o=n[a];i.caches[o]=s[o].info()}var c=i.cacheDefaults=angular.extend({},e);for(var l in r.defaults)l in c||(c[l]=e["$$"+l]);return i},i.get=function(e){if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof e);return s[e]},i.keySet=function(){var e,t={};for(e in s)s.hasOwnProperty(e)&&(t[e]=e);return t},i.keys=function(){return t(s)},i.destroyAll=function(){for(var e in s)s[e].destroy();s={}},i.clearAll=function(){for(var e in s)s[e].removeAll()},i.enableAll=function(){for(var e in s)s[e].$$disabled=!1},i.disableAll=function(){for(var e in s)s[e].$$disabled=!0},i}}var r=e("../defaults"),a=e("../DSCache"),o="3.1.1";t.exports=i},{"../DSCache":4,"../defaults":19}],19:[function(e,t,n){function i(){}var r={capacity:Number.MAX_VALUE,maxAge:Number.MAX_VALUE,deleteOnExpire:"none",onExpire:null,cacheFlushInterval:null,recycleFreq:1e3,storageMode:"memory",storageImpl:null,disabled:!1,storagePrefix:"angular-cache.caches."};for(var a in r)i.prototype["$$"+a]=r[a];t.exports={Config:i,defaults:r}},{}],20:[function(e,t,n){!function(t,n,i){"use strict";n.$$minErr=n.$$minErr||function(e){return function(){var t,i,r=arguments[0],a="["+(e?e+":":"")+r+"] ",o=arguments[1],s=arguments,c=function(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e};for(t=a+o.replace(/\{\d+\}/g,function(e){var t,i=+e.slice(1,-1);return i+2<s.length?(t=s[i+2],"function"==typeof t?t.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof t?"undefined":"string"!=typeof t?n.toJson(t):t):e}),t=t+"\nhttp://errors.angularjs.org/"+n.version.full+"/"+(e?e+"/":"")+r,i=2;i<arguments.length;i++)t=t+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(c(arguments[i]));return new Error(t)}},n.module("app").provider("DSBinaryHeap",e("./DSBinaryHeap").DSBinaryHeapProvider),n.module("app").provider("DSCacheFactory",e("./DSCacheFactory"))}(window,window.angular)},{"./DSBinaryHeap":1,"./DSCacheFactory":18}],21:[function(e,t,n){t.exports={stringifyNumber:function(e){return e&&angular.isNumber(e)?e.toString():e},keySet:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n},keys:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}}},{}]},{},[20]),function(){"use strict";angular.module("app").service("dateParser",["$locale","orderByFilter",function(e,t){function n(e){var n=[],i=e.split("");return angular.forEach(r,function(t,r){var a=e.indexOf(r);if(a>-1){e=e.split(""),i[a]="("+t.regex+")",e[a]="$";for(var o=a+1,s=a+r.length;s>o;o++)i[o]="",e[o]="$";e=e.join(""),n.push({index:a,apply:t.apply})}}),{regex:new RegExp("^"+i.join("")+"$"),map:t(n,"index")}}function i(e,t,n){return 1===t&&n>28?29===n&&(e%4===0&&e%100!==0||e%400===0):3===t||5===t||8===t||10===t?31>n:!0}this.parsers={};var r={yyyy:{regex:"\\d{4}",apply:function(e){this.year=+e}},yy:{regex:"\\d{2}",apply:function(e){this.year=+e+2e3}},y:{regex:"\\d{1,4}",apply:function(e){this.year=+e}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1}},M:{regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(t,r){if(!angular.isString(t)||!r)return t;r=e.DATETIME_FORMATS[r]||r,this.parsers[r]||(this.parsers[r]=n(r));var a=this.parsers[r],o=a.regex,s=a.map,c=t.match(o);if(c&&c.length){for(var l,u={year:1900,month:0,date:1,hours:0},d=1,f=c.length;f>d;d++){var p=s[d-1];p.apply&&p.apply.call(u,c[d])}return i(u.year,u.month,u.date)&&(l=new Date(u.year,u.month,u.date,u.hours)),l}}}]).directive("renderModelAsHours",function(){return{require:"ngModel",link:function(e,t,n,i){i.$render=function(){var e=parseInt(i.$modelValue,10);return isNaN(e)?void t.val(i.$modelValue):(10>e&&(e="0"+e),void t.val(e))}}}}).directive("timeDatePicker",["$filter","$sce","$rootScope","$parse",function(e,t,n,i){var r;return r=e("date"),{restrict:"AE",replace:!0,scope:{_modelValue:"=ngModel"},require:"ngModel",templateUrl:"core/datetime/input.html",link:function(e,t,n,r){var a,o;return n.$observe("defaultMode",function(t){return e._mode=null!=t?t:"date"}),n.$observe("displayMode",function(t){return e._displayMode=t}),n.$observe("orientation",function(t){return e._verticalMode="true"===t}),n.$observe("displayTwentyfour",function(t){return e._hours24=null!=t&&t}),n.$observe("mindate",function(t){return null!=t&&angular.isDate(t)?e.restrictions.mindate=t:void 0}),n.$observe("maxdate",function(t){return null!=t&&angular.isDate(t)?e.restrictions.maxdate=t:void 0}),r.$render=function(){return e.setDate(r.$modelValue)},o=i(n.onSave),a=i(n.onCancel),e.save=function(){return e._modelValue=e.date,r.$setDirty(),o(e.$parent,{$value:e.date})},e.cancel=function(){return a(e.$parent,{}),r.$render()}},controller:["$scope",function(e){var n;return e.restrictions={mindate:void 0,maxdate:void 0},e.setDate=function(t){return e.date=null!=t?new Date(t):new Date,e.calendar._year=e.date.getFullYear(),e.calendar._month=e.date.getMonth(),e.clock._minutes=e.date.getMinutes(),e.clock._hours=e._hours24?e.date.getHours():e.date.getHours()%12,e._hours24||0!==e.clock._hours?void 0:e.clock._hours=12},e.display={fullTitle:function(){return r(e.date,"EEEE d MMMM yyyy, h:mm a")},title:function(){return"date"===e._mode?r(e.date,"date"===e._displayMode?"EEEE":"EEEE h:mm a"):r(e.date,"MMMM d yyyy")},"super":function(){return"date"===e._mode?r(e.date,"MMM"):""},main:function(){return t.trustAsHtml("date"===e._mode?r(e.date,"d"):""+r(e.date,"h:mm")+"<small>"+r(e.date,"a")+"</small>")},sub:function(){return"date"===e._mode?r(e.date,"yyyy"):r(e.date,"HH:mm")}},e.calendar={_month:0,_year:0,_months:function(){var e,t;for(t=[],n=e=0;11>=e;n=++e)t.push(r(new Date(0,n),"MMMM"));return t}(),offsetMargin:function(){return new Date(this._year,this._month).getDay()},isVisible:function(e){return new Date(this._year,this._month,e).getMonth()===this._month},"class":function(t){return null!=e.date&&new Date(this._year,this._month,t).getTime()===new Date(e.date.getTime()).setHours(0,0,0,0)?"selected":new Date(this._year,this._month,t).getTime()===(new Date).setHours(0,0,0,0)?"today":""},select:function(t){var n=e.date.setFullYear(this._year,this._month,t);return e.save(),n},monthChange:function(){return(null==this._year||isNaN(this._year))&&(this._year=(new Date).getFullYear()),e.date.setFullYear(this._year,this._month),e.date.getMonth()!==this._month?e.date.setDate(0):void 0},_incMonth:function(e){for(this._month+=e;this._month<0||this._month>11;)this._month<0?(this._month+=12,this._year--):(this._month-=12,this._year++);return this.monthChange()}},e.clock={_minutes:0,_hours:0,_incHours:function(t){return this._hours=e._hours24?Math.max(0,Math.min(23,this._hours+t)):Math.max(1,Math.min(12,this._hours+t)),isNaN(this._hours)?this._hours=0:void 0},_incMinutes:function(e){return this._minutes=Math.max(0,Math.min(59,this._minutes+e)),isNaN(this._minutes)?this._minutes=0:void 0},setAM:function(t){return null==t&&(t=!this.isAM()),t&&!this.isAM()?e.date.setHours(e.date.getHours()-12):!t&&this.isAM()?e.date.setHours(e.date.getHours()+12):void 0},isAM:function(){return e.date.getHours()<12}},e.$watch("clock._minutes",function(t,n){if(null!=t&&t!==e.date.getMinutes()&&!isNaN(t)&&t>=0&&59>=t){var i=e.date.setMinutes(t);return i=e.date.setSeconds(0),e.save(),i}}),e.$watch("clock._hours",function(t){if(null!=t&&!isNaN(t)&&(e._hours24||(24===t?t=12:12===t?t=0:e.clock.isAM()||(t+=12)),t!==e.date.getHours())){var n=e.date.setHours(t);return e.save(),n}}),e.setNow=function(){return e.setDate()},e._mode="date",e.modeClass=function(){return null!=e._displayMode&&(e._mode=e._displayMode),""+(null!=e._verticalMode&&e._verticalMode?"vertical ":"")+("full"===e._displayMode?"full-mode":"time"===e._displayMode?"time-only":"date"===e._displayMode?"date-only":"date"===e._mode?"date-mode":"time-mode")},e.modeSwitch=function(){var t;return e._mode=null!=(t=e._displayMode)?t:"date"===e._mode?"time":"date"},e.modeSwitchText=function(){return"date"===e._mode?"Clock":"Calendar"}}]}}]).directive("timeDatePickerDialog",["$modal","dateFilter","dateParser","GLOBAL_CONFIG","$$rAF",function(e,t,n,i,r){return{require:["ngModel","^form"],link:function(a,o,s,c){var l=c[0],u=(c[1],!1);l.$render=function(){o.val(t(l.$modelValue,i.date.format))},o.on("click focus",function(t){t.preventDefault(),u||(u=!0,r(function(){e.open({windowClass:"modal-medium datepicker-pop",popFrom:!1,inDirection:!1,outDirection:!1,fullScreen:!1,templateUrl:"core/datetime/popup.html",controller:["$scope",function(e){e.date=l.$modelValue;var t=e.$close;e.$close=function(){t()},e.select=function(){l.$setViewValue(e.date),l.$render(),e.$close()},e.$on("$destroy",function(){u=!1})}]})}))}),l.$parsers.unshift(function(e){if(e){if(angular.isDate(e)&&!isNaN(e))return l.$setValidity("date",!0),e;if(angular.isString(e)){var t=n.parse(e,dateFormat)||new Date(e);return isNaN(t)?void l.$setValidity("date",!1):(l.$setValidity("date",!0),t)}return void l.$setValidity("date",!1)}return l.$setValidity("date",!0),null})}}}])}(),function(){"use strict";angular.module("app").run(["helpers","modals","$modal","GLOBAL_CONFIG",function(e,t,n,i){e.fields||(e.fields={}),e.form||(e.form={}),$.extend(e.fields,{sorter:function(e,t){var n=parseInt(e.name,10),i=parseInt(t.name,10);return isNaN(n)&&(n=999999),isNaN(i)&&(i=999999),n-i},applyGlobalConfig:function(e){angular.isUndefined(e.ui.help)&&angular.isDefined(i.fields.help[e._maker_])&&(e.ui.help=i.fields.help[e._maker_][e.code_name]),angular.isUndefined(e.ui.emptyHelp)&&angular.isDefined(i.fields.emptyHelp[e._maker_])&&(e.ui.emptyHelp=i.fields.emptyHelp[e._maker_][e.code_name]),angular.isUndefined(e.ui.label)&&angular.isDefined(i.fields.label[e._maker_])&&(e.ui.label=i.fields.label[e._maker_][e.code_name])},utils:{attrs:function(e){var t=this.defaultAttrs(e),n=this.extraAttrs(e),i=[];return angular.extend(t,n),angular.forEach(t,function(e,t){i.push(t+(e?'="'+e+'"':""))}),i.join(" ")},defaultAttrs:function(t){var n,i={};return t.max_size&&(i["ng-maxlength"]="config.max_size"),void 0!==t.ui.pattern&&(i["ng-pattern"]=t.pattern),i["ng-required"]=angular.isString(t.required)?t.required:"config.required",i["ng-model"]=t.ui.args,i.placeholder=t.ui.placeholder,
angular.isArray(t.ui.writable)?(n=t.ui.model+".ui.rule.field"+$.map(t.ui.writable,function(t){return"['"+e.addslashes(t)+"']"}).join("")+".writable",i["ng-disabled"]="!"+n,t.ui.writableCompiled=n):(i["ng-disabled"]="!"+t.ui.writable,t.ui.writableCompiled=t.ui.writable),i.readonly&&delete i["ng-disabled"],i},extraAttrs:function(e){return e.ui.attrs},label:function(e){var t="{{config.ui.label}}";return void 0===e.ui.label&&(t="{{config.ui.autoLabel|inflector:humanize}}"),t}}}),$.extend(e.form,{wakeUp:function(e,t){var n=!1;return angular.forEach(e,function(i){angular.isObject(i)&&i.hasOwnProperty("$valid")&&!i.$valid&&angular.isFunction(i.$setViewValue)&&(i.$setViewValue(void 0!==i.$viewValue?i.$viewValue:""),i.$setDirty(),i.$setTouched(),t&&e.$setDirty(),n=!0)}),n},setDirty:function(){this.container&&this.container.form&&this.container.form.$setDirty()},setPristine:function(){this.container&&this.container.form&&this.container.form.$setPristine()},validate:function(){var t=this.container.form;return t.$valid?!0:(e.form.wakeUp(t),this.$broadcast("invalidForm"),!1)},leave:function(e){var n=this.container.form;n.$pristine?e():t.confirm("discard",e)}}),$.extend(t,{fields:{remote:function(t,i,r){n.open({scope:t,templateUrl:"core/models/manage.html",controller:["$scope",function(n){var r,a=t.save,o=t.complete,s=!0;r=function(){return"view"+e.toolbar.makeTitle(i.code_name)},i._title_.push(r),n.dialog={templateBodyUrl:"core/models/manage_body_default.html",toolbar:{}},n.parentContainer=n.container,n.container={},n.close=angular.bind(n,e.form.leave,function(){n.formSetPristine(),n.$close()}),n.formSetDirty=angular.bind(n,e.form.setDirty),n.formSetPristine=angular.bind(n,e.form.setPristine),n.formBuilder={0:[i]},n.layouts={groups:[{label:!1}]},n.$on("itemDelete",function(){n.formSetDirty()}),n.$watch("parentContainer.form.$dirty",function(e,t){return s?void(s=!1):void(e?n.formSetDirty():n.formSetPristine())}),n.$watch("entity.id",function(){n.dialog.toolbar.title=e.toolbar.buildTitle(i._title_)}),n.save=function(e){var i=a.call(t,e);return i&&i.then(n.formSetPristine),i},n.complete=function(e){o.call(t,e),n.formSetPristine()},n.$on("$destroy",function(){angular.isArray(i.ui.specifics.parentArgs)&&i.ui.specifics.parentArgs.empty(),i._title_.remove(r)})}]})}}})}]).directive("validFile",function(){return{require:"ngModel",link:function(e,t,n,i){t.bind("change",function(){e.$apply(function(){i.$setViewValue(t.val()),i.$render()})})}}}).directive("jsonOnly",function(){return{require:"ngModel",link:function(e,t,n,i){var r=function(e,t){var n=!1;try{e=angular[t](e),n=!0}catch(r){}return i.$setValidity("jsonOnly",n),e},a=function(e){return r(e,"fromJson")},o=function(e){return r(e,"toJson")};i.$parsers.push(a),i.$formatters.push(o)}}}).directive("repeatedText",["helpers",function(e){return{require:"ngModel",link:function(t,n,i,r){var a=function(t,n){var i=!1;try{"list"===n&&(t=e.splitLines(t),t=_.uniq(t)),"str"===n&&angular.isArray(t)&&(t=t.join("\n")),i=!0}catch(a){}return r.$setValidity("invalid",i),t},o=function(e){return a(e,"list")},s=function(e){return a(e,"str")};r.$parsers.push(o),r.$formatters.push(s)}}}]).directive("generateUploadUrl",["endpoint","$rootScope",function(e,t){return{restrict:"A",require:"^form",link:function(t,n,i,r){var a=n,o=a.parents("form:first"),s=function(){return a.val()?void e.post("blob_upload_url","11",{upload_url:e.url}).then(function(e){o.attr("action",e.data.upload_url),r.$setDirty()}):!1},c=function(t,n){o.attr("action",e.url),a.val("")};return o.length?($(n).on("change",s),t.$on("$destroy",function(){$(n).off("change",s)}),t.$on("ngUploadComplete",c),void t.$on("ngUploadCompleteError",s)):(console.error("Directive generateUploadUrl demands explicit <form> tag"),!1)}}}]).directive("formBuilder",["$compile","underscoreTemplate","modelsMeta",function(e,t,n){return{restrict:"A",require:"^form",templateUrl:"core/fields/builder.html",scope:!0,transclude:!0,controller:["$scope","$element","$attrs",function(e,t,n){e.configurations=e.$eval(n.formBuilder)}]}}]).directive("formInput",["$compile","underscoreTemplate","formInputTypes","helpers","GLOBAL_CONFIG",function(e,t,n,i,r){var a=n,o=i.fields.utils;return{restrict:"A",require:"^form",scope:!0,transclude:!0,link:function(n,r,s,c){var l=function(){var l,u,d,f,p,g,m=n.$eval(s.formInput),h=null;if(!angular.isObject(m))return void console.warn("Config provided is not object for element: ",r);if(l=m.code_name,h=null!==m.verbose_name&&void 0!==m.verbose_name?m.verbose_name:l,!l)return void console.error("Your field config",m,"has no name defined defined. element: ",r);if(u={ui:{args:"args."+l,parentArgs:"args",rootScope:"rootScope",model:"entity",autoLabel:h,directiveScope:function(){return n},specifics:{},systemName:l,name:l,form:{root:c,field:function(){return this.root[u.ui.name]},hasErrors:function(){return this.field()?Object.keys(this.field().$error).length:!1},messages:function(){return this.field()?(this.field().$dirty&&this.hasErrors()?this.field().$error:!1)||u.ui:!1},shouldShowMessages:function(){return u.ui.hideMessages?!1:!0}},writable:[l],path:void 0,realPath:void 0,attrs:{}}},i.mergeDeep(m,u),u=m,angular.isFunction(u.ui.init)&&(g=u.ui.init,u.ui.init=void 0),u.ui.init||(u.ui.init={callbacks:[],add:function(e,t){var n=null;angular.forEach(this.callbacks,function(t,i){angular.isDefined(t[e])&&(n=t)}),null!==n?n[e]=t:(n={},n[e]=t,this.callbacks.push(n))}}),g&&u.ui.init.add("init",g),angular.isDefined(u.ui.path)||(u.ui.path=[l]),angular.isArray(u.ui.writable)&&(u.ui.writable=angular.copy(u.ui.path)),angular.isDefined(u.ui.realPath)||(u.ui.realPath=[l]),i.fields.applyGlobalConfig(u),void 0!==a[u.type]){if(p={config:u,element:r,scope:n,attrs:s},d=a[u.type](p),u.ui.compiled={attrs:o.attrs(u),label:o.label(u)},angular.forEach(u.ui.init.callbacks,function(e){angular.forEach(e,function(e){e(p)})}),u.ui.render===!1)return;f=t.get(angular.isDefined(u.ui.template)?u.ui.template:"core/fields/"+d+".html")({config:u}),n.config=u,r.html(f),e(r.contents())(n)}n.$on("$destroy",function(){u.ui.directiveScope=void 0,u.ui.form=void 0})};l()}}}]).directive("compatibilityMaker",["modelsUtil",function(e){return{restrict:"A",link:function(t,n,i,r){var a=function(){var r=t.$eval(i.compatibilityMaker),a=e.argumentsToJson(r);n.val(a)};t.$watch(i.compatibilityMaker,a),t.$on("ngUploadSubmit",a)}}}]).directive("submitIfFiles",["$parse","helpers",function(e,t){return{require:"^form",link:function(n,i,r,a){var o,s,c=i.parents("form:first"),l=e(r.submitIfFiles),u=e(r.submitIfFilesNoComplete),d=e(r.submitIf),f=e(r.submitNative),p=function(){var e,i,r=t.form.wakeUp(a,!0);return r&&(n.$$phase||n.$apply()),d&&!d(n)?!1:(i=f(n),o=c.find('input[type="file"]'),s=!1,o.length&&o.each(function(){return $(this).val()?(s=!0,!1):void 0}),i&&s?(c.trigger("submit"),!1):(e=l(n,{dontShowMessage:s}),e&&angular.isObject(e)&&e.then&&e.then(function(){return s?(c.trigger("submit"),!1):void u(n)}),void n.$apply()))};i.on("click",p),n.$on("$destroy",function(){i.off("click",p)})}}}]).directive("submitIfValid",["$parse",function(e){return{require:"^form",link:function(t,n,i,r){var a=n.parents("form:first"),o=e(i.submitIfValid),s=function(e){return o(t)&&a.submit(),e.preventDefault()};n.on("click",s),t.$on("$destroy",function(){n.off("click",s)})}}}]).directive("showNumberOfSelectedFiles",function(){return{restrict:"A",link:function(e,t,n){var i=t.parents(".fake-button:first"),r=i.find(n.showNumberOfSelectedFiles),a=r.text(),o=function(){setTimeout(function(){var e=t.prop("files");e&&e.length?(r.css("display","inline"),r.text(a.replace(":total",e.length))):r.hide()},200)};t.bind("change",o),o(),e.$on("ngUploadComplete",o),e.$on("ngUploadCompleteError",o),e.$on("$destroy",function(){t.unbind("change",o)})}}}).directive("checkNumeric",function(){return{require:["ngModel","^form"],link:function(e,t,n,i){var r=function(e){var t=!isNaN(parseInt(e,10));return t||(t=!isNaN(parseFloat(e,10))),t},a="required"===t.attr("required");i[0].$parsers.unshift(function(e){var t,n=r(e);return a||n&&!angular.isUndefined(e)&&e.length&&e.replace(/[^0-9+.]/g,"")||(n=!0),i[0].$setValidity("checkNumeric",n),angular.isDefined(e)?(t=e.replace(/[^0-9+.]/g,""),t!==e&&(i[0].$setViewValue(t),i[0].$render()),t):n?e:void 0})}}}).factory("formInputTypes",["underscoreTemplate","$timeout","$parse","endpoint","modelsMeta","models","$q","$filter","$modal","helpers","errorHandling","modals","GLOBAL_CONFIG","snackbar",function(e,t,n,i,r,a,o,s,c,l,u,d,f,p){var g=s("inflector"),m={_SelectBox:function(e){return angular.isDefined(e.config.ui.specifics.searchEnabled)||(e.config.ui.specifics.searchEnabled=e.config.choices.length<10?!1:!0),e.config.choices.length&&e.config.ui.specifics&&e.config.ui.specifics.translatedChoices!==!1&&(e.config.ui.specifics.translatedChoices=[],angular.forEach(e.config.choices,function(t){var n=l.getProperty(f.fields.translateChoices,[e.config._maker_,e.config.code_name,t]);angular.isUndefined(n)&&(n=t),e.config.ui.specifics.translatedChoices.push({key:t,name:n})})),"select"},SuperStringProperty:function(e){var t=e.config;return void 0===t.ui.attrs.type&&(t.ui.attrs.type="text"),t.choices?(void 0!==e.config.ui.attrs["repeated-text"]&&delete e.config.ui.attrs["repeated-text"],this._SelectBox(e)):e.config.repeated?(e.config.ui.attrs["repeated-text"]="",this.SuperTextProperty(e)):"string"},SuperFloatProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperStringProperty(e))},SuperIntegerProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperFloatProperty(e))},SuperDecimalProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperFloatProperty(e))},SuperBooleanProperty:function(e){return e.config.required=!1,(!e.config.ui.specifics||angular.isUndefined(e.config.ui.specifics.type))&&(e.config.ui.specifics.type="checkbox"),"boolean"},SuperVirtualKeyProperty:function(e){return this.SuperKeyProperty(e)},SuperKeyProperty:function(e){if(e.config.searchable===!1)return this.SuperStringProperty(e);var t,n,i,s,c=e.config,l={cache:{query:{24:!0,12:!0,13:!0,17:!0},type:{12:"local",17:"local","default":"memory"}},finder:{24:!0},view:{"default":function(e){return e?e.name:""}},init:{13:function(e){e.scope.$watch(e.config.ui.parentArgs+".country",function(t,n){if(t!==n){var i=e.scope.$eval(e.config.ui.parentArgs);i.region=null,c.ui.specifics.initial()}})}},queryFilter:{24:function(e,t){var n=angular.copy(t.search["default"]),i={search:n};return e&&i.search.filters.push({field:"name",operator:"==",value:e}),i},17:function(e,t){var n={search:{filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}},i=n.search;return"weight_uom"===c.code_name&&i.filters.push({value:"Weight",field:"measurement",operator:"=="}),"volume_uom"===c.code_name&&i.filters.push({value:"Volume",field:"measurement",operator:"=="}),"product_uom"===c.code_name&&(i.filters.unshift({value:"Currency",field:"measurement",operator:"!="}),i.orders=[{field:"measurement",operator:"asc"},{field:"key",operator:"asc"}]),n},13:function(t,n){var i=e.scope.$eval(e.config.ui.parentArgs);return i&&i.country?{search:{ancestor:i.country,filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}}:!1}}},u=a[c.kind],d={},f={},p=c.ui.specifics.override||{},g=function(){c.ui.specifics._mapEntities={},angular.forEach(c.ui.specifics.entities,function(e){c.ui.specifics._mapEntities[e.key]=1})},m=c.kind?r.getActionArguments(c.kind,"search"):{},h=function(e){return c.ui.specifics.entities=e.data.entities,g(),c.ui.specifics.entities},v=o.defer(),y=v.promise;return c.ui.specifics.view=function(e){var t=l.view[c.kind];return t||(t=l.view["default"]),p.view&&(t=p.view),t(e)},t=l.init[c.kind],p.init&&(t=p.init),angular.isDefined(t)&&t(e),$.extend(d,c.ui.specifics.search),c.ui.specifics.search=d,angular.isFunction(c.ui.specifics.entities)&&(c.ui.specifics.getEntities=c.ui.specifics.entities,c.ui.specifics.entities=c.ui.specifics.entities()),angular.isUndefined(c.ui.specifics.entities)&&(c.ui.specifics.entities=[]),g(),s=l.finder[c.kind],p.finder&&(s=p.finder),c.ui.specifics.search.ready=y,u&&!c.ui.specifics.getEntities&&u.actions.search&&(f.cache=l.cache.query[c.kind],f.cacheType=l.cache.type[c.kind]||l.cache.type["default"],p.cache&&angular.isDefined(p.cache.query)&&(f.cache=p.cache.query),p.cache&&angular.isDefined(p.cache.type)&&(f.cacheType=p.cache.type),c.ui.specifics.initial=function(){return n=l.queryFilter[c.kind],p.queryFilter&&(n=p.queryFilter),n?(i=n,n=i(null,m),s&&(c.ui.specifics.search.find=function(e){return u.actions.search(i(e,m),f).then(function(e){var t=e.data.entities;angular.forEach(t,function(e){angular.isUndefined(c.ui.specifics._mapEntities[e.key])&&(c.ui.specifics._mapEntities[e.key]=1,c.ui.specifics.entities.push(e))})})}),c.ui.specifics.search.missing=function(e){if(null!==e&&void 0!==e&&e.length){var t=angular.isArray(e);u.actions.search({search:{keys:t?e:[e]}},{cache:!0}).then(function(n){var i=n.data.entities;t?angular.forEach(i,function(e){angular.isUndefined(c.ui.specifics._mapEntities[e.key])&&(c.ui.specifics._mapEntities[e.key]=1,c.ui.specifics.entities.push(e))}):angular.isUndefined(c.ui.specifics._mapEntities[e])&&(c.ui.specifics._mapEntities[e]=1,c.ui.specifics.entities.unshift(n.data.entities[0]))})}}):n=m.search["default"],u.actions.search(n,f).then(h)},c.ui.specifics.initial().then(function(){v.resolve()})),"select_async"},SuperLocalStructuredProperty:function(s){var u,f,h,v,y=s.config,b=[],w=[],k=y.modelclass,x=_.toArray(k),A=!angular.isDefined(y.ui.specifics),C=[],S=l.callable(s.scope.formSetDirty),E={secondary:!0,perLine:1,clickable:!0};return y.ui.specifics.toolbar||(y.ui.specifics.toolbar={}),y.ui.specifics.sortMode=!0,x=x.sort(l.fields.sorter),(A||!y.ui.specifics.fields)&&(y.ui.specifics.fields=x,y.ui.specifics.sortFields&&(angular.forEach(y.ui.specifics.sortFields,function(e){C.push(_.findWhere(y.ui.specifics.fields,{code_name:e}))}),y.ui.specifics.fields=C)),!A&&y.ui.specifics.excludeFields&&(angular.forEach(y.ui.specifics.fields,function(e,t){-1===$.inArray(e.code_name,y.ui.specifics.excludeFields)&&w.push(e)}),y.ui.specifics.fields=w),u={fields:b,addNewText:"Add",addText:"{{config.ui.specifics.addNewText}}"},y.ui.specifics.listConfig&&$.extend(E,y.ui.specifics.listConfig),y.ui.specifics.listConfig=E,angular.forEach(u,function(e,t){void 0===y.ui.specifics[t]&&(y.ui.specifics[t]=e)}),y.ui.specifics.parentArgs=s.scope.$eval(y.ui.args),y.ui.specifics.entity=s.scope.$eval(y.ui.model),y.ui.specifics.rootScope=s.scope.$eval(y.ui.rootScope),y.ui.specifics.sortableOptions||(y.ui.specifics.sortableOptions={}),f={disabled:!1,start:function(e,t){s.scope.$broadcast("itemOrderStarted")},axis:!1,containment:!1,whatSortMeans:function(){d.alert("howToSort")},handle:".sort-handle",tolerance:"pointer",helper:"clone",sort:function(e,t){var n,i,r=t.helper.width(),a=t.item.scope(),o=a.$eval(t.item.attr("current-item"));i=t.offset.left+r,r/2>i&&(n=!0),o&&(n?(t.helper.addClass("about-to-delete"),o._state="deleted",s.scope.formSetDirty()):(t.helper.removeClass("about-to-delete"),o._state=null)),s.scope.$broadcast("itemOrderSorting")},stop:function(e,t){var n=[],i=[];angular.forEach(y.ui.specifics.parentArgs,function(e,t){n.push(e._sequence),t=y.ui.specifics.parentArgs.length-1-t,i.push(t),e._sequence=t,e.ui.access[e.ui.access.length-1]=t}),n.equals(i)||s.scope.formSetDirty(),s.scope.$broadcast("itemOrderChanged"),s.scope.$apply()}},$.extend(f,y.ui.specifics.sortableOptions),y.ui.specifics.sortableOptions=f,y.ui.init.add("checkDisabledStateForSortable",function(){var e=n(y.ui.writableCompiled+"");y.ui.specifics.sortableOptions.disabled=!e(s.scope)}),s.scope.$watch(y.ui.args,function(e,t){e!==t&&(y.ui.specifics.parentArgs=e)}),h=function(){y.ui.specifics.formBuilder=[],angular.forEach(y.ui.specifics.fields,function(e){var t=angular.copy(y.ui.writable);angular.isArray(t)&&t.push(e.ui.writableName?e.ui.writableName:e.code_name),e.ui.path=[],e.ui.path.extend(y.ui.path),e.ui.path.push(e.code_name),e.ui.realPath=[],e.ui.realPath.extend(y.ui.realPath),e.ui.realPath.push(e.code_name),angular.isDefined(e.ui.name)||(e.ui.name=y.ui.name+"."+e.code_name),e.ui.writable=t,y.ui.specifics.formBuilder.push(e)})},h(),angular.isUndefined(y.ui.specifics.toolbar.titleAdd)&&(y.ui.specifics.toolbar.titleAdd="add"+l.toolbar.makeTitle(y.code_name)),angular.isUndefined(y.ui.specifics.toolbar.titleEdit)&&(y.ui.specifics.toolbar.titleEdit="edit"+l.toolbar.makeTitle(y.code_name)),y.ui.specifics.remote&&(v=y.ui.specifics.getRootArgs?y.ui.specifics.getRootArgs():y.ui.specifics.rootScope.args,y.repeated&&v.id&&s.scope.args.id&&(y.ui.specifics.reader=a[v.action_model].reader({kind:v.action_model,key:v.key,args:v,access:y.ui.realPath,complete:function(e){y.ui.specifics.parentArgs.extend(e)}}),angular.isDefined(y.ui.specifics.readerSettings)&&y.ui.specifics.reader.state(y.ui.specifics.readerSettings),(angular.isUndefined(y.ui.specifics.remoteAutoload)||y.ui.specifics.remoteAutoload)&&(angular.isArray(y.ui.specifics.parentArgs)&&y.ui.specifics.parentArgs.empty(),t(function(){y.ui.specifics.reader.load()},100,!1)))),y.repeated||y.ui.specifics.modal===!0?(y.ui.specifics.remove=function(e){e._state="deleted",s.scope.$emit("itemDelete",e),s.scope.$broadcast("itemDelete",e),S()},y.ui.specifics.manage=function(t,n,u){h(),c.open({popFrom:y.ui.specifics.cards&&u?l.clicks.realEventTarget(u.target):void 0,template:e.get(y.ui.specifics.templateUrl?y.ui.specifics.templateUrl:"core/fields/manage_structured.html")({config:y}),controller:["$scope","modelsUtil",function(e,c){var u,f=y.ui.specifics.modal?0:y.ui.specifics.parentArgs.length,h={0:[]},b=[],w={},k=function(t,n){var i,r=[],a=e.isNew&&y.repeated;return angular.forEach(n,function(e,t){var n=parseInt(e,10);isNaN(n)||(e=0),r.push(e)}),a&&r.pop(),i=l.getProperty(t.data.entity,r),a&&i.length&&(i=_.findWhere(i,{_state:"created"})),i};y.ui.specifics.getScope=function(){return e},e.isNew=!1,e.rootFormSetDirty=S,e.formSetDirty=angular.bind(e,l.form.setDirty),e.formSetPristine=angular.bind(e,l.form.setPristine),e.response=null,e.config=y,t?!y.ui.specifics.modal&&t.ui&&(f=_.last(t.ui.access)):(t={kind:y.modelclass_kind,_sequence:f},c.normalize(t,y.modelclass,y.ui.specifics.entity,y.code_name,f),angular.isDefined(n)&&$.extend(t,n),e.isNew=!0),angular.isDefined(t.ui)&&(t.ui.access=angular.copy(y.ui.realPath),y.ui.specifics.modal||t.ui.access.push(f)),e.layouts={groups:[{label:!1}]},e.formBuilder=h,e.container={action:i.url},e.args=angular.copy(t),e.parentArgs=y.ui.specifics.parentArgs,e.rootScope=y.ui.specifics.rootScope,e.entity=y.ui.specifics.entity,y.ui.specifics.remote?e.close=angular.bind(e,l.form.leave,function(){e.$close(),y.ui.specifics.afterClose&&y.ui.specifics.afterClose(e)}):($.extend(y.ui.specifics.toolbar,{leftIcon:"navigation.arrow-back",hideSave:!0}),e.close=function(){var t=e.save();t?t.then(function(){e._close_=void 0,e.$close()}):d.confirm("discardWithFieldsRequired",e.$close)},e._close_=e.close),e.validateForm=angular.bind(e,l.form.validate),e.$on("$destroy",function(){y.ui.specifics.getScope=void 0}),angular.forEach(y.ui.specifics.formBuilder,function(t){if(l.fields.applyGlobalConfig(t),t.ui.initialRealPath?t.ui.realPath=angular.copy(t.ui.initialRealPath):t.ui.initialRealPath=angular.copy(t.ui.realPath),t.ui.realPath.pop(),y.ui.specifics.modal||t.ui.realPath.push(f),t.ui.realPath.push(t.code_name),t.ui.groupBy){if(t.ui.hideMessages=!0,!w[t.ui.groupBy]){var n={ui:{group:{help:t.ui.groupHelp,label:t.ui.groupLabel,name:t.ui.groupBy,fields:[],messages:function(){var e={help:!0};return angular.forEach(n.ui.group.fields,function(t){t.ui.form.hasErrors()&&t.ui.form.field().$dirty&&(e=t.ui.form.messages())}),e},shouldShowMessages:function(){return!0}}}};w[t.ui.groupBy]=n,b.push(t.ui.groupBy),h[0].push(w[t.ui.groupBy])}return t.ui.label=!1,void w[t.ui.groupBy].ui.group.fields.push(t)}if(t.is_structured&&m[t.type]){var i,r={label:g(t.ui.label||t.code_name,"humanize")};_.string.contains(t.type,"Remote")&&(r.include="core/misc/action.html",r.action=function(){var n=!0;t.ui.specifics.canOpen&&(n=t.ui.specifics.canOpen()),n&&d.fields.remote(e,t)}),e.layouts.groups.push(r),i=e.layouts.groups.length-1,angular.isDefined(h[i])||(h[i]=[],h[i].push(t))}else h[0].push(t)}),y.ui.specifics.remote?(e.rootArgs=v,e.setAction=function(t){e.sendRootArgs.action_id=t},e.sendRootArgs={},e.save=function(n){if(!e.validateForm())return!1;var i,o=function(){var t,n,i,a={},o=e.rootArgs,s=e.args.ui.access;o=angular.copy(o),l.setProperty(o,s,e.args),e.sendRootArgs=o,angular.forEach(e.rootScope.config.fields,function(t){_.string.contains(t.type,"RemoteStructured")&&t.code_name!==e.args.ui.access[0]&&delete o[t.code_name]}),o.read_arguments=a,angular.forEach(s,function(e,n){!angular.isDefined(a[e])&&isNaN(parseInt(e,10))&&(a[e]={config:{}},a=a[e]),o=o[e],angular.isArray(o)?t=o:(angular.isDefined(t)&&(t.empty(),t.push(o),t=void 0),null!==o.key&&angular.isDefined(o.key)&&(angular.isDefined(a.config.keys)||(a.config.keys=[]),a.config.keys.push(o.key)))}),(i=function(e,t){e&&e.key?(n=r.getFields(e.kind),angular.forEach(n,function(n){if(n.is_structured&&_.string.contains(n.type,"RemoteStructured")){var r=[],a={config:{keys:r}};n.repeated&&angular.forEach(e[n.code_name],function(e){e.key&&(r.push(e.key),i(e,a))}),t[n.code_name]=a}})):angular.isArray(e)&&angular.forEach(e,function(e){i(e,t)})})(o,a)};return o(),y.ui.specifics.beforeSave&&y.ui.specifics.beforeSave(e),i=a[e.sendRootArgs.action_model].actions[e.sendRootArgs.action_id](e.sendRootArgs),i.then(function(i){e.response=i;var r=angular.copy(e.args.ui.access),a=k(i,r);$.extend(e.args,a),e.args.ui.access=r,e.isNew&&(y.repeated&&e.parentArgs.unshift(e.args),e.isNew=!1),$.extend(t,e.args),o(),angular.isDefined(y.ui.specifics.afterSave)&&y.ui.specifics.afterSave(e),e.formSetPristine(),n||p.showK("changesSaved")},function(t){angular.isDefined(y.ui.specifics.afterSaveError)&&y.ui.specifics.afterSaveError(e,t)}),i},e.complete=function(t){e.response=t;var n=angular.copy(e.args.ui.access),i=k(t,n);$.extend(e.args,i),e.args.ui.access=n,angular.isDefined(y.ui.specifics.afterComplete)&&y.ui.specifics.afterComplete(e),e.formSetPristine(),p.showK("changesSaved")},e.noComplete=function(){angular.isDefined(y.ui.specifics.noComplete)&&y.ui.specifics.noComplete(e),e.formSetPristine()},e.completeError=function(t){angular.isDefined(y.ui.specifics.afterCompleteError)&&y.ui.specifics.afterCompleteError(e,t),e.formSetPristine()}):e.save=function(){if(!e.validateForm())return!1;e.container.form.$dirty&&e.rootFormSetDirty();var n=null,i=o.defer(),r=i.promise,a=function(){var n=null,r=0;y.repeated&&(e.isNew?(e.parentArgs.unshift(e.args),e.isNew=!1,r=e.parentArgs.length-1,angular.forEach(e.parentArgs,function(e,t){t=r-t,e._sequence=t,e.sequence=t})):$.extend(t,e.args)),angular.isFunction(y.ui.specifics.afterSave)&&(n=y.ui.specifics.afterSave(e,s)),n&&n.then?n.then(function(){e.formSetPristine(),i.resolve(),y.closeAfterSave&&e.close()}):(e.formSetPristine(),i.resolve(),y.closeAfterSave&&e.close())};return angular.isFunction(y.ui.specifics.beforeSave)&&(n=y.ui.specifics.beforeSave(e,s)),n&&n.then?n.then(a):a(),r},y.ui.specifics.scope&&$.extend(e,y.ui.specifics.scope),angular.isFunction(y.ui.specifics.init)&&y.ui.specifics.init(e),u=function(){return y.ui.specifics.toolbar["title"+(e.isNew?"Add":"Edit")]},y._title_.push(u),e.$watch("isNew",function(){y.ui.specifics.toolbar.title=l.toolbar.buildTitle(y._title_)}),angular.forEach(y.ui.specifics.fields,function(e){e._title_=y._title_.concat()}),e.$on("$destroy",function(){y._title_.remove(u)})}]})},angular.isUndefined(y.ui.specifics.create)&&(y.ui.specifics.create=y.ui.specifics.manage),s.scope.$on("$destroy",function(){y.ui.specifics.create=void 0})):y.ui.specifics.SingularCtrl=["$scope",function(e){e.args=y.ui.specifics.parentArgs,s.scope.$watchCollection(y.ui.args,function(t,n){$.extend(e.args,t)}),y.ui.specifics.getScope=function(){return e};var t=function(){return y.ui.specifics.toolbar.titleEdit};y._title_.push(t),angular.forEach(y.ui.specifics.fields,function(e){e._title_=y._title_.concat()}),e.$on("$destroy",function(){y._title_.remove(t),y.ui.specifics.getScope=void 0})}],"structured_"+(y.repeated?"repeated":"single")},_RemoteStructuredPropery:function(e){var t=e.config;t.ui.specifics.remote=!0},SuperStructuredProperty:function(e){return this.SuperLocalStructuredProperty(e)},SuperRemoteStructuredProperty:function(e){this._RemoteStructuredPropery(e);var t=this.SuperLocalStructuredProperty(e);return t},SuperImageLocalStructuredProperty:function(e){return this.SuperLocalStructuredProperty(e),e.config.ui.specifics.displayImageConfig||(e.config.ui.specifics.displayImageConfig={size:360}),e.config.ui.specifics.sortableOptions||(e.config.ui.specifics.sortableOptions={}),$.extend(e.config.ui.specifics.sortableOptions,{axis:!1,containment:!1}),"image"},SuperImageStructuredProperty:function(e){return e.config.ui.specifics.sortableOptions||(e.config.ui.specifics.sortableOptions={}),$.extend(e.config.ui.specifics.sortableOptions,{axis:!1,containment:!1}),this.SuperImageLocalStructuredProperty(e)},SuperImageRemoteStructuredProperty:function(e){this._RemoteStructuredPropery(e);var t=this.SuperImageLocalStructuredProperty(e);return t},SuperTextProperty:function(e){return e.config.repeated&&(e.config.ui.attrs["repeated-text"]=""),(void 0===e.config.ui.specifics.autoGrow||e.config.ui.specifics.autoGrow)&&(e.config.ui.attrs["msd-elastic"]=""),"text"},SuperJsonProperty:function(e){return e.config.ui.attrs["json-only"]="",this.SuperTextProperty(e)},SuperDateTimeProperty:function(e){return e.config.ui.attrs["time-date-picker-dialog"]="",e.config.ui.attrs.readonly="true","string"}};return m}]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,n){return{require:"ngModel",restrict:"A, C",link:function(i,r,a,o){function s(){var e=v;p=u,b=getComputedStyle(u),angular.forEach(E,function(t){e+=t+":"+b.getPropertyValue(t)+";"}),$.setAttribute("style",e)}function c(){var t,n,r,a,o;p!==u&&s(),g||(g=!0,$.value=u.value+m,$.style.overflowY=u.style.overflowY,t=""===u.style.height?"auto":parseInt(u.style.height,10),n=getComputedStyle(u).getPropertyValue("width"),"px"===n.substr(n.length-2,2)&&(a=parseInt(n,10)-k.width,$.style.width=a+"px"),r=$.scrollHeight,r>S?(r=S,o="scroll"):C>r&&(r=C),r+=k.height,u.style.overflowY=o||"hidden",t!==r&&(u.style.height=r+"px",i.$emit("elastic:resize",d)),e(function(){g=!1},1,!1))}function l(){g=!1,c()}var u=r[0],d=r;if("TEXTAREA"===u.nodeName&&t.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var f=u.value;u.value="",u.value=f;var p,g,m=a.msdElastic?a.msdElastic.replace(/\\n/g,"\n"):n.append,h=angular.element(t),v="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",y=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+v+'"/>').data("elastic",!0),$=y[0],b=getComputedStyle(u),_=b.getPropertyValue("resize"),w="border-box"===b.getPropertyValue("box-sizing")||"border-box"===b.getPropertyValue("-moz-box-sizing")||"border-box"===b.getPropertyValue("-webkit-box-sizing"),k=w?{width:parseInt(b.getPropertyValue("border-right-width"),10)+parseInt(b.getPropertyValue("padding-right"),10)+parseInt(b.getPropertyValue("padding-left"),10)+parseInt(b.getPropertyValue("border-left-width"),10),height:parseInt(b.getPropertyValue("border-top-width"),10)+parseInt(b.getPropertyValue("padding-top"),10)+parseInt(b.getPropertyValue("padding-bottom"),10)+parseInt(b.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},x=parseInt(b.getPropertyValue("min-height"),10),A=parseInt(b.getPropertyValue("height"),10),C=Math.max(x,A)-k.height,S=parseInt(b.getPropertyValue("max-height"),10),E=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(S=S&&S>0?S:9e4,$.parentNode!==document.body&&angular.element(document.body).append($),d.css({resize:"none"===_||"vertical"===_?"none":"horizontal"}).data("elastic",!0),u.oninput="onpropertychange"in u&&"oninput"in u?u.onkeyup=c:c,h.bind("resize",l),i.$watch(function(){return o.$modelValue},function(e){l()}),i.$on("elastic:adjust",function(){s(),l()}),e(c),i.$on("$destroy",function(){y.remove(),h.unbind("resize",l)}))}}}}]).directive("fastNgChange",["$parse","$mdUtil",function(e,t){return{priority:1,link:function(n,i,r){var a=e(r.fastNgChange),o=i.val(),s=t.debounce(function(e){var t=i.val();o!==t&&(o=t,a(n,{$event:e}))},100,n,!0);i.on("change keydown",s),n.$on("$destroy",function(){i.off("change keydown",s)})}}}]).directive("fastNgModel",["$parse","$mdUtil",function(e,t){return{priority:-1,link:function(n,i,r){var a=e(r.fastNgModel),o=t.debounce(function(e){a.assign(n,i.val())},100,n,!0);i.on("keyup",o),n.$on("$destroy",function(){i.off("keyup",o)})}}}])}(),function(){"use strict";angular.module("app").run(["helpers",function(e){e.grid={calculate:function(e,t,n,i){var r,a,o,s,c,l,u=t-n,d=[];for(r=0;u>r&&(a=t-r,o=e/a,s=Math.floor(o),a=e/s,a>t&&(s+=1,a=e/s,n>a&&(s-=1,a=t)),c=Math.floor(a),l=Math.floor(e%(c*s)/2),c-=2*i,d=[c,s,l],!(o>4||1===s));r++);return d}},e.gridStacked={getHeight:function(e,t,n){n=2*n,t-=e.length*n;var i=0;return angular.forEach(e,function(e){i+=e.proportion}),t/i},setHeight:function(e,t){angular.forEach(e,function(e){e.width=t*e.proportion,e.height=t})},resize:function(e,t){this.setHeight(e,this.getHeight(e,t))},calculate:function(e,t,n,i){var r,a,o,s=0,c=t;e:for(;t.length>0;){for(r=1;r<t.length+1;++r)if(a=t.slice(0,r),o=this.getHeight(a,e,i),n>o){this.setHeight(a,o),s++,t=t.slice(r);continue e}this.setHeight(a,Math.min(n,o)),s++;break}return c}}}]).directive("gridStacked",["helpers","$timeout",function(e,t){return{link:function(n,i,r){var a=function(){var t=0,a=function(a){var o=i.width(),s=[],c=1;!o||a&&t===o||(angular.forEach(n.$eval(r.gridStacked),function(e){"deleted"!==e._state&&s.push(angular.copy(e))}),e.gridStacked.calculate(o,s,240,c),i.find(".grid-item").filter(function(){return"none"!==$(this).css("display")}).each(function(e){angular.isDefined(s[e])&&($(this).css({width:s[e].width,height:s[e].height}).addClass("visible"),$(this).find("img").css({height:s[e].height}))}))};a(),setTimeout(function(){a(!0)},50)};n.$on("modalResize",a),n.$on("itemOrderChanged",a),n.$on("itemOrderSorting",a),n.$on("ngRepeatEnd",a),n.$on("itemDelete",function(){t(a,0,!1)}),n.$watch(r.gridStacked+".length",function(){t(a,0,!1)})}}}]).directive("gridGenerator",["GLOBAL_CONFIG","helpers","$timeout",function(e,t,n){return{link:function(n,i,r){var a=n.$eval(r.gridGenerator)||{},o=a.margin||0,s=a.maxWidth||e.grid.maxWidth,c=a.minWidth||e.grid.minWidth,l=a.maxHeight||e.grid.maxHeight,u=a.fixedHeight,d=angular.isDefined(a.square)?a.square:!0,f=function(){if(i=$(i),i.length){var e,n=i,r=n.width();r&&(e=t.grid.calculate(r,s,c,o),(n.css("paddingLeft")!==e[2]||n.css("paddingRight")!==e[2])&&n.css({paddingRight:e[2],paddingLeft:e[2]}),n.find(".grid-item").filter(function(){return"none"!==$(this).css("display")}).each(function(){var n,i=u?u:t.newHeightByWidth(s,l,e[0]);(e[0]!==$(this).width()||$(this).height()!==i)&&(n=$(this).width(e[0]),d?n.height(e[0]):$(this).height(i)),$(this).addClass("visible")}))}};$(window).bind("resize",f),n.$on("ngRepeatEnd",f),n.$on("itemDelete",f),n.$watch(r.gridGeneratorItems+".length",f),n.$on("$destroy",function(){$(window).off("resize",f)})}}}]).directive("gridScale",["helpers","$timeout","GLOBAL_CONFIG",function(e,t,n){return{controller:["$scope","$element",function(t,n){var i=this,r=0;i.items=[],
i.config={},i.columns=1,i.calc=[],i.getColumns=function(){var t=e.grid.calculate(n.width(),i.config.maxWidth,i.config.minWidth,i.config.margin);i.columns=t[1],i.calc=t},i.add=function(e){r+=1,i.items.push(e),i.calculate(e),r===i.columns&&(r=0)},i.remove=function(e){i.items.remove(e),i.resize()},i.calculate=function(e){return i.columns<2&&n.width()>i.config.maxWidth?(e.css("width","calc((100%) - "+2*i.config.margin+"px)"),void n.css({marginLeft:i.calc[2],marginRight:i.calc[2]})):(n.css({marginLeft:"",marginRight:""}),void e.css("width","calc(("+100/i.columns+"%) - "+2*i.config.margin+"px)"))},i.resize=function(e){i.getColumns(),angular.forEach(i.items,function(t){i.calculate(t),e&&i.config.square})},$(window).on("resize",i.resize),t.$on("$destroy",function(){$(window).off("resize",i.resize)})}],link:function(e,t,i,r){$.extend(r.config,n.grid,e.$eval(i.gridScale)||{}),r.getColumns()}}}]).directive("gridScaleItem",["helpers",function(e){return{require:"^gridScale",link:function(e,t,n,i){var r=function(){t.addClass("visible")},a=e.$eval(n.gridScaleItem)||{};i.add(t),a.image?e.$on("displayImageLoaded",r):setTimeout(r,50),e.$on("$destroy",function(){i.remove(t)})}}}])}(),function(){"use strict";angular.module("app").run(["helpers","$mdConstant",function(e,t){$.extend(e,{clicks:{realEventTarget:function(e){var t=$(e),n=t.parents(".grid-item:first"),i=t.parents(".card:first");return!t.hasClass("grid-item")&&n.length&&(e=n.get(0)),i.length&&(e=i.get(0)),e}},closestLargestNumber:function(e,t){var n=Math.max.apply(null,e),i=0;for(i=0;i<e.length;i++)e[i]>t&&e[i]<n&&(n=e[i]);return n},newWidthByHeight:function(e,t,n){var i;return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),i=n/t,e*i},newHeightByWidth:function(e,t,n){var i;return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),i=n/e,t*i},url:{abs:function(e){return window.location.protocol+"//"+window.location.host+"/"+e},urlsafe:function(e){return window.btoa(e).replace("=","-")},urlunsafe:function(e){return window.atob(e.replace("-","="))},jsonFromUrlsafe:function(t){return angular.fromJson(e.url.urlunsafe(t))},jsonToUrlsafe:function(t){return e.url.urlsafe(angular.toJson(t))}}});var n=function(e,n){return $(this).on(t.CSS.ANIMATIONEND,function i(r){r.target===this&&(n.call(this,r),"one"===e&&$(this).off(t.CSS.ANIMATIONEND,i))})};$.fn.oneAnimationEnd=function(e){return n.call(this,"one",e)},$.fn.onAnimationEnd=function(e){return n.call(this,"on",e)}}]).directive("fillEmptySpace",function(){return{link:function(e,t,n){var i=t.parents(".overflow-y:first");e.$on("modalResize",function(){var e=t.height(),n=i.height(),r=t.find(".list:last"),a=r.outerHeight();n>e&&r.css("min-height",a+(n-e))})}}}).directive("helpRender",function(){return{scope:{help:"=helpRender"},templateUrl:"core/misc/help_render.html",link:function(e,t,n){e.isTemplate=function(){return!angular.isArray(e.help)}}}}).directive("displayImage",["GLOBAL_CONFIG",function(e){return{scope:{image:"=displayImage",config:"=displayImageConfig"},link:function(t,n,i){t.config||(t.config={}),angular.isDefined(t.config.size)||(t.config.size=240);var r=function(i,r){if(i!==r){var a=n,o=function(){a.css("visibility","visible"),t.$emit("displayImageLoaded",a)},s=function(){var n=t.config.defaultImage;n||(n="defaultImage"),a.attr("src",e[n]),o()};t.image&&t.image.serving_url?a.on("load",o).on("error",s).attr("src",t.image.serving_url+(t.config.size===!0?"":"=s"+t.config.size)):(s(),o())}};t.$watch("image.serving_url",r),r(!0,!1)}}}]).directive("loading",["$parse",function(e){return{link:function(t,n,i){angular.isDefined(i.loading)&&t.$watch(i.loading,function(e){e?n.attr("disabled","disabled"):n.removeAttr("disabled")});var r=function(e){return e.stopImmediatePropagation(),e.preventDefault(),!1},a=angular.isDefined(i.loading)?e(i.loading):function(){return!1};t.$on("disableUI",function(e,i){a(t)||(i===!0?(n.attr("disabled","disabled"),n.on("click",r)):(n.removeAttr("disabled"),n.off("click",r)))})}}}]).directive("onNgRepeatEnd",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){e.$last===!0&&e.$evalAsync(function(){e.$emit("ngRepeatEnd")})}}}]).directive("defaultFieldDisplay",["$compile",function(e){return{scope:{val:"=defaultFieldDisplay"},templateUrl:"buyer/address_display.html",controller:["$scope",function(e){e.notEmpty=function(e){return angular.isString(e)||angular.isNumber(e)}}]}}]).directive("draggableClick",["$parse","helpers",function(e,t){return{restrict:"A",link:function(t,n,i){var r=e(i.draggableClick),a=function(e,i){return n.hasClass("dragged")&&!i?void n.removeClass("dragged"):void t.$apply(function(){r(t,{$event:e})})};n.on("click",a),t.$on("$destroy",function(){n.off("click",a)})}}}]).directive("loadMoreButton",function(){return{restrict:"A",templateUrl:"core/misc/load_more_button.html",scope:{config:"=loadMoreButton"}}}).directive("autoloadOnVerticalScrollEnd",function(){return{restrict:"A",link:function(e,t,n){var i,r,a,o,s;i=e.$eval(n.autoloadOnVerticalScrollEnd),n.autoloadOnVerticalScrollEnd&&i&&i.loader&&(r=function(){var e=i.listen;return e?e=$(i.listen||window):(e=t.parents("md-content[md-scroll-y]:first"),e.length||(e=t.parents(".overflow-y:first"))),e}(),a=function(e,t){var n=i.loader.load();return n?void n.then(function(){t()}):(t(),!1)},s={conditions:{"max-bottom":i.bottom||40},scrollElement:r.get(0),throttle:100,handler:a},o=new Steady(s),e.$on("$destroy",function(){o.stop(),o=void 0}))}}}).directive("resizeChart",["helpers",function(e){return{priority:100,link:function(t,n,i){var r=function(){var t=$(n).width(),i=e.newHeightByWidth(640,260,t);$(n).height(i)};r(),t.$on("modalResize",r)}}}]).directive("listButton",function(){return{templateUrl:"core/misc/list_button.html",transclude:!0,replace:!0}}).directive("mdInkRippleList",["$mdInkRipple",function(e){return{link:function(t,n,i){e.attach(t,n,{dimBackground:!0,multiplier:.1,moveToCenter:!1})}}}]).directive("mdInkRippleAction",["$mdInkRipple",function(e){return{link:function(t,n,i){e.attachButtonBehavior(t,n,{dimBackground:!1})}}}]).directive("mdInkRippleFit",["$mdInkRipple",function(e){return{link:function(t,n,i){e.attachButtonBehavior(t,n,{dimBackground:!1,fitRipple:!0,moveToCenter:!1})}}}]).directive("icon",["$mdInkRipple",function(e){return{templateUrl:"core/misc/icon.html",replace:!0,transclude:!0,scope:!0,link:function(e,t,n){var i=n.type.split(".");e.type=i[0],e.icon=i[1],e.color=n.color||"normal"}}}]).directive("contentListView",function(){return{scope:{val:"=contentListView"},templateUrl:"core/misc/content_list_view.html"}}).directive("sidenavItem",["$timeout","$mdSidenav",function(e,t){return{templateUrl:"core/misc/sidenav_item.html",transclude:!0,replace:!0}}]).filter("labelize",["GLOBAL_CONFIG","$log",function(e,t){return function(n,i){angular.isUndefined(i)&&(i="default");var r,a=e.labels[i];return angular.isUndefined(a)?(t.warn("Group is not defined: "+i),n):(r=a[n],angular.isDefined(r)?r:(t.warn("Path for label not found: "+i+"."+n),n))}}]).filter("propsFilter",function(){return function(e,t){var n=[];return angular.isArray(e)?e.forEach(function(e){var i,r,a,o=!1,s=Object.keys(t);for(i=0;i<s.length;i++)if(r=s[i],a=t[r].toLowerCase(),-1!==e[r].toString().toLowerCase().indexOf(a)){o=!0;break}o&&n.push(e)}):n=e,n}}).filter("capitalize",function(){return function(e){return _.str.capitalize(e)}}).filter("output",["modelsMeta","outputTypes","$cacheFactory",function(e,t,n){var i=t,r=n("cacheFields"),a=function(t){return r.get(t)||r.put(t,e.getFields(t)),r.get(t)};return function(e,t,n){var r,o,s,c=e[t];if(e.kind&&(r=a(e.kind),o=r[t],angular.isDefined(o))){if(s=i[o.type],angular.isDefined(s))return s(c,o);if(c&&"object"==typeof c&&c.hasOwnProperty("name"))return c.name}return c}}]).filter("escape",function(){return function(e){return e?_.escape(e):e}}).filter("autobr",["helpers",function(e){return function(e){return e?e.replace(/\n\r?/g,"<br />"):e}}]).filter("formatCurrency",["$injector","$locale",function(e,t){var n=e.get("$filter"),i=n("number"),r=t.NUMBER_FORMATS;return r.DEFAULT_PRECISION=angular.isUndefined(r.DEFAULT_PRECISION)?2:r.DEFAULT_PRECISION,function(e,t){if(e=parseFloat(e,10),!angular.isNumber(e)||isNaN(e))return"";var n,r,a,o,s,c,l,u=0>e;return e=Math.abs(e),n=i(e,t.digits),r="<"+n+">",a=t.symbol,a&&(o=u&&t.negative_currency_symbol_precedes||t.positive_currency_symbol_precedes,s=u&&t.negative_separate_by_space||t.positive_separate_by_space,r=o?a+(s?" ":"")+r:r+(s?" ":"")+a),c=u&&t.negative_sign_position||t.positive_sign_position,l=u&&t.negative_sign||t.positive_sign,l||(l=""),0===c?r="("+r+")":1===c?r=l+r:2===c?r+=l:r=3===c?r.replace("<",l):4===c?r.replace(">",l):l+r,r=r.replace("<","").replace(">","")}}]).filter("substr",function(){return function(e){return angular.isString(e)?String.prototype.substr.apply(e,Array.prototype.slice.call(arguments,1)):e}}).filter("nl2br",function(){return function(e){return void 0!==e?e.replace(/\n/g,"<br />"):void 0}}).filter("highlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n&&t?t.replace(new RegExp(e(n),"gi"),'<span class="ui-select-highlight">$&</span>'):t}}).factory("outputTypes",["dateFilter","GLOBAL_CONFIG","modelsMeta",function(e,t,n){var i={SuperDateTimeProperty:function(n,i){var r=new Date(n);return e(r,t.date.format)}};return i}]).factory("searchBuilder",["modelsMeta","GLOBAL_CONFIG",function(e,t){var n=function(){var n={kind:null,hide:!1,filters:{},indexes:[],indexID:null,fields:{indexID:{type:"SuperStringProperty",choices:[],code_name:"indexID",required:!0,ui:{args:"search.indexID",label:t.fields.label.search.indexID,specifics:{translatedChoices:!1},writable:!0,attrs:{"ng-change":"search.makeFilters()"}}},ancestor:{type:"SuperStringProperty",code_name:"ancestor",required:"search.indexes[search.indexID].ancestor",ui:{args:"search.send.ancestor",label:t.fields.label.search.ancestor,writable:!0}},filters:[],orders:[]},mapIndexes:function(e){angular.forEach(e,function(e,t){e._index=t})},formatSearchFilter:function(e){var t,n="";return e&&angular.isObject(e)?(e.ancestor&&!e.filters&&(n+="Ancestor and "),e.filters&&(n+="Filter by ",e.ancestor&&(n+="ancestor and "),t=$.map(e.filters,function(e){return e[0]}),n+=t.join(" and "),e.orders&&(n+=" and ")),e.orders&&(n+=" order by "+$.map(e.orders,function(e){return e[0]}).join(", ")),n):e},resetFilters:function(){this.send.filters=[],this.send.orders=[],delete this.send.ancestor},changeKindUI:function(){this.changeKind(),this.setSearch(this.kind,void 0),this.makeFilters()},changeKind:function(){var t,n,i=e.getActionArguments(this.kind,"search"),r=this;if(i){try{t=i.search,this.default_send=t["default"]}catch(a){}t?this.hide=!1:(this.hide=!0,t={}),n=t.cfg,this.cfg=n,this.send.kind=this.kind,this.filters=n.filters||{},this.indexes=n.indexes||[],this.indexID=null,this.mapIndexes(n.indexes),r.fields.indexID.choices=[],angular.forEach(n.indexes,function(e){var t={key:e._index,name:r.formatSearchFilter(e)};r.fields.indexID.choices.push(t)})}},changeOrderBy:function(e){e.field=this.indexes[this.indexID].orders[e._index][0]},makeFilters:function(e){var n,i,r,a=this;angular.isDefined(e)||(e=!0),e&&this.resetFilters(),a.fields.filters=[],a.fields.orders=[],n=a.indexes[a.indexID],angular.forEach(n.filters,function(n,o){i=a.filters[n[0]],i.required="search.indexID != null && search.send.filters.length",i.code_name="filter_"+n[0],i.ui={args:"search.send.filters['"+o+"'].value",writable:!0},e&&a.send.filters.push({field:n[0],operator:n[1][0],value:i["default"]?i["default"]:"",_index:o}),r={type:"SuperStringProperty",choices:n[1],code_name:"op_"+o,required:i.required,ui:{label:t.fields.label.search.operator,writable:!0,args:"search.send.filters['"+o+"'].operator"}},a.fields.filters.push([r,i])}),angular.forEach(n.orders,function(t,n){e&&a.send.orders.push({field:t[0],operator:t[1][0],_index:n}),i={type:"SuperStringProperty",choices:t[1],code_name:"order_by_"+t[0],required:"search.indexID != null && search.send.filters.length",ui:{writable:!0,args:"search.send.orders['"+n+"'].operator"}},a.fields.orders.push(i)}),n.orders||(a.send.orders=[])},discoverIndexID:function(){var e=this,t=this.send.filters,n=this.send.ancestor,i=this.send.orders;angular.forEach(this.indexes,function(r,a){if(!(n&&!r.ancestor||!n&&r.ancestor)){var o=!0,s=0,c=0;r.filters&&(o=!1,t&&t.length&&(angular.forEach(r.filters,function(e){var n=_.findWhere(t,{field:e[0]});n&&-1!==$.inArray(n.operator,e[1])&&(s+=1)}),t.length===s&&r.filters.length===t.length&&(o=!0,e.indexID=a))),angular.forEach(r.orders,function(e,t){var n=_.findWhere(i,{field:e[0]});o&&n&&-1!==$.inArray(n.operator,e[1])&&(c+=1,n._index=t)}),o&&r.orders&&c===i.length&&r.orders.length===i.length&&(e.indexID=a)}})},setSearch:function(t,n){if(void 0===t||null===t)return void(this.hide=!0);this.kind!==t&&(this.kind=t,this.changeKind(),this.resetFilters());var i=e.getActionArguments(this.kind,"search"),r=null;if(i){try{r=i.search}catch(a){}r&&(void 0===n&&r["default"]?this.send=r["default"]:n&&(this.send=n),this.discoverIndexID(),this.makeFilters(!1))}else this.hide=!0},doSearch:function(){throw new Error("Not implemented")},submitSearch:function(){this.doSearch()},send:{filters:[],orders:[]}};return n};return{create:n}}]).factory("channelApi",["GLOBAL_CONFIG",function(e){var t={instances:{},create:function(e){if(!t.instances[e]){var n;n={callbacks:{},events:{},signals:[],socket:null,afterOnclose:[],onclose:function(e){this.afterOnclose.unshift(e)},channel:new goog.appengine.Channel(e),open:function(e){var t=this;return angular.forEach(e,function(e,n){t[n](e)}),null!==t.socket?t:(t.socket=t.channel.open(t.events),t.socket.onclose=function(){angular.forEach(t.afterOnclose,function(e){e()})},t)},destroy:function(){delete t.instances[e]},queue:function(e,t){var n=this.signals.length;this.signals.push(n),this.callbacks[e].push([t,n])},dispatch:function(e,t){var n=this,i=[];angular.forEach(this.callbacks[e],function(e){return-1===$.inArray(e[1],n.signals)?void i.push(e):(t=_.toArray(t),t.push(function(){n.signals.remove(e[1])}),void e[0].apply(n.socket,t))}),i&&(angular.forEach(i,function(t){n.callbacks[e].remove(t)}),i=[]),n.signals.length||n.socket.close()}},angular.forEach(["onopen","onmessage","onerror"],function(e){n.callbacks[e]=[],n[e]=function(t){this.queue(e,t)},n.events[e]=function(){n.dispatch(e,arguments)}}),n.afterOnclose.push(function(){n.destroy()}),t.instances[e]=n}return t.instances[e]}};return e.debug&&(window._channelApi=t),t}]).factory("channelNotifications",["channelApi","modals",function(e,t){var n={instances:{},create:function(i){var r;return n.instances[i]?r=n.instances[i]:(r=e.create(i),n.instances[i]=r,r.open({onclose:function(){delete n.instances[i]},onmessage:function(e,n){if(n(),angular.isObject(e)&&e.data)try{var i=angular.fromJson(e.data);t.alert("channelNotifications",{title:"Notification from server",messages:[i.body]})}catch(r){}}})),r}};return n}]).directive("collapse",["$animate",function(e){return{link:function(t,n,i){function r(){n.removeClass("collapse").addClass("collapsing"),e.addClass(n,"in",{to:{height:n[0].scrollHeight+"px"}}).then(a)}function a(){n.removeClass("collapsing"),n.css({height:"auto"})}function o(){n.css({height:n[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing"),e.removeClass(n,"in",{to:{height:"0"}}).then(s)}function s(){n.css({height:"0"}),n.removeClass("collapsing"),n.addClass("collapse")}t.$watch(i.collapse,function(e){e?o():r()})}}}])}(),function(){"use strict";var e=function(e){var t=e.popFrom;return t?$(t):t},t=function(e,t){var n=e[0].getBoundingClientRect(),i=t[0].getBoundingClientRect(),r=e.width(),a=e.height(),o=t.width(),s=t.height(),c=o/r,l=1/c,u=s/a,d=1/u,f=-i.left+n.left+n.width/2-i.width/2,p=-i.top+n.top+n.height/2-i.height/2;return{top:p,left:f,scale:{x:l,y:d}}};angular.module("app").factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){var n;for(n=0;n<e.length;n++)if(t===e[n].key)return e[n]},keys:function(){var t,n=[];for(t=0;t<e.length;t++)n.push(e[t].key);return n},top:function(){return e[e.length-1]},remove:function(t){var n,i=-1;for(n=0;n<e.length;n++)if(t===e[n].key){i=n;break}return e.splice(i,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("modalBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,templateUrl:"core/modal/backdrop.html",link:function(t,n,i){t.backdropClass=i.backdropClass||"",e(function(){n.addClass("in")},0,!1)}}}]).directive("modalWindow",["$modalStack","$timeout","$$rAF","$mdConstant","$q","$animate","animationGenerator",function(n,i,r,a,o,s,c){return{restrict:"EA",scope:{index:"@",animate:"=",modalOptions:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"core/modal/window.html"},link:function(s,l,u){var d,f=e(s.modalOptions);l.addClass(s.modalOptions.fullScreen?"":"modal-medium"),u.windowClass&&l.addClass(u.windowClass),s.size=u.size,s.$isRendered=!0,d=function(){var e,n,i,o,u,d,p=s.modalOptions.inDirection,g=p&&!f,m=f,h=!g&&!m,v=!s.modalOptions.fullScreen;g?e=function(){l.addClass(p+" slide drawer visible in")}:v&&(n=l.find(".modal-dialog"),o=n.width(),u=n.height(),s.modalOptions.resize=function(){var e,t,i=$(window).width()-80,r=$(window).height()-48,a=n.width(),s=n.height(),c=u>=r,l=o>=i;e=c||r>s&&c?r:"",t=l||i>a&&l?i:"",n.css("max-height",e),n.css("max-width",t)},s.modalOptions.resize(),$(window).on("resize",s.modalOptions.resize)),f?(i=t(f,l),d=c.single("pop-in","0% {top: "+i.top+"px; left: "+i.left+"px; "+a.RAW_CSS.TRANSFORM+": scale("+i.scale.x+", "+i.scale.y+"); }1% { opacity:1; }75% { top: 0px; left: 0px;}100% { top: 0px; left: 0px; "+a.RAW_CSS.TRANSFORM+": scale(1, 1);opacity:1;}"),e=function(){l.addClass("pop "+d.className).data("animator",d),r(function(){f.css("opacity",0)})}):h&&(e=function(){l.addClass("fade in")}),l.oneAnimationEnd(function(){l.addClass("visible"),$(window).triggerHandler("modal.visible",[l]),s.modalOptions.opened=!0,s.$broadcast("opened")}),$(window).triggerHandler("modal.open",[l]),r(e)},u.$observe("modalRender",function(e){"true"===e&&i(d,50,!1)}),s.close=function(e){var t=n.getTop(),i=o.defer();return i.resolve(),t&&t.value.backdrop&&"static"!==t.value.backdrop&&e.target===e.currentTarget?(e.preventDefault(),e.stopPropagation(),n.dismiss(t.key,"backdrop click")):i.promise},s.backdropClose=s.close}}}]).directive("modalTransclude",function(){return{link:function(e,t,n,i,r){r(e.$parent,function(e){t.empty(),t.append(e)})}}}).factory("$modalStack",["$timeout","$document","$compile","$rootScope","$$stackedMap","mdContextualMonitor","$mdConstant","$q","animationGenerator","$animate","$$rAF",function(n,i,r,a,o,s,c,l,u,d,f){function p(){return v.length()-1}function g(n,i,r){var a,o,s,l=e(i.modalOptions),d="in",p="out",g=n.data("animator");l&&g&&(a=t(l,n),s=u.single("pop-out","0% { opacity:1;top: 0px; left: 0px; "+c.RAW_CSS.TRANSFORM+": scale(1, 1);}75% { top: 0px; left: 0px;}100% { opacity:1;top: "+a.top+"px; left: "+a.left+"px; "+c.RAW_CSS.TRANSFORM+": scale("+a.scale.x+", "+a.scale.y+"); }"),p=s.className,d=g.className),f(function(){n.removeClass(d).addClass(p)}),o=function(e){n.remove(),r&&r(),l&&l.css("opacity",1),n=void 0,g&&g.destroy(),s&&s.destroy()},n.oneAnimationEnd(o),setTimeout(function(){n&&o()},600)}function m(e,t){var n=i.find("body").eq(0),r=v.get(e).value,a=r.backdropDomEl,o=r.backdropScope;v.remove(e),a.removeClass("in").addClass("out").oneAnimationEnd(function(){a.remove(),o.$destroy(),r.backdropScope=void 0,r.backdropDomEl=void 0}),g(r.modalDomEl,r.modalScope,function(){r.modalScope.$destroy(),n.toggleClass(h,v.length()>0),$(window).triggerHandler("modal.close"),t.resolve()})}var h="modal-open",v=o.createNew(),y={};return y.open=function(e,t){var n,o,c,l,u,d,f,g={deferred:t.deferred,modalScope:t.scope,backdrop:t.backdrop};v.add(e,g),t.scope.modalOptions={inDirection:t.inDirection,outDirection:t.outDirection,popFrom:t.popFrom,fullScreen:t.fullScreen,opened:!1},c=i.find("body").eq(0),l=p(),o=a.$new(!0),o.index=l,u=angular.element('<div class="opaque" modal-backdrop></div>'),u.attr("backdrop-class",t.backdropClass),n=r(u)(o),c.append(n),g.backdropDomEl=n,g.backdropScope=o,f=angular.element("<div modal-window></div>"),f.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:v.length()-1,"modal-options":"modalOptions",animate:"animate",exiting:"exiting"}).html(t.content),d=r(f)(t.scope),v.top().value.modalDomEl=d,c.append(d),c.addClass(h),e.esc=function(t){var n=v.get(e);return t&&t.preventDefault(),n&&n.value&&n.value.modalScope&&n.value.modalScope._close_?n.value.modalScope._close_():(a.$apply(function(){y.dismiss(e,"escape key press")}),!0)},s.queue(e.esc)},y._dequeue=function(e,t){s.dequeue(t.esc),e&&e.value&&e.value.modalScope.modalOptions.resize&&$(window).off("resize",e.value.modalScope.modalOptions.resize)},y.close=function(e,t,n){n||(n="resolve");var i=v.get(e),r=l.defer();return y._dequeue(i,e),i?(i.value.deferred[n](t),m(e,r)):r.resolve(),r.promise},y.dismiss=function(e,t){return y.close(e,t,"reject")},y.dismissAll=function(e){for(var t=this.getTop();t;)this.dismiss(t.key,e),t=this.getTop()},y.getTop=function(){return v.top()},y}]).provider("$modal",function(){var e={options:{backdrop:!1,inDirection:"right",outDirection:"right",fullScreen:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,i,r,a,o,s){function c(e){return e.template?i.when(e.template):r.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:a}).then(function(e){return e.data})}function l(e){var n=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(i.when(t.invoke(e)))}),n}var u={};return u.open=function(t){var r=i.defer(),a=i.defer(),u={result:r.promise,opened:a.promise,close:function(e){return s.close(u,e)},dismiss:function(e){return s.dismiss(u,e)}};if(t=angular.extend({},e.options,t),t.resolve=t.resolve||{},!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var d=i.all([c(t)].concat(l(t.resolve)));return d.then(function(e){var i=(t.scope||n).$new();i.$close=u.close,i.$dismiss=u.dismiss;var a,c={},l=1;t.controller&&(c.$scope=i,c.$modalInstance=u,angular.forEach(t.resolve,function(t,n){c[n]=e[l++]}),a=o(t.controller,c),t.controllerAs&&(i[t.controllerAs]=a)),s.open(u,{scope:i,deferred:r,content:e[0],backdrop:t.backdrop,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,size:t.size,inDirection:t.inDirection,outDirection:t.outDirection,fullScreen:t.fullScreen,popFrom:t.popFrom})},function(e){r.reject(e)}),d.then(function(){a.resolve(!0)},function(){a.reject(!1)}),u},u}]};return e}).directive("fitInModal",function(){return{link:function(e,t,n){var i,r=function(n){i&&clearTimeout(i),i=setTimeout(function(){var n=$(t).parents(".modal:first"),i=n.find(".modal-dialog:first"),r=n.hasClass("modal-medium")?parseInt(-1===i.css("max-height").indexOf("%")?i.css("max-height"):0,10)||i.height():$(window).height();i.find(".fixed-height, .min-height, .max-height").each(function(){var e=r,t=i.find(".md-actions"),n=i.find("md-toolbar"),a="height";t.length&&(e-=t.outerHeight()),n.length&&(e-=n.outerHeight()),$(this).hasClass("min-height")&&(a="min-height"),$(this).hasClass("max-height")&&(a="max-height"),$(this).css(a,e)}),e.$broadcast("modalResize")},50)};$(window).bind("resize modal.open",r),e.$on("$destroy",function(){$(window).unbind("resize modal.open",r)})}}}).factory("modals",["$modal","$q","helpers","GLOBAL_CONFIG",function(e,t,n,i){var r={alert:function(e,t,n){return r.confirm(e,t,n,!0)},confirm:function(e,t,r,a){var o,s={message:e+" missing config, see core/config/config.js"};return angular.isFunction(t)?o={confirm:t}:angular.isObject(t)&&(o=t),angular.isDefined(r)&&(angular.isObject(r)?o=r:o.message=r),o=n.alwaysObject(o),n.extendDeep(s,o,i.modals[a?"alerts":"confirmations"][e]),s.noSecondary=a,s.confirm=function(){var e=this;return o.noAutoDismiss?o.confirm.call(e):void this.dismiss().then(function(){angular.isFunction(o.confirm)&&o.confirm.call(e)})},this.create(s,s.modal)},create:function(t,i){var r,a={message:""};return n.extendDeep(a,t),r={fullScreen:!1,inDirection:!1,outDirection:!1,templateUrl:"core/misc/confirm.html",controller:["$scope",function(e){var n=angular.isFunction(t)?t:t.ok?t.ok:null;a.dismiss=function(){var t=e.$close();return t.then(function(){n&&n.call(e)}),t},angular.isObject(t)||(t={}),a.message&&!a.messages&&(a.messages=[a.message]),e.config=a,$.extend(e,a.scope),a.scope=void 0}]},$.extend(r,i),e.open(r)}};return i.debug&&(window._modals=r),r}])}(),function(){"use strict";angular.module("app").run(["modals","helpers","models","$modal","modelsMeta","snackbar",function(e,t,n,i,r,a){e.models||(e.models={}),e.models.sudo=function(e,o){var s={fullScreen:!1,popFrom:!1,inDirection:!1,outDirection:!1,templateUrl:null,controller:["$scope",function(i){var s=r.getActionArguments(e.kind,"sudo");i.args={},i.fields=s,angular.forEach(i.fields,function(t){$.extend(t.ui,{writable:!0,label:!1,attrs:{"native-placeholder":"","class":"full-width"}}),i.args[t.code_name]=e[t.code_name]}),i.fields.message.ui.placeholder="Write message to user!",i.fields.note.ui.placeholder="Write note to admins!",i.validateForm=angular.bind(i,t.form.validate),i.container={},i.config={},i.config.dismiss=function(){return i.$close()},i.config.text={primary:"Ok"},i.config.confirm=function(){if(i.validateForm()){var r=n[e.kind].actions.sudo(i.args);r.then(function(e){o.onConfirm&&o.onConfirm(e.data.entity),i.config.dismiss(),a.showK("administered")})}else t.form.wakeUp(i.container.form)}}]};$.extend(s,o),i.open(s)},t.models||(t.models={}),$.extend(t.models,{isEntityListEmpty:function(e){var t,n=!e||0===e.length;return n||(t=0,angular.forEach(e,function(e){"deleted"===e._state&&(t+=1)}),n=t===e.length),n}})}]).value("modelsInfo",{}).value("currentAccount",{}).factory("modelsMeta",["$injector","GLOBAL_CONFIG",function(e,t){var n={},i=function(e,t){angular.forEach(e,function(e,n){void 0===e.ui&&(e.ui={}),null===e.code_name&&(e.code_name=n),e._maker_=t,void 0!==e.modelclass&&i(e.modelclass,e.modelclass_kind)})};return n.friendlyActionName=function(e,t){var n,i,r=this.get(e);return void 0===r?void 0:(n=r.actions,angular.forEach(n,function(e){e.key===t&&(i=e.id)}),i)},n.getFields=function(e){if(!angular.isDefined(e))return void console.error("provided kind id is not acceptable, got: "+e);var t,n=this.get(e);return angular.isDefined(n)?(t=angular.copy(n.fields),i(t,e),t):void console.error("could not find meta info for kind "+e)},n.getDefaultActionArguments=function(e,t){var n=this.getActionArguments(e,t),i={};return angular.forEach(n.arguments,function(e){null!==e["default"]&&(i[e.code_name]=e["default"])}),i},n.getActionArguments=function(e,t){var n,r,a=this.get(e),o={};return angular.isDefined(a)?angular.isDefined(t)?(n=a.mapped_actions[t],angular.isDefined(n)?(r=angular.copy(n.arguments),i(r,e+"-"+t),r):void console.error("action "+t+" not found for kind "+e)):(angular.forEach(a.mapped_actions,function(t){r=angular.copy(t.arguments),i(r,e+"-"+t.id),o[t.id]=r}),o):void 0},n.getActions=function(e){var t,n=this.get(e);return angular.isDefined(n)?(t=n.mapped_actions,angular.forEach(t,function(t){i(t.arguments,e+"-"+t.id)}),t):void 0},n.getName=function(e){var t=this.get(e);return angular.isDefined(t)?t.name:void console.error("model name not found for kind "+e)},n.get=function(t){var n,i=e.get("modelsInfo"),r=i[t],a={},o={};return void 0===r?void console.error("no info for kind "+t):(angular.forEach(r,function(e,t){"_actions"!==t&&"__name__"!==t&&(a[t]=e)}),angular.forEach(r._actions,function(e){o[e.id]=e}),n={actions:r._actions,mapped_actions:o,fields:a,name:r.__name__})},t.debug&&(window._modelsMeta=n),n}]).factory("ruleEngine",["modelsMeta",function(e){var t={run:function(t){var n={},i={},r=e.get(t.kind),a=t._action_permissions,o=t._field_permissions,s=r.actions,c={action:n,input:i,field:o},l=function(e){return a[s[e].key]},u=function(e){var t=l(e);return t.executable};return void 0===a?void 0:(angular.forEach(s,function(e,t){c.action[e.id]||(c.action[e.id]={}),c.action[e.id].executable=u(t),angular.forEach(e.arguments,function(t){var n=t.code_name;c.input[e.id]||(c.input[e.id]={}),c.input[e.id][n]=t})}),c)}};return t}]).factory("modelsUtil",["modelsMeta","ruleEngine","GLOBAL_CONFIG",function(e,t,n){var i={normalizeMultiple:function(e){angular.forEach(e,function(e){i.normalize(e)})},argumentsToJson:function(e,t){var n=["_field_permissions","_next_read_arguments","_read_arguments","_action_permissions","ui"];return JSON.stringify(e,function(e,t){var i,r=t;return angular.isObject(t)&&t.ui&&(i={},angular.forEach(t,function(e,t){-1===$.inArray(t,n)&&(i[t]=e)}),r=i),"string"==typeof e&&"$"===e.charAt(0)?r=void 0:t&&t.document&&t.location&&t.alert&&t.setInterval?r="$WINDOW":t&&document===t?r="$DOCUMENT":t&&t.$evalAsync&&t.$watch&&(r="$SCOPE"),r},t?"  ":null)},normalize:function(n,r,a,o,s,c){n.ui&&n.ui.normalized||(void 0===r&&(r=e.getFields(n.kind)),void 0===c&&(n.ui={},n.ui.normalized=!0,n.ui.access=[],o&&(n.ui.access.extend(a.ui.access),n.ui.access.push(o),void 0!==s&&n.ui.access.push(s)),void 0===a&&(n.ui.rule=t.run(n))),angular.forEach(r,function(e){var t=e["default"],r=n[e.code_name];"SuperDateTimeProperty"!==e.type||t||(t=new Date),e.repeated&&!angular.isArray(t)&&(t=[]),(void 0===r||null===r)&&null!==t&&void 0!==t&&(n[e.code_name]=t),"SuperDateTimeProperty"===e.type&&angular.isString(r)&&(n[e.code_name]=new Date(r)),e.is_structured&&(e.repeated?angular.forEach(r,function(t,r){i.normalize(t,e.modelclass,n,e.code_name,r)}):((void 0===r||null===r)&&e.required&&(r={kind:e.modelclass_kind},n[e.code_name]=r),void 0!==r&&null!==r&&i.normalize(r,e.modelclass,n,e.code_name,void 0,c)))}))}};return n.debug&&(window._modelsUtil=i),i}]).factory("modelsEditor",["$modal","endpoint","$q","helpers","modelsUtil","errorHandling","models","modelsMeta","$timeout","$filter","formInputTypes","recordBrowser","snackbar",function(e,t,n,i,r,a,o,s,c,l,u,d,f){var p={create:function(n){var a,p,g={showClose:!0,closeAfterSave:!1,action:"update",templateBodyUrl:"core/models/manage_body_default.html",scope:{},fields:[],init:angular.noop,getScope:null,defaultInit:angular.noop,defaultArgumentLoader:function(e){var t=angular.copy(e.entity),n=s.getActionArguments(e.config.kind,e.config.action),i={};return angular.forEach(n,function(e){var n=t[e.code_name];void 0===n&&null!==e["default"]&&void 0!==e["default"]&&(n=e["default"]),void 0!==n&&(i[e.code_name]=n)}),e.entity.key&&(i.key=t.key),e.entity.id&&(i.id=t.id),i.ui=t.ui,t._read_arguments&&(i.read_arguments=t._read_arguments),t._next_read_arguments&&(i._next_read_arguments=t._next_read_arguments),$.extend(i,e.withArgs),i.action_id=e.config.action,i.action_model=e.config.kind,i},argumentLoader:function(e){return this.defaultArgumentLoader(e)},defaultPrepareReadArguments:function(e){angular.isObject(e.args.read_arguments)||(e.args.read_arguments={});var t=e.args.read_arguments,n=function(e,t,n){if(angular.isArray(e)){var i=n[t];i||(i={config:{}}),i.config||(i.config={}),e&&angular.isObject(e[0])&&(i.config.keys=$.map(e,function(e){return e.key})),n[t]=i}};angular.forEach(e.args,function(e,i){n(e,i,t)})},prepareReadArguments:function(e){this.defaultPrepareReadArguments(e)}};return i.mergeDeep(n,g),!angular.isDefined(n.fields)&&angular.isDefined(n.kind)&&angular.isDefined(n.action)&&(n.fields=[],a=s.getActionArguments(n.kind,n.action),angular.forEach(a,function(e){angular.isDefined(n.excludeFields)&&-1!==$.inArray(e.code_name,n.excludeFields)||n.fields.push(e)})),n.keyedFields={},angular.forEach(n.fields,function(e){n.keyedFields[e.code_name]=e}),console.log("modelsEditor.config",n),p={config:n,read:function(e,t){void 0===t&&(t={key:e.key});var i=this;return o[n.kind].actions.read(t).then(function(n){
$.extend(e,n.data.entity),i.open(e,t)}),this},prepare:function(e,t){var i=this;return o[n.kind].actions.prepare(t).then(function(n){$.extend(e,n.data.entity),i.open(e,t)}),this},open:function(a,s){var p,g=e,m="open";return p=function(e){var p,g,m=l("inflector"),h={},v=!1,y=function(){if(v||!e.entity.id)return!1;if(angular.isDefined(e.historyConfig)||(e.historyConfig=!1),e.historyConfig===!0)e.historyConfig={kind:n.kind,key:e.entity.key};else if(e.historyConfig===!1)return!1;v=!0;var t=e.args.ui.rule.field._records;e.historyConfig.key=e.entity.key,t&&t.visible&&e.layouts.groups.push(d.attach(e.historyConfig))},b="edit"+n.kind,_="add"+n.kind;n.getScope=function(){return e},r.normalize(a),n.toolbar||(n.toolbar={}),angular.isUndefined(n.toolbar.titleEdit)&&(n.toolbar.titleEdit=b),angular.isUndefined(n.toolbar.titleAdd)&&(n.toolbar.titleAdd=_),e.container={action:t.url},e.withArgs=s,e.config=n,e.dialog={toolbar:n.toolbar,templateBodyUrl:n.templateBodyUrl},e.entity=a,e.args=n.argumentLoader(e),e.rootScope=e,e.formSetPristine=angular.bind(e,i.form.setPristine),e.formSetDirty=angular.bind(e,i.form.setDirty),e.validateForm=angular.bind(e,i.form.validate),e.setAction=function(t){e.args.action_id=t,n.action=t},e.save=function(t){if(!e.validateForm())return!1;n.prepareReadArguments(e);var i=o[n.kind].actions[e.args.action_id](e.args);return i.then(function(i){$.extend(e.entity,i.data.entity);var r=n.argumentLoader(e);$.extend(e.args,r),y(),angular.isDefined(n.afterSave)&&n.afterSave(e),e.formSetPristine(),t||f.showK("changesSaved")},function(t){angular.isDefined(n.afterSaveError)&&n.afterSaveError(e,t)}),i},e.complete=function(t){$.extend(e.entity,t.data.entity);var i=n.argumentLoader(e);$.extend(e.args,i),y(),angular.isDefined(n.afterComplete)&&n.afterComplete(e),n.closeAfterSave&&c(function(){e.close()}),e.formSetPristine(),f.showK("changesSaved"),console.log("modelsEditor.complete",e)},e.noComplete=function(){angular.isDefined(n.noComplete)&&n.noComplete(e)},e.completeError=function(t){angular.isDefined(n.afterCompleteError)&&n.afterCompleteError(e,t)},e.close=angular.bind(e,i.form.leave,function(){e._close_=void 0,e.$close(),n.afterClose&&n.afterClose(e)}),e._close_=e.close,g=function(){var t,n=e.dialog.toolbar;return e.entity.id?(angular.isDefined(n.titleEdit)&&(n.title=i.toolbar.title(n.titleEdit)),t=n.titleEdit):(angular.isDefined(n.titleAdd)&&(n.title=i.toolbar.title(n.titleAdd)),t=n.titleAdd),t},n._title_=[g],e.$watch("entity.id",g),angular.forEach(n.fields,function(e){e._title_=n._title_.concat()}),angular.isDefined(n.scope)&&$.extend(e,n.scope),e.formBuilder={0:[]},angular.isDefined(e.layouts)?angular.forEach(e.layouts.groups,function(t,i){if(e.formBuilder[i]=[],angular.isDefined(t.fields))angular.forEach(t.fields,function(t){h[t]||(p=n.keyedFields[t],e.formBuilder[i].push(p),h[t]=1)});else{var r=!1;angular.forEach(n.fields,function(t){r||h[t.code_name]||(h[t.code_name]=1,t.is_structured&&(r=!0),e.formBuilder[i].push(t))})}}):(e.layouts={groups:[{label:!1}]},angular.forEach(n.fields,function(t){if(t.is_structured&&u[t.type]){t.ui.initialLabel||(t.ui.initialLabel=t.ui.label),e.layouts.groups.push({label:m(t.ui.initialLabel||t.code_name,"humanize")}),t.ui.label=!1;var n=e.layouts.groups.length-1;angular.isDefined(e.formBuilder[n])||(e.formBuilder[n]=[],e.formBuilder[n].push(t)),e.layouts.groups[0].disabled=!1}else e.formBuilder[0].push(t)})),e.$watch("dialog.toolbar.title",function(t){angular.isObject(e.historyConfig)&&(e.historyConfig.title=t)}),n.defaultInit(e),n.init(e),console.log("modelsEditor.scope",e),y(),e.$on("$destroy",function(){n.getScope=void 0})},p.$inject=["$scope"],g[m]($.extend({templateUrl:"core/models/manage.html",controller:p},n.modalConfig)),this}}}};return p}]).factory("modelsConfig",function(){var e=[];return function(t){return t===!0?e:void e.push(t)}}).factory("models",["endpoint","modelsMeta","$injector","modelsConfig","helpers","$q","GLOBAL_CONFIG",function(e,t,n,i,r,a,o){var s={},c=function(n){var i={},a={kind:n,actions:{},getCacheKey:function(e){return this.kind+"_"+e},removeCache:function(t){return e.removeCache(this.getCacheKey(t))},getCache:function(t){return e.getCache(this.getCacheKey(t))},get:function(e){return angular.isDefined(this.actions.search)?this.actions.search({search:{keys:[e]}}):void console.error("get() relies on actions.search action. use actions.read() instead.")},paginate:function(e){var n=this,i={args:{search:{}},config:{}},a=t.getActionArguments(e.kind,"search"),o={loading:!1,more:null,cursor:null,args:i.args,load:function(){var t;return this.loading||this.more===!1?!1:(i.args.search.options||(i.args.search.options={}),i.args.search.options.start_cursor=this.cursor,this.loading=!0,t=n.actions[i.action?i.action:"search"](i.args,i.config),t.then(function(t){o.more=t.data.more,o.cursor=t.data.cursor,angular.isFunction(e.complete)&&e.complete.call(this,t)})["finally"](function(){o.loading=!1}),t)}};return i.args.search=a.search["default"],angular.isDefined(e.args)&&(r.merge(e.args,i.args),$.extend(i,e)),o},reader:function(e){if(!angular.isArray(e.access))return void console.error("path must be array, "+typeof e.access+" given");var t,n,i,a,o=this,c=function(e){return r.getProperty(e,t.join(".")+".config.more")},l=function(e){t=[],angular.forEach(e,function(e){isNaN(parseInt(e,10))&&t.push(e)})};return angular.isUndefined(e.next)&&(i={},a=e.args,e.next=i,angular.forEach(e.access,function(e,t){!angular.isDefined(i[e])&&isNaN(parseInt(e,10))&&(i[e]={config:{}},i=i[e]),a=a[e],angular.isUndefined(a)||null!==a.key&&angular.isDefined(a.key)&&(angular.isDefined(i.config.keys)||(i.config.keys=[]),i.config.keys.push(a.key))})),l(e.access),n={next:null,loading:!1,access:e.access,more:c(e.next),config:e,loaded:!1,state:function(e){this.next=e.next,angular.isDefined(e.access)&&(this.access=e.access,l(this.access)),this.more=angular.isDefined(e.more)?e.more:c(this.next)},setNextReadArguments:function(e){this.next=e,this.more=c(this.next)},setAccess:function(e){this.access=e,l(e),this.more=c(this.next)},load:function(){if(this.more===!1||this.loading)return!1;var i,a,l=this,u=l.next;return u||(u=angular.copy(e.next)),this.more||(a=u,angular.forEach(t,function(e,t){angular.isUndefined(u[e])?u[e]={}:u=u[e]}),u=a),this.loading=!0,i=e.read?e.read(u):(e.kind?s[e.kind]:o).actions.read({key:e.key,read_arguments:u}),i.then(function(t){var n,i,a=[];angular.forEach(l.access,function(e){isNaN(parseInt(e,10))||(e=0),a.push(e)}),n=r.getProperty(t.data.entity,a),angular.isFunction(e.complete)&&e.complete(n),i=t.data.entity._next_read_arguments,l.more=c(i),l.more&&(l.next=i)})["finally"](function(){n.loading=!1,n.loaded=!0}),i}}}};return a.config=i,angular.forEach(t.getActions(n),function(r,o){a.actions[o]=function(r,a){var s,c=t.getDefaultActionArguments(n,o),l=angular.copy(i);return $.extend(c,r),angular.isDefined(a)&&(a.merge?$.extend(l,a):l=a),s=i.cache,angular.isDefined(l)&&l.cache&&(s=l.cache),s===!0&&(s=n+"_"+o+"_"+window.btoa(angular.toJson(c))),angular.isDefined(s)&&s!==!1?(delete l.cache,e.cached(s,o,n,c,l)):e.post(o,n,c,l)}}),a};return s.initialized=!1,s.init=function(){if(s.initialized!==!0){var e,t=n.get("modelsInfo");angular.isDefined(t[0])&&(angular.forEach(t,function(e,t){s[t]=c(t)}),e=i(!0),angular.forEach(e,function(e){e(s)}),s.initialized=!0)}},o.debug&&(window._models=s),s}])}(),function(){"use strict";angular.module("app").factory("recordBrowser",["models","GLOBAL_CONFIG","$modal",function(e,t,n){return{attach:function(i){return{label:t.subheaders.history,include:"core/misc/action.html",action:function(){n.open({templateUrl:"core/models/manage.html",controller:["$scope",function(t){t.dialog={templateBodyUrl:"core/record/list.html",toolbar:{hideSave:!0,leftIcon:"navigation.arrow-back",title:i.title+" / History"}};var r={access:["_records"],key:i.key,next:{_records:{config:{more:!0,search:{orders:[{field:"logged",operator:"desc"}]}}}},complete:function(e){t.history.records.extend(e)}};$.extend(r,i.reader),t.close=t.$close,t.history={records:[],reader:e[i.kind].reader(r),view:function(e){n.open({templateUrl:"core/models/manage.html",controller:["$scope",function(t){t.record=e,t.dialog={},t.dialog.templateBodyUrl="core/record/view_body.html",t.dialog.toolbar={hideSave:!0,title:"Log for date  "+e.logged},t.close=function(){t.$close()}}]})}},t.history.reader.load()}]})}}}}}])}(),function(){"use strict";angular.module("app").directive("selectInput",["$simpleDialog","$$rAF","$mdConstant","underscoreTemplate","$timeout","$parse","helpers","$q","$modal",function(e,t,n,i,r,a,o,s,c){return{replace:!0,transclude:!0,require:["ngModel","^?mdInputContainer","^?form"],templateUrl:"core/select/input.html",scope:!0,link:function(o,l,u,d){var f,p,g=d[0],m=d[1],h=d[2],v=o.$eval(u.items),y=o.$eval(u.view),b=o.$eval(u.search),w=o.$eval(u.multiple),k=u.placeholder,x={},A=!1;m.input=l,p=function(e){var t=!g.$isEmpty(e);return angular.isArray(e)&&(t=0!==e.length),m.setHasValue(t),e},o.$watch(function(){return g.$invalid&&g.$touched},m.setInvalid),g.$parsers.push(p),g.$formatters.push(p),l.on("keyup",function(e){e.keyCode===n.KEY_CODE.ENTER&&x.open()}),l.on("click",function(e){A||x.open(),A=!1,e.preventDefault()}),l.on("blur",function(e){m.setFocused(!1)}),o.$on("$destroy",function(){m.setFocused(!1),m.setHasValue(!1),m.input=null}),x.getHash=function(e){return angular.isObject(e)?e.key:e},x.placeholder=k,x.loading=!1,x.multiple=w,x.items=[],x.find=function(e){if(null===e)return void 0;var t,n,i=function(e){var t,n;return angular.isObject(x.items[0])?n=_.findWhere(x.items,{key:e}):(t=x.items.indexOf(e),-1!==t&&(n=x.items[t])),n};return x.multiple?(n=[],t=[],e&&e.length&&angular.forEach(e,function(e){var r=i(e);angular.isUndefined(r)?n.push(e):t.push(r)})):(t=i(e),angular.isUndefined(t)&&(n=e)),angular.isDefined(n)&&n.length&&x.search&&x.search.ready&&x.search.ready.then(function(){x.search.missing&&x.search.missing(n)}),t},x.getActive=function(){return x.item=x.find(g.$modelValue),x.item},x.setItems=function(e){x.items=e,x.collectActive()},x.isSelected=function(e){var t=x.getHash(e);return x.multiple?-1!==$.inArray(t,g.$modelValue):g.$modelValue===t},x.anyUnselected=function(){return!0},x.anySelected=function(){return!0},x.multipleSelection={},x.multipleSelect=function(e){var t=x.getHash(e),n=!x.multipleSelection[t],i=g.$modelValue||[],r=-1!==$.inArray(t,g.$modelValue);x.multipleSelection[t]=n,x.multiple||(angular.isArray(x.item)||(x.item=i),n?r||(i.push(t),x.item.push(e)):r&&(i.remove(t),x.item.remove(e)),g.$setViewValue(i),h.$setDirty(),p(i))},x.completeMultiSelection=function(){var e=[],t=[];angular.forEach(x.items,function(n){var i=x.getHash(n);x.multipleSelection[i]&&(e.push(i),t.push(n))}),g.$setViewValue(e),h.$setDirty(),p(e),x.item=t,x.close()},x.collectActive=function(){angular.forEach(x.items,function(e){var t=x.getHash(e);angular.isUndefined(x.multipleSelection[t])&&-1!==$.inArray(t,g.$modelValue)&&(x.multipleSelection[t]=!0)})},x.isChecked=function(e){return x.multipleSelection[x.getHash(e)]},x.select=function(e){var t=x.getHash(e);g.$setViewValue(t),x.item=e,x.close()},x.close=angular.noop,x.opened=!1,x.open=function(e){x.opened||(x.opened=!0,r(function(){x.openSimpleDialog(e)}))},x.openSimpleDialog=function(r){if(!l.attr("disabled")){x.search&&(x.search.query={}),x.multipleSelection={},x.collectActive();var o,u,d=l.parents(".modal:first").find(".modal-dialog:first");d.length||(d=l.parents("body:first")),o=i.get("core/select/choices.html")({select:x}),u=o,x.multiple&&(u=i.get("core/select/multiple.html")().replace("{{content}}",o),r=void 0),(x.multiple?c.open:e.show)({template:u,popFrom:r?r.target:void 0,targetEvent:r,parent:d,inDirection:!1,outDirection:!1,fullScreen:!1,disableScroll:[l.parents("md-content:first"),l.parents(".fixed-height:first")],onBeforeHide:function(e,t){$(window).off("resize",t.resize)},onBeforeShow:function(e,i){var r=s.defer(),o=r.promise,c=!1,u=e.find('[tabindex="2"]'),f=function(){var o=l.parents("md-input-container:first");i.resize=function(){var t,r,a,s,c,f,p,g=o.offset(),m=l.offset(),h=i.parent,v=h.offset(),y=24,$=24,b=i.parent.height(),_=e.find("md-content"),w=e.find(".list-row-is-active"),k=d.find("md-toolbar"),A=0;w.length?(r=w.offset(),f=r,c=w):(f=u.offset(),c=u),k.length&&(A=k.height()),t=v.top+y+A,p=b-($+y+A),e.width(o.width()),e.height()>b||_.prop("scrollHeight")>b||e.height()>p?e.css({top:t,left:m.left}).height(p):(e.css(m),a=w.length?m.top-r.top+w.height()/5:g.top-e.height()/2+y,a>t?(s=a+e.height(),s+24>b&&(a-=s-(b-24),t>a&&(a=t)),e.css("top",a)):e.css("top",t)),w.length&&!x.multiple&&_.scrollTop(_.scrollTop()-_.offset().top+w.offset().top),f&&e.css(n.CSS.TRANSFORMORIGIN,f.left+o.width()/2+"px "+(f.top+w.height()/2-_.scrollTop())+"px 0px")},i.resize(),$(window).on("resize",function(){setTimeout(i.resize,100)}),e.oneAnimationEnd(function(t){r.resolve(),c=e.find(".list-row-is-active:first"),c.length||(c=u),x.search?setTimeout(function(){e.find('input[type="search"]').focus()},100):c.focus(),e.addClass("opacity-in")}).on("keyup",function(t){if(c){var i=c,r=!1,o=-1;t.keyCode===n.KEY_CODE.DOWN_ARROW?(c=c.next(),r=!0):t.keyCode===n.KEY_CODE.UP_ARROW?(c=c.prev(),r=!0):t.keyCode===n.KEY_CODE.ENTER&&(c=e.find(".simple-dialog-option:focus"),c.length||(c=e.find(".list-row-is-active:first")),o=c.length?a(c.attr("item"))(c.scope()):x.items[0],o&&x.select(o)),!c.length&&r&&(c=i),r&&c.focus()}}),t(function(){e.addClass("fade in"),A=!1})};return t(f),o},controller:["$scope",function(t){x.close=function(){x.multiple?t.$close():e.hide()},t.select=x,t.$on("$destroy",function(){x.opened=!1,m.setFocused(!1),l.focus()})}]})}},x.view=y,y||(x.view=function(e){return angular.isObject(e)?e.name:e}),g.$formatters.push(function(e){return x.item=x.find(e),e}),x.isFilterMatch=function(e){if(!b)return!0;var t,n,i=x.getFindTerm(),r=x.search.query;return x.search.filterProp&&(r=r[x.search.filterProp]),!r||r.length<1?!0:(t=x.search.filterProp?e[x.search.filterProp]:e,n=-1!==t.toString().toLowerCase().indexOf(i))},x.getFindTerm=function(){return a(x.search.filterProp)(x.search.query)},b&&(x.search={query:{},delay:200,doFind:function(){var e=x.getFindTerm();f&&clearTimeout(f),x.search.find&&(f=setTimeout(function(){x.search.find(e)},x.search.delay)),r(function(){$(window).triggerHandler("resize")},0,!1)}},$.extend(x.search,b),x.search.filterProp=x.search.filterProp?x.search.filterProp:"name",x.search.model||(x.search.model="select.search.query."+x.search.filterProp),!x.search.filter),x.setItems(v),o.$watchGroup([u.items+".length",u.items],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(x.setItems(o.$eval(u.items)),x.getActive(),x.opened&&r(function(){$(window).triggerHandler("resize")},0,!1))}),o.select=x}}}])}(),function(){"use strict";angular.module("app").directive("imageSlider",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(e,n,i){var r,a=t(i.imageSliderLoadMore),o=n.parent(".image-slider-outer:first"),s=!0,c=function(t,n){return s?(s=!1,void a(e,{callback:function(e,t){n(),s=t}})):!1},l=function(){var e=0;n.find(".image-slider-item").filter(function(){return"none"!==$(this).css("display")}).each(function(){e+=$(this).width()}),n.width(Math.ceil(e))},u=function(){var t=o.parents(".fixed-height:first").height(),n=o.parents(".modal:first").find(".new-pricetag-bar");n.length&&(t-=n.outerHeight()),t&&(o.height(t),e.$broadcast("imageSliderResized",t))};u(),e.$on("modalResize",u),e.$on("reMeasureImageSlider",function(){u(),l()}),e.$on("readyImageSlider",function(){u(),l(),r=new Steady({throttle:100,scrollElement:o.get(0),handler:c}),r.addTracker("checkLeft",function(){if(a){var e,t,n=o.get(0);return n?(e=n.scrollWidth-n.clientWidth,t=e-o.scrollLeft(),300>t?!0:!1):void r.stop()}}),r.addCondition("checkLeft",!0),o.data("steady",r)}),e.$on("$destroy",function(){r&&(r.stop(),o.data("steady",void 0))})}}}]).directive("sliderImage",["$timeout","helpers","GLOBAL_CONFIG",function(e,t,n){return{restrict:"A",link:function(i,r,a){var o=i.$eval(a.sliderImage),s=function(){var e=r.parents(".modal:first").find(".new-pricetag-bar"),i=r.parents(".fixed-height:first").innerHeight()-window.SCROLLBAR_WIDTH-(e.length?e.outerHeight():0),a=Math.ceil(i*o.proportion),s=t.closestLargestNumber(n.imageSizes,i),c=i;a=t.newWidthByHeight(a,c,i),r.attr("src",o.serving_url+"=s"+s).width(a).height(i),r.parents(".image-slider-item:first").width(a).height(i)},c=function(){s(),i.$emit("reMeasureImageSlider")};e(function(){s(),i.$last&&i.$emit("readyImageSlider")}),i.$on("modalResize",c),i.$on("itemDelete",function(){e(c)})}}}])}(),function(){"use strict";angular.module("app").factory("social",["$modal","GLOBAL_CONFIG",function(e,t){var n={share:function(t,n){e.open({templateUrl:"core/social/share.html",controller:["$scope",function(e){e.socials=[{name:"Facebook",key:"facebook",command:"https://www.facebook.com/sharer.php?s=100&p[url]={p[url]}&p[images][0]={p[images][0]}&p[title]={p[title]}&p[summary]={p[summary]}",require:["href"]},{name:"Twitter",key:"twitter",command:"https://twitter.com/intent/tweet?text={text}&url={url}",require:["url","text"]},{name:"Pinterest",key:"pinterest",command:"https://www.pinterest.com/pin/create/button/?url={url}&media={media}&description={description}",require:["url","media","description"]},{name:"Reddit",key:"reddit",command:"https://www.reddit.com/submit?url={url}&title={title}",require:["url","title"]},{name:"Linkedin",key:"linkedin",command:"https://www.linkedin.com/shareArticle?url={url}&title={title}",require:["url","title"]},{name:"Google+",icon:"googleplus",key:"googleplus",command:"https://plus.google.com/share?url={url}",require:["url"]},{name:"Tumblr",key:"tumblr",command:"https://www.tumblr.com/share/link?url={url}&name={name}&description={description}",require:["url","name","description"]}],e.getIcon=function(e){return"/client/dist/static/social/"+(e.icon||e.name.toLowerCase())+".png"},e.share=function(e){var n,i=$(window).width()/1.3,r=$(window).height()/1.3,a=screen.width/2-i/2,o=screen.height/2-r/2,s=e.command;return angular.forEach(e.require,function(n){var i=t[e.key][n];angular.isUndefined(i)?(s=s.replace("&"+n+"={"+n+"}",""),s=s.replace("?"+n+"={"+n+"}","")):s=s.replace("{"+n+"}",encodeURIComponent(t[e.key][n]))}),n=window.open(s,"Share to "+e.name,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=1, resizable=no, copyhistory=no, width="+i+", height="+r+", top="+o+", left="+a),n.focus(),n},e.container={},e.embed={enabled:n,values:{width:"100%",height:"100%",code:""},setCode:function(){var t=e.embed.values;return t.code='<iframe width="'+t.width+'" height="'+t.height+'" src="'+n.src+'" frameborder="0" allowfullscreen></iframe>',t.code},fields:[{type:"SuperStringProperty",code_name:"width",required:!0,ui:{writable:!0,args:"embed.values.width",parentArgs:"embed.values",attrs:{"ng-change":"embed.setCode()"}}},{type:"SuperStringProperty",code_name:"height",required:!0,ui:{writable:!0,args:"embed.values.height",parentArgs:"embed.values",attrs:{"ng-change":"embed.setCode()"}}},{type:"SuperTextProperty",code_name:"code",ui:{writable:!0,args:"embed.values.code",parentArgs:"embed.values",attrs:{readonly:"true",onclick:"this.select()"}}}]},e.embed.setCode(),e.close=e.$close}]})}};return t.debug&&(window._social=n),n}])}(),angular.module("app").directive("uploadSubmit",["$parse",function(e){function t(e,n){e=angular.element(e);var i=e.parent();return n=n.toLowerCase(),i&&i[0].tagName.toLowerCase()===n?i:i?t(i,n):null}return{restrict:"AC",link:function(e,n,i){n.bind("click",function(e){if(e&&(e.preventDefault(),e.stopPropagation()),!n.attr("disabled")){var i=t(n,"form");i.triggerHandler("submit"),i[0].submit()}})}}}]).directive("ngUpload",["$log","$parse","$document","$rootScope","errorHandling","modelsUtil",function(e,t,n,i,r,a){function o(e){var t,i=n.find("head");return angular.forEach(i.find("meta"),function(n){n.getAttribute("name")===e&&(t=n)}),angular.element(t)}var s=1;return{require:"form",restrict:"AC",link:function(n,c,l,u){function d(e){n.$isUploading=e}function f(){b.unbind("load"),n.$$phase?d(!1):n.$apply(function(){d(!1)});var t,o=(b[0].contentDocument||b[0].contentWindow.document).body;try{t=angular.fromJson(o.innerText||o.textContent)}catch(s){t=o.innerHTML,e.warn("Response is not valid JSON")}var c={content:{data:t}},l=t&&angular.isObject(t)&&!t.errors;$&&l&&(angular.isDefined(t.entities)?a.normalizeMultiple(t.entities):angular.isDefined(t.entity)&&a.normalize(t.entity)),l?n.$$phase?m(n,c):n.$apply(function(){m(n,c)}):n.$$phase?h(n,c):n.$apply(function(){h(n,c)}),i.$broadcast("disableUI",!1),l?n.$broadcast("ngUploadComplete",t):(r.modal(t.errors),n.$broadcast("ngUploadCompleteError",t))}s++;var p=u,g={},m=l.ngUpload?t(l.ngUpload):angular.noop,h=l.ngUploadError?t(l.ngUploadError):angular.noop,v=l.ngUploadLoading?t(l.ngUploadLoading):null,y=n.$eval(l.ngUploadOptions)||{},$=angular.isDefined(y.normalize)?y.normalize:!0;l.hasOwnProperty("uploadOptionsConvertHidden")&&(g.convertHidden="false"!=l.uploadOptionsConvertHidden),l.hasOwnProperty("uploadOptionsEnableRailsCsrf")&&(g.enableRailsCsrf="false"!=l.uploadOptionsEnableRailsCsrf),l.hasOwnProperty("uploadOptionsBeforeSubmit")&&(g.beforeSubmit=t(l.uploadOptionsBeforeSubmit)),c.attr({target:"upload-iframe-"+s,method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});var b=({url:c.attr("action")},angular.element('<iframe name="upload-iframe-'+s+'" border="0" width="0" height="0" style="width:0px;height:0px;border:none;display:none">'));if(g.enableRailsCsrf){var _=angular.element("<input />");_.attr("class","upload-csrf-token"),_.attr("type","hidden"),_.attr("name",o("csrf-param").attr("content")),_.val(o("csrf-token").attr("content")),c.append(_)}c.after(b),d(!1),c.bind("submit",function(){return p&&p.$invalid?!1:g.beforeSubmit&&0==g.beforeSubmit(n,{})?!1:(b.bind("load",f),g.convertHidden&&angular.forEach(c.find("input"),function(e){var t=angular.element(e);t.attr("ng-model")&&t.attr("type")&&"hidden"==t.attr("type")&&t.attr("value",n.$eval(t.attr("ng-model")))}),n.$$phase?(v&&v(n),d(!0)):n.$apply(function(){v&&v(n),d(!0)}),n.$broadcast("ngUploadSubmit"),void i.$broadcast("disableUI",!0))})}}}]),function(){"use strict";angular.module("app").run(["helpers",function(e){e.responsive={isTouch:function(){return Modernizr.touch},isMobile:function(){return"visible"===$("#is-mobile").css("visibility")},isTablet:function(){return"visible"===$("#is-tablet").css("visibility")},isDesktop:function(){return!this.isMobile()},isLandscape:function(){return"visible"===$("#is-landscape").css("visibility")},isPortrait:function(){return!this.isLandscape()}}}])}(),function(){"use strict";angular.module("app").constant("LOGIN_PROVIDERS",[{name:"Google",id:1},{name:"Facebook",id:2},{name:"Twitter",id:3},{name:"Pinterest",id:4}]).factory("mappedLoginProviders",["LOGIN_PROVIDERS",function(e){var t={};return angular.forEach(e,function(e){t[e.id]=e}),t}]).controller("AccountLoginStatusController",["$scope","$location","$state","modals",function(e,t,n,i){var r,a=t.search();a.success?n.go("home"):a.errors&&(r=angular.fromJson(a.errors),r&&r.action_denied&&i.alert("forbidden",function(){n.go("home")}))}]).controller("LoginLinksController",["$scope","endpoint","currentAccount","models",function(e,t,n,i){e.authorization_urls={},(void 0===n._is_guest||n._is_guest)&&i[11].actions.login({login_method:"1"}).then(function(t){e.authorization_urls=t.data.authorization_urls}),e.login=function(n){t.removeCache("currentAccount"),window.location.href=e.authorization_urls[n]}}]).controller("AccountManagementController",["$scope","currentAccount","models","modelsUtil",function(e,t,n,i){e.settings=function(){n[11].manageModal(t)},e.logout=function(){n[11].logout(t.key)}}]).filter("formatLoginProivider",["mappedLoginProviders",function(e){return function(t){var n=t.split("-"),i="";return n&&n[1]&&(i=e[n[1]].name),i}}]).run(["modelsConfig","channelApi","channelNotifications","endpoint","$window","modelsEditor","GLOBAL_CONFIG","modelsMeta","modelsUtil","$modal","helpers","modals","$q","mappedLoginProviders","LOGIN_PROVIDERS","snackbar",function(e,t,n,i,r,a,o,s,c,l,u,d,f,p,g,m){var h=function(e){return e.identity.split("-")[1]};e(function(e){$.extend(e[11],{channel:function(){var e=this.actions.create_channel(void 0,{cache:"accountChannel",cacheType:"memory"});return e.then(function(e){var n=e.data.token;return{token:n,channel:t.create(n)}})},channelNotifications:function(e){var t=this.channel();return t.then(function(e){var t=e.token;return{token:t,channel:n.create(t)}})},adminManageModal:function(e,t){return this.manageModal(e,t)},manageModal:function(t,n){n=u.alwaysObject(n);var i={kind:this.kind,templateBodyUrl:"account/manage_body.html",toolbar:{titleEdit:"account.settings",hideSave:!0},modalConfig:{popFrom:n.popFrom},init:function(t){var n=t.entity,r=["state","ui.rule","created","updated"],a=function(e){angular.forEach(["args","entity"],function(n){u.update(t[n],e,r)})},o=function(){var e=Object.keys(p);t.identities=t.entity.identities.concat(),angular.forEach(t.identities,function(t){var n=h(t);e[n]&&delete e[n]}),angular.forEach(g,function(n){e[n.id]&&t.identities.push({identity:"0-"+n.id,associated:!1})})};o(),n.ui.rule.action.sudo.executable&&(i.toolbar.templateActionsUrl="account/manage_actions.html"),t.args.disassociate=[],t.maybeDisconnect=function(n){n.email&&void 0===n.associated?d.confirm("disconnectSignInMethod",function(){t.args.disassociate.push(n.identity),t.save().then(function(){o(),m.showK("identityDisconnected")})}):d.confirm("connectSignInMethod",function(){e[11].actions.login({login_method:h(n)}).then(function(e){window.location.href=e.data.authorization_url})})},t.actions.sudo=function(){d.models.sudo(n,{templateUrl:"account/administer.html",onConfirm:a})}},scope:{historyConfig:!0,isAssociated:function(e){return-1===$.inArray(e.identity,this.args.disassociate)},setPrimary:function(e){this.container.form.$setDirty(),this.args.primary_identity=e.identity},disassociate:function(e){this.container.form.$setDirty(),this.isAssociated(e)?this.args.disassociate.push(e.identity):this.args.disassociate.remove(e.identity)},actions:{},layouts:{groups:[{label:!1},{label:o.subheaders.loginMethods}]}}};a.create(i).read(t,{key:t.key})},logout:function(e){var t=this;d.confirm("maybeLogout",function(){t.actions.logout({key:e}).then(function(e){i.removeCache(),r.location.reload(!1)})})}})})}])}(),function(){"use strict";angular.module("app").controller("BuyerManagementController",["$scope","endpoint","currentAccount","models",function(e,t,n,i){e.settings=function(){i[19].manageModal(n.key)},e.manageCollection=function(){i[18].manageModal(n.key)}}]).controller("BuyOrdersController",["$scope","modals","modelsEditor","GLOBAL_CONFIG","modelsMeta","helpers","models","modelsUtil","$state",function(e,t,n,i,r,a,o,s,c){var l="buy-carts"===c.current.name;e.setPageToolbarTitle("buyer."+(l?"carts":"orders")),e.listHelp=l?i.emptyHelp.cartBuyerList:i.emptyHelp.orderBuyerList,e.search={results:[],pagination:{},loaded:!1},e.scrollEnd={loader:!1},e.view=function(e,t){o[19].current().then(function(e){return e.data.entity}).then(function(n){o[34].manageModal(e,e._seller,n,{cartMode:l,popFrom:t?a.clicks.realEventTarget(t.target):!1})})},o[19].current().then(function(n){var i=n.data.entity;e.search.pagination=o[34].paginate({kind:"34",args:{search:{ancestor:i.key,filters:[{field:"state",operator:"IN",value:l?["cart","checkout"]:["completed","canceled"]}],orders:[{field:"updated",operator:"desc"},{field:"key",operator:"asc"}]}},config:{ignoreErrors:!0},complete:function(n){var i=n.data.errors;i?i.buyer&&t.alert("noBuyer"):e.search.results.extend(n.data.entities),e.search.loaded=!0}}),e.scrollEnd.loader=e.search.pagination,e.search.pagination.load()})}]).directive("buyerAddressListView",function(){return{scope:{val:"=buyerAddressListView"},templateUrl:"buyer/address_list_view.html",controller:["$scope",function(e){e.notEmpty=function(e){return angular.isString(e)||angular.isNumber(e)}}]}}).run(["$window","modelsEditor","modelsMeta","$q","modelsConfig","currentAccount","endpoint",function(e,t,n,i,r,a,o){r(function(e){$.extend(e[19],{current:function(e){return e||(e={}),e.account=a.key,this.actions.read(e,{cache:this.getCacheKey("current"),cacheType:"memory"})},manageModalFieldsOrder:["country","region","city","postal_code","street","name"],manageModal:function(r,a){var s,c=n.getActionArguments(this.kind,"update"),l=this;$.extend(c.addresses.ui,{label:!1,specifics:{listView:"buyer-address-list-view",listConfig:{perLine:3},sortFields:l.manageModalFieldsOrder,beforeSave:function(t,n){var r,a=[],o=t.args;return!o.region||o._region&&o.region===o._region.key||(r=e[13].get(o.region),r.then(function(e){e.data.entities.length&&(o._region=e.data.entities[0])}),a.push(r)),!o.country||o._country&&o.country===o._country.key||(r=e[12].actions.search(void 0,{cache:!0}),r.then(function(e){if(e.data.entities.length){var t=_.findWhere(e.data.entities,{key:o.country});angular.isDefined(t)&&(o._country=t)}}),a.push(r)),a.length?i.all(a):!1}}}),s={fields:_.toArray(c),kind:this.kind,action:"update",afterSave:function(){o.removeCache(l.getCacheKey("current")),angular.isDefined(a)&&a()},scope:{layouts:{groups:[{label:!1,fields:["addresses"]}]}},toolbar:{titleEdit:"buyer.viewAddresses"},excludeFields:["account","read_arguments"],argumentLoader:function(e){var t=this.defaultArgumentLoader(e);return t.account=r,t}},t.create(s).read({},{account:r})}})})}])}(),function(){"use strict";angular.module("app").directive("catalogNewPricetag",["$parse",function(e){return{restrict:"A",link:function(t,n,i){var r=e(i.catalogNewPricetag);n.on("click",function(e){var i=n.offset(),a=e.pageX-i.left,o=e.pageY-i.top,s=n.parents(".image-slider-item:first"),c=s.width(),l=s.height();t.$apply(function(){r(t,{config:{position_left:a,position_top:o,image_width:c,image_height:l}})})})}}}]).directive("catalogPricetagPosition",["$timeout","models",function(e,t){return{link:function(n,i,r){var a=n.$eval(r.catalogPricetagPosition),o=function(){var e,n=$(i).parents(".image-slider-item:first");e=t[31].calculatePricetagPosition(a.position_top,a.position_left,a.image_width,a.image_height,n.width(),n.height()),a._position_top=e[0],a._position_left=e[1],$(i).css({top:a._position_top,left:a._position_left,visibility:"visible"})};e(o,0,!1),n.$on("modalResize",o),n.$watch(r.catalogPricetagPosition+"._state",o)}}}]).directive("productInstanceCardView",["$compile",function(e){return{scope:{val:"=productInstanceCardView"},templateUrl:"catalog/product/product_instance_card_view.html",link:function(e){e.showVariantLabel=function(e){return e.split(":")[0]},e.showVariantValue=function(e){var t=e.split(":");return t.slice(1,t.length).join(":")}}}}]).run(["modelsEditor","modelsMeta","modelsConfig","$modal","modals","helpers","$q","GLOBAL_CONFIG","$mdSidenav","$timeout","snackbar","social",function(e,t,n,i,r,a,o,s,c,l,u,d){n(function(n){var f=function(e,t){e.sidenavMenuID=t,e.notRipplable=[".catalog-close-button",".catalog-pricetag",".catalog-pricetag-link"],e.toggling=!1,e.close=function(){return e.toggle(void 0,"close")},e.open=function(){return e.toggle(void 0,"open")},e.toggle=function(t,n){if(!e.toggling){var i,r=c(e.sidenavMenuID),a=!1;t&&t.target&&(i=$(t.target),angular.forEach(e.notRipplable,function(e){(i.is(e)||i.parent().is(e))&&(a=!0)}),a)||(e.toggling=!0,l(function(){r[n||(r.isOpen()?"close":"open")]().then(function(){e.toggling=!1})}))}}},p=function(e,t){t||(t=0);var n=e.modelclass;angular.forEach(n,function(n){if(n.ui.realPath){var i=e.ui.realPath.concat();i.push(n.code_name),n.ui.realPath=i,n.ui.initialRealPath=i,n.modelclass&&p(n,t+1)}})};$.extend(n[31],{formatPublicSearchResults:function(e){angular.forEach(e,function(e){e._cover={serving_url:e.cover,proportion:e.cover_proportion},e._seller_logo={serving_url:e.seller_logo,proportion:2.4}})},calculatePricetagPosition:function(e,t,n,i,r,a){var o=e/n*r,s=t/i*a;return[o,s]},previewModal:function(e,t){return t=a.alwaysObject(t),
t.hideAddToCart=!0,this.viewModal(e,t)},viewProductModal:function(e,t,r,s,c){var l={_seller:{},_images:{config:{keys:[t]},pricetags:{config:{keys:[r]},_product:{_category:{}}}}};c=a.alwaysObject(c),this.actions.read({key:e,read_arguments:l}).then(function(e){var l=e.data.entity,p=function(){var e={};return e.product=l._images[0].pricetags[0]._product,e.originalProduct=angular.copy(e.product),e.catalog=l,e.variants=[],e.variantSelection=[],e.hideAddToCart=!1,e.currentVariation=[],angular.forEach(e.product.variants,function(t,n){e.variants.push({name:t.name,options:t.options,option:s?s[n][t.name]:t.options[0],description:t.description}),e.variantSelection.push({type:"SuperStringProperty",choices:t.allow_custom_value?null:t.options,code_name:"option_"+n,ui:{help:t.description,label:t.name,writable:!0,attrs:{"ng-change":"changeVariation()"},args:"variants["+n+"].option"}})}),e.changeVariationPromise=function(){var i,a=[],s=!1;return e.currentVariation.splice(0,e.currentVariation.length),angular.forEach(e.variants,function(t){var n={};null===t.option&&(s=!0),t.allow_custom_value||(a.push(t.name+": "+t.option),n[t.name]=t.option,e.currentVariation.push(n))}),s?(i=o.defer().promise,i.resolve(),i):n[31].actions.read({key:this.catalog.key,read_arguments:{_images:{config:{keys:[t]},pricetags:{config:{keys:[r]},_product:{_instances:{config:{search:{filters:[{field:"variant_options",operator:"ALL_IN",value:a}]}}}}}}}})},e}();i.open({resolve:{productInstanceResponse:function(){return p.changeVariationPromise().then(function(e){return e})}},templateUrl:"catalog/product/view.html",windowClass:"no-overflow",popFrom:c.popFrom,controller:["$scope","productInstanceResponse",function(e,r){var o,s,l;$.extend(e,p),e.variantMenu={},e.productMenu={},f(e.productMenu,"right_product_sidenav"+_.uniqueId()),f(e.variantMenu,"right_variantMenu_sidenav"+_.uniqueId()),l=function(){if(!e.product)return void(e.socialMeta={});var t=a.url.abs("catalog/"+e.catalog.key+"/product/"+e.product.key),n=function(t){return e.product.images&&e.product.images.length?e.product.images[0].serving_url+"=s"+(t||"600"):void 0};e.socialMeta={facebook:{"p[url]":t,"p[images][0]":n(600),"p[title]":e.product.name},twitter:{url:t,text:"Product - "+e.product.name},pinterest:{url:t,media:n(600),description:"Share on pinterest"},googleplus:{url:t},reddit:{url:t,title:e.product.name},linkedin:{url:t,title:e.product.name},tumblr:{url:t,name:e.product.name}}},e.displayShare=function(){return d.share(e.socialMeta,{src:a.url.abs("embed/catalog/"+e.catalog.key+"/product/"+e.product.key)})},e.variantChooser={},e.setupVariantChooser=function(t){e.variantChooser=t,e.variantMenu.open()},e.completeVariantChooser=function(t){e.variantChooser.option=t,e.variantMenu.close(),e.changeVariation()},e.resetVariation=function(){this.resetVariantProduct(),e.variationApplied=!1,angular.forEach(e.variants,function(e){e.option=null})},e.resetVariantProduct=function(){$.extend(this.product,this.originalProduct),e.productInstance=null},e.variationApplied=!1,e.viewContent=function(e){i.open({templateUrl:"core/misc/content_view.html",controller:["$scope",function(t){t.markDown=!0,t.content=e,t.close=function(){t.$close()}}]})},e.canAddToCart=!0,e.hasThisProduct=!1,e.disableUpdateCart=!1,e.productQuantity=0,s=e.catalog._seller.key,e.cartProductQuantity=function(){e.productQuantity=0,e.hasThisProduct=!1,e.disableUpdateCart=!1,n[34].current(s).then(function(t){var n=t.data.entity;n.id?(angular.forEach(n._lines,function(t){t.product._reference.parent.id===e.product.parent.id&&t.product._reference.id===e.product.id&&angular.toJson(e.currentVariation)===angular.toJson(t.product.variant_signature)&&(e.productQuantity=parseInt(t.product.quantity,10),e.productQuantity>0&&(e.hasThisProduct=!0,e.disableUpdateCart=!0))}),e.canAddToCart=n.ui.rule.action.update_line.executable):e.canAddToCart=!0,e.productQuantity||(e.productQuantity=1)})},o=function(t){var n,i,r=["images","code","unit_price","weight","weight_uom","volume","volume_uom","description","contents","availability"];try{n=t.data.entity._images[0].pricetags[0]._product}catch(a){}n&&(i=n._instances[0]),i?(e.productInstance=i,angular.forEach(r,function(t){var n=i[t];null!==n&&n.length&&(e.product[t]=n)})):e.resetVariantProduct(),e.variationApplied=!0},e.changeVariation=function(){this.changeVariationPromise().then(o).then(e.cartProductQuantity)},o(r),e.cartProductQuantity(),e.increaseQuantity=function(){e.disableUpdateCart=!1,e.productQuantity=parseInt(e.productQuantity,10)+1},e.decreaseQuantity=function(){0!==parseInt(e.productQuantity,10)&&(e.disableUpdateCart=!1,e.productQuantity=parseInt(e.productQuantity,10)-1)},e.changedQuantity=function(){e.disableUpdateCart=!1},e.addToCart=function(){if(!e.hasThisProduct&&e.productQuantity<1){e.container.form.$setDirty();var i=e.container.form.productQuantity;return i.$setViewValue(void 0!==i.$viewValue?i.$viewValue:""),i.$setDirty(),void i.$setValidity("required",!1)}n[19].current().then(function(i){return n[34].actions.update_line({buyer:i.data.entity.key,product:e.product.key,image:t,quantity:e.productQuantity,variant_signature:e.currentVariation})}).then(function(t){c.events&&c.events.addToCart&&c.events.addToCart.call(this,t),n[34].getCache("current"+s)&&n[34].current(s).then(function(e){$.extend(e.data.entity,t.data.entity)}),e.productQuantity<1?(e.hasThisProduct=!1,e.productQuantity=1):(e.hasThisProduct=!0,e.disableUpdateCart=!0),u.showK("cartUpdated")})},e.$watch("product.id",function(e,t){l()}),e.close=function(){e.$close()}}]})})},viewModal:function(e,t){var o=this;o.actions.read({key:e,read_arguments:{_seller:{_content:{},_feedback:{}},_images:{pricetags:{}}}}).then(function(e){var s=e.data.entity;return s._images.length?void i.open({templateUrl:"catalog/view.html",windowClass:"no-overflow",popFrom:t.popFrom,controller:["$scope",function(t){t.catalogMenu={},f(t.catalogMenu,"right_catalog_sidenav"+_.uniqueId()),t.catalog=s,t.catalog.action_model="31",t.logoImageConfig={};var i,r,c=a.url.abs("catalog/"+t.catalog.key);r=angular.copy(t.catalog.ui.access),r.push("_images"),i=n[31].reader({key:t.catalog.key,next:{_images:t.catalog._next_read_arguments._images},access:r,complete:function(e){t.catalog._images.extend(e)}}),t.socialMeta={facebook:{"p[url]":c,"p[images][0]":t.catalog._images[0].serving_url+"=s600","p[title]":t.catalog.name},twitter:{url:c,text:"Catalog - "+t.catalog.name},pinterest:{url:c,media:t.catalog._images[0].serving_url+"=s600",description:"Share on pinterest"},googleplus:{url:c},reddit:{url:c,title:t.catalog.name},linkedin:{url:c,title:t.catalog.name},tumblr:{url:c,name:t.catalog.name}},t.displayShare=function(){return d.share(t.socialMeta,{src:a.url.abs("embed/catalog/"+t.catalog.key)})},t.loadMoreImages=function(t){var n=i.load();n?n.then(function(){t.call(this,e,i.more)}):t.call(this,void 0,i.more)},t.displayCart=function(){n[19].current().then(function(e){n[34].manageModal(void 0,t.catalog._seller,e.data.entity,{cartMode:!0})})},n[34].current(t.catalog._seller.key),t.viewProduct=function(e,n,i){var r=i.target,a=$(r).parents(".catalog-pricetag:first");a.length&&(r=a.get(0)),o.viewProductModal(t.catalog.key,e.key,n.key,null,{popFrom:r})},t.sellerDetails=function(){n[23].viewModal(t.catalog._seller)},t.close=angular.bind(t,a.form.leave,function(){t.$close()})}]}):void r.alert("noImagesInCatalog")})},adminManageModal:function(e,t){return this.manageModal(e,void 0,t)},manageModal:function(o,c,l){l=a.alwaysObject(l);var d=t.getActionArguments("31","update"),f=!angular.isDefined(o),g=function(e){e.setAction("catalog_upload_images"),e.dialog.toolbar.templateActionsUrl="catalog/manage_actions.html",c(e.entity)},m=function(e){e.setAction("update")},h=function(e){m(e)},v={kind:this.kind,action:f?"create":"update",modalConfig:l,fields:_.toArray(d),toolbar:{templateActionsUrl:f?!1:"catalog/manage_actions.html",titleEdit:"seller.edit31",titleAdd:"seller.add31"},afterSave:g,afterSaveError:g,afterComplete:m,afterCompleteError:m,init:function(e){$.extend(d._images.ui,{label:!1,specifics:{sortableOptions:{stop:function(){if(d._images.ui.specifics.parentArgs.length){var e=d._images.ui.specifics.parentArgs[0].sequence,t=[],n=[],i=d._images.ui.directiveScope();angular.forEach(d._images.ui.specifics.parentArgs,function(i,r){r=e-r,t.push(i.sequence),n.push(r),i.sequence=r,i.ui.access[i.ui.access.length-1]=r}),t.equals(n)||i.formSetDirty(),i.$broadcast("itemOrderChanged")}}}}});var t=["state","ui.rule","created","updated"],i=function(n){angular.forEach(["args","entity"],function(i){a.update(e[i],n,t)})};e.actions={publish:function(){r.confirm("publishCatalog",function(){n[31].actions.publish({key:e.entity.key}).then(function(e){u.showK("catalogPublished"),i(e.data.entity)})})},discontinue:function(){r.confirm("discontinueCatalog",function(){n[31].actions.discontinue({key:e.entity.key}).then(function(e){u.showK("catalogDiscontinued"),i(e.data.entity)})})},duplicate:function(){r.confirm("duplicateCatalog",function(){n[11].channelNotifications().then(function(t){n[31].actions.catalog_duplicate({key:e.entity.key,channel:t.token}).then(function(e){u.showK("duplicationInProgressCatalog")})})})},sudo:function(){r.models.sudo(e.entity,{templateUrl:"catalog/administer.html",onConfirm:i})}}},noComplete:h,scope:{historyConfig:!0,addProducts:function(){var e=this;i.open({templateUrl:"core/models/manage.html",windowClass:"no-overflow",controller:["$scope","$timeout",function(t,i){var o,c,l,f=angular.copy(e.args.ui.access);f.push(d._images.code_name),t.rootScope=e.rootScope,t.config=e.rootScope.config,t.entity=e.entity,t.args=angular.copy(e.args),t.dialog={templateBodyUrl:"catalog/manage_products.html",toolbar:{}},t.container={},t.formSetPristine=angular.bind(t,a.form.setPristine),t.formSetDirty=angular.bind(t,a.form.setDirty),t.validateForm=angular.bind(t,a.form.validate),t.args._images=[],l=function(){return"viewProducts"},t.config._title_.push(l),t.$on("$destroy",function(){t.config._title_.remove(l),d._images._title_.remove(l),d._images.modelclass.pricetags._title_.remove(l),d._images.modelclass.pricetags.modelclass._product._title_.remove(l)}),d._images._title_=t.config._title_.concat(),d._images.modelclass.pricetags._title_=d._images._title_.concat(),d._images.modelclass.pricetags.modelclass._product._title_=d._images._title_.concat(),t.dialog.toolbar.title=a.toolbar.buildTitle(t.config._title_),o=n[31].reader({key:t.args.key,next:{_images:{}},access:f,complete:function(e){t.args._images.extend(e)}}),o.load(),t.onStart=function(e,t,n,i){$(t.helper).addClass("dragged"),$(t.helper).find("a").addClass("dragged")},t.onDrag=function(e,n,i,r){var a=function(){var e,a,o,s,c,l=$(n.helper),u=l.parents(".image-slider-item:first"),d=l.outerWidth(),f=u.width(),p=u.next(),g=u.prev(),m=parseInt(l.css("top"),10),h=parseInt(l.css("left"),10),v=!0,y=t.args._images.indexOf(i),b=!1,w=!1;u.length&&d&&(0===h?s=0:(s=f-(h+d),v=!1),0===s&&v?(y-=1,b=!0,e=g,a=g.width()-d-5):0!==s||v||(y+=1,b=!0,e=p,a=5),-1!==y&&b&&(o=t.args._images[y],angular.isDefined(o)&&(r._state="deleted",w=_.findWhere(o.pricetags,{key:r.key}),w&&(r=w),r.image_width=e.width(),r.image_height=e.height(),r.position_left=a,r.position_top=m,r._position_left=a,r._position_top=m,r._state=null,w||(c=angular.copy(r),c._image=i,o.pricetags.push(c),r._state="deleted"),t.$$phase||t.$digest())))};a()},t.onStop=function(e,n,i,r){if("deleted"!==r._state){var a=$(e.target).parents(".image-slider-item:first");r.position_top=n.position.top,r.position_left=n.position.left,r.image_width=a.width(),r.image_height=a.height(),r._position_top=r.position_top,r._position_left=r.position_left,t.formSetDirty(),t.$$phase||t.$digest()}},t.onDrop=function(e,n,i){var r=$(e.target),a=r.offset(),o=n.offset,s={position_top:o.top-a.top,position_left:o.left-a.left,image_width:r.width(),image_height:r.height()};t.createProduct(i,s)},t.loadMoreImages=function(e){var t=o.load();t?t.then(function(t){e.call(this,t,o.more)}):e.call(this,void 0,o.more)},c=function(e,n){t.image=e,t.pricetag=n},t.loadingManageProduct=!1,t.manageProduct=function(e,i){i._image&&(e=i._image),t.loadingManageProduct||(t.loadingManageProduct=!0,c(e,i),n[31].actions.read({key:t.entity.key,read_arguments:{_images:{config:{keys:[e.key]},pricetags:{config:{keys:[i.key]},_product:{}}}}}).then(function(n){var r=n.data.entity,a=t.args._images.indexOf(e),o=r._images[0].pricetags[0]._product,s=["_images",a,"pricetags",e.pricetags.indexOf(i),"_product"];t.fieldProduct.ui.specifics.toolbar||(t.fieldProduct.ui.specifics.toolbar={}),t.fieldProduct.ui.specifics.toolbar.templateActionsUrl="catalog/product/manage_actions.html",i._product=o,o.ui.access=s,t.fieldProduct.ui.realPath=s,p(t.fieldProduct),t.fieldProduct.ui.specifics.manage(o)})["finally"](function(){t.loadingManageProduct=!1}))},t.howToDrag=function(e){r.alert("howToDropPricetag")},t.createProduct=function(e,n){var i=t.args._images.indexOf(e),r={_sequence:e.pricetags.length,image_height:n.image_height,image_width:n.image_width,position_left:n.position_left,position_top:n.position_top,_position_left:n.position_left,_position_top:n.position_top,value:{},_product:{},ui:{access:["_images",i,"pricetags",e.pricetags.length]}};e.pricetags.push(r),c(e,r),t.fieldProduct.ui.specifics.toolbar.templateActionsUrl=!1,t.fieldProduct.ui.realPath=["_images",i,"pricetags",e.pricetags.length-1,"_product"],p(t.fieldProduct),t.fieldProduct.ui.specifics.create()},t.fieldProduct=d._images.modelclass.pricetags.modelclass._product,$.extend(t.fieldProduct.ui,{init:function(e){e.config.ui.specifics.remove=function(e,n){t.pricetag._state="deleted",t.formSetDirty(),n()}},args:"pricetag._product",parentArgs:"pricetag",path:["_images","pricetags","_product"],render:!1,label:!1,specifics:{remoteAutoload:!1,modal:!0,beforeSave:function(e){e.setAction("update");var t=_.last(e.sendRootArgs._images[0].pricetags);t.value={name:e.args.name,price:e.args.unit_price}},templateFooterUrl:"catalog/product/manage_footer.html",getRootArgs:function(){return t.args},afterClose:function(e){t.pricetag._product=null,e.args.key||t.image.pricetags.remove(t.pricetag)},afterSave:function(e){e.setAction("product_upload_images");var n=e.response.data.entity._images[0].pricetags[0];$.extend(t.pricetag,n)},afterComplete:function(e){e.setAction("update")},noComplete:function(e){e.setAction("update")},duplicate:function(){r.confirm("duplicateCatalogPricetag",function(){n[11].channelNotifications().then(function(e){n[31].actions.catalog_pricetag_duplicate({key:t.entity.key,channel:e.token,read_arguments:{_images:{config:{keys:[t.image.key]},pricetags:{config:{keys:[t.pricetag.key]}}}}}).then(function(e){u.showK("duplicationInProgressCatalogPricetag")})})})}}}),$.extend(t.fieldProduct.modelclass.images.ui,{name:"images"}),$.extend(t.fieldProduct.modelclass._instances.modelclass.images.ui,{name:"images"}),$.extend(t.fieldProduct.modelclass._instances.ui,{label:s.subheaders.productInstances,path:["_images","pricetags"],specifics:{cards:!0,cardView:"product-instance-card-view",getRootArgs:function(){return t.args},beforeSave:function(e){e.setAction("update")},afterSave:function(e){e.setAction("product_instance_upload_images")},afterComplete:function(e){e.setAction("update")},noComplete:function(e){e.setAction("update")},sortableOptions:{stop:function(){var e,n=t.fieldProduct.modelclass._instances,i=[],r=[],a=t.fieldProduct.ui.specifics.getScope();n.ui.specifics.parentArgs.length&&(e=n.ui.specifics.parentArgs[0].sequence,angular.forEach(n.ui.specifics.parentArgs,function(t,n){n=e-n,i.push(t.sequence),r.push(n),t.sequence=n,t.ui.access[t.ui.access.length-1]=n}),i.equals(r)||a.formSetDirty(),a.$broadcast("itemOrderChanged"))}},canOpen:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args;return n.id?n.variants.length?!0:(u.showK("createVariantsFirst"),!1):(u.showK("saveProductFirst"),!1)},init:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args,i=[],r=t.fieldProduct.modelclass._instances.modelclass.variant_options;angular.forEach(n.variants,function(e){e.allow_custom_value||angular.forEach(e.options,function(t){i.push(e.name+": "+t)})}),r.choices=i},excludeFields:["created","sequence"]}}),$.extend(t.fieldProduct.modelclass.contents.ui,{specifics:{}}),$.extend(t.fieldProduct.modelclass.images.ui,{name:"images",specifics:{}}),$.extend(t.fieldProduct.modelclass.variants.ui,{specifics:{}}),t.save=function(){var i;return t.rootScope.config.prepareReadArguments(t),i=n[31].actions[t.args.action_id](t.args),i.then(function(n){$.extend(t.entity,n.data.entity);var i=t.rootScope.config.argumentLoader(t);e.args=angular.copy(i),t.args=angular.copy(i),t.formSetPristine(),u.showK("changesSaved")}),i},t.close=angular.bind(t,a.form.leave,function(){t.$close()})}]})},layouts:{groups:[{label:!1,fields:["name","discontinue_date"]},{label:s.subheaders.catalogImages,include:"core/misc/action.html",action:function(){var e=v.getScope();return a.form.wakeUp(e.container.form),e.container.form.$valid?void r.fields.remote(v.getScope(),d._images):void u.showK("provideProperValues")}},{label:s.subheaders.catalogProducts,include:"core/misc/action.html",action:function(){var e=v.getScope();return e.entity.cover?void v.getScope().addProducts():void u.showK("uploadImagesFirst")}}]}}};f?n[23].current().then(function(t){e.create(v).prepare({},{seller:t.data.entity.key})}):e.create(v).read(o,{key:o.key})}})})}])}(),function(){"use strict";angular.module("app").run(["modelsConfig","endpoint","currentAccount","modelsMeta","GLOBAL_CONFIG","modelsEditor","helpers","$timeout","snackbar",function(e,t,n,i,r,a,o,s,c){e(function(e){var t={_sellers:{_content:{},_feedback:{}}};$.extend(e[18],{current:function(e){return e||(e={}),e.account=n.key,this.actions.read(e,{cache:this.getCacheKey("current"),cacheType:"memory"})},manageModal:function(n){var l,u=i.getActionArguments(this.kind,"update"),d=this;l={kind:this.kind,action:"update",fields:_.toArray(u),toolbar:{hideSave:!0,titleEdit:"buyer.edit18"},templateBodyUrl:"collection/manage_body.html",excludeFields:["account","read_arguments"],init:function(e){var t=[];e.close=e.$close,e.$watch("args.notify",function(n,i){var r,a=function(e){t.length&&(angular.forEach(t,function(t){t!==e&&s.cancel(t)}),t=[])};n!==i&&(a(),r=s(function(){e.save().then(function(){c.showK("changesSaved")}),a(r)},1e3),t.push(r))})},afterComplete:function(e){e.entity._sellers.iremove(function(t){return-1===$.inArray(t.key,e.entity.sellers)}),d.getCache("current")&&d.current().then(function(t){$.extend(t.data.entity,e.entity)})},scope:{remove:function(e){this.args.sellers.remove(e.key),this.entity._sellers.remove(e)},view:function(t,n){var i=this;e[23].actions.read({account:t.parent.key,read_arguments:{_content:{},_feedback:{}}}).then(function(t){e[23].viewModal(t.data.entity,{popFrom:o.clicks.realEventTarget(n.target),removedOrAdded:function(e){i.entity._sellers.iremove(function(t){return-1===$.inArray(t.key,e.sellers)});var t=function(t){return-1===$.inArray(t,e.sellers)};i.entity.sellers.iremove(t),i.args.sellers.iremove(t)}})})},layouts:{groups:[{label:!1},{label:r.subheaders.collectionSeller}]}}},a.create(l).read({},{account:n,read_arguments:t})}})})}])}(),function(){"use strict";angular.module("app").controller("MainMenuController",["$scope","$mdSidenav","$timeout",function(e,t,n){e.closeMenu=function(){n(function(){t("left").close()})},e.openMenu=function(){n(function(){t("left").open()})}}]).run(["$rootScope","GLOBAL_CONFIG","currentAccount","helpers",function(e,t,n,i){e.currentAccount=n,e.GLOBAL_CONFIG=t,e.JSON=JSON,e.helpers=i,e.pageToolbarTitle="",e.setPageTitle=function(t,n){e.pageTitle=i.toolbar.title(t),n||(e.pageToolbarTitle=e.pageTitle)},e.setPageToolbarTitle=function(t,n){e.pageToolbarTitle=i.toolbar.title(t),n||(e.pageTitle=e.pageToolbarTitle)}}]).controller("HomePageController",["$scope","models","modals","$state","$stateParams","helpers","$q","modelsMeta",function(e,t,n,i,r,a,o,s){var c={search:{}},l=o.defer(),u=l.promise;e.setPageToolbarTitle("home"),e.sellerDetail=!1,e.view=function(e,n){t[31].viewModal(e,{popFrom:a.clicks.realEventTarget(n.target)})},r.key&&(c.search.filters=[{field:"seller_account_key",operator:"IN",value:r.key}],e.sellerDetail={},t[23].actions.read({account:r.key,read_arguments:{_feedback:{},_content:{}}}).then(function(t){$.extend(e.sellerDetail,t.data.entity)}),e.viewSeller=function(){t[23].viewModal(e.sellerDetail)}),"following"===i.current.name?(u=t[18].current(),u.then(function(t){e.search.pagination.args.search.filters=[{field:"ancestor",operator:"IN",value:t.data.entity.sellers}]})):l.resolve(),e.search={results:[],pagination:t[31].paginate({kind:"31",args:c,config:{normalizeEntity:!1},action:"public_search",complete:function(n){var i=n.data.entities;t[31].formatPublicSearchResults(i),e.search.results.extend(i)}})},e.scrollEnd={loader:!1},e.scrollEnd.loader=e.search.pagination,u.then(function(){e.search.pagination.load()})}])}(),function(){"use strict";angular.module("app").run(["modelsConfig","modelsMeta",function(e,t){e(function(e){e[12].config.cache=!0,e[12].getSubdivisions=function(n,i){var r=e[13],a=t.getDefaultActionArguments(r.kind,"search");return a.ancestor=n,r.search(a,i)}})}])}(),function(){"use strict";angular.module("app").directive("toggleExpand",["$timeout",function(e){return{link:function(t,n,i){var r,a=function(e,t){angular.isUndefined(r)||(n.css("overflow","hidden"),n.height(e?r:0))};e(function(){r=n.height(),a(t.$eval(i.toggleExpand))},0,!1),t.$watch(i.toggleExpand,a)}}}]).directive("alwaysScrollToBottom",["$timeout",function(e){return{link:function(e,t,n){var i=function(){t.scrollTop(t[0].scrollHeight)};e.$watchGroup(e.$eval(n.alwaysScrollToBottom),function(e,t){e!==t&&i()})}}}]).filter("displayTaxes",function(){return function(e){var t="";return e&&(t=$.map(e,function(e){return e.name}).join(", ")),t}}).run(["modelsMeta","modelsConfig","$modal","modals","snackbar","helpers","endpoint","$q","$filter","currentAccount","$mdSidenav","$timeout",function(e,t,n,i,r,a,o,s,c,l,u,d){t(function(t){$.extend(t[34],{current:function(e){var n=this;return t[19].current().then(function(t){var i=t.data.entity;return n.actions.view_order({buyer:i.key,seller:e},{cache:n.getCacheKey("current"+e),cacheType:"memory"})})},adminManageModal:function(e,t){return t=a.alwaysObject(t),this.manageModal(e,e._seller,void 0,$.extend({sellerMode:!0},t))},manageModal:function(o,s,c,f){f=a.alwaysObject(f);var p,g=this,m=f.cartMode,h=f.sellerMode,v={};p=m?{buyer:c.key,seller:s.key,read_arguments:{_seller:{_feedback:{},_content:{}},_messages:{_agent:{}}}}:{key:o.key,read_arguments:{_lines:{config:{limit:0}},_seller:{_feedback:{},_content:{}},_messages:{_agent:{}}}},t[34].actions[m?"view_order":"read"](p,v).then(function(c){n.open({templateUrl:"order/view.html",popFrom:f.popFrom,controller:["$scope",function(f){var p={customPlaceholder:null,updateLiveEntity:function(e){var t=f.order._messages;$.extend(f.order,e.data.entity),f.order._messages=t},reactOnStateChange:function(e){a.update(f.order,e.data.entity,["state","feedback_adjustment","feedback","ui"]),p.reactOnUpdate()},reactOnUpdate:function(){o&&$.extend(o,f.order),g.getCache("current"+s.key)&&g.current(s.key).then(function(e){$.extend(e.data.entity,f.order)})},logMessageAction:e.getActionArguments("34","log_message"),orderUpdateFields:e.getActionArguments("34","update"),billingAddressFields:[],shippingAddressFields:[],sorter:function(e,n){var i=t[19].manageModalFieldsOrder.indexOf(e.code_name),r=t[19].manageModalFieldsOrder.indexOf(n.code_name);return-1===i&&(i=99999),i-r}};angular.forEach(p.orderUpdateFields.shipping_address.modelclass,function(e){$.extend(e.ui,{args:"addresses.shipping."+e.code_name,parentArgs:"addresses.shipping",writable:!0,name:"supplier_"+e.code_name}),e.required=e.required?"!addresses.sameAsBilling":!1,p.shippingAddressFields.push(e)}),angular.forEach(p.orderUpdateFields.billing_address.modelclass,function(e){$.extend(e.ui,{args:"addresses.billing."+e.code_name,parentArgs:"addresses.billing",writable:!0,name:"supplier_"+e.code_name}),p.billingAddressFields.push(e)}),p.billingAddressFields.sort(p.sorter),p.shippingAddressFields.sort(p.sorter),$.extend(p.logMessageAction.message.ui,{label:!1,args:"messages.draft.message",parentArgs:"messages.draft",writable:"order.ui.rule.action.log_message.executable",placeholder:"Type message here.",attrs:{"native-placeholder":"","class":"primary"}}),f.dialog={toolbar:{templateRight:"order/toolbar_actions.html"}},f.$watch("order.state",function(e,t){var n="Cart";"completed"===e&&(n="Order"),f.dialog.toolbar.title=n}),f.stage={checkout:null,current:1,out:[],canShowPay:function(){return"checkout"===f.order.state},isOut:function(e){return-1!==$.inArray(e,f.stage.out)},toCheckout:function(){f.stage.out.push(1),f.stage.current=2},toDeliveryMethod:function(){var e=f.addresses.form.billing.$valid,t={billing_address:f.addresses.billing};f.addresses.sameAsBilling?t.shipping_address=f.addresses.billing:(e=e&&f.addresses.form.shipping.$valid,t.shipping_address=f.addresses.shipping),e?f.cmd.order.update(t).then(function(){f.stage.out.push(2),f.stage.current=3}):(a.form.wakeUp(f.addresses.form.billing),f.addresses.sameAsBilling||a.form.wakeUp(f.addresses.form.shipping))},toReviewOrder:function(){i.confirm("toCheckout",function(){f.carrier.form.$valid?f.cmd.order.update({carrier:f.carrier.selected,state:"checkout"}).then(function(){f.stage.out.push(3),f.stage.current=4}):a.form.wakeUp(f.carrier.form)})},complete:function(){f.stage.out=[],f.stage.current=1}},f.cmd={},f.container={},f.cartMode=m,f.sellerMode=h,f.order=c.data.entity,f.seller=s,f.currentAccount=l,f.addresses={sameAsBilling:!0,form:{},shipping:{},billing:{},browse:function(e){var i=f;t[19].current().then(function(r){n.open({backdrop:!0,fullScreen:!1,inDirection:!1,outDirection:!1,templateUrl:"order/browse_addresses.html",controller:["$scope",function(n){n.addresses=r.data.entity.addresses,n.select=function(t){var r=function(){angular.forEach(t,function(t,n){i.addresses[e][n]=t})};r(),n.$close().then(function(){d(r,100)})},n.manage=function(){t[19].manageModal(r.data.entity.parent.key,function(){t[19].current().then(function(e){n.addresses=e.data.entity.addresses})})}}]})})},fields:{shipping:p.shippingAddressFields,billing:p.billingAddressFields,sameAsBilling:{type:"SuperBooleanProperty",code_name:"sameAsBilling",ui:{writable:!0,parentArgs:"addresses",args:"addresses.sameAsBilling",specifics:{type:"checkbox"}}}}},f.payment={method:f.order.payment_method},f.carrier={selected:f.order.carrier?f.order.carrier.reference:null,available:c.data.carriers?c.data.carriers:[],form:null},f.format={variantLabel:function(e){return Object.keys(e)[0]},variantValue:function(e){return e[f.format.variantLabel(e)]}},f.order._messages&&f.order._messages.length&&f.order._messages.reverse(),f.messages={reader:t[34].reader({key:f.order.key,next:{_messages:angular.copy(f.order._next_read_arguments._messages)},access:["_messages"],complete:function(e){f.order._messages.prepend(e)}}),toggling:!1,open:!1,draft:{message:null,key:f.order.key},field:p.logMessageAction.message,nav:function(){return u(f.messages.sidebarID)},sent:!1,send:function(e){t[34].actions[e](f.messages.draft).then(function(e){f.messages.draft.message="",f.messages.sent=!f.messages.sent,f.order._messages.push(e.data.entity._messages[0]),p.reactOnStateChange(e)})},sidebarID:"messages"+_.uniqueId(),logMessage:function(){return this.send("log_message")},close:function(){return f.message.toggle(!0)},toggle:function(e){if(!f.order._lines.length)return void r.showK("messangerDisabledWhenEmpty");if(!f.messages.toggling){var t=f.messages.nav(),n=t.isOpen();f.messages.toggling=!0,e===!0&&(n=!0),d(function(){t[n?"close":"open"]().then(function(){f.messages.toggling=!1,f.messages.open=!n})})}}},f.feedback={canShowButton:function(){var e=!1;return angular.forEach(["leave_feedback","review_feedback","sudo_feedback"],function(t){e||(e=f.order.ui.rule.action[t].executable)}),e},showAction:function(){var i=f,o=e.getActionArguments("34","leave_feedback");$.extend(o.message.ui,{writable:!0,parentArgs:"feedback",args:"feedback.message",label:!1,placeholder:"Please, write comment here. Comments appear in the messages feed.",attrs:{"native-placeholder":"","class":"full-width"}}),n.open(f.order.ui.rule.action.leave_feedback.executable||f.order.ui.rule.action.sudo_feedback.executable?{fullScreen:!1,inDirection:!1,outDirection:!1,templateUrl:"order/leave_feedback.html",controller:["$scope",function(e){e.config={},e.feedback={form:null,messageField:o.message,message:"",choice:"neutral",choices:[{key:"positive"},{key:"negative"},{key:"neutral"}]},e.config.dismiss=function(){return e.$close()},e.config.text={primary:"Leave Feedback"},e.config.confirm=function(){e.feedback.form.$valid?t[34].actions[i.order.ui.rule.action.leave_feedback.executable?"leave_feedback":"sudo_feedback"]({key:i.order.key,message:e.feedback.message,feedback:e.feedback.choice}).then(function(t){i.order._messages.push(t.data.entity._messages[0]),p.reactOnStateChange(t),e.config.dismiss(),r.showK("feedbackLeft")}):a.form.wakeUp(e.feedback.form)}}]}:{fullScreen:!1,inDirection:!1,outDirection:!1,templateUrl:"order/seller_feedback.html",controller:["$scope",function(e){e.config={},e.feedback={form:null,messageField:o.message,message:"",choice:"review_feedback",choices:[{key:"review_feedback",name:"Review Feedback",help:"Ask Buyer to review feedback."},{key:"report_feedback",name:"Report Feedback",help:"Ask Admin to intervene."}]},e.config.dismiss=function(){return e.$close()},e.config.text={primary:"Leave Feedback"},e.order=i.order,e.config.confirm=function(){e.feedback.form.$valid?t[34].actions[e.feedback.choice]({key:i.order.key,message:e.feedback.message}).then(function(t){i.order._messages.push(t.data.entity._messages[0]),p.reactOnStateChange(t),e.config.dismiss(),r.showK("feedback"+("report_feedback"===e.feedback.choice?"Reported":"Reviewed"))}):a.form.wakeUp(e.feedback.form)}}]})}},f.cmd.order={update:function(e){var n={key:f.order.key,payment_method:f.payment.method,_lines:f.order._lines};return $.extend(n,e),t[34].actions.update(n).then(function(e){p.updateLiveEntity(e),p.reactOnUpdate(),f.carrier.available=e.data.carriers,f.carrier.selected=e.data.entity.carrier?e.data.entity.carrier.reference:null})},cancel:function(){"checkout"===f.order.state&&i.confirm("cancelOrder",function(){t[34].actions.cancel({key:f.order.key}).then(function(e){t[34].removeCache("current"+s.key),f.close()})})}},f.cmd.line={view:function(e,n){var i=e.product._reference;t[31].viewProductModal(i.parent.parent.parent.key,i.parent.parent.key,i.pricetag.key,e.product.variant_signature,{popFrom:a.clicks.realEventTarget(n.target),events:{addToCart:p.updateLiveEntity}})},remove:function(e){e.quantity=0,e._state="deleted"}},f.cmd.seller={view:function(){t[23].viewModal(f.seller)}},f.close=function(){f.$close()},f.lineDrag={options:{disabled:!1,axis:"x",handle:".sort-handle",distance:10,stop:function(e,t){f.$apply()}},whatSortMeans:function(){i.alert("howToDeleteLine")},onStart:function(e,t,n){$(t.helper).find(".sort-handle").addClass("dragged")},onDrag:function(e,t,n){var i,r,a=t.helper.width();r=t.offset.left+a,a/2>r&&(i=!0),n&&(i?t.helper.addClass("about-to-delete"):t.helper.removeClass("about-to-delete"))},onStop:function(e,t,n){t.helper.hasClass("about-to-delete")?t.helper.animate({left:2*t.helper.width()*-1},function(){d(function(){f.cmd.line.remove(n),f.cmd.order.update().then(function(){r.showK("cartUpdated")})})}):t.helper.animate(t.originalPosition,function(){t.helper.attr("style","")})}},function(){("checkout"===f.order.state||"completed"===f.order.state)&&(f.stage.out.extend([1,2,3]),f.stage.current=4,f.stage.checkout=1)}(),f.notifyUrl=a.url.abs("api/order/complete/paypal"),f.completePath=a.url.abs("payment/completed/"+f.order.key),f.cancelPath=a.url.abs("payment/canceled/"+f.order.key)}]})})}})})}])}(),function(){"use strict";var e=function(e){return angular.isString(e)||angular.isNumber(e);

};angular.module("app").directive("addressRuleLocationListView",function(){return{scope:{val:"=addressRuleLocationListView"},templateUrl:"seller/address_rule_location_list_view.html",controller:["$scope",function(t){t.notEmpty=e,t.postalCodes=function(e){return e.join(", ")}}]}}).directive("defaultLineListView",function(){return{scope:{val:"=defaultLineListView"},templateUrl:"seller/default_line_list_view.html"}}).directive("carrierLineRuleListView",function(){return{scope:{val:"=carrierLineRuleListView"},templateUrl:"seller/carrier_line_rule_list_view.html",controller:["$scope",function(t){t.notEmpty=e}]}}).controller("SellerManagementController",["$scope","endpoint","currentAccount","models",function(e,t,n,i){e.settings=function(){i[23].manageModal(n.key)}}]).controller("SellCatalogsController",["$scope","modals","helpers","currentAccount","modelsEditor","modelsMeta","models","modelsUtil","$rootScope",function(e,t,n,i,r,a,o,s,c){e.setPageToolbarTitle("seller.catalogs");var l=function(t){_.findWhere(e.search.results,{key:t.key})||e.search.results.unshift(t)};e.create=function(){o[31].manageModal(void 0,l)},e.preview=function(e,t){o[31].previewModal(e,{popFrom:n.clicks.realEventTarget(t.target)})},e.manage=function(e,t){o[31].manageModal(e,l,{popFrom:n.clicks.realEventTarget(t.target)})},e.search={results:[],pagination:{},loaded:!1},e.scrollEnd={loader:!1},o[23].current().then(function(n){var r=n.data.entity;e.search.pagination=o[31].paginate({kind:"31",args:{search:{ancestor:r.key}},config:{ignoreErrors:!0},complete:function(n){var r=n.data.errors;r?t.confirm("sellerProfileNotFound",function(){o[23].manageModal(i.key)}):(angular.forEach(_.range(1,10),function(e,t){}),e.search.results.extend(n.data.entities)),e.search.loaded=!0}}),e.scrollEnd.loader=e.search.pagination,e.search.pagination.load()})}]).controller("SellOrdersController",["$scope","modals","modelsEditor","helpers","currentAccount","GLOBAL_CONFIG","modelsMeta","models","modelsUtil","$state",function(e,t,n,i,r,a,o,s,c,l){var u="sell-carts"===l.current.name;e.setPageToolbarTitle("seller."+(u?"carts":"orders")),e.listHelp=u?a.emptyHelp.cartSellerList:a.emptyHelp.orderSellerList,e.search={results:[],pagination:{},loaded:!1},e.scrollEnd={loader:!1},e.view=function(e,t){s[34].manageModal(e,e._seller,void 0,{sellerMode:u,popFrom:i.clicks.realEventTarget(t.target)})},s[23].current().then(function(n){var i=n.data.entity;e.search.pagination=s[34].paginate({kind:"34",args:{search:{filters:[{field:"seller_reference",operator:"==",value:i.key}],orders:[{field:"updated",operator:"desc"}]}},config:{ignoreErrors:!0},complete:function(n){var i=n.data.errors;i?t.confirm("sellerProfileNotFound",function(){s[23].manageModal(r.key)}):e.search.results.extend(n.data.entities),e.search.loaded=!0}}),e.scrollEnd.loader=e.search.pagination,e.search.pagination.load()})}]).run(["modelsConfig","modelsMeta","modelsEditor","formInputTypes","underscoreTemplate","$modal","modals","helpers","$q","$timeout","currentAccount","$filter","dateFilter","GLOBAL_CONFIG","snackbar",function(e,t,n,i,r,a,o,s,c,l,u,d,f,p,g){var m=function(e){var t=p.fields.translateChoices.rules.kind[e];return angular.isDefined(t)?t:e};e(function(e){i.SuperPluginStorageProperty=function(n){var u=n.config,f=u.kinds,g=s.callable(n.scope.formSetDirty),h={listView:"default-line-list-view",listConfig:{perLine:2}},v={ui:{specifics:{type:"radio",trueLabel:p.fields.radioLabel.pluginLocation.trueLabel,falseLabel:p.fields.radioLabel.pluginLocation.falseLabel}}},y=function(e,t,n){return{ui:{groupBy:e,groupHelp:n,groupLabel:t}}},b={listView:"address-rule-location-list-view",sortFields:["country","region","postal_codes"],listConfig:{perLine:3},beforeSave:function(t,n){var i,r=[],a=t.args;return!a.region||a._region&&a.region===a._region.key||(i=e[13].get(a.region),i.then(function(e){e.data.entities.length&&(a._region=e.data.entities[0])}),r.push(i)),!a.country||a._country&&a.country===a._country.key||(i=e[12].actions.search(void 0,{cache:!0}),i.then(function(e){if(e.data.entities.length){var t=_.findWhere(e.data.entities,{key:a.country});angular.isDefined(t)&&(a._country=t)}}),r.push(i)),r.length?c.all(r):!1}},w={aboutPlugins:function(){a.open({templateUrl:"core/models/manage.html",controller:["$scope",function(e){e.dialog={templateBodyUrl:"seller/help/plugins.html",toolbar:{hideSave:!0,title:s.toolbar.title("seller.settings.aboutRules")}},e.close=function(){e.$close()}}]})},sortableOptions:{disabled:!1,start:function(e,t){n.scope.$broadcast("itemOrderStarted")},axis:!1,containment:!1,whatSortMeans:function(){o.alert("howToSort")},handle:".sort-handle",tolerance:"pointer",helper:"clone",sort:function(e,t){var i,r,a=t.helper.width(),o=t.item.scope(),s=o.$eval(t.item.attr("current-item"));r=t.offset.left+a,a/2>r&&(i=!0),s&&(i?(t.helper.addClass("about-to-delete"),s._state="deleted",n.scope.formSetDirty()):(t.helper.removeClass("about-to-delete"),s._state=null)),n.scope.$broadcast("itemOrderSorting")},stop:function(e,t){var i=[],r=[];angular.forEach(u.ui.specifics.parentArgs,function(e,t){i.push(e._sequence),t=u.ui.specifics.parentArgs.length-1-t,r.push(t),e._sequence=t,e.ui&&(e.ui.access[e.ui.access.length-1]=t)}),i.equals(r)||n.scope.formSetDirty(),n.scope.$broadcast("itemOrderChanged"),n.scope.$apply()}},pluginFieldOverrides:{113:{lines:{ui:{specifics:h},modelclass:{rules:{ui:{specifics:{toolbar:{titleEdit:"editPrice",titleAdd:"addPrice"},listView:"carrier-line-rule-list-view",listConfig:{perLine:2}}},modelclass:{condition_type:y("conditional",p.fields.label["124-update"].condition_type,p.fields.help["124-update"].condition_type),condition_operator:y("conditional"),condition_value:y("conditional"),price_type:y("price",p.fields.label["124-update"].price_type,p.fields.help["124-update"].price_type),price_operator:s.extendDeep(y("price"),{ui:{active:"args.price_type !== 'fixed'"}}),price_value:y("price")}},exclusion:v,locations:{ui:{specifics:b}}}}},107:{exclusion:v,locations:{ui:{specifics:b}}},126:{lines:{ui:{specifics:h},modelclass:{condition_type:y("conditional",p.fields.label["111-update"].condition_type,p.fields.help["111-update"].condition_type),condition_operator:y("conditional"),condition_value:y("conditional")}}},109:{carriers:{ui:{specifics:{entities:function(){return u.ui.specifics.parentArgs?$.map(u.ui.specifics.parentArgs,function(e){return e.active&&"113"===e.kind?{key:e.key,name:e.name}:void 0}):[]}}}},exclusion:v,locations:{ui:{specifics:b}}}},showType:m,kind:void 0,selectKinds:{type:"SuperStringProperty",_maker_:"rules",choices:f,required:!0,ui:{args:"info.kind",label:p.fields.label.plugins.kind,attrs:{"ng-change":"setNewArg()"},writable:!0},code_name:"kind"},remove:function(e){e._state="deleted",n.scope.$emit("itemDelete",e),n.scope.$broadcast("itemDelete",e),g()},create:function(){return this.manage()},manage:function(e){angular.isDefined(u.ui.specifics.templateUrl)||(u.ui.specifics.templateUrl="core/fields/manage_structured.html"),a.open({template:r.get(u.ui.specifics.templateUrl)({config:u}),controller:["$scope","modelsUtil",function(r,a){var f,p=d("inflector"),m=function(){r.layouts={groups:[{label:!1}]},r.formBuilder={0:[u.ui.specifics.selectKinds]}},h=function(e,t){var n=w.pluginFieldOverrides[e];return angular.isDefined(n)&&angular.isDefined(n[t])?angular.copy(n[t]):{}};u.ui.specifics.toolbar={leftIcon:"navigation.arrow-back",hideSave:!0},angular.isUndefined(u.ui.specifics.toolbar.titleAdd)&&(u.ui.specifics.toolbar.titleAdd="add"+s.toolbar.makeTitle(u.code_name)),angular.isUndefined(u.ui.specifics.toolbar.titleEdit)&&(u.ui.specifics.toolbar.titleEdit="edit"+s.toolbar.makeTitle(u.code_name)),f=function(){return u.ui.specifics.toolbar["title"+(r.isNew?"Add":"Edit")]},u._title_.push(f),r.isNew=!1,e?a.normalize(e,void 0,u.ui.specifics.entity,u.code_name,u.ui.specifics.parentArgs.length):(e={},r.isNew=!0),r.info={build:!0},r.config=u,r.setNewArg=function(){0!==r.info.kind&&r.args.kind!==r.info.kind&&(e={kind:r.info.kind},a.normalize(e,void 0,u.ui.specifics.entity,u.code_name,u.ui.specifics.parentArgs.length,!1),r.isNew=!0,r.args=e,r.getFormBuilder(),r.info.build=!1,l(function(){r.info.build=!0,r.$apply()},100))},m(),r.getFormBuilder=function(){m();var e=r.info.kind,n=t.getFields(e),a=0,o=!1;n=_.toArray(n),n.sort(s.fields.sorter),u.ui.specifics.fields=n,angular.forEach(n,function(t){t._title_=u._title_.concat(),t.ui.name="plugin."+t.code_name,t.ui.writable=!0;var n,a=h(e,t.code_name);a&&s.extendDeep(t,a),t.is_structured&&i[t.type]?(r.layouts.groups.push({label:p(t.ui.label||t.code_name,"humanize"),disabled:!1,open:!1}),t.ui.label=!1,n=r.layouts.groups.length-1,angular.isDefined(r.formBuilder[n])||(r.formBuilder[n]=[],r.formBuilder[n].push(t)),r.layouts.groups[0].disabled=!1):r.formBuilder[0].push(t)}),angular.forEach(r.layouts.groups,function(e,t){r.formBuilder[t].length&&(a+=1),o===!1&&(r.formBuilder[t].length?(e.open=!0,o=e):e.open=!1)}),1===a&&(o.disabled=!0)},r.container={},r.args=angular.copy(e),r.parentArgs=u.ui.specifics.parentArgs,r.entity=u.ui.specifics.entity,r.rootFormSetDirty=g,r.formSetDirty=angular.bind(r,s.form.setDirty),r.formSetPristine=angular.bind(r,s.form.setPristine),r.validateForm=angular.bind(r,s.form.validate),r.args&&r.args.kind&&(r.info.kind=r.args.kind,r.getFormBuilder()),r.close=function(){var e=r.save();e?e.then(function(){r._close_=void 0,r.$close()}):o.confirm("discardWithFieldsRequired",r.$close)},r._close_=r.close,r.save=function(){var t,i,a=c.defer(),o=a.promise;if(r.validateForm()&&r.info.kind)return angular.isFunction(u.ui.specifics.beforeSave)&&(t=u.ui.specifics.beforeSave(r,n)),i=function(){var t=null,i=0;r.isNew?(r.parentArgs.unshift(r.args),r.isNew=!1,i=r.parentArgs.length,angular.forEach(r.parentArgs,function(e,t){t=i-t,e._sequence=t})):$.extend(e,r.args),angular.isFunction(u.ui.specifics.afterSave)&&(t=u.ui.specifics.afterSave(r,n)),t&&t.then?t.then(function(){a.resolve()}):a.resolve()},r.container.form.$dirty&&g(),t&&t.then?t.then(i):i(),r.isNew=!1,o},r.$on("$destroy",function(){u._title_.remove(f),u.ui.specifics.getScope=void 0}),r.$watch("isNew",function(){u.ui.specifics.toolbar.title=s.toolbar.buildTitle(u._title_)})}]})}};return u.ui.specifics.parentArgs=n.scope.$eval(u.ui.args),u.ui.specifics.entity=n.scope.$eval(u.ui.model),n.scope.$watch(u.ui.args,function(e,t){e!==t&&(u.ui.specifics.parentArgs=e)}),angular.forEach(w,function(e,t){void 0===u.ui.specifics[t]&&(u.ui.specifics[t]=e)}),"plugins"}}),e(function(e){var i={_content:{documents:{}},_plugin_group:{}};$.extend(e[23],{viewModal:function(t,n){n=s.alwaysObject(n);var i=n.removedOrAdded,r=n.popFrom;a.open({templateUrl:"seller/view.html",popFrom:r,controller:["$scope","currentAccount",function(n,r){var o;n.seller=t,n.alreadyInCollection=!1,n.loadedCollection=e[18].current().then(function(e){var t=e.data.entity;return-1!==$.inArray(n.seller.key,t.sellers)&&(n.alreadyInCollection=!0),t}),o=[],n.catalogs=[],n.search={results:[],pagination:e[31].paginate({kind:"31",args:{search:{filters:[{field:"ancestor",operator:"IN",value:n.seller.key}]}},config:{normalizeEntity:!1},action:"public_search",complete:function(t){var i=t.data.entities;e[31].formatPublicSearchResults(i),n.search.results.extend(i)}})},n.scrollEnd={loader:!1},n.scrollEnd.loader=n.search.pagination,n.search.pagination.load(),n.viewCatalog=function(t,n){e[31].viewModal(t.key,{popFrom:s.clicks.realEventTarget(n.target)})},n.seller._feedback&&(angular.forEach(n.seller._feedback.feedbacks,function(e){e.positive_count=_.random(0,100),e.negative_count=_.random(0,100),e.neutral_count=_.random(0,100),o.push({c:[{v:f(e.date,"MMM")},{v:e.positive_count},{v:e.negative_count},{v:e.neutral_count}]})}),n.chartConfig={type:"ColumnChart",data:{cols:[{id:"months",label:"Months",type:"string"},{id:"positive",label:"Positive",type:"number"},{id:"negative",label:"Negative",type:"number"},{id:"neutral",label:"Neutral",type:"number"}],rows:o},options:{colors:["green","red","gray"],series:{0:{axis:"positive"},1:{axis:"negative"},3:{axis:"neutral"}},axes:{y:{positive:{label:"Positive"},negative:{label:"Negative",side:"right"},neutral:{label:"Neutral",side:"right"}}}}},n.feedbackStats=function(){var e,t,n,i,r=0,a=0,o=0,s=[];return e=parseFloat(r/(r+o)*100).toFixed(1),t=parseFloat(o/(o+r)*100).toFixed(1),n=parseFloat(a/(a+o+r)*100).toFixed(1),i=r-o>0?r-o:0,s[0]=r,s[1]=a,s[2]=o,s[3]=e,s[4]=t,s[5]=n,s[6]=i,s}()),n.viewContent=function(e){a.open({templateUrl:"core/misc/content_view.html",controller:["$scope",function(t){t.plainText=!0,t.content=e,t.close=function(){t.$close()}}]})},n.toggleCollection=function(){n.loadedCollection.then(function(t){var a=t,o=!1;n.alreadyInCollection?(o=!0,a.sellers.remove(n.seller.key)):a.sellers.unshift(n.seller.key),e[18].actions.update({account:r.key,sellers:a.sellers,notify:a.notify}).then(function(e){var t=e.data.entity;n.alreadyInCollection=!o,$.extend(a,t),angular.isFunction(i)&&i(t,n.alreadyInCollection)})})},n.close=function(){n.$close()}}]})},current:function(e){return e||(e={}),e.account=u.key,this.actions.read(e,{cache:"currentSeller",cacheType:"memory"})},manageModal:function(e){var r,a=t.getActionArguments(this.kind,"update");a._content.ui.label=!1,$.extend(a._content.modelclass.documents.ui,{label:!1,specifics:{listView:"content-list-view",listConfig:{perLine:1}}}),$.extend(a._plugin_group.modelclass.plugins.ui,{label:!1}),a.logo.ui.specifics={displayImageConfig:{size:240}},a._plugin_group.ui.label=!1,r={kind:this.kind,action:"update",fields:_.toArray(a),toolbar:{submitNative:!0,titleEdit:"seller.settings"},excludeFields:["account","read_arguments"],argumentLoader:function(t){var n=this.defaultArgumentLoader(t);return n.account=e,null===n._content&&(n._content={kind:"21",documents:[]}),n.read_arguments=i,n},scope:{layouts:{groups:[{label:!1,fields:["name","logo"]},{label:p.subheaders.sellerContents,fields:["_content"]},{label:p.subheaders.sellerPlugins,fields:["_plugin_group"]}]}}},n.create(r).read({},{account:e,read_arguments:i})}})})}])}(),function(){"use strict";angular.module("app").controller("AdminListController",["$scope","models","$stateParams","GLOBAL_CONFIG","searchBuilder","$state","helpers",function(e,t,n,i,r,a,o){var s=n.kind,c=null,l={},u=i.admin.listViewDirective[s];try{c=o.url.jsonFromUrlsafe(n.query),l=c}catch(d){}e.config={titles:i.admin.listTitles,kind:s},e.maybeTemplate=u===!0?"admin/list_view/"+s+".html":u,e.setPageToolbarTitle("admin."+e.config.titles[s]),e.manage=function(e,n){t[s].adminManageModal(e,{popFrom:o.clicks.realEventTarget(n.target)})},e.search=r.create(),$.extend(e.search,{doSearch:function(){a.go("admin-list",{kind:this.kind,query:o.url.jsonToUrlsafe({search:this.send})})},results:[],pagination:t[s].paginate({args:l,kind:s,complete:function(t){e.search.results.extend(t.data.entities)}})}),e.search.kind=s,c||(c=e.search.pagination.args),e.search.changeKindUI(),c&&e.search.setSearch(s,c.search),e.scrollEnd={loader:e.search.pagination},e.search.pagination.load()}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","GLOBAL_CONFIG",function(e,t){e.state("home",{url:"/",templateUrl:"home/index.html",controller:"HomePageController"}).state("following",{url:"/following",templateUrl:"home/index.html",controller:"HomePageController"}).state("seller-info",{url:"/seller/:key",controller:"HomePageController",templateUrl:"home/index.html"}).state("sell-catalogs",{url:"/sell/catalogs",controller:"SellCatalogsController",templateUrl:"catalog/list.html"}).state("sell-orders",{url:"/sell/orders",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("sell-carts",{url:"/sell/carts",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("buy-orders",{url:"/buy/orders",controller:"BuyOrdersController",templateUrl:"order/list.html"}).state("buy-carts",{url:"/buy/carts",controller:"BuyOrdersController",templateUrl:"buyer/carts.html"}).state("login-status",{url:"/login/status",template:"",controller:"AccountLoginStatusController"}).state("admin-list",{url:"/admin/list/:kind/:query",templateUrl:function(e){var n,i="admin/list.html";return void 0!==e.kind&&(n=t.admin.listTemplates[e.kind],n&&n.templateUrl&&(i=n.templateUrl)),i},controller:"AdminListController"})}]).run(["modelsInfo","endpoint","models","currentAccount","GLOBAL_CONFIG","modelsUtil",function(e,t,n,i,r,a){$.extend(e,window.MODELS_META),$.extend(i,window.CURRENT_ACCOUNT),a.normalize(i),n.init(),r.debug||(delete window.MODELS_META,delete window.CURRENT_ACCOUNT)}])}();