function Steady(e){if(!e)throw new Error("missing options");if(!e.handler)throw new Error("missing handler parameter");this.scrollElement=e.scrollElement||window,this.conditions=e.conditions||{},this.handler=e.handler,this.values={},this.tracked={},this.success=!1,this.throttleVal=e.throttle||100,this.processing=!1,this.stopped=!1,this._parse(),"pageYOffset"in this.scrollElement?(this._addBottom(),this._addTop()):(this._addBottomEl(),this._addTopEl(),this._addScrollLeft()),this._addWidth(),this._onScroll()}function injector(e){return $(document).injector().get(e)}function $apply(){console.time("$apply");var e=injector("$rootScope");e.$apply(),console.timeEnd("$apply")}function msieversion(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):!1}window.ng||(window.ng=function(e){return e}),window.isChromeApp=window.chrome&&chrome.app&&chrome.app.runtime,window._chromeLocalStorage=null,window.getLocalStorage=function(){return window.isChromeApp?window.isChromeApp?(window._chromeLocalStorage||(window._chromeLocalStorage={_data:{},setItem:function(e,t){return this._data[e]=String(t)},getItem:function(e){return this._data.hasOwnProperty(e)?this._data[e]:void 0},removeItem:function(e){return delete this._data[e]},clear:function(){return this._data={}}}),window._chromeLocalStorage):void 0:window.localStorage},Steady.prototype.addCondition=function(e,t){this.conditions[e]=t,this._parse()},Steady.prototype.removeCondition=function(e){delete this.conditions[e],this._parse()},Steady.prototype.addTracker=function(e,t){this.tracked[e]={cb:t,name:e}},Steady.prototype._addBottom=function(){this.addTracker("bottom",function(e){var t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);return t-(e.pageYOffset+e.innerHeight)})},Steady.prototype._addTop=function(){this.addTracker("top",function(e){return e.pageYOffset})},Steady.prototype._addBottomEl=function(){this.addTracker("bottom",function(e){var t=Math.max(e.scrollHeight,e.offsetHeight);return t-(e.scrollTop+e.offsetHeight)})},Steady.prototype._addTopEl=function(){this.addTracker("top",function(e){return e.scrollTop})},Steady.prototype._addScrollLeft=function(){this.addTracker("scrollLeft",function(e){return e.scrollLeft})},Steady.prototype._addWidth=function(){this.addTracker("width",function(e){return e.innerWidth})},Steady.prototype._parse=function(){this._parsed={},this._wantedTrackers=[],this._parsedMax={},this._parsedMin={};for(var e in this.conditions)if(this.conditions.hasOwnProperty(e)){var t=e.substr(0,4);switch(t){case"min-":this._wantedTrackers.push(e.substr(4,e.length)),this._parsedMin[e.substr(4,e.length)]=this.conditions[e];break;case"max-":this._wantedTrackers.push(e.substr(4,e.length)),this._parsedMax[e.substr(4,e.length)]=this.conditions[e];break;default:this._wantedTrackers.push(e),this._parsed[e]=this.conditions[e]}}},Steady.prototype._check=function(){var e=[];for(var t in this.values)this._parsed.hasOwnProperty(t)&&e.push(this._parsed[t]==this.values[t]),this._parsedMin.hasOwnProperty(t)&&e.push(this._parsedMin[t]<=this.values[t]),this._parsedMax.hasOwnProperty(t)&&e.push(this._parsedMax[t]>=this.values[t]);if(e.length&&-1==e.indexOf(!1)){this.processing=!0;var n=this._done.bind(this);window.requestAnimationFrame(this.handler.bind(this,this.values,n))}},Steady.prototype._done=function(){this.processing=!1},Steady.prototype._onScroll=function(){this._onScrollHandler=this._throttledHandler(),this.scrollElement.addEventListener("scroll",this._onScrollHandler,!1)},Steady.prototype._throttledHandler=function(){var e=this;return this.throttle(function(t){if(e._wantedTrackers.length&&!e.processing){for(var n=0;n<e._wantedTrackers.length;n++)e.tracked[e._wantedTrackers[n]]&&(e.values[e._wantedTrackers[n]]=e.tracked[e._wantedTrackers[n]].cb(e.scrollElement||window));window.requestAnimationFrame(e._check.bind(e))}},this.throttleVal)},Steady.prototype.stop=function(){this.stopped||(this.scrollElement.removeEventListener("scroll",this._onScrollHandler,!1),this.stopped=!0)},Steady.prototype.resume=function(){this.stopped&&this._onScroll(),this.stopped=!1},Steady.prototype.throttle=function(e,t){var n,i=!0;return function(){var r=this,o=arguments;return i?(e.apply(r,o),void(i=!1)):void(n||(n=!0,setTimeout(function(){e.apply(r,o),n=!1},t)))}},"object"==typeof module&&module.exports&&(module.exports=Steady),function(){function e(e){var t,i,r,o,a,s;for(r=e.length,i=0,t="";r>i;){if(o=255&e.charCodeAt(i++),i==r){t+=n.charAt(o>>2),t+=n.charAt((3&o)<<4),t+="==";break}if(a=e.charCodeAt(i++),i==r){t+=n.charAt(o>>2),t+=n.charAt((3&o)<<4|(240&a)>>4),t+=n.charAt((15&a)<<2),t+="=";break}s=e.charCodeAt(i++),t+=n.charAt(o>>2),t+=n.charAt((3&o)<<4|(240&a)>>4),t+=n.charAt((15&a)<<2|(192&s)>>6),t+=n.charAt(63&s)}return t}function t(e){var t,n,r,o,a,s,c;for(s=e.length,a=0,c="";s>a;){do t=i[255&e.charCodeAt(a++)];while(s>a&&-1==t);if(-1==t)break;do n=i[255&e.charCodeAt(a++)];while(s>a&&-1==n);if(-1==n)break;c+=String.fromCharCode(t<<2|(48&n)>>4);do{if(r=255&e.charCodeAt(a++),61==r)return c;r=i[r]}while(s>a&&-1==r);if(-1==r)break;c+=String.fromCharCode((15&n)<<4|(60&r)>>2);do{if(o=255&e.charCodeAt(a++),61==o)return c;o=i[H4]}while(s>a&&-1==o);if(-1==o)break;c+=String.fromCharCode((3&r)<<6|o)}return c}var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);window.btoa||(window.btoa=e),window.atob||(window.atob=t)}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0===r)return-1;var o=+t||0;if(Math.abs(o)===1/0&&(o=0),o>=r)return-1;for(n=Math.max(o>=0?o:r-Math.abs(o),0);r>n;){if(n in i&&i[n]===e)return n;n++}return-1}),function(){"use strict";Array.prototype.iremove=function(e){for(var t=this.length;t--;)e(this[t],t)&&this.splice(t,1)},Array.prototype.remove=function(e){var t=this.indexOf(e);return-1!==t&&this.splice(t,1),this},Array.prototype.empty=function(e){return this.splice(0,this.length),this},Array.prototype.contains=function(e,t){if(angular.isArray(e)){var n=[];return angular.forEach(e,function(t){n.push(this.indexOf(e)>-1)}),t?_.all(n):_.some(n)}return this.indexOf(e)>-1},Array.prototype.equals=function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0,n=this.length;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},Array.prototype.compare=function(e){if(!e)return!1;if(this.length!==e.length)return!1;var t,n=this.length;for(t=0;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].compare(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},Array.prototype.prepend=function(e){var t=this;angular.forEach(e,function(e){t.unshift(e)})},Array.prototype.extend=function(e){var t=this;angular.forEach(e,function(e){t.push(e)})}}(),function(){"use strict";window.console||(window.console={}),angular.forEach(["log","error","trace","debug","info"],function(e){window.console[e]||(window.console[e]=angular.noop)});var e=window.isChromeApp?"https://x-arcanum-801.appspot.com":window.location.protocol+"//"+window.location.host,t={debug:!0,host:e,modules:["config","ngAnimate","ngMessages","ui.router","ui.sortable","ui.inflector","ngSanitize","ngDragDrop","timer","googlechart","btford.markdown","material.core","material.core.gestures","material.components.button","material.components.checkbox","material.components.content","material.components.simpledialog","material.components.input","material.components.radioButton","material.components.sidenav","material.components.swipe","material.components.textField","material.components.toolbar"],api:{endpoint:{path:e+"/api/endpoint"},modelsMeta:e+"/api/model_meta"},date:{format:"d MMM yyyy, HH:mm"},toolbar:{titles:{}},snackbar:{messages:{}},misc:{text:{}},subheaders:{},fields:{help:{},label:{},translateChoices:{},emptyHelp:{}},sellerPluginName:{},labels:{},modals:{confirmations:{},alerts:{}},defaultImage:"/client/dist/static/240x240_placeholder.png",defaultLogo:"/client/dist/static/720x300_placeholder.png",defaultCatalogCover:"/client/dist/static/240x240_placeholder.png",grid:{maxWidth:240,minWidth:180,maxHeight:360,margin:1},emptyHelp:{},imageSizes:_.range(50,1650,50),social:{facebook:{id:"125702284258635"}},admin:{listTemplates:{},menu:[{name:"Accounts",kind:11},{name:"Catalogs",kind:31},{name:"Orders",kind:"34"}],listViewDirective:{31:!0,11:!0,34:!0},listTitles:{31:"catalogs",11:"users",34:"orders"}}};t.debug&&(window._GLOBAL_CONFIG=t),angular.module("config",["ng"]).constant("GLOBAL_CONFIG",t).config(["$httpProvider","$locationProvider","$compileProvider",function(e,t,n){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",t.hashPrefix("!"),t.html5Mode(!window.isChromeApp),window.isChromeApp&&n.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension):/)}]),angular.module("app",t.modules)}(),$(function(){"use strict";var e=$("<div>").css({height:1,overflow:"scroll"}).appendTo("body"),t=$("<div>").css({height:2}).appendTo(e);window.SCROLLBAR_WIDTH=e.width()-t.width(),Modernizr.touch&&(window.SCROLLBAR_WIDTH=0),e.remove()}),function(){"use strict";angular.element(document).ready(function(){var e=function(e){if(-1!==e.status){var t=confirm("Could not start application. Reload your browser and try again?");t&&window.location.reload(!0)}},t=angular.injector(["config"]),n=t.get("$http"),i=t.get("$q"),r=t.get("GLOBAL_CONFIG"),o=[n.get(r.api.modelsMeta),n.get(r.api.endpoint.path+"?action_id=current_account&action_model=11")];i.all(o).then(function(t){var n=t[0].data,i=t[1].data;window.MODELS_META=n,window.CURRENT_ACCOUNT=i.entity,n&&n.errors||i&&i.errors?e():angular.bootstrap(document,["app"],{strictDi:!1})},e)})}(),window.DEBUG,function(){"use strict";angular.module("app").factory("errorHandling",["$modal","snackbar","GLOBAL_CONFIG","modals",function(e,t,n,i){var r=n.backendErrorHandling,o={translate:function(e,t,n){var i=r[e];return angular.isString(i)?i:angular.isFunction(i)?i(t,n):t},modal:function(e){i.alert(null,{title:"Error while performing an action",templateUrl:"core/misc/errors.html",text:{primary:"Got it"},errors:function(){var t=[];return angular.forEach(e,function(e,n){t.push([n,o.translate(n,e)])}),t}()})},snackbar:function(e,n,i){if(e.traceback)return t.showK("errorWithTraceback");var r,a=function(){var t=[];return angular.forEach(e,function(e,n){t.push(o.translate(n,e,i))}),t}().join("\n");n&&(r=n(e),r!==!1&&(a=r)),t.show(a)}};return o}]).factory("helpers",["GLOBAL_CONFIG",function(e){var t={callable:function(e){return angular.isFunction(e)?e:angular.noop},endpoint:{isResponseError:function(e){return angular.isString(e)||200!==e.status||e.data.errors},isResponseHttpError:function(e){return angular.isString(e)||200!==e.status}},alwaysObject:function(e){return angular.isObject(e)?e:{}},splitLines:function(e){return e.match(/[^\r\n]+/g)},addslashes:function(e){return e.toString().replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},resolveDefaults:function(e,n){return n=t.alwaysObject(n),angular.forEach(e,function(e,t){angular.isUndefined(n[t])||(n[t]=e)}),n},setProperty:function(e,t,n){var i,r,o=t;return angular.isArray(t)||(t=t.split("."),o=t),r=_.last(o),o=o.slice(0,o.length-1),o.length?(i=this.getProperty(e,o),void(i[r]=n)):void(e[t.join("")]=n)},forceSetProperty:function(e,t,n){var i,r,o=e;return angular.isArray(t)||(t=t.split(".")),1===t.length?void(e[t.join("")]=n):void angular.forEach(t,function(e,a){i=o,o=o[e],r=a===t.length-1,angular.isUndefined(o)&&!r&&(o={},i[e]=o),r&&(i[e]=n)})},getProperty:function(e,t,n){var i=t;return angular.isArray(i)||(i=t.split(".")),angular.forEach(i,function(t){try{e=e[t]}catch(i){return n}}),angular.isUndefined(e)?n:e},extendDeep:function(e){return angular.forEach(arguments,function(n){n!==e&&angular.forEach(n,function(n,i){e[i]&&angular.isObject(e[i])?t.extendDeep(e[i],n):e[i]=n})}),e},extend:function(e){return angular.forEach(arguments,function(t){t!==e&&angular.forEach(t,function(t,n){e[n]=t})}),e},merge:function(e){return angular.forEach(arguments,function(t){t!==e&&angular.forEach(t,function(t,n){angular.isDefined(e[n])||(e[n]=t)})}),e},mergeDeep:function(e){return angular.forEach(arguments,function(n){n!==e&&angular.forEach(n,function(n,i){e[i]&&angular.isObject(e[i])?t.mergeDeep(e[i],n):angular.isDefined(e[i])||(e[i]=n)})}),e},update:function(e,n,i){angular.isDefined(i)?angular.forEach(i,function(i){var r=t.getProperty(n,i);t.setProperty(e,i,r)}):$.extend(e,n)}};return e.debug&&(window._helpers=t),t}]).factory("endpoint",["$http","generalLocalCache","GLOBAL_CONFIG","helpers","modelsUtil","$rootScope","$q","$cacheFactory","$injector",function(e,t,n,i,r,o,a,s,c){var l,u=s("endpointOnlyInMemory"),d=function(e){return void 0===e||"local"===e?t:"memory"===e?u:void console.error("Invalid type of cache provided: "+e)},p=function(e,t,n,r){return r=i.alwaysObject(r),n=i.alwaysObject(n),[angular.extend({action_model:t,action_id:e},n),r]},f="endpoint_",g=[];return g.push(u),g.push(t),l={getCache:function(e){var t=null;return angular.forEach(g,function(n){t||(t=n.get(f+e))}),t},removeCache:function(e){return angular.isDefined(e)?angular.isArray(e)?(angular.forEach(e,function(e){l.removeCache(e)}),!0):void angular.forEach(g,function(t){t.remove(f+e)}):(angular.forEach(g,function(e){e.removeAll()}),!0)},url:n.api.endpoint.path,cached:function(e,t,n,i,r){var o,s,c=d(r?r.cacheType:void 0),u=f+e,p=c.get(u),g=p&&angular.isFunction(p.then);return g?p:void 0===p?(s=l[r.method?r.method.toLowerCase():"post"](t,n,i,r),s.then(function(e){c.put(u,e)},function(){c.remove(u)}),c.put(u,s),s):(o=a.defer(),s=o.promise,o.resolve(p),s)},post:function(t,n,i,o){var a,s=p(t,n,i,o),c={method:"POST",url:l.url};return s[0]=r.argumentsToJson(s[0]),s[1]&&angular.isString(s[1].cache)?(a=s[1].cache,s[1].cache=!1,l.cached(a,t,n,i,s[1])):(angular.extend(c,s[1]),c.data=s[0],e(c))},get:function(t,n,i,o){var a,s=p(t,n,i,o),c={params:s[0]},u={method:"GET",url:l.url};return s[0]=r.argumentsToJson(s[0]),$.extend(c,s[1]),angular.extend(u,c),u&&angular.isString(u.cache)?(a=u.cache,u.cache=!1,l.cached(a,t,n,i,c)):e(u)}},n.debug&&(window._endpoint=l),l}]).factory("generalLocalCache",["DSCacheFactory","$cacheFactory",function(e,t){function n(e,t){return t&&(t.value&&angular.isFunction(t.value.then)||angular.isObject(t.value)&&void 0!==t.value[s])?a:angular.toJson(t)}var i,r,o=t("localStoragePolyfillInMemory"),a="___undefined___",s="___in_memory_only___",c=window.getLocalStorage();return i={getItem:function(e){var t=o.get(e);return t&&angular.isObject(t)&&void 0!==t[s]&&(t=t[s]),void 0===t&&(t=c.getItem(e)),t!==a?t:void 0},setItem:function(e,t){var i;o.put(e,t),t=n(e,t);try{i=c.setItem(e,t)}catch(r){}return i},removeItem:function(e){return o.remove(e),c.removeItem(e)}},r=e("generalCache",{storageMode:"localStorage",storageImpl:i}),r.inMemory=function(e){var t={};return t[s]=e,t},r}]).run(["$http","generalLocalCache",function(e,t){e.defaults.cache=t}]).config(["$httpProvider",function(e){var t=!1;e.interceptors.push(["$rootScope","$q","$injector",function(e,n,i){var r=function(r){var o,a,s,c,l,u,d=r.data,p=void 0===r.config.normalizeEntity||r.config.normalizeEntity,f=i.get("errorHandling"),g=i.get("modelsUtil"),m=r.config.activitySpinner===!0,h=function(){e.$broadcast("disableUI",!1)},v=i.get("currentAccount"),y=void 0===r.config.disableUI||r.config.disableUI===!0;if(m&&e.activitySpinner.stop(),-1===r.status)return f.snackbar({connection_refused:!0},void 0,r.data),y&&h(),n.reject(r);if(!t&&angular.isObject(r.data)&&void 0!==v._is_guest&&void 0!==r.data.is_guest&&r.data.is_guest!==v._is_guest&&(a=i.get("models"),s=i.get("$state"),l=i.get("$timeout"),c=i.get("snackbar"),u=!0,t=!0,a[11].actions.current_account().then(function(e){var n=e.data.entity,i="youAreNotSignedIn";v._is_guest!==n._is_guest&&($.extend(v,n),n._is_guest?r.data.errors&&s.go("home"):(s.go(s.current,{},{inherit:!0,location:!1,reload:!0}),i="loginSuccess"),l(function(){c.showK(i)})),t=!1})),!r.config.ignoreErrors||r.config.ignoreErrors>1){if(r.status>200&&(!r.config.ignoreErrors||2===r.config.ignoreErrors))return u||f.snackbar(angular.isString(r.data)?{traceback:r.data}:r.data.errors,r.config.handleError,r.data),y&&h(),n.reject(r);if(d&&d.errors&&(!r.config.ignoreErrors||r.config.ignoreErrors>2)&&(u||f.snackbar(r.data.errors,r.config.handleError,r.data),o=void 0===r.config.rejectOnErrors||r.config.rejectOnErrors===!0,d.errors.action_denied&&(o=!0),o&&y))return h(),n.reject(r)}return p&&d&&(angular.isDefined(d.entities)?g.normalizeMultiple(d.entities):angular.isDefined(d.entity)&&g.normalize(d.entity)),y&&h(),r||n.when(r)};return{response:r,responseError:r,request:function(t){var i=void 0===t.disableUI||t.disableUI===!0,r=t.activitySpinner===!0;return i&&e.$broadcast("disableUI",!0),r&&e.activitySpinner.start(),t||n.when(t)}}}])}]).factory("underscoreTemplate",["$templateCache",function(e){return{get:function(t){return _.template(e.get(t))}}}]).factory("animationGenerator",function(){var e={classNamePrefix:"tmp-",prefix:function(e){return(/WebKit/.test(navigator.userAgent)?"-webkit-":"")+e},compile:function(t){var n="";return angular.forEach(t,function(t,i){n+=e.prefix(i)+": "+t+";\n"}),n},make:function(t,n){var i="@"+e.prefix("keyframes")+" "+t+" {\n";return i+=n,i+="\n} ."+e.classNamePrefix+t+"{"+e.prefix("animation-name")+":"+t+";}"},single:function(t,n){var i=_.uniqueId(),r="temporary-animator"+i,o=$("#"+r);return t+=i,o.length||(o=$("<style/>").attr("id",r),o.appendTo("head")),o.text(e.make(t,n)),{name:t,className:e.classNamePrefix+t,destroy:function(){o.remove()}}}};return e})}(),function(){"use strict";angular.module("app").config(["GLOBAL_CONFIG","$injector",function(e,t){var n={};$.extend(e.modals.confirmations,{discardWithFieldsRequired:{title:"Discard changes?",message:"There are some invalid changes on the form you are trying to leave. If you discard them, the changes will not be applied and will be lost permanently.",text:{primary:"Discard"}},disconnectSignInMethod:{title:"Disconnect the identity?",message:"If this is the only sign in identity connected to your Miraclestyle account, you will permanently lose access to the account and all of its data after this action is completed!",text:{primary:"Disconnect"}},removePricetagConfirm:{title:"Remove the product?",message:"The product will be permanently removed from the catalog! You will be notified once this action is completed.",text:{primary:"Remove"}},connectSignInMethod:{title:"Connect the identity?",message:"If this sign in identity is already connected to another Miraclestyle account, you will have to disconnect it before you proceed with this action!",text:{primary:"Connect"}},discard:{title:"Discard unsaved changes?",message:"There are some unsaved changes on the form you are trying to close. If you discard them, the changes will be lost permanently, and the form will revert to previously saved state.",text:{primary:"Discard"}},maybeLogout:{title:"Confirm sign out",message:"Are you sure you want to sign out?",text:{primary:"Sign out"}},cancelOrder:{title:"Reset the cart?",message:"This cart will be emptied, and all of its settings will be lost after this action is completed.",text:{primary:"Reset"}},toCheckout:{title:"Review the cart?",message:"You won't be able to update the cart after this step. However, you will be able to reset the cart, or place an order by making a payment.",text:{primary:"Review"}},publishCatalog:{title:"Publish the catalog?",message:'A published catalog is accessible to the general public and can be shared and embedded to third party websites. With an exception of a product "Stock configurations", a published catalog cannot be edited. However, a published catalog can be duplicated, and the duplicate is ready for editing. You will be notified once this action is completed.',text:{primary:"Publish"}},discontinueCatalog:{title:"Discontinue the catalog?",message:"A discontinued catalog is not accessible to the general public and is eventually entirely removed from the Miraclestyle app. However, products of a discontinued catalog remain accessible for the 180 days to those who have purchased them. A discontinued catalog cannot be edited or duplicated. You will be notified once this action is completed.",text:{primary:"Discontinue"}},duplicateCatalogPricetag:{title:"Schedule duplication?",message:"Duplication can take a while to complete! You will be notified once this action is completed.",text:{primary:"Schedule"}},duplicateCatalog:{title:"Schedule duplication?",message:"Duplication can take a while to complete! You will be notified once this action is completed.",text:{primary:"Schedule"}}}),n.gotit={primary:"Got it"},$.extend(e.modals.alerts,{howToSort:{title:"How to use this action",messages:["Reorder the item by dragging it within its group.","Remove the item by dragging it outside the left edge of the screen."],text:n.gotit},howToDeleteDragging:{title:"How to use this action",message:"Remove the item by dragging it outside the left edge of the screen.",text:n.gotit},howToDropPricetag:{title:"How to use this action",messages:['Add a new product to the catalog by dragging the "Add" tag to a catalog image. While dragging, it is preferable to aim the tag dot for the image area that shows the product that the tag will link to. Add one tag per product per catalog.',"Reposition a tag by dragging it within images area.",'Click on a tag to open the "Edit Product" form while editing the catalog.',"Click on a tag to open the product view while viewing the catalog."],text:n.gotit}}),$.extend(e.labels,{account:{active:"Active",suspended:"Suspended"},catalog:{draft:"Draft",published:"Published",indexed:"Indexed",discontinued:"Discontinued",unindex:"Unindex",index:"Index"},order:{cart:"Cart",checkout:"Checkout",completed:"Completed",canceled:"Canceled",positive:"Positive",negative:"Negative",neutral:"Neutral",revision:"Review",reported:"Reported",sudo:"Administered",review:"Review"}}),n.fieldhelpForProduct={weight:"Product weight, expressed in kilograms, per unit of measurement. This field is used by the Carrier rule for calculating delivery costs.",volume:"Product volume, expressed in liters, per unit of measurement. This field is used by the Carrier rule for calculating delivery costs."},$.extend(e.fields.help,{"124-update":{condition_type:"Condition under which this line applies.",price_type:"Price formula that calculates this price."},106:{postal_codes:"Postal codes this location affects. Specify one postal code per line."},108:{reciever_email:"Primary email address for your PayPal account.",business:'Email address on which you want to receive your PayPal payments. This value will be the same as "Receiver Email" in case that you have only one email address associated with your PayPal account.'},109:{product_codes:"Specific product codes this rule applies to. Specify one product code per line.",address_type:"Buyer address type this rule applies to."},124:{product_codes:"Specific product codes this line applies to. Specify one product code per line."},117:{currency:"Currency you accept, and your product unit prices are expressed in."},"111-update":{condition_type:"Condition under which this price applies.",price_type:"Price formula that calculates this price."},"23-update":{name:"Name of the brand, company, or store that you represent.",logo:"Click on the logo above to upload logo image of the brand, company, or store that you represent. Logo must be of 2.4:1 aspect ratio, preferably 720 pixels wide and 300 pixels high."},14:{name:"Recipient's full name or business name."},107:{address_type:"Buyer address type this rule applies to."},27:n.fieldhelpForProduct,28:n.fieldhelpForProduct,"31-update":{discontinue_date:"Date when this catalog will be automatically discontinued and become unavailable to the general public."},26:{name:"Name of the variant input control that is visible on the product view.",options:"Options that are available for selection on the variant input control. Specify one option per line.",description:"Brief description visible beneath the variant input control.",allow_custom_value:"If enabled, options defined above will be ignored, and buyers will be able to supply a custom value in the variant input control"}}),$.extend(e.fields.label,{search:{indexID:"Search options",ancestor:"Ancestor",operator:"Operator"},plugins:{kind:"Rule"},28:{uom:"Unit of measurement",variant_options:"Select all variant options you want this configuration to be matched with",weight:"Weight (kilogram)",volume:"Volume (liter)",_stock:"Stock Configurations"},27:{uom:"Unit of measurement",weight:"Weight (kilogram)",volume:"Volume (liter)"},109:{carriers:"Carriers this rule applies to"},112:{rules:"Prices"},124:{discount_value:"Discount (%)",product_categories:"Product categories"},"31-update":{discontinue_date:"Expiration date"},"124-update":{condition_type:"Condition",price_type:"Price"},"111-update":{condition_type:"Condition",price_type:"Price"},"23-update":{logo:"Seller logo"}}),n.conditionOperatorSpec={"==":"equals to","!=":"is not equal to",">":"is greater than","<":"is less than",">=":"is greater than or equal to","<=":"is less than or equal to"},n.addressTypeSpec={billing:"Billing",shipping:"Shipping"},n.conditionTypeSpec={weight:"weight",volume:"volume","weight*volume":"weight multiplied by volume",price:"price",quantity:"quantity"},$.extend(e.fields.translateChoices,{107:{address_type:n.addressTypeSpec},133:{availability:{"in stock":"In stock","out of stock":"Out of stock",preorder:"Preorder","available for order":"Available for order"}},109:{address_type:n.addressTypeSpec,type:{proportional:"Proportional (%)",fixed:"Fixed (Amount)"}},111:{condition_type:n.conditionTypeSpec,condition_operator:n.conditionOperatorSpec,price_type:{fixed:"fixed",variable:"varied by"},price_operator:{weight:"weight multiplied by",volume:"volume multiplied by","weight*volume":"weight multiplied by volume multiplied by",price:"price multiplied by",quantity:"quantity multiplied by"}},124:{condition_operator:n.conditionOperatorSpec},rules:{kind:{109:"Tax",126:"Discount",107:"Address",117:"Currency",108:"PayPal",113:"Carrier"}}}),$.extend(e.fields.emptyHelp,{"19-update":{addresses:"buyer/help/addresses.html"},"31-update":{_images:"catalog/help/images.html"},109:{carriers:"seller/help/carriers.html",product_categories:"seller/help/product_categories.html",locations:"seller/help/locations.html"},124:{product_categories:"seller/help/product_categories_line.html"},113:{lines:"seller/help/carrier_lines.html"},112:{locations:"seller/help/locations_line.html",prices:"seller/help/prices.html"},126:{lines:"seller/help/discount_lines.html"},134:{stocks:"catalog/product/help/stock_configurations.html"},107:{locations:"seller/help/locations.html"},28:{images:"catalog/product/help/images.html",contents:"catalog/product/help/contents.html",variants:"catalog/product/help/variants.html",_instances:"catalog/product/help/instances.html"},27:{images:"catalog/product/help/images.html",contents:"catalog/product/help/contents.html",variant_options:"catalog/product/help/variant_options.html"},21:{documents:"seller/help/contents.html"}}),e.fields.radioLabel||(e.fields.radioLabel={}),$.extend(e.fields.radioLabel,{pluginLocation:{falseLabel:"Applies to all locations except those listed in the Locations section",trueLabel:"Applies only to the locations listed in the Locations section"}}),$.extend(e.misc.text,{leaveUnsaved:"You have unsaved changes."}),$.extend(e.subheaders,{loginMethods:"Sign in identities",productInstances:"Variant configurations",catalogImages:"Images",catalogProducts:"Products",history:"History",record:"Log Entry",sellerContents:"Contents",sellerPlugins:"Rules"}),$.extend(e.emptyHelp,{orderSellerList:"seller/help/orders.html",cartSellerList:"seller/help/carts.html",orderBuyerList:"buyer/help/orders.html",cartBuyerList:"buyer/help/carts.html",catalogList:"catalog/help/list.html",cart:"order/help/empty.html",cartMessages:"order/help/messages.html",sellerProfileCatalogList:"seller/help/profile_catalogs.html"}),$.extend(e.snackbar.messages,{changesSaved:"Changes saved.",cartUpdated:"Cart updated.",catalogPublished:"Catalog published.",catalogDiscontinued:"Catalog discontinued.",duplicationInProgressCatalog:"Catalog scheduled for duplication.",administered:"Administered.",identityDisconnected:"Identity disconnected.",identityConnected:"Identity connected.",createVariantsFirst:"Create some variants first.",saveProductFirst:"Save product first.",provideProperValues:"Provide proper values in the form fields first!",uploadImagesFirst:'Navigate to the "Images" to upload and arrange catalog images first.',messangerDisabledWhenEmpty:"Messenger is disabled for empty shopping carts!",accessDenied:"Action denied! Your account is not authorized to perform this action.",noBuyer:"No buyer address. You did not provide any buyer information.",sellerProfileNotFound:'Navigate to the "Seller / Settings" to configure seller profile first.',productDuplicated:"Product duplicated.",catalogDuplicated:"Catalog duplicated.",errorWithTraceback:"Server errored with traceback.",actionFailedCheckForm:"Action failed! Inspect the form for errors.",orderPaymentSuccessProgress:"Order processing is in pogress.",orderPaymentSuccessProgresscanceled:"Order payment is canceled.",orderPaymentSuccessProgresscompleted:"Order payment is completed.",sellerProhibtsAddress:"The seller prohibits one of the addresses that you have supplied.",productOutOfStock:"Product out of stock.",saveChangesFirst:"Save changes first.",loginSuccess:"Signed in.",loginFailed:"Sign in failed!",loggedOut:"Signed out.",loginCanceled:"Sign in canceled.",youAreNotSignedIn:"You are not signed in.",saveInProgress:"Please wait save in progress."}),$.extend(e.toolbar.titles,{seller:"Seller",edit31:"Catalog",add31:"Catalog",viewImages:"Images",viewProducts:"Products",editProduct:"Edit Product",addProduct:"Add Product",editPluginGroup:!1,viewStock:"Stock Configurations",editStock:!1,editStocks:"Edit Stock Configuration",addStocks:"Add Stock Configuration",settings:"Settings",addPlugins:"Add Rule",editPlugins:"Edit Rule",addVariants:"Add Variant",editVariants:"Edit Variant",home:"Home",about:"About",acceptable_use_policy:"Acceptable Use Policy",tos:"Terms of Service",support:"Support",copyright_policy:"Copyright & Trademark",privacy_policy:"Privacy Policy",buyer:"Buyer",carts:"Carts",orders:"Orders",catalogs:"Catalogs",addLines:"Add Line",viewAddresses:"Addresses",addAddresses:"Add Address",editAddresses:"Edit Address",addLocations:"Add Location",editLocations:"Edit Location",editLines:"Edit Line",addPrice:"Add Price",addPrices:"Add Price",editPrice:"Edit Price",viewInstances:"Variant Configurations",editInstances:"Edit Variant Configuration",addInstances:"Add Variant Configuration",addContents:"Add Content",editContents:"Edit Content",account:"Account",admin:"Admin",users:"Accounts",aboutRules:"About Rules",addDocuments:"Add Content",editDocuments:"Edit Content",editContent:!1,sellerProfile:"Seller Profile"}),e.backendErrorHandling||(e.backendErrorHandling={})}]).run(["GLOBAL_CONFIG","currentAccount","models","$state","$timeout","snackbar",function(e,t,n,i,r,o){$.extend(e.backendErrorHandling,{
sellerProfileNotFound:function(t){return t.not_found&&-1!==$.inArray("seller",t.not_found)?e.snackbar.messages.sellerProfileNotFound:!1},productOutOfStock:function(t){return t.plugin_error&&-1!==$.inArray("product_out_of_stock",t.plugin_error)?e.snackbar.messages.productOutOfStock:!1},internal_server_error:function(e){return"Error occurred on the server."},action_denied:function(){return"You do not have permission to perform this action."},not_found:function(e){return"Requested data "+e.join(", ")+" could not be found in database."},invalid_image_type:"You have supplied incorrect type of image format.",invalid_model:"You have requested access to resource that does not exist,",invalid_action:"You have requested access to the action that does not exist.",required:function(e){return"Some values are missing: "+e.join(", ")+"."},connection_refused:function(){return"Failed to establish connection."},traceback:function(e){var t=$.parseHTML(e);return $(t).filter("pre").text()},transaction:function(e){return"timeout"===e?"Transaction was not completed due timeout. Please try again.":"failed"===e?"Transaction was not completed due failure. Please try again.":e}})}])}(),function(){"use strict";function e(e,t){function n(e){return angular.isDefined(e.href)||angular.isDefined(e.ngHref)}function i(e,t){return n(t)?'<a class="md-button" ng-transclude></a>':'<button class="md-button" ng-transclude></button>'}function r(i,r,o){var a=r[0];e.attachButtonBehavior(i,r);var s=a.textContent.trim();s||t.expect(r,"aria-label"),n(o)&&angular.isDefined(o.ngDisabled)&&i.$watch(o.ngDisabled,function(e){r.attr("tabindex",e?-1:0)})}return{restrict:"E",replace:!0,transclude:!0,template:i,link:r}}angular.module("material.components.button",["material.core"]).directive("mdButton",e),e.$inject=["$mdInkRipple","$mdAria"]}(),function(){"use strict";function e(e,t,n,i,r,o){function a(t,a){return a.type="checkbox",a.tabindex=a.tabindex||"0",t.attr("role",a.type),t.on("click",function(e){this.hasAttribute("disabled")&&e.stopImmediatePropagation()}),function(t,a,c,l){function u(e,n,i){c[e]&&t.$watch(c[e],function(e){i[e]&&a.attr(n,i[e])})}function d(e){var t=e.which||e.keyCode;(t===n.KEY_CODE.SPACE||t===n.KEY_CODE.ENTER)&&(e.preventDefault(),a.hasClass("md-focused")||a.addClass("md-focused"),p(e))}function p(e){a[0].hasAttribute("disabled")||(!function(){var t=c.ngChecked?c.checked:!l.$viewValue;l.$setViewValue(t,e&&e.type),l.$render()}(),t.$digest())}function f(){l.$viewValue?o.addClass(a,s):o.removeClass(a,s)}l=l||i.fakeNgModel(),c.ngChecked&&t.$watch(t.$eval.bind(t,c.ngChecked),l.$setViewValue.bind(l)),u("ngDisabled","tabindex",{"true":"-1","false":c.tabindex}),e.link.pre(t,{on:angular.noop,0:{}},c,[l]),t.mouseActive=!1,a.on("click",p).on("keypress",d).on("mousedown",function(){t.mouseActive=!0,r(function(){t.mouseActive=!1},100)}).on("focus",function(){t.mouseActive===!1&&a.addClass("md-focused")}).on("blur",function(){a.removeClass("md-focused")}),l.$render=f}}e=e[0];var s="md-checked";return{restrict:"E",transclude:!0,require:"?ngModel",template:'<div class="md-container list-primary-tile"><div class="avatar-small"><div><icon class="button-square" type="check_box"></icon><icon class="button-square" type="check_box_outline_blank"></icon></div></div></div><div ng-transclude class="md-label"></div>',compile:a}}angular.module("material.components.checkbox",["material.core"]).directive("mdCheckbox",e),e.$inject=["inputDirective","$mdAria","$mdConstant","$mdUtil","$timeout","$animate"]}(),function(){"use strict";function e(){function e(e,t){this.$scope=e,this.$element=t}return{restrict:"E",controller:["$scope","$element",e],link:function(e,n,i){n[0];e.$broadcast("$mdContentLoaded",n),t(n[0])}}}function t(e){angular.element(e).on("$md.pressdown",function(t){"t"===t.pointer.type&&(t.$materialScrollFixed||(t.$materialScrollFixed=!0,0===e.scrollTop?e.scrollTop=1:e.scrollHeight===e.scrollTop+e.offsetHeight&&(e.scrollTop-=1)))})}angular.module("material.components.content",["material.core"]).directive("mdContent",e).config(["markdownConverterProvider",function(e){e.config({extensions:["demo"]})}]),e.$inject=[]}(),function(){var e=function(e){return[{type:"output",filter:function(e){if(window._allow)return e;try{$.parseHTML(e)}catch(t){return""}var n=$("<div />").html(e),i=function(e){return e},r=function(e){var t=-1!==e.indexOf("%"),n=-1!==e.indexOf("px"),i="";return t&&(i="%"),n&&(i="px"),parseInt(e,10)+i},o={strong:!0,b:!0,hr:!0,ol:!0,blockquote:!0,kbd:!0,code:!0,i:!0,em:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,li:!0,div:!0,pre:!0,p:!0,br:!0,iframe:{width:r,height:r,src:i,allowfullscreen:function(){return""},frameborder:function(e){return parseInt(e,10)}}};return n.find("*").each(function(){var e=$(this),t=e.get(0).nodeName.toLowerCase(),n=o[t];n?$.each(this.attributes,function(){var t=angular.isObject(n)?n[this.name]:!1;t?e.attr(this.name,t(e.attr(this.name))):e.removeAttr(this.name)}):e.remove()}),n.html()}}]};"undefined"!=typeof window&&window.Showdown&&window.Showdown.extensions&&(window.Showdown.extensions.demo=e),"undefined"!=typeof module&&(module.exports=e)}(),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.jqueryui=!0;var r=e.target;if("mousemove"===t){var o=document.elementFromPoint(e.clientX,e.clientY);null!==o&&(r=o)}r.dispatchEvent(i)}}if(e.support.touch="ontouchend"in document||"onpointerdown"in document||"onMSPointerDown"in document,e.support.touch){var n,i,r,o,a,s,c,l,u,d=e.ui.mouse.prototype,p=d._mouseInit,f=d._mouseDestroy;d.state={},d._touchStart=function(e){s||(s=window.touchHelpers.getEventPoint,c=window.touchHelpers.updatePointerState,l=window.touchHelpers.makeStartPointer,u=window.touchHelpers.typesMatch);var d=this;if(!r&&d._mouseCapture(e.originalEvent.changedTouches[0])&&(r=!0,d._startedMove=e.timeStamp,d._touchMoved=!1,n=e.originalEvent.touches[0].screenX,i=e.originalEvent.touches[0].screenY,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"),!o&&!d.state.isRunning)){d.state.isRunning=!0;var p=+Date.now();a&&!u(e,a)&&p-a.endTime<1500||(o=l(e))}},d._touchDistanceMet=function(e){return e.distance>=this.options.distance},d._touchMove=function(e){var a=this;if(o&&u(e,o)&&c(e,o),r){var s=e.originalEvent.touches[0].screenX,l=e.originalEvent.touches[0].screenY;if(n===s&&i===l)return void(a._touchMoved=!1);a._touchMoved=!0,t(e,"mousemove")}},d._touchEnd=function(e){var n=this;return o&&u(e,o)&&(c(e,o),o.endTime=+Date.now()),r?(t(e,"mouseup"),t(e,"mouseout")||e,(!n._touchMoved||!n._touchDistanceMet(o)&&n.state.isRunning)&&t(e,"click"),n._touchMoved=!1,r=!1,a=o,o=null,void(n.state.isRunning=!1)):(a=o,void(o=null))},d._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),msieversion()&&t.element.css("-ms-touch-action","none"),p.call(t)},d._mouseDestroy=function(){var t=this;t._touchMoved=!1,t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),f.call(t)}}}(jQuery),function(){"use strict";function e(e,t,n){function i(e){var t=s[e];angular.isUndefined(t)&&(t=s[e]=r(e));var n=c[t];return angular.isUndefined(n)&&(n=o(t)),n}function r(t){return e.MEDIA[t]||("("!==t.charAt(0)?"("+t+")":t)}function o(e){var t=n.matchMedia(e);return t.addListener(a),c[t.media]=!!t.matches}function a(){var e=this;t.$evalAsync(function(){c[e.media]=!!e.matches})}var s={},c={};return i}!function(){function e(e){e.decorator("$$rAF",["$delegate",t])}function t(e){return e.throttle=function(t){var n,i,r,o;return function(){n=arguments,o=this,r=t,i||(i=!0,e(function(){r.apply(o,n),i=!1}))}},e}function n(e,t){function n(e){return r?"webkit"+e.charAt(0).toUpperCase()+e.substring(1):e}function i(e){return r?"-webkit-"+e:e}var r=/webkit/i.test(t.vendorPrefix);return{KEY_CODE:{ENTER:13,ESCAPE:27,SPACE:32,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40},RAW_CSS:{TRANSFORM:i("transform"),TRANSFORMORIGIN:i("transformOrigin"),TRANSITION:i("transition"),TRANSITION_DURATION:i("transitionDuration"),ANIMATION_PLAY_STATE:i("animationPlayState"),ANIMATION_DURATION:i("animationDuration"),ANIMATION_NAME:i("animationName"),ANIMATION_TIMING:i("animationTimingFunction"),ANIMATION_DIRECTION:i("animationDirection")},CSS:{TRANSITIONEND:"transitionend"+(r?" webkitTransitionEnd":""),ANIMATIONEND:"animationend"+(r?" webkitAnimationEnd":""),TRANSFORM:n("transform"),TRANSFORMORIGIN:n("transformOrigin"),TRANSITION:n("transition"),TRANSITION_DURATION:n("transitionDuration"),ANIMATION_PLAY_STATE:n("animationPlayState"),ANIMATION_DURATION:n("animationDuration"),ANIMATION_NAME:n("animationName"),ANIMATION_TIMING:n("animationTimingFunction"),ANIMATION_DIRECTION:n("animationDirection")},MEDIA:{sm:"(max-width: 600px)","gt-sm":"(min-width: 600px)",md:"(min-width: 600px) and (max-width: 960px)","gt-md":"(min-width: 960px)",lg:"(min-width: 960px) and (max-width: 1200px)","gt-lg":"(min-width: 1200px)"}}}angular.module("material.core",[]).config(e),e.$inject=["$provide"],angular.module("material.core").factory("$mdConstant",n),n.$inject=["$$rAF","$sniffer"]}(),function(){function e(e,t){function n(){return[].concat(v)}function i(){return v.length}function r(e){return v.length&&e>-1&&e<v.length}function o(e){return e?r(d(e)+1):!1}function a(e){return e?r(d(e)-1):!1}function s(e){return r(e)?v[e]:null}function c(e,t){return v.filter(function(n){return n[e]===t})}function l(e,t){return e?(angular.isNumber(t)||(t=v.length),v.splice(t,0,e),d(e)):-1}function u(e){p(e)&&v.splice(d(e),1)}function d(e){return v.indexOf(e)}function p(e){return e&&d(e)>-1}function f(){return v.length?v[0]:null}function g(){return v.length?v[v.length-1]:null}function m(e,n,i,o){i=i||h;var a=d(n);if(!r(a))return null;var s=a+(e?-1:1),c=null;return r(s)?c=v[s]:t&&(c=e?g():f(),s=d(c)),null===c||s===o?null:(angular.isUndefined(o)&&(o=s),i(c)?c:m(e,c,i,o))}var h=function(){return!0};t=!!t;var v=e||[];return{items:n,count:i,inRange:r,contains:p,indexOf:d,itemAt:s,findBy:c,add:l,remove:u,first:f,last:g,next:angular.bind(null,m,!1),previous:angular.bind(null,m,!0),hasPrevious:a,hasNext:o}}angular.module("material.core").config(["$provide",function(t){t.decorator("$mdUtil",["$delegate",function(t){return t.iterator=e,t}])}])}(),angular.module("material.core").factory("$mdMedia",e),e.$inject=["$mdConstant","$rootScope","$window"],function(){var e=["0","0","0"];angular.module("material.core").factory("$mdUtil",["$document","$timeout",function(t,n){var i;return i={now:window.performance?angular.bind(window.performance,window.performance.now):Date.now,elementRect:function(e,t){var n=e[0];t=t||n.offsetParent||document.body,t=t[0]||t;var i=n.getBoundingClientRect(),r=t.getBoundingClientRect();return{left:i.left-r.left+t.scrollLeft,top:i.top-r.top+t.scrollTop,width:i.width,height:i.height}},fakeNgModel:function(){return{$fake:!0,$setViewValue:function(e){this.$viewValue=e,this.$render(e),this.$viewChangeListeners.forEach(function(e){e()})},$isEmpty:function(e){return 0===(""+e).length},$parsers:[],$formatters:[],$viewChangeListeners:[],$render:angular.noop}},debounce:function(e,t,i,r){var o;return function(){var a=i,s=Array.prototype.slice.call(arguments);n.cancel(o),o=n(function(){o=void 0,e.apply(a,s)},t||10,r)}},throttle:function(e,t){var n;return function(){var r=this,o=arguments,a=i.now();(!n||a-n>t)&&(e.apply(r,o),n=a)}},nextUid:function(){for(var t,n=e.length;n;){if(n--,t=e[n].charCodeAt(0),57==t)return e[n]="A",e.join("");if(90!=t)return e[n]=String.fromCharCode(t+1),e.join("");e[n]="0"}return e.unshift("0"),e.join("")},disconnectScope:function(e){if(e&&e.$root!==e&&!e.$$destroyed){var t=e.$parent;e.$$disconnected=!0,t.$$childHead===e&&(t.$$childHead=e.$$nextSibling),t.$$childTail===e&&(t.$$childTail=e.$$prevSibling),e.$$prevSibling&&(e.$$prevSibling.$$nextSibling=e.$$nextSibling),e.$$nextSibling&&(e.$$nextSibling.$$prevSibling=e.$$prevSibling),e.$$nextSibling=e.$$prevSibling=null}},reconnectScope:function(e){if(e&&e.$root!==e&&e.$$disconnected){var t=e,n=t.$parent;t.$$disconnected=!1,t.$$prevSibling=n.$$childTail,n.$$childHead?(n.$$childTail.$$nextSibling=t,n.$$childTail=t):n.$$childHead=n.$$childTail=t}},getClosest:function(e,t){t=t.toUpperCase();do if(e.nodeName===t)return e;while(e=e.parentNode);return null}}}]),angular.element.prototype.focus=angular.element.prototype.focus||function(){return this.length&&this[0].focus(),this},angular.element.prototype.blur=angular.element.prototype.blur||function(){return this.length&&this[0].blur(),this}}(),function(){function e(e,t,n){function i(e,t,n){var i=e[0];i.hasAttribute(t)||a(i,t)||(n=angular.isString(n)&&n.trim()||"",n.length&&e.attr(t,n))}function r(t,n,r){e(function(){i(t,n,r())})}function o(e,t){r(e,t,function(){return e.text().trim()})}function a(e,t){function i(e){var t=e.currentStyle?e.currentStyle:n.getComputedStyle(e);return"none"===t.display}var r=e.hasChildNodes(),o=!1;if(r)for(var a=e.childNodes,s=0;s<a.length;s++){var c=a[s];1===c.nodeType&&c.hasAttribute(t)&&(i(c)||(o=!0))}return o}return{expect:i,expectAsync:r,expectWithText:o}}angular.module("material.core").service("$mdAria",e),e.$inject=["$$rAF","$log","$window"]}(),function(){function e(e,t,n,i,r,o){this.compile=function(a){var s=a.templateUrl,c=a.template||"",l=a.controller,u=a.controllerAs,d=a.resolve||{},p=a.locals||{},f=a.transformTemplate||angular.identity,g=a.bindToController;return angular.forEach(d,function(e,t){d[t]=angular.isString(e)?n.get(e):n.invoke(e)}),angular.extend(d,p),d.$template=s?t.get(s,{cache:o}).then(function(e){return e.data}):e.when(c),e.all(d).then(function(e){var t=f(e.$template),n=angular.element("<div>").html(t.trim()).contents(),o=i(n);return{locals:e,element:n,link:function(t){if(e.$scope=t,l){var i=r(l,e);g&&angular.extend(i,e),n.data("$ngControllerController",i),n.children().data("$ngControllerController",i),u&&(t[u]=i)}return o(t)}}})}}angular.module("material.core").service("$mdCompiler",e),e.$inject=["$q","$http","$injector","$compile","$controller","$templateCache"]}(),function(e){function t(){}function n(e,t,n){function i(e){return function(t,n){n.distance<this.state.options.maxDistance&&!t.jqueryui&&this.dispatchEvent(t,e,n)}}function r(e,t,n){var i=f[t.replace(/^\$md./,"")];if(!i)throw new Error("Failed to register element with handler "+t+". Available handlers: "+Object.keys(f).join(", "));return i.registerElement(e,n)}function o(t,n){var i=new e(t);return angular.extend(i,n),f[t]=i,h}var c=navigator.userAgent||navigator.vendor||window.opera,d=c.match(/ipad|iphone|ipod/i),p=c.match(/android/i),m="undefined"!=typeof window.jQuery&&angular.element===window.jQuery,h={handler:o,register:r,isHijackingClicks:(d||p)&&!m&&!g};if(h.isHijackingClicks){var v=8;h.handler("click",{options:{maxDistance:v},onEnd:i("click")}),h.handler("focus",{options:{maxDistance:v},onEnd:function(e,t){function n(e){var t=["INPUT","SELECT","BUTTON","TEXTAREA","VIDEO","AUDIO"];return"-1"!=e.getAttribute("tabindex")&&!e.hasAttribute("DISABLED")&&(e.hasAttribute("tabindex")||e.hasAttribute("href")||-1!=t.indexOf(e.nodeName))}t.distance<this.state.options.maxDistance&&n(e.target)&&(this.dispatchEvent(e,"focus",t),e.target.focus())}}),h.handler("mouseup",{options:{maxDistance:v},onEnd:i("mouseup")}),h.handler("mousedown",{onStart:function(e){this.dispatchEvent(e,"mousedown")}})}return window.touchHelpers||(window.touchHelpers={}),window.touchHelpers.getEventPoint=u,window.touchHelpers.updatePointerState=l,window.touchHelpers.makeStartPointer=a,window.touchHelpers.typesMatch=s,h.handler("press",{onStart:function(e,t){this.dispatchEvent(e,"$md.pressdown")},onEnd:function(e,t){this.dispatchEvent(e,"$md.pressup")}}).handler("hold",{options:{maxDistance:6,delay:500},onCancel:function(){n.cancel(this.state.timeout)},onStart:function(e,t){return this.state.registeredParent?(this.state.pos={x:t.x,y:t.y},void(this.state.timeout=n(angular.bind(this,function(){this.dispatchEvent(e,"$md.hold"),this.cancel()}),this.state.options.delay,!1))):this.cancel()},onMove:function(e,t){e.preventDefault();var n=this.state.pos.x-t.x,i=this.state.pos.y-t.y;Math.sqrt(n*n+i*i)>this.options.maxDistance&&this.cancel()},onEnd:function(){this.onCancel()}}).handler("drag",{options:{minDistance:6,horizontal:!0,cancelMultiplier:1.5},onStart:function(e){this.state.registeredParent||this.cancel()},onMove:function(e,t){var n,i;e.preventDefault(),this.state.dragPointer?this.dispatchDragMove(e):(this.state.options.horizontal?(n=Math.abs(t.distanceX)>this.state.options.minDistance,i=Math.abs(t.distanceY)>this.state.options.minDistance*this.state.options.cancelMultiplier):(n=Math.abs(t.distanceY)>this.state.options.minDistance,i=Math.abs(t.distanceX)>this.state.options.minDistance*this.state.options.cancelMultiplier),n?(this.state.dragPointer=a(e),l(e,this.state.dragPointer),this.dispatchEvent(e,"$md.dragstart",this.state.dragPointer)):i&&this.cancel())},dispatchDragMove:t.throttle(function(e){this.state.isRunning&&(l(e,this.state.dragPointer),this.dispatchEvent(e,"$md.drag",this.state.dragPointer))}),onEnd:function(e,t){this.state.dragPointer&&(l(e,this.state.dragPointer),this.dispatchEvent(e,"$md.dragend",this.state.dragPointer))}}).handler("swipe",{options:{minVelocity:.65,minDistance:10},onEnd:function(e,t){if(Math.abs(t.velocityX)>this.state.options.minVelocity&&Math.abs(t.distanceX)>this.state.options.minDistance){var n="left"==t.directionX?"$md.swipeleft":"$md.swiperight";this.dispatchEvent(e,n)}}})}function i(e){this.name=e,this.state={}}function r(){function e(e,t,n){n=n||d;var i=new angular.element.Event(t);i.$material=!0,i.pointer=n,i.srcEvent=e,i.jqueryui=e.jqueryui,angular.extend(i,{clientX:n.x,clientY:n.y,screenX:n.x,screenY:n.y,pageX:n.x,pageY:n.y,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}),angular.element(n.target).trigger(i)}function t(e,t,n){n=n||d;var i;"click"===t||"mouseup"==t||"mousedown"==t?(i=document.createEvent("MouseEvents"),i.initMouseEvent(t,!0,!0,window,e.detail,n.x,n.y,n.x,n.y,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget||null)):(i=document.createEvent("CustomEvent"),i.initCustomEvent(t,!0,!0,{})),i.$material=!0,i.pointer=n,i.srcEvent=e,i.jqueryui=e.jqueryui,n.target.dispatchEvent(i)}var n="undefined"!=typeof window.jQuery&&angular.element===window.jQuery;return i.prototype={options:{},dispatchEvent:n?e:t,onStart:angular.noop,onMove:angular.noop,onEnd:angular.noop,onCancel:angular.noop,start:function(e,t){if(!this.state.isRunning){var n=this.getNearestParent(e.target),i=n&&n.$mdGesture[this.name]||{};this.state={isRunning:!0,options:angular.extend({},this.options,i),registeredParent:n},this.onStart(e,t)}},move:function(e,t){this.state.isRunning&&this.onMove(e,t)},end:function(e,t){this.state.isRunning&&(this.onEnd(e,t),this.state.isRunning=!1)},cancel:function(e,t){this.onCancel(e,t),this.state={}},getNearestParent:function(e){for(var t=e;t;){if((t.$mdGesture||{})[this.name])return t;t=t.parentNode}return null},registerElement:function(e,t){function n(){delete e[0].$mdGesture[i.name],e.off("$destroy",n)}var i=this;return e[0].$mdGesture=e[0].$mdGesture||{},e[0].$mdGesture[this.name]=t||{},e.on("$destroy",n),n}},i}function o(e,t){function n(e){var t=!e.clientX&&!e.clientY;t||e.$material||e.isIonicTap||c(e)||(e.preventDefault(),e.stopPropagation())}function i(e){var t=0===e.clientX&&0===e.clientY;t||e.$material||e.isIonicTap||e.jqueryui||c(e)?(m=null,"label"==e.target.tagName.toLowerCase()&&(m={x:e.x,y:e.y})):(e.preventDefault(),e.stopPropagation(),m=null)}function r(e,n){var i;for(var r in f)i=f[r],i instanceof t&&("start"===e&&i.cancel(),i[e](n,d))}function o(e){if(!d){var t=+Date.now();p&&!s(e,p)&&t-p.endTime<1500||(d=a(e),r("start",e))}}function u(e){d&&s(e,d)&&(l(e,d),r("move",e))}function g(e){d&&s(e,d)&&(l(e,d),d.endTime=+Date.now(),r("end",e),p=d,d=null)}document.contains||(document.contains=function(e){return document.body.contains(e)}),!h&&e.isHijackingClicks&&(document.addEventListener("click",i,!0),document.addEventListener("mouseup",n,!0),document.addEventListener("mousedown",n,!0),document.addEventListener("focus",n,!0),console.log("clickHijacker"),h=!0);var v="mousedown touchstart pointerdown",y="mousemove touchmove pointermove",$="mouseup mouseleave touchend touchcancel pointerup pointercancel";angular.element(document).on(v,o).on(y,u).on($,g).on("$$mdGestureReset",function(){p=d=null})}function a(e){var t=u(e),n={startTime:+Date.now(),target:e.target,type:e.type.charAt(0)};return n.startX=n.x=t.pageX,n.startY=n.y=t.pageY,n}function s(e,t){return e&&t&&e.type.charAt(0)===t.type}function c(e){return m&&m.x==e.x&&m.y==e.y}function l(e,t){var n=u(e),i=t.x=n.pageX,r=t.y=n.pageY;t.distanceX=i-t.startX,t.distanceY=r-t.startY,t.distance=Math.sqrt(t.distanceX*t.distanceX+t.distanceY*t.distanceY),t.directionX=t.distanceX>0?"right":t.distanceX<0?"left":"",t.directionY=t.distanceY>0?"up":t.distanceY<0?"down":"",t.duration=+Date.now()-t.startTime,t.velocityX=t.distanceX/t.duration,t.velocityY=t.distanceY/t.duration}function u(e){return e=e.originalEvent||e,e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0]||e}var d,p,f={},g=!1,m=null,h=!1;angular.module("material.core.gestures",[]).provider("$mdGesture",t).factory("$$MdGestureHandler",r).run(o),t.prototype={skipClickHijack:function(){return g=!0},$get:["$$MdGestureHandler","$$rAF","$timeout",function(e,t,i){return new n(e,t,i)}]},n.$inject=["$$MdGestureHandler","$$rAF","$timeout"],o.$inject=["$mdGesture","$$MdGestureHandler"]}(window.jQuery),function(){function e(){function e(e){function t(e){return o.optionsFactory=e.options,o.methods=(e.methods||[]).concat(r),a}function n(t,n){if(n=n||{},n.methods=n.methods||[],n.options=n.options||function(){return{}},/^cancel|hide|show$/.test(t))throw new Error("Preset '"+t+"' in "+e+" is reserved!");if(n.methods.indexOf("_options")>-1)throw new Error("Method '_options' in "+e+" is reserved!");return o.presets[t]={methods:n.methods.concat(r),optionsFactory:n.options,argOption:n.argOption},a}function i(t,n,i){function r(e){return e&&e._options&&(e=e._options),l.show(angular.extend({},c,e))}function a(t,n){var r={};return r[e]=u,i.invoke(t||function(){return n},{},r)}var s,c,l=t(),u={hide:l.hide,cancel:l.cancel,show:r};return s=o.methods||[],c=a(o.optionsFactory,{}),angular.forEach(o.presets,function(e,t){function n(e){this._options=angular.extend({},i,e)}var i=a(e.optionsFactory,{}),r=(e.methods||[]).concat(s);if(angular.extend(i,{$type:t}),angular.forEach(r,function(e){n.prototype[e]=function(t){return this._options[e]=t,this}}),e.argOption){var o="show"+t.charAt(0).toUpperCase()+t.slice(1);u[o]=function(e){var n=u[t](e);return u.show(n)}}u[t]=function(t){return arguments.length&&e.argOption&&!angular.isObject(t)&&!angular.isArray(t)?(new n)[e.argOption](t):new n(t)}}),u}var r=["onHide","onShow","onRemove"],o={presets:{}},a={setDefaults:t,addPreset:n,$get:i};return a.addPreset("build",{methods:["controller","controllerAs","resolve","template","templateUrl","themable","transformTemplate","parent"]}),i.$inject=["$$interimElement","$animate","$injector"],a}function t(e,t,n,i,r,o,a,s){function c(e){return e&&angular.isString(e)?e.replace(/\{\{/g,l).replace(/}}/g,u):e}var l=a.startSymbol(),u=a.endSymbol(),d="{{"===l&&"}}"===u,p=d?angular.identity:c;return function(){function a(e){e.zIndex=80+f.length;var t=new u(e);return f.unshift(t),t.show().then(function(){return t.deferred.promise})}function c(e,n){var i;return void 0!==n?(i=n,f.splice(f.indexOf(n),1)):i=f.shift(),i&&i.remove().then(function(){i.deferred.resolve(e)}),i?i.deferred.promise:t.when(e)}function l(e,n){var i;return void 0!==n?(i=n,f.splice(f.indexOf(n),1)):i=f.shift(),i&&i.remove().then(function(){i.deferred.reject(e)}),i?i.deferred.promise:t.reject(e)}function u(a){var c,l,u;return a=a||{},a=angular.extend({scope:a.scope||n.$new(a.isolateScope),onShow:function(e,t,n){return o.enter(t,n.parent)},onRemove:function(e,n,i){return n&&o.leave(n)||t.when()}},a),a.template&&(a.template=p(a.template)),c={options:a,deferred:t.defer(),show:function(){return s.compile(a).then(function(n){function o(){a.hideDelay&&(l=i(d.cancel,a.hideDelay))}angular.extend(n.locals,c.options),angular.isString(a.parent)?a.parent=angular.element(e[0].querySelector(a.parent)):a.parent||(a.parent=r.find("body"),a.parent.length||(a.parent=r)),u=n.link(a.scope),u.css("z-index",a.zIndex);var s=a.onShow(a.scope,u,a);return t.when(s).then(function(){(a.onComplete||angular.noop)(a.scope,u,a),o()})})},cancelTimeout:function(){l&&(i.cancel(l),l=void 0)},remove:function(){c.cancelTimeout();var e=a.onRemove(a.scope,u,a);return t.when(e).then(function(){a.scope.$destroy()})}},a.interimElement=c,a.stack=f,c}var d,f=[];return d={show:a,hide:c,cancel:l}}}return e.$get=t,t.$inject=["$document","$q","$rootScope","$timeout","$rootElement","$animate","$interpolate","$mdCompiler"],e}angular.module("material.core").provider("$$interimElement",e)}(),function(){function e(){function e(e){function t(e){return o.optionsFactory=e.options,o.methods=(e.methods||[]).concat(r),a}function n(t,n){if(n=n||{},n.methods=n.methods||[],n.options=n.options||function(){return{}},/^cancel|hide|show$/.test(t))throw new Error("Preset '"+t+"' in "+e+" is reserved!");if(n.methods.indexOf("_options")>-1)throw new Error("Method '_options' in "+e+" is reserved!");return o.presets[t]={methods:n.methods.concat(r),optionsFactory:n.options,argOption:n.argOption},a}function i(t,n,i){function r(e){return e&&e._options&&(e=e._options),l.show(angular.extend({},c,e))}function a(t,n){var r={};return r[e]=u,i.invoke(t||function(){return n},{},r)}var s,c,l=t(),u={hide:l.hide,cancel:l.cancel,show:r};return s=o.methods||[],c=a(o.optionsFactory,{}),angular.forEach(o.presets,function(e,t){function n(e){this._options=angular.extend({},i,e)}var i=a(e.optionsFactory,{}),r=(e.methods||[]).concat(s);if(angular.extend(i,{$type:t}),angular.forEach(r,function(e){n.prototype[e]=function(t){return this._options[e]=t,this}}),e.argOption){var o="show"+t.charAt(0).toUpperCase()+t.slice(1);u[o]=function(e){var n=u[t](e);return u.show(n)}}u[t]=function(t){return arguments.length&&e.argOption&&!angular.isObject(t)&&!angular.isArray(t)?(new n)[e.argOption](t):new n(t)}}),u}var r=["onHide","onShow","onRemove"],o={presets:{}},a={setDefaults:t,addPreset:n,$get:i};return a.addPreset("build",{methods:["controller","controllerAs","resolve","template","templateUrl","themable","transformTemplate","parent"]}),i.$inject=["$$interimStackableElement","$animate","$injector"],a}function t(e,t,n,i,r,o,a,s){function c(e){return e&&angular.isString(e)?e.replace(/\{\{/g,l).replace(/}}/g,u):e}var l=a.startSymbol(),u=a.endSymbol(),d="{{"===l&&"}}"===u,p=d?angular.identity:c;return function(){function a(e){e.zIndex=80+f.length;var t=new u(e);return f.unshift(t),t.show().then(function(){return t.deferred.promise})}function c(e,n){var i;return void 0!==n?(i=n,f.splice(f.indexOf(n),1)):i=f.shift(),i&&i.remove().then(function(){i.deferred.resolve(e)}),i?i.deferred.promise:t.when(e)}function l(e,n){var i;return void 0!==n?(i=n,f.splice(f.indexOf(n),1)):i=f.shift(),i&&i.remove().then(function(){i.deferred.reject(e)}),i?i.deferred.promise:t.reject(e)}function u(a){var c,l,u;return a=a||{},a=angular.extend({scope:a.scope||n.$new(a.isolateScope),onShow:function(e,t,n){return o.enter(t,n.parent)},onRemove:function(e,n,i){return n&&o.leave(n)||t.when()}},a),a.template&&(a.template=p(a.template)),c={options:a,deferred:t.defer(),show:function(){return s.compile(a).then(function(n){function o(){a.hideDelay&&(l=i(d.cancel,a.hideDelay))}angular.extend(n.locals,c.options),angular.isString(a.parent)?a.parent=angular.element(e[0].querySelector(a.parent)):a.parent||(a.parent=r.find("body"),a.parent.length||(a.parent=r)),u=n.link(a.scope),u.css("z-index",a.zIndex);var s=a.onShow(a.scope,u,a);return t.when(s).then(function(){(a.onComplete||angular.noop)(a.scope,u,a),o()})})},cancelTimeout:function(){l&&(i.cancel(l),l=void 0)},remove:function(){c.cancelTimeout();var e=a.onRemove(a.scope,u,a);return t.when(e).then(function(){a.scope.$destroy()})}},a.interimElement=c,a.stack=f,c}var d,f=[];return d={show:a,hide:c,cancel:l}}}return e.$get=t,t.$inject=["$document","$q","$rootScope","$timeout","$rootElement","$animate","$interpolate","$mdCompiler"],e}angular.module("material.core").provider("$$interimStackableElement",e)}(),function(){function e(e,t){function n(e){return e&&""!==e}var i,r=[],o={};return i={notFoundError:function(t){e.error("No instance found for handle",t)},getInstances:function(){return r},get:function(e){if(!n(e))return null;var t,i,o;for(t=0,i=r.length;i>t;t++)if(o=r[t],o.$$mdHandle===e)return o;return null},register:function(e,t){function n(){var t=r.indexOf(e);-1!==t&&r.splice(t,1)}function i(){var n=o[t];n&&(n.resolve(e),delete o[t])}return t?(e.$$mdHandle=t,r.push(e),i(),n):angular.noop},when:function(e){if(n(e)){var r=t.defer(),a=i.get(e);return a?r.resolve(a):o[e]=r,r.promise}return t.reject("Invalid `md-component-id` value.")}}}angular.module("material.core").factory("$mdComponentRegistry",e),e.$inject=["$log","$q"]}(),function(){function e(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")?!0:!1}function t(e,t){return{controller:angular.noop,link:function(t,n,i){i.hasOwnProperty("mdInkRippleCheckbox")?e.attachCheckboxBehavior(t,n):e.attachButtonBehavior(t,n)}}}function n(t,n,i,r){function o(e,t,n){return c(e,t,angular.extend({isFAB:t.hasClass("md-fab"),isMenuItem:t.hasClass("md-menu-item"),center:!1,dimBackground:!0},n))}function a(e,t,n){return c(e,t,angular.extend({center:!0,dimBackground:!1,fitRipple:!0},n))}function s(e,t,n){return c(e,t,angular.extend({center:!1,dimBackground:!0,outline:!0},n))}function c(t,o,a){function s(t){g&&clearTimeout(g),g=setTimeout(function(){c(t)},e()?80:0)}function c(e){if(l()){var t="ripple-animation";if(u&&e.target){var i=$(e.target),a=!1;if(angular.forEach(u,function(e){(i.is(e)||i.parent().is(e))&&(a=!0)}),a)return}d=!0;var s={};s.style={top:"0",left:"0"};var c=angular.element('<div class="ripple-active"></div>');c.css(s.style),o[0].hasAttribute("ripple-dark")?c.addClass("ripple-dark"):o[0].hasAttribute("ripple-light")&&c.addClass("ripple-light"),o.append(c);var p=o[0].hasAttribute("md-ink-ripple-action")||o[0].hasAttribute("ripple-action");if(p)s.style={top:"0px",left:"0px",height:o.outerWidth()+"px",width:o.outerWidth()+"px"},t+=" ripple-action";else if(o[0].hasAttribute("md-ink-ripple-switch"))s.style={top:"-14px",left:"-14px",height:"48px",width:"48px"};else{var f=o.width(),g=o.height(),m=o[0].getBoundingClientRect(),h=2*Math.round(Math.sqrt(f*f+g*g));h>2e3&&(h=2e3);var v=-(h/2);s.style={top:e.clientY-m.top,left:e.clientX-m.left,height:h,width:h,"margin-top":v,"margin-left":v}}c.css(s.style),n(function(){r(function(){c.addClass(t),c.oneAnimationEnd(function(){c.remove()})})},0,!1)}}function l(){function e(e){return e&&e.hasAttribute&&e.hasAttribute("disabled")}var t=p.parentNode,n=t&&t.parentNode,i=n&&n.parentNode;return!(e(p)||e(t)||e(n)||e(i))}if(o.controller("mdNoInk"))return angular.noop;var u=o.attr("md-ink-ripple-ignore");u=u?i(u)(t):void 0,a=angular.extend({colorElement:o,mousedown:!0,hover:!0,focus:!0,center:!1,mousedownPauseTime:150,dimBackground:!1,outline:!1,isFAB:!1,isMenuItem:!1,fitRipple:!1},a);var d=(o.controller("mdInkRipple")||{},o.attr("md-highlight"),!1),p=o[0],f=o.attr("md-ripple-size");switch(f){case"full":a.isFAB=!0;break;case"partial":a.isFAB=!1}return o.addClass("ripple-presence"),a.mousedown&&o.on("$md.pressdown",s),function(){o.off("$md.pressdown",s),o.removeClass("ripple-presence")};var g}return{attachButtonBehavior:o,attachCheckboxBehavior:a,attachTabBehavior:s,attach:c}}function i(){return function(){return{controller:angular.noop
}}}angular.module("material.core").factory("$mdInkRipple",n).directive("mdInkRipple",t).directive("mdNoInk",i()).directive("mdNoBar",i()).directive("mdNoStretch",i()),t.$inject=["$mdInkRipple","$parse"],n.$inject=["$window","$timeout","$parse","$$rAF"]}()}(),function(){function e(e){function t(e,t,n){}function n(t,n,i){var r=this;r.isErrorGetter=i.mdIsError&&e(i.mdIsError),r.element=n,r.setFocused=function(e){n.toggleClass("md-input-focused",!!e)},r.setHasValue=function(e){n.toggleClass("md-input-has-value",!!e)},r.setNoFloat=function(e){n.toggleClass("md-input-no-float",!!e)},r.setInvalid=function(e){n.toggleClass("md-input-invalid",!!e)},t.$watch(function(){return r.label&&r.input},function(e){e&&!r.label.attr("for")&&r.label.attr("for",r.input.attr("id"))})}return n.$inject=["$scope","$element","$attrs"],{restrict:"E",link:t,controller:n}}function t(){return{restrict:"E",require:"^?mdInputContainer",link:function(e,t,n,i){i&&(i.label=t,e.$on("$destroy",function(){i.label=null}))}}}function n(e,t,n,i){function r(t,n,i,r){function o(e){return s.setHasValue(!c.$isEmpty(e)),e}function a(){s.setHasValue(n.val().length>0||(n[0].validity||{}).badInput)}var s=r[0],c=r[1]||e.fakeNgModel(),l=angular.isDefined(i.readonly);if(s){if(s.input)throw new Error("<md-input-container> can only have *one* <input> or <textarea> child element!");s.input=n,n.addClass("md-input"),n.attr("id")||n.attr("id","input_"+e.nextUid());var u=s.isErrorGetter||function(){return c.$invalid&&(c.$dirty||c.$touched)};t.$watch(u,s.setInvalid),c.$parsers.push(o),c.$formatters.push(o),n.on("input",a),l||n.on("focus",function(e){s.setFocused(!0)}).on("blur",function(e){s.setFocused(!1),a()}),t.$on("$destroy",function(){s.setFocused(!1),s.setHasValue(!1),s.input=null})}}return{restrict:"E",require:["^?mdInputContainer","?ngModel"],link:r}}function i(e){function t(t,n,i,r){function o(e){return l.text((n.val()||e||"").length+"/"+a),e}var a,s=r[0],c=r[1],l=angular.element('<div class="md-char-counter">');i.$set("ngTrim","false"),c.element.append(l),s.$formatters.push(o),s.$viewChangeListeners.push(o),n.on("input keydown",function(){o()}),t.$watch(i.mdMaxlength,function(t){a=t,angular.isNumber(t)&&t>0?(l.parent().length||e.enter(l,c.element,angular.element(c.element[0].lastElementChild)),o()):e.leave(l)}),s.$validators["md-maxlength"]=function(e,t){return!angular.isNumber(a)||0>a?!0:(e||n.val()||t||"").length<=a}}return{restrict:"A",require:["ngModel","^mdInputContainer"],link:t}}function r(){function e(e,t,n,i){if(i&&!t[0].hasAttribute("native-placeholder")){var r=n.placeholder;t.removeAttr("placeholder"),i.element.append('<div class="md-placeholder">'+r+"</div>")}}return{restrict:"A",require:"^^?mdInputContainer",link:e}}angular.module("material.components.input",["material.core"]).directive("mdInputContainer",e).directive("label",t).directive("input",n).directive("textarea",n).directive("mdMaxlength",i).directive("placeholder",r),e.$inject=["$parse"],n.$inject=["$mdUtil","$window","$compile","$animate"],i.$inject=["$animate"]}(),function(){"use strict";function e(e,t){function n(n,i,r,o){function a(n){switch(n.keyCode){case t.KEY_CODE.LEFT_ARROW:case t.KEY_CODE.UP_ARROW:n.preventDefault(),s.selectPrevious();break;case t.KEY_CODE.RIGHT_ARROW:case t.KEY_CODE.DOWN_ARROW:n.preventDefault(),s.selectNext();break;case t.KEY_CODE.ENTER:var r=angular.element(e.getClosest(i[0],"form"));r.length>0&&r.triggerHandler("submit")}}var s=o[0],c=o[1]||e.fakeNgModel();s.init(c),i.attr({role:"radiogroup",tabIndex:i.attr("tabindex")||"0"}).on("keydown",a)}function i(e){this._radioButtonRenderFns=[],this.$element=e}function r(){return{init:function(e){this._ngModelCtrl=e,this._ngModelCtrl.$render=angular.bind(this,this.render)},add:function(e){this._radioButtonRenderFns.push(e)},remove:function(e){var t=this._radioButtonRenderFns.indexOf(e);-1!==t&&this._radioButtonRenderFns.splice(t,1)},render:function(){this._radioButtonRenderFns.forEach(function(e){e()})},setViewValue:function(e,t){this._ngModelCtrl.$setViewValue(e,t),this.render()},getViewValue:function(){return this._ngModelCtrl.$viewValue},selectNext:function(){return o(this.$element,1)},selectPrevious:function(){return o(this.$element,-1)},setActiveDescendant:function(e){this.$element.attr("aria-activedescendant",e)}}}function o(t,n){var i=e.iterator(Array.prototype.slice.call(t[0].querySelectorAll("md-radio-button")),!0);if(i.count()){var r=function(e){return!angular.element(e).attr("disabled")},o=t[0].querySelector("md-radio-button.md-checked"),a=i[0>n?"previous":"next"](o,r)||i.first();angular.element(a).triggerHandler("click")}}return i.prototype=r(),{restrict:"E",controller:["$element",i],require:["mdRadioGroup","?ngModel"],link:{pre:n}}}function t(e,t){function n(n,r,o,a){function s(e){r[0].hasAttribute("disabled")||n.$apply(function(){a.setViewValue(o.value,e&&e.type)})}function c(){var e=a.getViewValue()==o.value;e!==u&&(u=e,r.attr("aria-checked",e),e?(r.addClass(i),a.setActiveDescendant(r.attr("id"))):r.removeClass(i))}function l(n,i){function r(){return o.id||"radio_"+t.nextUid()}i.ariaId=r(),n.attr({id:i.ariaId,role:"radio","aria-checked":"false"}),e.expectWithText(n,"aria-label")}var u;l(r,n),a.add(c),o.$observe("value",c),r.on("click",s).on("$destroy",function(){a.remove(c)})}var i="md-checked";return{restrict:"E",require:"^mdRadioGroup",transclude:!0,template:'<div class="md-container list-primary-tile"><div class="avatar-small"><div><icon class="button-square" type="radio_button_checked"></icon><icon class="button-square" type="radio_button_unchecked"></icon></div></div></div><div ng-transclude class="md-label"></div>',link:n}}angular.module("material.components.radioButton",["material.core"]).directive("mdRadioGroup",e).directive("mdRadioButton",t),e.$inject=["$mdUtil","$mdConstant"],t.$inject=["$mdAria","$mdUtil"]}(),function(){"use strict";function e(e,t){return function(n){var i="SideNav '"+n+"' is not available!",r=e.get(n);return r||e.notFoundError(n),{isOpen:function(){return r&&r.isOpen()},isLockedOpen:function(){return r&&r.isLockedOpen()},toggle:function(){return r?r.toggle():t.reject(i)},open:function(){return r?r.open():t.reject(i)},close:function(){return r?r.close():t.reject(i)}}}}function t(e,t,n,i,r,o,a,s,c){function l(r,l,u,d){function p(e,n){r.isLockedOpen=e,e===n?l.toggleClass("md-locked-open",!!e):t[e?"addClass":"removeClass"](l,"md-locked-open"),S.toggleClass("md-locked-open",!!e)}function f(n){if(w)return void(w=!1);var i=(l.parent(),[]);S[n?"on":"off"]("click",function(t){var n=this;e(function(){h.apply(n,t)})}),c[n?"queue":"dequeue"](m),n&&(v=s[0].activeElement),l.before(S);var o=function(){r.isOpen&&l.focus(),b=!1,r.stateChanged&&r.stateChanged(r.isOpen)},u=function(){r.isOpen||S.remove()};return n?(l.removeClass("invisible out"),S.removeClass("out"),i.push(t.addClass(S,"in").then(u)),i.push(t.addClass(l,"in").then(o))):(l.removeClass("in"),S.removeClass("in"),i.push(t.addClass(S,"out").then(u)),i.push(t.addClass(l,"out").then(o))),y=a.all(i)}function g(t){if(r.isOpen==t||b)return a.when(!0);b=!0;var n=a.defer();return r.isOpen=t,e(function(){y.then(function(e){r.isOpen||(v&&v.focus(),v=null),t&&A(),n.resolve(e)})},0,!1),n.promise}function m(t){return e(function(){h(t)}),!0}function h(e){return e&&(e.preventDefault(),e.stopPropagation()),d.close()}var v=null,y=a.when(!0),b=!1,w=!r.isOpen,k=n(u.mdIsLockedOpen),C=function(){return k(r.$parent,{$media:i})},S=o('<md-backdrop class="md-sidenav-backdrop md-opaque fade">')(r);l.on("$destroy",d.destroy);var x=l.css("width"),A=function(){var e=$(window).width()-56;return e>x?void l.css({width:"","min-width":""}):void(l.width()>e&&l.css({width:e,"min-width":e}))};A(),A=_.throttle(A,100),$(window).bind("resize",A),r.$watch(C,p),r.$watch("isOpen",f),r.$on("$destroy",function(){$(window).off("resize",A)}),d.$toggleOpen=g}return{restrict:"E",scope:{isOpen:"=?mdIsOpen",componentID:"=?mdComponentId",stateChanged:"=?mdStateChanged"},controller:"$mdSidenavController",compile:function(e){return e.addClass("md-closed slide drawer out invisible"),e.attr("tabIndex","-1"),l}}}function n(e,t,n,i,r,o){var a=this;a.$toggleOpen=function(){return r.when(e.isOpen)},a.isOpen=function(){return!!e.isOpen},a.isLockedOpen=function(){return!!e.isLockedOpen},a.open=function(){return a.$toggleOpen(!0)},a.close=function(){return a.$toggleOpen(!1)},a.toggle=function(){return a.$toggleOpen(!e.isOpen)},a.destroy=i.register(a,e.componentID||n.mdComponentId)}angular.module("material.components.sidenav",["material.core"]).factory("$mdSidenav",e).directive("mdSidenav",t).controller("$mdSidenavController",n).run(["helpers","$mdSidenav","$timeout","$q",function(e,t,n,i){e.sideNav||(e.sideNav={}),e.sideNav.setup=function(e,r,o){o||(o=[]),r+=_.uniqueId(),e.id=r,e.notRipplable=o,e.toggling=!1,e.close=function(){return e.toggle(void 0,"close")},e.open=function(){return e.toggle(void 0,"open")},e.toggle=function(r,o){var a,s=t(e.id),c=!1,l=i.defer(),u=l.promise;return e.toggling?(l.resolve(),u):r&&r.target&&(a=$(r.target),angular.forEach(e.notRipplable,function(e){(a.is(e)||a.parent().is(e))&&(c=!0)}),c)?(l.resolve(),u):(e.toggling=!0,n(function(){s[o||(s.isOpen()?"close":"open")]().then(function(){e.toggling=!1,l.resolve()})}),u)}}}]),e.$inject=["$mdComponentRegistry","$q"],t.$inject=["$timeout","$animate","$parse","$mdMedia","$mdConstant","$compile","$q","$document","mdContextualMonitor"],n.$inject=["$scope","$element","$attrs","$mdComponentRegistry","$q","$parse"]}(),function(){"use strict";function e(e,t){var n=[],i=!1,r=1,o=function(){return r+=1},a=function(){!n.length&&window.location.hash.length&&(window.location.hash="",r=1)},s=function(e){var t=n.pop(),i=t&&t(e);return!i&&t&&n.push(t),a(),i};return{dequeue:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),a()},queue:function(r){if(!window.isChromeApp){var a="context-monitor-",c=window.location.hash,l=o();i||(e.on("keyup",function(e){e.keyCode===t.KEY_CODE.ESCAPE&&(s(e)||e.preventDefault())}),$(window).bind("hashchange",function(e){var t,n=window.location.hash,i=parseInt(n.substr(a.length+1),10),r=parseInt(c.substr(a.length+1),10);(isNaN(i)||!isNaN(r)&&r>i)&&(t=!0),c=n,t&&(s()||e.preventDefault())}),i=!0),window.location.hash=a+l,n.push(r)}}}}function t(e){return{restrict:"E"}}function n(e){function t(e,t,n,i,r,o,a,s,c,l,u,d){function p(e){return"simple-dialog"}function f(e,t){}function g(t,n,r){function o(){var e=n[0].querySelector(".dialog-close");if(!e){var t=n[0].querySelectorAll(".md-actions button");e=t[t.length-1]}return angular.element(e)}r.parent=angular.element(r.parent),r.popInTarget=angular.element(r.popFrom);var a=o(),s=p(r),c=n.find(s);return h(c),r.disableScrollInfo=[],r.disableScroll||(r.disableScroll=[]),r.disableParentScroll&&r.disableScroll.push(r.parent),angular.forEach(r.disableScroll,function(e){r.disableScrollInfo.push({old:{"overflow-y":e.css("overflow-y"),"overflow-x":e.css("overflow-x")},element:e}),e.css("overflow","hidden"),e.css("overflow-wrap","normal"===e.css("overflow-wrap")?"break-word":"normal")}),r.hasBackdrop&&(r.backdrop=angular.element('<md-backdrop class="simple-dialog-backdrop" style="z-index: '+r.zIndex+'">'),i.enter(r.backdrop,r.parent)),c.css("z-index",r.zIndex+1),v(n,r).then(function(){r.rootElementKeyupCallback=function(){return 0===r.stack.indexOf(r.interimElement)&&e(function(){u.cancel("esc",r.interimElement)}),!0},d.queue(r.rootElementKeyupCallback),r.clickOutsideToClose&&(r.dialogClickOutsideCallback=function(t){t.target===r.backdrop[0]&&e(u.cancel)},r.backdrop.on("click",r.dialogClickOutsideCallback)),a.focus()})}function m(e,t,n){return n.clickOutsideToClose&&n.backdrop&&n.backdrop.off("click",n.dialogClickOutsideCallback),n.backdrop&&i.leave(n.backdrop),angular.forEach(n.disableScrollInfo,function(e){e.element.css(e.old),e.element.css("overflow-wrap","normal"===e.element.css("overflow-wrap")?"break-word":"normal")}),n.disableScrollInfo=[],o[0].removeEventListener("scroll",n.captureScroll,!0),d.dequeue(n.rootElementKeyupCallback),$(t,n).then(function(){n.scope.$destroy(),t.remove(),n.popInTarget&&n.popInTarget.focus()})}function h(e){e.attr({role:"dialog"});var t=e.find("md-content");0===t.length&&(t=e),r.expectAsync(e,"aria-label",function(){var e=t.text().split(/\s+/);return e.length>3&&(e=e.slice(0,3).concat("...")),e.join(" ")})}function v(e,t){f(e,t);var n,i,r=e.find(p(t)),o=t.parent,a=l.defer();return o.append(e),n=a.promise,i=n.then(function(){var e,n=l.defer(),i=n.promise;return t.onBeforeShow&&(e=t.onBeforeShow(r,t),e&&e.then)?e:(n.resolve(),i)}),a.resolve(),i}function y(e){function t(i){i.target===e[0]&&(e.off(s.CSS.TRANSITIONEND,t),n.resolve())}var n=l.defer();return e.on(s.CSS.TRANSITIONEND,t),n.promise}function $(e,t){f(e,t);var n,i,r=e.find(p(t));return t.onBeforeHide&&t.onBeforeHide(r,t),r.hasClass("fade")?(i=l.defer(),r.oneAnimationEnd(function(){i.resolve()}),r.removeClass("in").addClass("out"),n=i.promise):(n=y(r),n.then(function(){t.onAfterHide&&t.onAfterHide(r,t)}),r.removeClass("transition-in").addClass("transition-out"),setTimeout(function(){r.addClass("opacity-out")},50)),n}return{hasBackdrop:!0,isolateScope:!0,onShow:g,onRemove:m,clickOutsideToClose:!0,popFrom:null,disableParentScroll:!0,transformTemplate:function(e){return'<div class="simple-dialog-container">'+e+"</div>"}}}return t.$inject=["$timeout","$rootElement","$compile","$animate","$mdAria","$document","$mdUtil","$mdConstant","$$rAF","$q","$simpleDialog","mdContextualMonitor"],e("$simpleDialog").setDefaults({methods:["disableParentScroll","hasBackdrop","clickOutsideToClose","popFrom"],options:t})}angular.module("material.components.simpledialog",["material.core"]).factory("mdContextualMonitor",e).directive("simpleDialog",t).provider("$simpleDialog",n),e.$inject=["$rootElement","$mdConstant"],t.$inject=["$$rAF"],n.$inject=["$$interimElementProvider"]}(),function(){"use strict";var e=angular.module("material.components.swipe",[]);["SwipeLeft","SwipeRight"].forEach(function(t){var n="md"+t,i="$md."+t.toLowerCase();e.directive(n,["$parse",function(e){function t(t,r,o){var a=e(o[n]);r.on(i,function(e){t.$apply(function(){a(t,{$event:e})})})}return{restrict:"A",link:t}}])})}(),function(){"use strict";function e(e,t,n){return{restrict:"E",replace:!0,scope:{fid:"@?mdFid",label:"@?",value:"=ngModel"},compile:function(i,r){return n.warn("<md-text-float> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer"),angular.isUndefined(r.mdFid)&&(r.mdFid=e.nextUid()),{pre:function(e,n,i){var r=t(i.ngDisabled);e.isDisabled=function(){return r(e.$parent)},e.inputType=i.type||"text"}}},template:'<md-input-group tabindex="-1"> <label for="{{fid}}" >{{label}}</label> <md-input id="{{fid}}" ng-disabled="isDisabled()" ng-model="value" type="{{inputType}}"></md-input></md-input-group>'}}function t(e){return{restrict:"CE",controller:["$element",function(t){e.warn("<md-input-group> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer"),this.setFocused=function(e){t.toggleClass("md-input-focused",!!e)},this.setHasValue=function(e){t.toggleClass("md-input-has-value",e)}}]}}function n(e,t){return{restrict:"E",replace:!0,template:"<input >",require:["^?mdInputGroup","?ngModel"],link:function(e,n,i,r){function o(e){return e=angular.isUndefined(e)?n.val():e,angular.isDefined(e)&&null!==e&&""!==e.toString().trim()}if(r[0]){t.warn("<md-input> is deprecated. Please use `<md-input-container>` and `<input>`.More information at http://material.angularjs.org/#/api/material.components.input/directive/mdInputContainer");var a=r[0],s=r[1];e.$watch(e.isDisabled,function(e){n.attr("aria-disabled",!!e),n.attr("tabindex",!!e)}),n.attr("type",i.type||n.parent().attr("type")||"text"),s&&s.$formatters.push(function(e){return a.setHasValue(o(e)),e}),n.on("input",function(){a.setHasValue(o())}).on("focus",function(e){a.setFocused(!0)}).on("blur",function(e){a.setFocused(!1),a.setHasValue(o())}),e.$on("$destroy",function(){a.setFocused(!1),a.setHasValue(!1)})}}}}angular.module("material.components.textField",["material.core"]).directive("mdInputGroup",t).directive("mdInput",n).directive("mdTextFloat",e),e.$inject=["$mdUtil","$parse","$log"],t.$inject=["$log"],n.$inject=["$mdUtil","$log"]}(),function(){"use strict";angular.module("app").factory("snackbar",["GLOBAL_CONFIG",function(e){var t={show:$.noop,hide:$.noop,showK:function(n,i){var r=e.snackbar.messages[n];return angular.isUndefined(r)&&(r=n),t.show($.extend({message:r},i))}};return e.debug&&(window._snackbar=t),t}]).directive("qsnackbar",["snackbar",function(e){return{link:function(t,n){var i=function(){e.hide()};n.on("click",i),t.$on("$destroy",function(){n.off("click",i)})}}}]).directive("ngClick",["snackbar",function(e){return{restrict:"A",priority:100,link:function(t,n,i){var r=function(){e.animating||e.hide()};n.on("click",r),t.$on("$destroy",function(){n.off("click",r)})}}}]).directive("snackbar",["snackbar","$timeout","$animate","$q",function(e,t,n,i){return{scope:!0,require:"snackbar",templateUrl:"core/snackbar/view.html",controller:["$scope",function(t){var r,o=function(){t.$$phase||t.$digest()};t.message="",t.size=1,t.element=null,e.animating=!1,e.hide=function(){var e=i.defer();return n.removeClass(t.element,"in"),t.element.hasClass("out")?e.resolve():(n.addClass(t.element,"out").then(function(){e.resolve()}),o()),e.promise},e.show=function(i){return angular.isObject(i)||(i={message:i}),t.message=i.message,i.hideAfter||(i.hideAfter=t.message.length/16*2e3+500),t.size=i.size,t.calculateSize=function(){return t.size?t.size:t.element.find(".brief").height()>16?2:1},o(),e.animating=!0,e.hide().then(function(){return n.removeClass(t.element,"out"),n.addClass(t.element,"in").then(function(){e.animating=!1,i.hideAfter&&(r&&clearTimeout(r),r=setTimeout(function(){e.hide()},i.hideAfter))})})}}],link:function(e,t,n){e.element=t.find(".snackbar")}}}])}(),function(){"use strict";function e(e,t,n){return{restrict:"E",controller:angular.noop,link:function(i,r,o){function a(){function a(t,n){r.parent()[0]===n.parent()[0]&&(u&&u.off("scroll",g),n.on("scroll",g),n.attr("scroll-shrink","true"),u=n,e(s))}function s(){l=r.prop("offsetHeight"),u.css("margin-top",-l*f+"px"),c()}function c(e){var n=e?e.target.scrollTop:p;m(),d=Math.min(l/f,Math.max(0,d+n-p)),r.css(t.CSS.TRANSFORM,"translate3d(0,"+-d*f+"px,0)"),u.css(t.CSS.TRANSFORM,"translate3d(0,"+(l-d)*f+"px,0)"),p=n}var l,u,d=0,p=0,f=o.mdShrinkSpeedFactor||.5,g=e.throttle(c),m=n.debounce(s,5e3);i.$on("$mdContentLoaded",a)}angular.isDefined(o.mdScrollShrink)&&a()}}}angular.module("material.components.toolbar",["material.core","material.components.content"]).directive("mdToolbar",e).run(["helpers","GLOBAL_CONFIG",function(e,t){angular.isUndefined(e.toolbar)&&(e.toolbar={}),$.extend(e.toolbar,{title:function(e,n){var i,r=t.toolbar.titles,o=[],a=r[e];return n||(n=" / "),angular.isDefined(a)?angular.isArray(a)?a.join(n):a:(i=angular.isArray(e)?e:e.split("."),angular.forEach(i,function(e,t){var n=r[e];n!==!1&&o.push(angular.isDefined(n)?n:e)}),o.length?o.join(n):e)},buildTitle:function(t){var n=[];return angular.forEach(t,function(e){n.push(e())}),e.toolbar.title(n.join("."))},makeTitle:function(e){return _.string.capitalize(_.string.camelize(e))}})}]),e.$inject=["$$rAF","$mdConstant","$mdUtil"]}(),function(){"use strict";angular.module("app").directive("actionDropdownList",function(){return{templateUrl:"core/action/dropdown_list.html",transclude:!0,replace:!0}}).directive("actionDropdown",["$simpleDialog","$$rAF","$mdConstant","underscoreTemplate","$timeout","$parse","$q","helpers",function(e,t,n,i,r,o,a,s){return{replace:!0,transclude:!0,templateUrl:"core/action/dropdown.html",scope:!0,link:function(n,i,o){var s={},c=n.$eval(o.template);c&&(s.opened=!1,s.open=function(e){s.opened||(s.opened=!0,r(function(){s.openSimpleDialog(e)}))},s.openSimpleDialog=function(r){e.show({templateUrl:c,popFrom:r.target,parent:i.parents(o.parent),onBeforeHide:function(e,t){$(window).off("resize",t.resize)},onBeforeShow:function(e,n){var r=a.defer(),c=r.promise,l=function(){var a=i;return n.resize=function(){var t=a.offset(),i=n.parent,r=parseInt(i.css("padding-top"),10)||24,s=parseInt(i.css("padding-bottom"),10)||24,c=t.top,l=t.left-(e.width()-a.outerWidth())-12,u=i.height()-(s+r),d=i.width()-e.width()-16;c=t.top,16>c&&(c=16),16>l&&(l=16),l>d&&(l=d),o.fixedPosition?"toolbar"===o.fixedPosition&&e.css({top:"8px",left:"auto",right:"8px"}):e.css({top:c,left:l}),e.height()>u&&e.height(u)},n.resize(),$(window).on("resize",n.resize),t(function(){e.addClass("fade in")}),e.oneAnimationEnd(function(){i.addClass("opacity-in"),r.resolve()}),c};t(l),e.on("click",s.close)},controller:["$scope",function(e){e.parent=n,e.$on("$destroy",function(){s.opened=!1})}]})},s.close=function(){e.hide()},n.dropdown=s)}}}]).directive("actionToolbar",function(){return{transclude:!0,replace:!0,scope:!0,templateUrl:"core/action/toolbar.html",link:function(e,t,n){e.spec=e.$eval(n.spec),e.$on("modalStateComplete",function(){e.spec=e.$eval(n.spec)})}}})}(),function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){function i(e,t,n){for(var i=e[n],r=t(i);n>0;){var o=Math.floor((n+1)/2)-1,a=e[o];if(r>=t(a))break;e[o]=i,e[n]=a,n=o}}function r(e,t,n){for(var i=e.length,r=e[n],o=t(r);;){var a=2*(n+1),s=a-1,c=null;if(i>s){var l=e[s],u=t(l);o>u&&(c=s)}if(i>a){var d=e[a],p=t(d);p<(null===c?o:t(e[s]))&&(c=a)}if(null===c)break;e[n]=e[c],e[c]=r,n=c}}function o(e){if(e&&!angular.isFunction(e))throw new Error("DSBinaryHeap(weightFunc): weightFunc: must be a function!");e=e||function(e){return e},this.weightFunc=e,this.heap=[]}function a(){this.$get=function(){return o}}o.prototype.push=function(e){this.heap.push(e),i(this.heap,this.weightFunc,this.heap.length-1)},o.prototype.peek=function(){return this.heap[0]},o.prototype.pop=function(){var e=this.heap[0],t=this.heap.pop();return this.heap.length>0&&(this.heap[0]=t,r(this.heap,this.weightFunc,0)),e},o.prototype.remove=function(e){for(var t=this.heap.length,n=0;t>n;n++)if(angular.equals(this.heap[n],e)){var o=this.heap[n],a=this.heap.pop();return n!==t-1&&(this.heap[n]=a,i(this.heap,this.weightFunc,n),r(this.heap,this.weightFunc,n)),o}return null},o.prototype.removeAll=function(){this.heap=[]},o.prototype.size=function(){return this.heap.length},t.exports={DSBinaryHeapProvider:a,DSBinaryHeap:o}},{}],2:[function(e,t,n){t.exports=function(){clearInterval(this.$$cacheFlushIntervalId),clearInterval(this.$$recycleFreqId),this.removeAll(),this.$$storage&&(this.$$storage.removeItem(this.$$prefix+".keys"),this.$$storage.removeItem(this.$$prefix)),this.$$storage=null,this.$$data=null,this.$$lruHeap=null,this.$$expiresHeap=null,this.$$prefix=null}},{}],3:[function(e,t,n){var i=e("../utils");t.exports=function(e,t){var n=this;if(angular.isArray(e)){var r=e,o=[];return angular.forEach(r,function(e){var i=n.get(e,t);null!==i&&void 0!==i&&o.push(i)}),o}if(e=i.stringifyNumber(e),!this.$$disabled){if(t=t||{},!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof e);if(t&&!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof t);if(t.onExpire&&!angular.isFunction(t.onExpire))throw angular.$$minErr("ng")("areq","Expected options.onExpire to be a function! Found: {0}.",typeof t.onExpire);var a;if(this.$$storage){var s=this.$$storage.getItem(this.$$prefix+".data."+e);if(!s)return;a=angular.fromJson(s)}else{if(!(e in this.$$data))return;a=this.$$data[e]}var c=a.value,l=(new Date).getTime();return this.$$storage?(this.$$lruHeap.remove({key:e,accessed:a.accessed}),a.accessed=l,this.$$lruHeap.push({key:e,accessed:l})):(this.$$lruHeap.remove(a),a.accessed=l,this.$$lruHeap.push(a)),"passive"===this.$$deleteOnExpire&&"expires"in a&&a.expires<l?(this.remove(e),this.$$onExpire?this.$$onExpire(e,a.value,t.onExpire):t.onExpire&&t.onExpire(e,a.value),c=void 0):this.$$storage&&this.$$storage.setItem(this.$$prefix+".data."+e,a),c}}},{"../utils":21}],4:[function(e,t,n){function i(e,t){if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected storageMode to be a string! Found: {0}.",typeof e);if("memory"!==e&&"localStorage"!==e&&"sessionStorage"!==e)throw angular.$$minErr("ng")("areq",'Expected storageMode to be "memory", "localStorage" or "sessionStorage"! Found: {0}.',e);var n=window.getLocalStorage();if(this.$$storageMode=e,t){if(!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected storageImpl to be an object! Found: {0}.",typeof t);if(!("setItem"in t&&"function"==typeof t.setItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "setItem(key, value)"! Found: {0}.',typeof t.setItem);if(!("getItem"in t&&"function"==typeof t.getItem))throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "getItem(key)"! Found: {0}.',typeof t.getItem);if(!("removeItem"in t)||"function"!=typeof t.removeItem)throw angular.$$minErr("ng")("areq",'Expected storageImpl to implement "removeItem(key)"! Found: {0}.',typeof t.removeItem);this.$$storage=t}else if("localStorage"===this.$$storageMode)try{n.setItem("angular-cache","angular-cache"),n.removeItem("angular-cache"),this.$$storage=n}catch(i){delete this.$$storage,this.$$storageMode="memory"}else if("sessionStorage"===this.$$storageMode)try{sessionStorage.setItem("angular-cache","angular-cache"),sessionStorage.removeItem("angular-cache"),this.$$storage=sessionStorage}catch(i){delete this.$$storage,this.$$storageMode="memory"}}function r(e,t){if(e=e||{},t=!!t,!angular.isObject(e))throw angular.$$minErr("ng")("areq","Expected cacheOptions to be an object! Found: {0}.",typeof e);"disabled"in e?this.$$disabled=!!e.disabled:t&&delete this.$$disabled,"capacity"in e?this.setCapacity(e.capacity):t&&this.setCapacity(null),"deleteOnExpire"in e?this.setDeleteOnExpire(e.deleteOnExpire):t&&this.setDeleteOnExpire(null),"maxAge"in e?this.setMaxAge(e.maxAge):t&&this.setMaxAge(null),"recycleFreq"in e?this.setRecycleFreq(e.recycleFreq):t&&this.setRecycleFreq(null),"cacheFlushInterval"in e?this.setCacheFlushInterval(e.cacheFlushInterval):t&&this.setCacheFlushInterval(null),"onExpire"in e?this.setOnExpire(e.onExpire):t&&this.setOnExpire(null)}function o(e,t){this.$$data={},this.$$id=e,this.$$storage=null,this.$$expiresHeap=new s(function(e){return e.expires}),this.$$lruHeap=new s(function(e){return e.accessed}),t=t||{},"storageMode"in t&&i.apply(this,[t.storageMode,t.storageImpl]),"storagePrefix"in t&&(this.$$storagePrefix=t.storagePrefix),this.$$prefix=this.$$storagePrefix+e,r.apply(this,[t,!0])}var a=e("../defaults"),s=e("../DSBinaryHeap").DSBinaryHeap;for(var c in a.defaults)o.prototype["$$"+c]=a.defaults[c];o.prototype.setOptions=r,o.prototype.setCapacity=e("./setCapacity"),o.prototype.setDeleteOnExpire=e("./setDeleteOnExpire"),o.prototype.setMaxAge=e("./setMaxAge"),o.prototype.setRecycleFreq=e("./setRecycleFreq"),o.prototype.setCacheFlushInterval=e("./setCacheFlushInterval"),o.prototype.setOnExpire=e("./setOnExpire"),o.prototype.put=e("./put"),o.prototype.get=e("./get"),o.prototype.remove=e("./remove"),o.prototype.removeAll=e("./removeAll"),o.prototype.removeExpired=e("./removeExpired"),o.prototype.destroy=e("./destroy"),o.prototype.info=e("./info"),o.prototype.keySet=e("./keySet"),o.prototype.keys=e("./keys"),o.prototype.disable=function(){this.$$disabled=!0},o.prototype.enable=function(){delete this.$$disabled},o.prototype.touch=function(e){if(e){var t=this,n=this.get(e,{onExpire:function(e,n){t.put(e,n)}});n&&this.put(e,n)}else for(var i=this.keys(),r=0;r<i.length;r++)this.touch(i[r])},t.exports=o},{"../DSBinaryHeap":1,"../defaults":19,"./destroy":2,"./get":3,"./info":5,"./keySet":6,"./keys":7,"./put":8,"./remove":9,"./removeAll":10,"./removeExpired":11,"./setCacheFlushInterval":12,"./setCapacity":13,"./setDeleteOnExpire":14,"./setMaxAge":15,"./setOnExpire":16,"./setRecycleFreq":17}],5:[function(e,t,n){t.exports=function(e){if(e){var t;if(this.$$storage){var n=this.$$storage.getItem(this.$$prefix+".data."+e);return n?(t=angular.fromJson(n),{created:t.created,accessed:t.accessed,expires:t.expires,isExpired:(new Date).getTime()-t.created>this.$$maxAge}):void 0}return e in this.$$data?(t=this.$$data[e],{created:t.created,accessed:t.accessed,expires:t.expires,isExpired:(new Date).getTime()-t.created>this.$$maxAge}):void 0}return{id:this.$$id,capacity:this.$$capacity,maxAge:this.$$maxAge,deleteOnExpire:this.$$deleteOnExpire,onExpire:this.$$onExpire,cacheFlushInterval:this.$$cacheFlushInterval,recycleFreq:this.$$recycleFreq,storageMode:this.$$storageMode,storageImpl:this.$$storage,disabled:this.$$disabled,size:this.$$lruHeap&&this.$$lruHeap.size()||0}}},{}],6:[function(e,t,n){var i=e("../utils");t.exports=function(){if(this.$$storage){var e=this.$$storage.getItem(this.$$prefix+".keys"),t={};if(e)for(var n=angular.fromJson(e),r=0;r<n.length;r++)t[n[r]]=n[r];return t}return i.keySet(this.$$data)}},{"../utils":21}],7:[function(e,t,n){var i=e("../utils");t.exports=function(){if(this.$$storage){var e=this.$$storage.getItem(this.$$prefix+".keys");return e?angular.fromJson(e):[]}return i.keys(this.$$data)}},{"../utils":21}],8:[function(e,t,n){var i=e("../utils");t.exports=function(e,t){var n=this;if(!this.$$disabled&&null!==t&&void 0!==t){if(t&&t.then,!1)return void t.then(function(t){angular.isObject(t)&&"status"in t&&"data"in t?n.put(e,[t.status,t.data,t.headers(),t.statusText]):n.put(e,t)});if(e=i.stringifyNumber(e),!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected key to be a string! Found: {0}.",typeof e);var r=(new Date).getTime(),o={key:e,value:t,created:r,accessed:r};if(o.expires=o.created+this.$$maxAge,this.$$storage){var a=this.$$storage.getItem(this.$$prefix+".keys"),s=a?angular.fromJson(a):[],c=this.$$storage.getItem(this.$$prefix+".data."+e);c&&this.remove(e),this.$$expiresHeap.push({key:e,expires:o.expires}),this.$$lruHeap.push({key:e,accessed:o.accessed}),this.$$storage.setItem(this.$$prefix+".data."+e,o);for(var l=!1,u=0;u<s.length;u++)if(s[u]===e){l=!0;break}l||s.push(e),this.$$storage.setItem(this.$$prefix+".keys",s)}else this.$$data[e]&&this.remove(e),this.$$expiresHeap.push(o),this.$$lruHeap.push(o),this.$$data[e]=o;return this.$$lruHeap.size()>this.$$capacity&&this.remove(this.$$lruHeap.peek().key),t}}},{"../utils":21}],9:[function(e,t,n){t.exports=function(e){if(!this.$$storage){var t=this.$$data[e]?this.$$data[e].value:void 0;return this.$$lruHeap.remove(this.$$data[e]),this.$$expiresHeap.remove(this.$$data[e]),this.$$data[e]=null,delete this.$$data[e],t}var n=this.$$storage.getItem(this.$$prefix+".data."+e);if(n){var i=angular.fromJson(n);this.$$lruHeap.remove({key:e,accessed:i.accessed}),this.$$expiresHeap.remove({key:e,expires:i.expires}),this.$$storage.removeItem(this.$$prefix+".data."+e);var r=this.$$storage.getItem(this.$$prefix+".keys"),o=r?angular.fromJson(r):[],a=o.indexOf(e);return a>=0&&o.splice(a,1),this.$$storage.setItem(this.$$prefix+".keys",o),i.value}}},{}],10:[function(e,t,n){t.exports=function(){if(this.$$storage){this.$$lruHeap.removeAll(),this.$$expiresHeap.removeAll();var e=this.$$storage.getItem(this.$$prefix+".keys");if(e)for(var t=angular.fromJson(e),n=0;n<t.length;n++)this.remove(t[n]);this.$$storage.setItem(this.$$prefix+".keys",[])}else{this.$$lruHeap.removeAll(),this.$$expiresHeap.removeAll();for(var i in this.$$data)this.$$data[i]=null;this.$$data={}}}},{}],11:[function(e,t,n){t.exports=function(){for(var e,t,n=(new Date).getTime(),i={};(t=this.$$expiresHeap.peek())&&t.expires<n;)i[t.key]=t.value?t.value:null,
this.$$expiresHeap.pop();if(this.$$storage)for(e in i){var r=this.$$storage.getItem(this.$$prefix+".data."+e);r&&(i[e]=angular.fromJson(r).value,this.remove(e))}else for(e in i)this.remove(e);if(this.$$onExpire)for(e in i)this.$$onExpire(e,i[e]);return i}},{}],12:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$cacheFlushInterval;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected cacheFlushInterval to be greater than zero! Found: {0}.",e);e!==this.$$cacheFlushInterval&&(this.$$cacheFlushInterval=e,clearInterval(this.$$cacheFlushIntervalId),function(e){e.$$cacheFlushIntervalId=setInterval(function(){e.removeAll()},e.$$cacheFlushInterval)}(this))}}},{}],13:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$capacity;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected capacity to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected capacity to be greater than zero! Found: {0}.",e);this.$$capacity=e}for(var t={};this.$$lruHeap.size()>this.$$capacity;)t[this.$$lruHeap.peek().key]=this.remove(this.$$lruHeap.peek().key);return t}},{}],14:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$deleteOnExpire;else{if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected deleteOnExpire to be a string! Found: {0}.",typeof e);if("none"!==e&&"passive"!==e&&"aggressive"!==e)throw angular.$$minErr("ng")("areq",'Expected deleteOnExpire to be "none", "passive" or "aggressive"! Found: {0}.',e);this.$$deleteOnExpire=e}this.setRecycleFreq(this.$$recycleFreq)}},{}],15:[function(e,t,n){var i=e("../utils");t.exports=function(e){if(null===e)delete this.$$maxAge;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected maxAge to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected maxAge to be greater than zero! Found: {0}.",e);this.$$maxAge=e}var t,n,r;if(this.$$expiresHeap.removeAll(),this.$$storage){var o=this.$$storage.getItem(this.$$prefix+".keys");for(n=o?angular.fromJson(o):[],t=0;t<n.length;t++){r=n[t];var a=this.$$storage.getItem(this.$$prefix+".data."+r);if(a){var s=angular.fromJson(a);s.expires=this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:s.created+this.$$maxAge,this.$$expiresHeap.push({key:r,expires:s.expires})}}}else for(n=i.keys(this.$$data),t=0;t<n.length;t++)r=n[t],this.$$data[r].expires=this.$$maxAge===Number.MAX_VALUE?Number.MAX_VALUE:this.$$data[r].created+this.$$maxAge,this.$$expiresHeap.push(this.$$data[r]);return"aggressive"===this.$$deleteOnExpire?this.removeExpired():{}}},{"../utils":21}],16:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$onExpire;else{if(!angular.isFunction(e))throw angular.$$minErr("ng")("areq","Expected onExpire to be a function! Found: {0}.",typeof e);this.$$onExpire=e}}},{}],17:[function(e,t,n){t.exports=function(e){if(null===e)delete this.$$recycleFreq;else{if(!angular.isNumber(e))throw angular.$$minErr("ng")("areq","Expected recycleFreq to be a number! Found: {0}.",typeof e);if(0>e)throw angular.$$minErr("ng")("areq","Expected recycleFreq to be greater than zero! Found: {0}.",e);this.$$recycleFreq=e}clearInterval(this.$$recycleFreqId),"aggressive"===this.$$deleteOnExpire?!function(e){e.$$recycleFreqId=setInterval(function(){e.removeExpired()},e.$$recycleFreq)}(this):delete this.$$recycleFreqId}},{}],18:[function(e,t,n){function i(){var e=new r.Config;this.version=a,this.setCacheDefaults=function(t){if(t=t||{},!angular.isObject(t))throw angular.$$minErr("ng")("areq","Expected options to be an object! Found: {0}.",typeof t);for(var n in r.defaults)n in t&&(e[n]=t[n]);"disabled"in t&&(e.$$disabled=!!t.disabled)},this.$get=function(){function t(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}function n(t,n){if(t in s)throw angular.$$minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",t);if(!angular.isString(t))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof t);return s[t]=new o(t,angular.extend({},e,n)),s[t].destroy=function(){this.constructor.prototype.destroy.call(this),delete s[this.$$id]},s[t]}function i(e,t){return n(e,t)}var s={};return i.createCache=n,i.version=a,i.info=function(){for(var n=t(s),i={size:n.length,caches:{}},o=0;o<n.length;o++){var a=n[o];i.caches[a]=s[a].info()}var c=i.cacheDefaults=angular.extend({},e);for(var l in r.defaults)l in c||(c[l]=e["$$"+l]);return i},i.get=function(e){if(!angular.isString(e))throw angular.$$minErr("ng")("areq","Expected cacheId to be a string! Found: {0}.",typeof e);return s[e]},i.keySet=function(){var e,t={};for(e in s)s.hasOwnProperty(e)&&(t[e]=e);return t},i.keys=function(){return t(s)},i.destroyAll=function(){for(var e in s)s[e].destroy();s={}},i.clearAll=function(){for(var e in s)s[e].removeAll()},i.enableAll=function(){for(var e in s)s[e].$$disabled=!1},i.disableAll=function(){for(var e in s)s[e].$$disabled=!0},i}}var r=e("../defaults"),o=e("../DSCache"),a="3.1.1";t.exports=i},{"../DSCache":4,"../defaults":19}],19:[function(e,t,n){function i(){}var r={capacity:Number.MAX_VALUE,maxAge:Number.MAX_VALUE,deleteOnExpire:"none",onExpire:null,cacheFlushInterval:null,recycleFreq:1e3,storageMode:"memory",storageImpl:null,disabled:!1,storagePrefix:"angular-cache.caches."};for(var o in r)i.prototype["$$"+o]=r[o];t.exports={Config:i,defaults:r}},{}],20:[function(e,t,n){!function(t,n,i){"use strict";n.$$minErr=n.$$minErr||function(e){return function(){var t,i,r=arguments[0],o="["+(e?e+":":"")+r+"] ",a=arguments[1],s=arguments,c=function(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e};for(t=o+a.replace(/\{\d+\}/g,function(e){var t,i=+e.slice(1,-1);return i+2<s.length?(t=s[i+2],"function"==typeof t?t.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof t?"undefined":"string"!=typeof t?n.toJson(t):t):e}),t=t+"\nhttp://errors.angularjs.org/"+n.version.full+"/"+(e?e+"/":"")+r,i=2;i<arguments.length;i++)t=t+(2==i?"?":"&")+"p"+(i-2)+"="+encodeURIComponent(c(arguments[i]));return new Error(t)}},n.module("app").provider("DSBinaryHeap",e("./DSBinaryHeap").DSBinaryHeapProvider),n.module("app").provider("DSCacheFactory",e("./DSCacheFactory"))}(window,window.angular)},{"./DSBinaryHeap":1,"./DSCacheFactory":18}],21:[function(e,t,n){t.exports={stringifyNumber:function(e){return e&&angular.isNumber(e)?e.toString():e},keySet:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=t);return n},keys:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}}},{}]},{},[20]),function(){"use strict";angular.module("app").service("dateParser",["$locale","orderByFilter",function(e,t){function n(e){var n=[],i=e.split("");return angular.forEach(r,function(t,r){var o=e.indexOf(r);if(o>-1){e=e.split(""),i[o]="("+t.regex+")",e[o]="$";for(var a=o+1,s=o+r.length;s>a;a++)i[a]="",e[a]="$";e=e.join(""),n.push({index:o,apply:t.apply})}}),{regex:new RegExp("^"+i.join("")+"$"),map:t(n,"index")}}function i(e,t,n){return 1===t&&n>28?29===n&&(e%4===0&&e%100!==0||e%400===0):3===t||5===t||8===t||10===t?31>n:!0}this.parsers={};var r={yyyy:{regex:"\\d{4}",apply:function(e){this.year=+e}},yy:{regex:"\\d{2}",apply:function(e){this.year=+e+2e3}},y:{regex:"\\d{1,4}",apply:function(e){this.year=+e}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1}},M:{regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(t,r){if(!angular.isString(t)||!r)return t;r=e.DATETIME_FORMATS[r]||r,this.parsers[r]||(this.parsers[r]=n(r));var o=this.parsers[r],a=o.regex,s=o.map,c=t.match(a);if(c&&c.length){for(var l,u={year:1900,month:0,date:1,hours:0},d=1,p=c.length;p>d;d++){var f=s[d-1];f.apply&&f.apply.call(u,c[d])}return i(u.year,u.month,u.date)&&(l=new Date(u.year,u.month,u.date,u.hours)),l}}}]).directive("renderModelAsHours",function(){return{require:"ngModel",link:function(e,t,n,i){i.$render=function(){var e=parseInt(i.$modelValue,10);return isNaN(e)?void t.val(i.$modelValue):(10>e&&(e="0"+e),void t.val(e))}}}}).directive("timeDatePicker",["$filter","$sce","$rootScope","$parse",function(e,t,n,i){var r;return r=e("date"),{restrict:"AE",replace:!0,scope:{_modelValue:"=ngModel"},require:"ngModel",templateUrl:"core/datetime/input.html",link:function(e,t,n,r){var o,a;return n.$observe("defaultMode",function(t){return e._mode=null!=t?t:"date"}),n.$observe("displayMode",function(t){return e._displayMode=t}),n.$observe("orientation",function(t){return e._verticalMode="true"===t}),n.$observe("displayTwentyfour",function(t){return e._hours24=null!=t&&t}),n.$observe("mindate",function(t){return null!=t&&angular.isDate(t)?e.restrictions.mindate=t:void 0}),n.$observe("maxdate",function(t){return null!=t&&angular.isDate(t)?e.restrictions.maxdate=t:void 0}),r.$render=function(){return e.setDate(r.$modelValue)},a=i(n.onSave),o=i(n.onCancel),e.save=function(){return e._modelValue=e.date,r.$setDirty(),a(e.$parent,{$value:e.date})},e.cancel=function(){return o(e.$parent,{}),r.$render()}},controller:["$scope",function(e){var n;return e.restrictions={mindate:void 0,maxdate:void 0},e.setDate=function(t){return e.date=null!=t?new Date(t):new Date,e.calendar._year=e.date.getFullYear(),e.calendar._month=e.date.getMonth(),e.clock._minutes=e.date.getMinutes(),e.clock._hours=e._hours24?e.date.getHours():e.date.getHours()%12,e._hours24||0!==e.clock._hours?void 0:e.clock._hours=12},e.display={fullTitle:function(){return r(e.date,"EEEE d MMMM yyyy, h:mm a")},title:function(){return"date"===e._mode?r(e.date,"date"===e._displayMode?"EEEE":"EEEE h:mm a"):r(e.date,"MMMM d yyyy")},"super":function(){return"date"===e._mode?r(e.date,"MMM"):""},main:function(){return t.trustAsHtml("date"===e._mode?r(e.date,"d"):""+r(e.date,"h:mm")+"<small>"+r(e.date,"a")+"</small>")},sub:function(){return"date"===e._mode?r(e.date,"yyyy"):r(e.date,"HH:mm")}},e.calendar={_month:0,_year:0,_months:function(){var e,t;for(t=[],n=e=0;11>=e;n=++e)t.push(r(new Date(0,n),"MMMM"));return t}(),offsetMargin:function(){return new Date(this._year,this._month).getDay()},isVisible:function(e){return new Date(this._year,this._month,e).getMonth()===this._month},"class":function(t){return null!=e.date&&new Date(this._year,this._month,t).getTime()===new Date(e.date.getTime()).setHours(0,0,0,0)?"selected":new Date(this._year,this._month,t).getTime()===(new Date).setHours(0,0,0,0)?"today":""},select:function(t){var n=e.date.setFullYear(this._year,this._month,t);return e.save(),n},monthChange:function(){return(null==this._year||isNaN(this._year))&&(this._year=(new Date).getFullYear()),e.date.setFullYear(this._year,this._month),e.date.getMonth()!==this._month?e.date.setDate(0):void 0},_incMonth:function(e){for(this._month+=e;this._month<0||this._month>11;)this._month<0?(this._month+=12,this._year--):(this._month-=12,this._year++);return this.monthChange()}},e.clock={_minutes:0,_hours:0,_incHours:function(t){return this._hours=e._hours24?Math.max(0,Math.min(23,this._hours+t)):Math.max(1,Math.min(12,this._hours+t)),isNaN(this._hours)?this._hours=0:void 0},_incMinutes:function(e){return this._minutes=Math.max(0,Math.min(59,this._minutes+e)),isNaN(this._minutes)?this._minutes=0:void 0},setAM:function(t){return null==t&&(t=!this.isAM()),t&&!this.isAM()?e.date.setHours(e.date.getHours()-12):!t&&this.isAM()?e.date.setHours(e.date.getHours()+12):void 0},isAM:function(){return e.date.getHours()<12}},e.$watch("clock._minutes",function(t,n){if(null!=t&&t!==e.date.getMinutes()&&!isNaN(t)&&t>=0&&59>=t){var i=e.date.setMinutes(t);return i=e.date.setSeconds(0),e.save(),i}}),e.$watch("clock._hours",function(t){if(null!=t&&!isNaN(t)&&(e._hours24||(24===t?t=12:12===t?t=0:e.clock.isAM()||(t+=12)),t!==e.date.getHours())){var n=e.date.setHours(t);return e.save(),n}}),e.setNow=function(){return e.setDate()},e._mode="date",e.modeClass=function(){return null!=e._displayMode&&(e._mode=e._displayMode),""+(null!=e._verticalMode&&e._verticalMode?"vertical ":"")+("full"===e._displayMode?"full-mode":"time"===e._displayMode?"time-only":"date"===e._displayMode?"date-only":"date"===e._mode?"date-mode":"time-mode")},e.modeSwitch=function(){var t;return e._mode=null!=(t=e._displayMode)?t:"date"===e._mode?"time":"date"},e.modeSwitchText=function(){return"date"===e._mode?"Clock":"Calendar"}}]}}]).directive("timeDatePickerDialog",["$modal","dateFilter","dateParser","GLOBAL_CONFIG","$$rAF",function(e,t,n,i,r){return{require:["ngModel","^form"],link:function(o,a,s,c){var l=c[0],u=(c[1],!1);l.$render=function(){a.val(t(l.$modelValue,i.date.format))},a.on("click focus",function(t){t.preventDefault(),u||(u=!0,r(function(){e.open({windowClass:"modal-medium datepicker-pop",popFrom:!1,inDirection:!1,outDirection:!1,fullScreen:!1,cantCloseWithBackdrop:!0,templateUrl:"core/datetime/popup.html",controller:["$scope",function(e){e.date=l.$modelValue;var t=e.$close;e.$close=function(){t()},e.select=function(){l.$setViewValue(e.date),l.$render(),e.$close()},e.$on("$destroy",function(){u=!1})}]})}))}),l.$parsers.unshift(function(e){if(e){if(angular.isDate(e)&&!isNaN(e))return l.$setValidity("date",!0),e;if(angular.isString(e)){var t=n.parse(e,dateFormat)||new Date(e);return isNaN(t)?void l.$setValidity("date",!1):(l.$setValidity("date",!0),t)}return void l.$setValidity("date",!1)}return l.$setValidity("date",!0),null})}}}])}(),function(){"use strict";angular.module("app").directive("repeatedText",["helpers",function(e){return{require:"ngModel",link:function(t,n,i,r){var o=function(t,n){var i=!1;try{"list"===n&&(t=e.splitLines(t),t=_.uniq(t)),"str"===n&&angular.isArray(t)&&(t=t.join("\n")),i=!0}catch(o){}return r.$setValidity("invalid",i),t},a=function(e){return o(e,"list")},s=function(e){return o(e,"str")};r.$parsers.push(a),r.$formatters.push(s)}}}]).directive("checkNumeric",function(){return{require:["ngModel","^form"],link:function(e,t,n,i){var r=function(e){var t=!isNaN(parseInt(e,10));return t||(t=!isNaN(parseFloat(e,10))),t},o="required"===t.attr("required");i[0].$parsers.unshift(function(e){var t,n=r(e);return o||n&&!angular.isUndefined(e)&&e.length&&e.replace(/[^0-9+.]/g,"")||(n=!0),i[0].$setValidity("checkNumeric",n),angular.isDefined(e)?(t=e.replace(/[^0-9+.]/g,""),t!==e&&(i[0].$setViewValue(t),i[0].$render()),t):n?e:void 0})}}}).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,n){return{require:"ngModel",restrict:"A, C",link:function(i,r,o,a){function s(){var e=v;f=u,b=getComputedStyle(u),angular.forEach(E,function(t){e+=t+":"+b.getPropertyValue(t)+";"}),$.setAttribute("style",e)}function c(){var t,n,r,o,a;f!==u&&s(),g||(g=!0,$.value=u.value+m,$.style.overflowY=u.style.overflowY,t=""===u.style.height?"auto":parseInt(u.style.height,10),n=getComputedStyle(u).getPropertyValue("width"),"px"===n.substr(n.length-2,2)&&(o=parseInt(n,10)-k.width,$.style.width=o+"px"),r=$.scrollHeight,r>A?(r=A,a="scroll"):x>r&&(r=x),r+=k.height,u.style.overflowY=a||"hidden",t!==r&&(u.style.height=r+"px",i.$emit("elastic:resize",d)),e(function(){g=!1},1,!1))}function l(){g=!1,c()}var u=r[0],d=r;if("TEXTAREA"===u.nodeName&&t.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var p=u.value;u.value="",u.value=p;var f,g,m=o.msdElastic?o.msdElastic.replace(/\\n/g,"\n"):n.append,h=angular.element(t),v="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",y=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+v+'"/>').data("elastic",!0),$=y[0],b=getComputedStyle(u),_=b.getPropertyValue("resize"),w="border-box"===b.getPropertyValue("box-sizing")||"border-box"===b.getPropertyValue("-moz-box-sizing")||"border-box"===b.getPropertyValue("-webkit-box-sizing"),k=w?{width:parseInt(b.getPropertyValue("border-right-width"),10)+parseInt(b.getPropertyValue("padding-right"),10)+parseInt(b.getPropertyValue("padding-left"),10)+parseInt(b.getPropertyValue("border-left-width"),10),height:parseInt(b.getPropertyValue("border-top-width"),10)+parseInt(b.getPropertyValue("padding-top"),10)+parseInt(b.getPropertyValue("padding-bottom"),10)+parseInt(b.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},C=parseInt(b.getPropertyValue("min-height"),10),S=parseInt(b.getPropertyValue("height"),10),x=Math.max(C,S)-k.height,A=parseInt(b.getPropertyValue("max-height"),10),E=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(A=A&&A>0?A:9e4,$.parentNode!==document.body&&angular.element(document.body).append($),d.css({resize:"none"===_||"vertical"===_?"none":"horizontal"}).data("elastic",!0),u.oninput="onpropertychange"in u&&"oninput"in u?u.onkeyup=c:c,h.bind("resize",l),i.$watch(function(){return a.$modelValue},function(e){l()}),i.$on("elastic:adjust",function(){s(),l()}),e(c),i.$on("$destroy",function(){y.remove(),h.unbind("resize",l)}))}}}}]).run(["formInputTypes","GLOBAL_CONFIG","helpers",function(e,t,n){$.extend(e,{_SelectBox:function(e){return angular.isDefined(e.config.ui.specifics.searchEnabled)||(e.config.ui.specifics.searchEnabled=e.config.choices.length<10?!1:!0),e.config.choices.length&&e.config.ui.specifics&&e.config.ui.specifics.translatedChoices!==!1&&(e.config.ui.specifics.translatedChoices=[],angular.forEach(e.config.choices,function(i){var r=angular.isObject(i),o=n.getProperty(t.fields.translateChoices,[e.config._maker_,e.config.code_name,r?i.name:i]);angular.isUndefined(o)&&(o=r?i.name:i),e.config.ui.specifics.translatedChoices.push({key:r?i.key:i,name:o})})),"select"},SuperStringProperty:function(e){var t=e.config;return void 0===t.ui.attrs.type&&(t.ui.attrs.type="text"),t.choices?t.repeated?this._SuperStringRepeated(e):(void 0!==e.config.ui.attrs["repeated-text"]&&delete e.config.ui.attrs["repeated-text"],this._SelectBox(e)):t.repeated?(t.ui.attrs["repeated-text"]="",this.SuperTextProperty(e)):"string"},SuperFloatProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperStringProperty(e))},SuperIntegerProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperFloatProperty(e))},SuperDecimalProperty:function(e){var t=e.config;return t.choices?this._SelectBox(e):(t.ui.attrs["check-numeric"]="",this.SuperFloatProperty(e))},_SuperStringRepeated:function(e){var t={};return e.config.ui.specifics.select=t,e.config._groupable=!0,"select_multiple"},SuperTextProperty:function(e){return e.config.repeated&&(e.config.ui.attrs["repeated-text"]=""),(void 0===e.config.ui.specifics.autoGrow||e.config.ui.specifics.autoGrow)&&(e.config.ui.attrs["msd-elastic"]=""),"text"}})}])}(),function(){"use strict";angular.module("app").filter("humanized",["$filter",function(e){return function(t){var n=e("inflector"),i=n(t,"humanize");return i=i.toLowerCase(),_.string.capitalize(i)}}]).run(["helpers","modals","$modal","GLOBAL_CONFIG","snackbar",function(e,t,n,i,r){e.fields||(e.fields={}),e.form||(e.form={}),$.extend(e.fields,{isFieldset:function(e){return e.is_structured||_.string.contains(e.type,"KeyProperty")&&e.repeated||e.ui.fieldset},sorter:function(e,t){var n=parseInt(e.name,10),i=parseInt(t.name,10);return isNaN(n)&&(n=999999),isNaN(i)&&(i=999999),n-i},applyGlobalConfig:function(e){angular.isUndefined(e.ui.help)&&angular.isDefined(i.fields.help[e._maker_])&&(e.ui.help=i.fields.help[e._maker_][e.code_name]),angular.isUndefined(e.ui.emptyHelp)&&angular.isDefined(i.fields.emptyHelp[e._maker_])&&(e.ui.emptyHelp=i.fields.emptyHelp[e._maker_][e.code_name]),angular.isUndefined(e.ui.label)&&angular.isDefined(i.fields.label[e._maker_])&&(e.ui.label=i.fields.label[e._maker_][e.code_name])},utils:{attrs:function(e){var t=this.defaultAttrs(e),n=this.extraAttrs(e),i=[];return angular.extend(t,n),angular.forEach(t,function(e,t){i.push(t+(e?'="'+e+'"':""))}),i.join(" ")},defaultAttrs:function(t){var n,i={};return t.max_size&&(i["ng-maxlength"]="config.max_size"),void 0!==t.ui.pattern&&(i["ng-pattern"]=t.pattern),i["ng-required"]=angular.isString(t.required)?t.required:"config.required",i["ng-model"]=t.ui.args,i.placeholder=t.ui.placeholder,angular.isArray(t.ui.writable)?(n=t.ui.model+".ui.rule.field"+$.map(t.ui.writable,function(t){return"['"+e.addslashes(t)+"']"}).join("")+".writable",i["ng-disabled"]="!"+n,t.ui.writableCompiled=n):(i["ng-disabled"]="!"+t.ui.writable,t.ui.writableCompiled=t.ui.writable),i.readonly&&delete i["ng-disabled"],i},extraAttrs:function(e){return e.ui.attrs},label:function(e){var t="{{config.ui.label}}";return void 0===e.ui.label&&(t="{{config.ui.autoLabel|humanized}}"),t}}}),$.extend(e.form,{wakeUp:function(e,t){var n=!1;return angular.forEach(e,function(i){angular.isObject(i)&&i.hasOwnProperty("$valid")&&!i.$valid&&angular.isFunction(i.$setViewValue)&&(i.$setViewValue(void 0!==i.$viewValue?i.$viewValue:""),i.$setDirty(),i.$setTouched(),t&&e.$setDirty(),n=!0)}),n},setDirty:function(){this.container&&this.container.form&&this.container.form.$setDirty()},setPristine:function(){this.container&&this.container.form&&this.container.form.$setPristine()},validate:function(){var t=this.container.form;return t.$valid?!0:(e.form.wakeUp(t),this.$broadcast("invalidForm"),r.showK("actionFailedCheckForm"),!1)},leave:function(e){var n=this.container.form;return n.$pristine?e():void t.confirm("discard",e)}})}]).directive("formBuilder",["$compile","underscoreTemplate","modelsMeta",function(e,t,n){return{restrict:"A",require:"^form",templateUrl:"core/fields/builder.html",scope:!0,transclude:!0,controller:["$scope","$element","$attrs",function(e,t,n){e.configurations=e.$eval(n.formBuilder)}]}}]).directive("formInput",["$compile","underscoreTemplate","formInputTypes","helpers","GLOBAL_CONFIG",function(e,t,n,i,r){var o=n,a=i.fields.utils;return{restrict:"A",require:"^form",scope:!0,transclude:!0,link:function(n,r,s,c){var l=function(){var l,u,d,p,f,g,m=n.$eval(s.formInput),h=null;if(!angular.isObject(m))return void console.warn("Config provided is not object for element: ",r);if(l=m.code_name,h=null!==m.verbose_name&&void 0!==m.verbose_name?m.verbose_name:l,!l)return void console.error("Your field config",m,"has no name defined defined. element: ",r);if(u={ui:{args:"args."+l,parentArgs:"args",rootScope:"rootScope",model:"entity",autoLabel:h,directiveScope:function(){return n},specifics:{},systemName:l,name:l,form:{root:c,field:function(){return this.root[u.ui.name]},hasErrors:function(){return this.field()?Object.keys(this.field().$error).length:!1},messages:function(){return this.field()?(this.field().$dirty&&this.hasErrors()?this.field().$error:!1)||u.ui:!1},shouldShowMessages:function(){return u.ui.hideMessages?!1:!0}},writable:[l],path:void 0,realPath:void 0,attrs:{}}},i.mergeDeep(m,u),u=m,angular.isFunction(u.ui.init)&&(g=u.ui.init,u.ui.init=void 0),u.ui.init||(u.ui.init={callbacks:[],add:function(e,t){var n=null;angular.forEach(this.callbacks,function(t,i){angular.isDefined(t[e])&&(n=t)}),null!==n?n[e]=t:(n={},n[e]=t,this.callbacks.push(n))}}),g&&u.ui.init.add("init",g),angular.isDefined(u.ui.path)||(u.ui.path=[l]),angular.isArray(u.ui.writable)&&(u.ui.writable=angular.copy(u.ui.path)),angular.isDefined(u.ui.realPath)||(u.ui.realPath=[l]),i.fields.applyGlobalConfig(u),void 0!==o[u.type]){if(f={config:u,element:r,scope:n,attrs:s},d=o[u.type](f),u.ui.compiled={attrs:a.attrs(u),label:a.label(u)},angular.forEach(u.ui.init.callbacks,function(e){angular.forEach(e,function(e){e(f)})}),u.ui.render===!1)return;p=t.get(angular.isDefined(u.ui.template)?u.ui.template:"core/fields/"+d+".html")({config:u}),n.config=u,r.html(p),e(r.contents())(n)}n.$on("$destroy",function(){u.ui.directiveScope=void 0,u.ui.form=void 0})};l()}}}]).directive("compatibilityMaker",["modelsUtil",function(e){return{restrict:"A",link:function(t,n,i,r){var o=function(){var r=t.$eval(i.compatibilityMaker),o=e.argumentsToJson(r);n.val(o)};t.$watch(i.compatibilityMaker,o),t.$on("ngUploadSubmit",o)}}}]).factory("formInputTypes",function(){var e={};return e}).directive("fastNgChange",["$parse","$mdUtil",function(e,t){return{priority:1,link:function(n,i,r){var o=e(r.fastNgChange),a=i.val(),s=t.debounce(function(e){var t=i.val();a!==t&&(a=t,o(n,{$event:e}))},100,n,!0);i.on("change keydown",s),n.$on("$destroy",function(){i.off("change keydown",s)})}}}]).directive("fastNgModel",["$parse","$mdUtil",function(e,t){return{priority:-1,link:function(n,i,r){var o=e(r.fastNgModel),a=t.debounce(function(e){o.assign(n,i.val())},100,n,!0);i.on("keyup",a),n.$on("$destroy",function(){i.off("keyup",a)})}}}]).directive("form",["GLOBAL_CONFIG",function(e){var t=!1,n=[];return{require:"^form",link:function(i,r,o,a){if(!window.isChromeApp){var s;t||(t=!0,window.onbeforeunload=function(){var t=!1;return angular.forEach(n,function(e){t=e()}),t?e.misc.text.leaveUnsaved:void 0}),s=function(){return a.$dirty},n.push(s),i.$on("$destroy",function(){n.remove(s)})}}}}])}(),function(){"use strict";angular.module("app").directive("validFile",function(){return{require:"ngModel",link:function(e,t,n,i){t.bind("change",function(){e.$apply(function(){i.$setViewValue(t.val()),i.$render()})})}}}).directive("jsonOnly",function(){return{require:"ngModel",link:function(e,t,n,i){var r=function(e,t){var n=!1;try{e=angular[t](e),n=!0}catch(r){}return i.$setValidity("jsonOnly",n),e},o=function(e){return r(e,"fromJson")},a=function(e){return r(e,"toJson")};i.$parsers.push(o),i.$formatters.push(a)}}}).directive("generateUploadUrl",["endpoint","$rootScope",function(e,t){return{restrict:"A",require:"^form",link:function(t,n,i,r){var o=n,a=o.parents("form:first"),s=function(){return o.val()?void e.post("blob_upload_url","11",{upload_url:e.url}).then(function(e){a.attr("action",e.data.upload_url),r.$setDirty()}):!1},c=function(t,n){a.attr("action",e.url),o.val("")};return a.length?($(n).on("change",s),t.$on("$destroy",function(){$(n).off("change",s)}),t.$on("ngUploadComplete",c),void t.$on("ngUploadError",s)):(console.error("Directive generateUploadUrl demands explicit <form> tag"),!1)}}}]).directive("submitIfFiles",["$parse","helpers",function(e,t){return{require:"^form",link:function(n,i,r,o){var a,s,c=i.parents("form:first"),l=e(r.submitIfFiles),u=e(r.submitIfFilesNoComplete),d=e(r.submitIf),p=e(r.submitNative),f=function(){var e,i,r=t.form.wakeUp(o,!0);return r&&(n.$$phase||n.$apply()),d&&!d(n)?!1:(i=p(n),a=c.find('input[type="file"]'),s=!1,a.length&&a.each(function(){return $(this).val()?(s=!0,!1):void 0}),i&&s?(c.trigger("submit"),!1):(e=l(n,{dontShowMessage:s}),e&&angular.isObject(e)&&e.then&&e.then(function(){return s?(c.trigger("submit"),!1):void u(n)}),void n.$apply()))};i.on("click",f),n.$on("$destroy",function(){i.off("click",f)})}}}]).directive("submitIfValid",["$parse",function(e){return{require:"^form",link:function(t,n,i,r){var o=n.parents("form:first"),a=e(i.submitIfValid),s=function(e){return a(t)&&o.submit(),e.preventDefault()};n.on("click",s),t.$on("$destroy",function(){n.off("click",s)})}}}]).directive("showNumberOfSelectedFiles",function(){return{restrict:"A",link:function(e,t,n){var i=t.parents(".fake-button:first"),r=i.find(n.showNumberOfSelectedFiles),o=r.text(),a=function(){setTimeout(function(){var e=t.prop("files");e&&e.length?(r.css("display","inline"),r.text(o.replace(":total",e.length))):r.hide()},200)};t.bind("change",a),a(),e.$on("ngUploadComplete",a),e.$on("ngUploadError",a),e.$on("$destroy",function(){t.unbind("change",a)})}}}).run(["formInputTypes","underscoreTemplate","$timeout","$parse","endpoint","modelsMeta","models","$q","$filter","$modal","helpers","errorHandling","modals","GLOBAL_CONFIG","snackbar",function(e,t,n,i,r,o,a,s,c,l,u,d,p,f,g){$.extend(e,{SuperBooleanProperty:function(e){return e.config.required=!1,(!e.config.ui.specifics||angular.isUndefined(e.config.ui.specifics.type))&&(e.config.ui.specifics.type="checkbox"),"boolean"},SuperVirtualKeyProperty:function(e){return this.SuperKeyProperty(e)},_SuperKeyPropertyRepeated:function(e){var t={};return e.config.ui.specifics.select=t,"select_multiple"},SuperKeyProperty:function(e){if(e.config.searchable===!1)return this.SuperStringProperty(e);var t,i,r,c,l=e.config,u="select_async",d={cache:{query:{24:!0,12:!0,13:!0,17:!0},type:{12:"local",17:"local",24:"local",13:"local","default":"memory"}},finder:{24:!0},grouping:{},view:{"default":function(e){return e?e.name:""}},init:{13:function(e){e.scope.$watch(e.config.ui.parentArgs+".country",function(t,n){if(t!==n){var i=e.scope.$eval(e.config.ui.parentArgs);i.region=null,e.config.ui.specifics.initial()}})}},queryFilter:{24:function(e,t){var n=angular.copy(t.search["default"]),i={search:n};return e&&i.search.filters.push({field:"name",operator:"==",value:e}),i},17:function(e,t){var n={search:{filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}},i=n.search;return"uom"===l.code_name&&(i.filters.unshift({value:"Currency",field:"measurement",operator:"!="}),i.orders=[{field:"measurement",operator:"asc"},{field:"key",operator:"asc"}]),"currency"===l.code_name&&i.filters.push({value:"Currency",field:"measurement",operator:"=="}),n},13:function(t,n){var i=e.scope.$eval(e.config.ui.parentArgs);return i&&i.country?{search:{ancestor:i.country,filters:[{value:!0,field:"active",operator:"=="}],orders:[{field:"name",operator:"asc"}]}}:!1}}},p=a[l.kind],f={},g={activitySpinner:!0},m=l.ui.specifics.override||{},h=function(){l.ui.specifics._mapEntities={},angular.forEach(l.ui.specifics.entities,function(e){l.ui.specifics._mapEntities[e.key]=1})},v=l.kind?o.getActionArguments(l.kind,"search"):{},y=function(e){return l.ui.specifics.entities=e.data.entities,h(),l.ui.specifics.entities},b=s.defer(),w=b.promise;return l.repeated&&(l.ui.fieldset=!0),l.ui.specifics.view=function(e){var t=d.view[l.kind];return t||(t=d.view["default"]),m.view&&(t=m.view),t(e)},t=d.init[l.kind],m.init&&(t=m.init),angular.isDefined(t)&&t(e),$.extend(f,l.ui.specifics.search),l.ui.specifics.search=f,angular.isFunction(l.ui.specifics.entities)&&(l.ui.specifics.getEntities=l.ui.specifics.entities,l.ui.specifics.entities=l.ui.specifics.entities()),angular.isUndefined(l.ui.specifics.entities)&&(l.ui.specifics.entities=[]),angular.isUndefined(l.ui.specifics.grouping)&&(l.ui.specifics.grouping=d.grouping[l.kind]),h(),c=d.finder[l.kind],m.finder&&(c=m.finder),l.ui.specifics.search.ready=w,g.cache=d.cache.query[l.kind],g.cacheType=d.cache.type[l.kind]||d.cache.type["default"],m.cache&&angular.isDefined(m.cache.query)&&(g.cache=m.cache.query),m.cache&&angular.isDefined(m.cache.type)&&(g.cacheType=m.cache.type),p&&!l.ui.specifics.getEntities&&p.actions.search&&(l.ui.specifics.initial=function(){return i=d.queryFilter[l.kind],m.queryFilter&&(i=m.queryFilter),i?(r=i,i=r(null,v),c&&(l.ui.specifics.search.find=function(e){return p.actions.search(r(e,v),g).then(function(e){var t=e.data.entities;angular.forEach(t,function(e){angular.isUndefined(l.ui.specifics._mapEntities[e.key])&&(l.ui.specifics._mapEntities[e.key]=1,l.ui.specifics.entities.push(e))})})}),l.ui.specifics.search.missing=function(e){if(null!==e&&void 0!==e&&e.length){var t=angular.isArray(e);p.actions.search({search:{keys:t?e:[e]}},g).then(function(n){var i=n.data.entities;

t?angular.forEach(i,function(e){angular.isUndefined(l.ui.specifics._mapEntities[e.key])&&(l.ui.specifics._mapEntities[e.key]=1,l.ui.specifics.entities.push(e))}):angular.isUndefined(l.ui.specifics._mapEntities[e])&&(l.ui.specifics._mapEntities[e]=1,l.ui.specifics.entities.unshift(n.data.entities[0]))})}}):i=v.search["default"],p.actions.search(i,g).then(y)},n(function(){l.ui.specifics.initial().then(function(){b.resolve()})})),e.scope.$on("$destroy",function(){l.ui.specifics.entities=[],l.ui.specifics._mapEntities={}}),l.ui.specifics.async=!0,l.repeated&&(u=this._SuperKeyPropertyRepeated(e)),function(){var t=l.ui.specifics.select||l.ui.specifics.search;"24"===e.config.kind&&(t.init=function(e,t,n,i,r){var o=function(e){angular.forEach(e,function(e){e.leafname=_.last(e.name.split(" / "))})};e.afterClose=function(){e.product_categories.resetToTop()},e.openTemplate="core/select/product_categories.html",e.windowClass="category-modal",e.product_categories={children:[],mapped:{},top:[],isLeaf:function(e){return-1!==$.inArray("visible",e.state)},resetToTop:function(){e.product_categories.children=[],e.product_categories.mapped={}},next:function(t){var n={search:{options:{limit:1e3},orders:[{operator:"asc",field:"name"}],filters:[{value:["indexable"],operator:"ALL_IN",field:"state"},{value:null,operator:"==",field:"parent_record"}]}};n.search.filters[1].value=t.key,a[24].actions.search(n,g).then(function(n){var i=n.data.entities,r={item:t},a=e.product_categories.mapped[t.key];o(i),a&&(r=a),r.visible=!0,i.length?(r.items=i,e.product_categories.children.push(r),e.product_categories.mapped[t.key]=r):(e.select(t),e.product_categories.resetToTop())})},prev:function(t){var n=e.product_categories.children,i=!1;angular.forEach(n,function(e,n){e===t&&(e.visible=!1,0===n&&(i=!0))})}},a[24].actions.search({search:{options:{limit:1e3},orders:[{operator:"asc",field:"name"}],filters:[{value:["indexable"],operator:"ALL_IN",field:"state"},{value:null,operator:"==",field:"parent_record"}]}},g).then(function(t){var n=t.data.entities;o(n),e.product_categories.top=n})})}(),u},SuperJsonProperty:function(e){return e.config.ui.attrs["json-only"]="",this.SuperTextProperty(e)},SuperDateTimeProperty:function(e){return e.config.ui.attrs["time-date-picker-dialog"]="",e.config.ui.attrs.readonly="true","datetime"}})}])}(),function(){"use strict";angular.module("app").run(["helpers","modals","$modal","GLOBAL_CONFIG","$q",function(e,t,n,i,r){$.extend(t,{fields:{remote:function(t,i,o){n.open({scope:t,templateUrl:"core/models/manage.html",controller:["$scope",function(n){var o,a=t.save,s=t.uploadComplete,c=!0;o=function(){return"view"+e.toolbar.makeTitle(i.code_name)},n.$stateHiddenLoading=!0,i.ui.specifics.readerDefer=r.defer(),i.ui.specifics.readerDefer.promise.then(function(){n.$stateHiddenLoading=!1,n.dialog.toolbar.hideSave=!1}),i._title_.push(o),n.dialog={templateBodyUrl:"core/models/manage_body_default.html",toolbar:{hideSave:!0}},n.parentContainer=n.container,n.container={},n.close=angular.bind(n,e.form.leave,function(){return n.formSetPristine(),n.$close()}),n.formSetDirty=angular.bind(n,e.form.setDirty),n.formSetPristine=angular.bind(n,e.form.setPristine),n.formBuilder={0:[i]},n.layouts={groups:[{label:!1}]},n.$on("itemDelete",function(){n.formSetDirty()}),n.$watch("parentContainer.form.$dirty",function(e,t){return c?void(c=!1):void(e?n.formSetDirty():n.formSetPristine())}),n.$watch("entity.id",function(){n.dialog.toolbar.title=e.toolbar.buildTitle(i._title_)}),n.save=function(e){var i=a.call(t,e);return i&&i.then(function(){n.formSetPristine()}),i},n.uploadComplete=function(e){s.call(t,e),n.formSetPristine()},n.$on("$destroy",function(){angular.isArray(i.ui.specifics.parentArgs)&&i.ui.specifics.parentArgs.empty(),i._title_.remove(o)})}]})}}})}]).run(["formInputTypes","underscoreTemplate","$timeout","$parse","endpoint","modelsMeta","models","$q","$filter","$modal","helpers","errorHandling","modals","GLOBAL_CONFIG","snackbar",function(e,t,n,i,r,o,a,s,c,l,u,d,p,f,g){$.extend(e,{SuperLocalStructuredProperty:function(d){var f,m,h,v,y,b,w=d.config,k=[],C=[],S=w.modelclass,x=_.toArray(S),A=!angular.isDefined(w.ui.specifics),E=[],O=u.callable(d.scope.formSetDirty),D={secondary:!0,perLine:1,clickable:!0,calculate:function(e,t){return parseInt(t,10)===parseInt(this.perLine,10)}};return w.ui.fieldset=!0,w.ui.specifics.toolbar||(w.ui.specifics.toolbar={}),w.ui.specifics.remoteOpts||(w.ui.specifics.remoteOpts={}),w.ui.specifics.sortMode=!0,x=x.sort(u.fields.sorter),(A||!w.ui.specifics.fields)&&(w.ui.specifics.fields=x,w.ui.specifics.sortFields&&(angular.forEach(w.ui.specifics.sortFields,function(e){E.push(_.findWhere(w.ui.specifics.fields,{code_name:e}))}),w.ui.specifics.fields=E)),!A&&w.ui.specifics.excludeFields&&(angular.forEach(w.ui.specifics.fields,function(e,t){-1===$.inArray(e.code_name,w.ui.specifics.excludeFields)&&C.push(e)}),w.ui.specifics.fields=C),f={fields:k,addNewText:"Add",addText:"{{config.ui.specifics.addNewText}}"},w.ui.specifics.listConfig&&$.extend(D,w.ui.specifics.listConfig),w.ui.specifics.listConfig=D,angular.forEach(f,function(e,t){void 0===w.ui.specifics[t]&&(w.ui.specifics[t]=e)}),w.ui.specifics.parentArgs=d.scope.$eval(w.ui.args),w.ui.specifics.entity=d.scope.$eval(w.ui.model),w.ui.specifics.rootScope=d.scope.$eval(w.ui.rootScope),w.ui.specifics.sortableOptions||(w.ui.specifics.sortableOptions={}),h={disabled:!1,start:function(e,t){d.scope.$broadcast("itemOrderStarted")},axis:!1,distance:6,containment:!1,whatSortMeans:function(){p.alert("howToSort")},handle:".sort-handle",tolerance:"pointer",helper:"clone",sort:function(e,t){var n,i,r=t.helper.width(),o=t.item.scope(),a=o.$eval(t.item.attr("current-item"));i=t.offset.left+r,r/2>i&&(n=!0),a&&(n?(t.helper.addClass("about-to-delete"),a._state="deleted"):(t.helper.removeClass("about-to-delete"),a._state=null)),d.scope.$broadcast("itemOrderSorting")},stop:function(e,t){var n;angular.forEach(w.ui.specifics.parentArgs,function(e,t){t=w.ui.specifics.parentArgs.length-1-t,("deleted"===e._state||e._sequence!==t)&&(n=!0),e._sequence=t,e.ui.access[e.ui.access.length-1]=t}),n&&d.scope.formSetDirty(),d.scope.$broadcast("itemOrderChanged"),d.scope.$apply()}},w.ui.specifics.setupSortableOptions&&(w.ui.specifics.sortableOptions=w.ui.specifics.setupSortableOptions()),$.extend(h,w.ui.specifics.sortableOptions),w.ui.specifics.sortableOptions=h,w.ui.init.add("checkDisabledStateForSortable",function(){var e=i(w.ui.writableCompiled+"");w.ui.specifics.sortableOptions.disabled=!e(d.scope)}),d.scope.$watch(w.ui.args,function(e,t){e!==t&&(w.ui.specifics.parentArgs=e)}),y=function(){w.ui.specifics.formBuilder=[],angular.forEach(w.ui.specifics.fields,function(e){var t=angular.copy(w.ui.writable);angular.isArray(t)&&t.push(e.ui.writableName?e.ui.writableName:e.code_name),e.ui.path=[],e.ui.path.extend(w.ui.path),e.ui.path.push(e.code_name),e.ui.realPath=[],e.ui.realPath.extend(w.ui.realPath),e.ui.realPath.push(e.code_name),angular.isDefined(e.ui.name)||(e.ui.name=w.ui.name+"."+e.code_name),e.ui.writable=t,w.ui.specifics.formBuilder.push(e)})},y(),angular.isUndefined(w.ui.specifics.toolbar.titleAdd)&&(w.ui.specifics.toolbar.titleAdd="add"+u.toolbar.makeTitle(w.code_name)),angular.isUndefined(w.ui.specifics.toolbar.titleEdit)&&(w.ui.specifics.toolbar.titleEdit="edit"+u.toolbar.makeTitle(w.code_name)),m=function(){w.ui.specifics.readerDefer&&w.ui.specifics.readerDefer.resolve()},w.ui.specifics.remote&&(b=w.ui.specifics.getRootArgs?w.ui.specifics.getRootArgs():w.ui.specifics.rootScope.args,w.repeated&&b.id&&d.scope.args.id?(w.ui.specifics.reader=a[b.action_model].reader({kind:b.action_model,key:b.key,args:b,access:w.ui.realPath,complete:function(e){angular.isArray(w.ui.specifics.parentArgs)&&w.ui.specifics.parentArgs.extend(e)}}),angular.isDefined(w.ui.specifics.readerSettings)&&w.ui.specifics.reader.state(w.ui.specifics.readerSettings),angular.isUndefined(w.ui.specifics.remoteAutoload)||w.ui.specifics.remoteAutoload?(angular.isArray(w.ui.specifics.parentArgs)&&w.ui.specifics.parentArgs.empty(),n(function(){w.ui.specifics.reader.load()["finally"](m)},100,!1)):m()):m()),w.repeated||w.ui.specifics.modal===!0?(w.ui.specifics.remove=function(e){e._state="deleted",d.scope.$emit("itemDelete",e),d.scope.$broadcast("itemDelete",e),O()},w.ui.specifics.manage=function(n,i,f){y(),f=u.alwaysObject(f),l.open({popFrom:f&&f.target?u.clicks.realEventTarget(f.target):void 0,template:t.get(w.ui.specifics.templateUrl||"core/fields/manage_structured.html")({config:w}),inDirection:f.inDirection,outDirection:f.outDirection,controller:["$scope","modelsUtil",function(t,l){var m,h;t.config=w,t.isNew=n?!1:!0,t.container={action:r.url},h=function(){return w.ui.specifics.toolbar["title"+(t.isNew?"Add":"Edit")]},w._title_.push(h),t.$watch("isNew",function(){w.ui.specifics.toolbar.title=u.toolbar.buildTitle(w._title_)}),w.ui.specifics.remote||$.extend(w.ui.specifics.toolbar,{leftIcon:w.ui.specifics.cards?"close":"arrow_back",hideSave:!0}),t.$on("$destroy",function(){w._title_.remove(h),w.ui.specifics.remoteOpts={},w.ui.additionalRealPaths=null}),m=function(t){var r=w.ui.specifics.modal?0:w.ui.specifics.parentArgs?w.ui.specifics.parentArgs.length:0,f={0:[]},m={},h=[],y={},k=function(e,n){var i,r=[],o=t.isNew&&w.repeated;return angular.forEach(n,function(e,t){var n=parseInt(e,10);isNaN(n)||(e=0),r.push(e)}),o&&r.pop(),i=u.getProperty(e.data.entity,r),o&&i.length&&(i=_.findWhere(i,{_state:"created"})),i};angular.forEach(w.ui.specifics.formBuilder,function(e){m[e.code_name]=e}),w.ui.specifics.getScope=function(){return t},t.rootFormSetDirty=O,t.formSetDirty=angular.bind(t,u.form.setDirty),t.formSetPristine=angular.bind(t,u.form.setPristine),t.response=null,n?!w.ui.specifics.modal&&n.ui&&(r=_.last(n.ui.access)):(n={kind:w.modelclass_kind,_sequence:r},l.normalize(n,w.modelclass,w.ui.specifics.entity,w.code_name,r),angular.isDefined(i)&&$.extend(n,i)),angular.isDefined(n.ui)&&(n.ui.access=angular.copy(w.ui.realPath),w.ui.specifics.modal||n.ui.access.push(r)),t.layouts={groups:[{label:!1}]},t.formBuilder=f,t.liveArg=n,t.args=angular.copy(t.liveArg),t.parentArgs=w.ui.specifics.parentArgs,t.rootScope=w.ui.specifics.rootScope,t.entity=w.ui.specifics.entity,w.ui.specifics.remote?t.close=angular.bind(t,u.form.leave,function(){var e=t.$close();return w.ui.specifics.afterClose&&w.ui.specifics.afterClose(t),e}):(t.close=function(){if(!t.container.form.$dirty)return t.$close();var e=t.save();return e?e.then(function(){return t._close_=void 0,t.$close()}):p.confirm("discardWithFieldsRequired",t.$close)},t._close_=t.close),t.validateForm=angular.bind(t,u.form.validate),t.$on("$destroy",function(){w.ui.specifics.getScope=void 0}),w.ui.specifics.layoutConfig&&(delete f[0],t.layouts={groups:[]},angular.forEach(w.ui.specifics.layoutConfig,function(e,n){var i=m[e.fields[0]];t.layouts.groups.push({label:e.label||i.label||c("humanized")(i.code_name)})})),v=function(e){var t,n,i=w.ui.specifics.layoutConfig;for(n=i.length-1;n>=0;n--)if(-1!==$.inArray(e.code_name,i[n].fields)){t=n;break}return t},angular.forEach(w.ui.specifics.formBuilder,function(n){var i,o,a;return u.fields.applyGlobalConfig(n),n.ui.initialRealPath?n.ui.realPath=angular.copy(n.ui.initialRealPath):n.ui.initialRealPath=angular.copy(n.ui.realPath),n.ui.realPath.pop(),w.ui.specifics.modal||n.ui.realPath.push(r),n.ui.realPath.push(n.code_name),n.ui.groupBy?(n.ui.hideMessages=!0,y[n.ui.groupBy]||(i={ui:{group:{help:n.ui.groupHelp,label:n.ui.groupLabel,name:n.ui.groupBy,fields:[],messages:function(){var e={help:!0};return angular.forEach(i.ui.group.fields,function(t){t.ui.form.hasErrors()&&t.ui.form.field().$dirty&&(e=t.ui.form.messages())}),e},shouldShowMessages:function(){return!0}}}},y[n.ui.groupBy]=i,h.push(n.ui.groupBy),w.ui.specifics.layoutConfig?(a=v(n),angular.isDefined(f[a])||(f[a]=[]),f[a].push(i)):f[0].push(i)),void y[n.ui.groupBy].ui.group.fields.push(n)):w.ui.specifics.layoutConfig?(a=v(n),angular.isDefined(f[a])||(f[a]=[]),void f[a].push(n)):void(u.fields.isFieldset(n)&&e[n.type]?(o={label:n.ui.label||c("humanized")(n.code_name)},_.string.contains(n.type,"Remote")&&(o.include="core/misc/action.html",o.action=function(){var e=!0;n.ui.specifics&&n.ui.specifics.canOpen&&(e=n.ui.specifics.canOpen()),e&&p.fields.remote(t,n)}),t.layouts.groups.push(o),a=t.layouts.groups.length-1,angular.isDefined(f[a])||(f[a]=[]),f[a].push(n)):f[0].push(n))}),w.ui.specifics.remote?(t.rootArgs=b,t.setAction=function(e){t.sendRootArgs.action_id=e},t.sendRootArgs={},t.save=function(e){if(!t.validateForm())return!1;var i,r=function(){var e,n,i,r={},a=t.rootArgs,s=t.args.ui.access,c=[];a=angular.copy(a),u.setProperty(a,s,t.args),w.ui.additionalRealPaths&&angular.forEach(w.ui.additionalRealPaths,function(e){u.setProperty(a,e,t.args)}),t.sendRootArgs=a,angular.forEach(t.rootScope.config.fields,function(e){_.string.contains(e.type,"RemoteStructured")&&e.code_name!==t.args.ui.access[0]&&delete a[e.code_name]}),a.read_arguments=r,angular.forEach(s,function(t,n){if(!angular.isDefined(r[t])&&isNaN(parseInt(t,10))&&(r[t]={config:{}},r=r[t],c.push(t)),a=a[t],angular.isArray(a))e=a;else{var i,o,s=c.join(".");w.ui.specifics.remoteOpts.read&&w.ui.specifics.remoteOpts.read[s]&&(i=w.ui.specifics.remoteOpts.read[s]),angular.isDefined(e)&&(o=e.concat(),e.empty(),e.push(a),i&&i(o,e),o=null,e=void 0),null!==a.key&&angular.isDefined(a.key)&&(angular.isDefined(r.config.keys)||(r.config.keys=[]),r.config.keys.push(a.key))}}),(i=function(e,t){e&&e.key?(n=o.getFields(e.kind),angular.forEach(n,function(n){if(n.is_structured&&_.string.contains(n.type,"RemoteStructured")){var r=[],o={config:{keys:r}};n.repeated&&angular.forEach(e[n.code_name],function(e){e.key&&(r.push(e.key),i(e,o))}),t[n.code_name]=o}})):angular.isArray(e)&&angular.forEach(e,function(e){i(e,t)})})(a,r)};return r(),w.ui.specifics.beforeSave&&w.ui.specifics.beforeSave(t),i=a[t.sendRootArgs.action_model].actions[t.sendRootArgs.action_id](t.sendRootArgs,{activitySpinner:!0}),i.then(function(i){t.response=i;var o,a=angular.copy(t.args.ui.access);o=w.ui.specifics.remoteOpts.response?w.ui.specifics.remoteOpts.response(i):k(i,a),$.extend(t.args,o),t.args.ui.access=a,t.isNew&&(w.repeated&&t.parentArgs.unshift(t.args),t.isNew=!1),$.extend(n,t.args),r(),angular.isDefined(w.ui.specifics.afterSave)&&w.ui.specifics.afterSave(t),t.formSetPristine(),e||g.showK("changesSaved")},function(e){angular.isDefined(w.ui.specifics.afterSaveError)&&w.ui.specifics.afterSaveError(t,e)}),i},t.uploadStart=function(){t.activitySpinner.start()},t.uploadEnd=function(){t.activitySpinner.stop()},t.uploadComplete=function(e){t.response=e;var n=angular.copy(t.args.ui.access),i=k(e,n);$.extend(t.args,i),t.args.ui.access=n,angular.isDefined(w.ui.specifics.afterUploadComplete)&&w.ui.specifics.afterUploadComplete(t),t.formSetPristine(),g.showK("changesSaved")},t.noComplete=function(){angular.isDefined(w.ui.specifics.noComplete)&&w.ui.specifics.noComplete(t),t.formSetPristine()},t.uploadError=function(e){angular.isDefined(w.ui.specifics.afterUploadError)&&w.ui.specifics.afterUploadError(t,e),t.formSetPristine()}):t.save=function(){if(!t.validateForm())return!1;t.container.form.$dirty&&t.rootFormSetDirty();var e=null,n=s.defer(),i=n.promise,r=function(){var e=null,i=0;w.repeated&&(t.isNew?(t.parentArgs.unshift(t.args),t.isNew=!1,i=t.parentArgs.length-1,angular.forEach(t.parentArgs,function(e,t){t=i-t,e._sequence=t,e.sequence=t})):$.extend(t.liveArg,t.args)),angular.isFunction(w.ui.specifics.afterSave)&&(e=w.ui.specifics.afterSave(t,d)),e&&e.then?e.then(function(){t.formSetPristine(),n.resolve(),w.closeAfterSave&&t.close()}):(t.formSetPristine(),n.resolve(),w.closeAfterSave&&t.close())};return angular.isFunction(w.ui.specifics.beforeSave)&&(e=w.ui.specifics.beforeSave(t,d)),e&&e.then?e.then(r):r(),i},w.ui.specifics.scope&&$.extend(t,w.ui.specifics.scope),angular.isFunction(w.ui.specifics.init)&&w.ui.specifics.init(t),angular.forEach(w.ui.specifics.fields,function(e){e._title_=w._title_.concat()})},angular.isFunction(n)?t.$state.promise(n,function(e,t){n=t.arg,i=t.defaultArgs,f=t.modalSettings,m(e)}):t.$state.instant(function(){m(t)})}]})},angular.isUndefined(w.ui.specifics.create)&&(w.ui.specifics.create=w.ui.specifics.manage),d.scope.$on("$destroy",function(){w.ui.specifics.create=void 0,w.ui.specifics.sortableOptions={}})):w.ui.specifics.SingularCtrl=["$scope",function(e){e.args=w.ui.specifics.parentArgs,d.scope.$watchCollection(w.ui.args,function(t,n){$.extend(e.args,t)}),w.ui.specifics.getScope=function(){return e};var t=function(){return w.ui.specifics.toolbar.titleEdit};w._title_.push(t),angular.forEach(w.ui.specifics.fields,function(e){e._title_=w._title_.concat()}),e.$on("$destroy",function(){w._title_.remove(t),w.ui.specifics.getScope=void 0})}],"structured_"+(w.repeated?"repeated":"single")},_RemoteStructuredPropery:function(e){var t=e.config;t.ui.specifics.remote=!0},SuperStructuredProperty:function(e){return this.SuperLocalStructuredProperty(e)},SuperRemoteStructuredProperty:function(e){this._RemoteStructuredPropery(e);var t=this.SuperLocalStructuredProperty(e);return t},SuperImageLocalStructuredProperty:function(e){return this.SuperLocalStructuredProperty(e),e.config.ui.specifics.displayImageConfig||(e.config.ui.specifics.displayImageConfig={size:360}),e.config.ui.specifics.sortableOptions||(e.config.ui.specifics.sortableOptions={}),$.extend(e.config.ui.specifics.sortableOptions,{axis:!1,containment:!1}),"image"},SuperImageStructuredProperty:function(e){return e.config.ui.specifics.sortableOptions||(e.config.ui.specifics.sortableOptions={}),$.extend(e.config.ui.specifics.sortableOptions,{axis:!1,containment:!1}),this.SuperImageLocalStructuredProperty(e)},SuperImageRemoteStructuredProperty:function(e){this._RemoteStructuredPropery(e);var t=this.SuperImageLocalStructuredProperty(e);return t}})}])}(),function(){"use strict";angular.module("app").run(["helpers",function(e){e.grid={calculate:function(e,t,n,i){var r,o,a,s,c,l,u=t-n,d=[];for(r=0;u>r&&(o=t-r,a=e/o,s=Math.floor(a),o=e/s,o>t&&(s+=1,o=e/s,n>o&&(s-=1,o=t)),c=Math.floor(o),l=Math.floor(e%(c*s)/2),c-=2*i,d=[c,s,l],!(a>4||1===s));r++);return d}},e.gridStacked={getHeight:function(e,t,n){n=2*n,t-=e.length*n;var i=0;return angular.forEach(e,function(e){i+=e.proportion}),t/i},setHeight:function(e,t){angular.forEach(e,function(e){e.width=t*e.proportion,e.height=t})},resize:function(e,t){this.setHeight(e,this.getHeight(e,t))},calculate:function(e,t,n,i){var r,o,a,s=0,c=t;e:for(;t.length>0;){for(r=1;r<t.length+1;++r)if(o=t.slice(0,r),a=this.getHeight(o,e,i),n>a){this.setHeight(o,a),s++,t=t.slice(r);continue e}this.setHeight(o,Math.min(n,a)),s++;break}return c}}}]).directive("gridStacked",["helpers","$timeout",function(e,t){return{link:function(n,i,r){var o=function(){var t=0,o=function(o){var a=i.width(),s=[],c=1;!a||o&&t===a||(angular.forEach(n.$eval(r.gridStacked),function(e){"deleted"!==e._state&&s.push(angular.copy(e))}),e.gridStacked.calculate(a,s,240,c),i.find(".grid-item").filter(function(){return"none"!==$(this).css("display")}).each(function(e){angular.isDefined(s[e])&&($(this).css({width:s[e].width,height:s[e].height}).addClass("visible"),$(this).find("img").css({height:s[e].height}))}))};o(),setTimeout(function(){o(!0)},50)};o=_.throttle(o,100),n.$on("modalResize",o),n.$on("itemOrderChanged",o),n.$on("itemOrderSorting",o),n.$on("ngRepeatEnd",o),n.$on("itemDelete",function(){t(o,0,!1)}),n.$watch(r.gridStacked+".length",function(){t(o,0,!1)})}}}]).directive("gridGenerator",["GLOBAL_CONFIG","helpers","$timeout",function(e,t,n){return{link:function(n,i,r){var o=n.$eval(r.gridGenerator)||{},a=o.margin||0,s=o.maxWidth||e.grid.maxWidth,c=o.minWidth||e.grid.minWidth,l=o.maxHeight||e.grid.maxHeight,u=o.fixedHeight,d=angular.isDefined(o.square)?o.square:!0,p=function(){if(i=$(i),i.length){var e,n=i,r=n.width();r&&(e=t.grid.calculate(r,s,c,a),(n.css("paddingLeft")!==e[2]||n.css("paddingRight")!==e[2])&&n.css({paddingRight:e[2],paddingLeft:e[2]}),n.find(".grid-item").filter(function(){return"none"!==$(this).css("display")}).each(function(){var n,i=u?u:t.newHeightByWidth(s,l,e[0]);(e[0]!==$(this).width()||$(this).height()!==i)&&(n=$(this).width(e[0]),d?n.height(e[0]):$(this).height(i)),$(this).addClass("visible")}))}};p=_.throttle(p,100),$(window).bind("resize",p),n.$on("ngRepeatEnd",p),n.$on("itemDelete",p),n.$watch(r.gridGeneratorItems+".length",p),n.$on("$destroy",function(){$(window).off("resize",p)})}}}]).directive("gridScale",["helpers","$timeout","GLOBAL_CONFIG",function(e,t,n){return{controller:["$scope","$element",function(t,n){var i=this,r=0;i.items=[],i.config={},i.columns=1,i.calc=[],i.getColumns=function(){var t=e.grid.calculate(n.width(),i.config.maxWidth,i.config.minWidth,i.config.margin);i.columns=t[1],i.calc=t},i.add=function(e){r+=1,i.items.push(e),i.calculate(e),r===i.columns&&(r=0)},i.remove=function(e){i.items.remove(e),i.resize()},i.calculate=function(e){return i.columns<2&&n.width()>i.config.maxWidth?(e.css("width","calc((100%) - "+2*i.config.margin+"px)"),void n.css({marginLeft:i.calc[2],marginRight:i.calc[2]})):(n.css({marginLeft:"",marginRight:""}),void e.css("width","calc(("+100/i.columns+"%) - "+2*i.config.margin+"px)"))},i.resize=function(e){i.getColumns(),angular.forEach(i.items,function(e){i.calculate(e)})},i.resize=_.throttle(i.resize,100),$(window).on("resize",i.resize),t.$on("$destroy",function(){$(window).off("resize",i.resize)})}],link:function(e,t,i,r){$.extend(r.config,n.grid,e.$eval(i.gridScale)||{}),r.getColumns()}}}]).directive("gridScaleItem",["helpers",function(e){return{require:"^gridScale",link:function(e,t,n,i){var r=function(e,n){if(n){var i=n.parents("[grid-scale-item]:first");i.length&&i.get(0)===t.get(0)&&t.addClass("visible")}else t.addClass("visible")},o=e.$eval(n.gridScaleItem)||{};i.add(t),o.image?e.$on("displayImageLoaded",r):setTimeout(r,50),e.$on("$destroy",function(){i.remove(t)})}}}])}(),function(){"use strict";angular.module("app").run(["helpers","$mdConstant","GLOBAL_CONFIG",function(e,t,n){$.extend(e,{clicks:{realEventTarget:function(e){var t=$(e),n=t.parents(".grid-item:first"),i=t.parents(".card:first");return!t.hasClass("grid-item")&&n.length&&(e=n.get(0)),i.length&&(e=i.get(0)),e}},closestLargestNumber:function(e,t){var n=Math.max.apply(null,e),i=0;for(i=0;i<e.length;i++)e[i]>t&&e[i]<n&&(n=e[i]);return n},newWidthByHeight:function(e,t,n){var i;return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),i=n/t,e*i},newHeightByWidth:function(e,t,n){var i;return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),i=n/e,t*i},popup:{openCentered:function(e,t){var n,i=$(window).width()/1.3,r=$(window).height()/1.3,o=screen.width/2-i/2,a=screen.height/2-r/2;return n=window.open(e,t,"width="+i+", height="+r+", top="+a+", left="+o),n.focus(),n}},url:{abs:function(e){return n.host+"/"+e},handleProtocol:function(e){return"https:"===document.location.protocol||"chrome-extension:"===document.location.protocol?e.replace("http://","https://"):e},urlsafe:function(e){return window.btoa(e).replace(new RegExp("=","g"),"-")},urlunsafe:function(e){return window.atob(e.replace(new RegExp("-","g"),"="))},jsonFromUrlsafe:function(t){return angular.fromJson(e.url.urlunsafe(t))},jsonToUrlsafe:function(t){return e.url.urlsafe(angular.toJson(t))}}});var i=function(e,n){return $(this).on(t.CSS.ANIMATIONEND,function i(r){r.target===this&&(n.call(this,r),"one"===e&&$(this).off(t.CSS.ANIMATIONEND,i))})};$.fn.oneAnimationEnd=function(e){return i.call(this,"one",e)},$.fn.onAnimationEnd=function(e){return i.call(this,"on",e)}}]).directive("fillEmptySpace",function(){return{link:function(e,t,n){var i=function(){var e=parseInt(t.css("marginTop"),10);t.css("min-height",$(window).height()-e)};i(),$(window).resize(i),e.$on("$destroy",function(){$(window).unbind("resize",i)})}}}).directive("onEnter",["$parse","helpers","$mdConstant",function(e,t,n){return{link:function(i,r,o){var a=e(o.onEnter);r.on("keydown",function(e){t.responsive.isMobile()||t.responsive.isTablet()||e.keyCode!==n.KEY_CODE.ENTER||e.shiftKey||(e.preventDefault(),a(i,{$event:e}),$(this).val(""))})}}}]).directive("helpRender",function(){return{scope:{help:"=helpRender"},templateUrl:"core/misc/help_render.html",link:function(e,t,n){e.isTemplate=function(){return!angular.isArray(e.help)}}}}).directive("displayImage",["GLOBAL_CONFIG","helpers","$http",function(e,t,n){return{scope:{image:"=displayImage",config:"=displayImageConfig"},link:function(i,r,o){var a,s;i.config||(i.config={}),angular.isDefined(i.config.size)||(i.config.size=240),s=function(o,s){if(o!==s){window.isChromeApp&&a&&URL.revokeObjectURL(a);var c=r,l=function(){c.css("visibility","inherit"),i.$emit("displayImageLoaded",c)},u=function(){var t=i.config.defaultImage;t||(t="defaultImage"),c.attr("src",e[t]),l()};i.image&&i.image.serving_url?(a=t.url.handleProtocol(i.image.serving_url)+(i.config.size===!0?"":"=s"+i.config.size),c.on("load",l).on("error",u),window.isChromeApp?n.get(a,{responseType:"blob"}).success(function(e){a=URL.createObjectURL(e.data),c.attr("src",a)}).error(u):c.attr("src",a)):setTimeout(function(){u(),l()},50)}},i.$watch("image.serving_url",s),s(!0,!1)}}}]).directive("loading",["$parse",function(e){return{link:function(t,n,i){angular.isDefined(i.loading)&&t.$watch(i.loading,function(e){e?n.attr("disabled","disabled"):n.removeAttr("disabled")});var r=function(e){return e.stopImmediatePropagation(),e.preventDefault(),!1},o=angular.isDefined(i.loading)?e(i.loading):function(){return!1};t.$on("disableUI",function(e,i){o(t)||(i===!0?(n.attr("disabled","disabled"),n.on("click",r)):(n.removeAttr("disabled"),n.off("click",r)))})}}}]).directive("onNgRepeatEnd",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){e.$last===!0&&e.$evalAsync(function(){e.$emit("ngRepeatEnd")})}}}]).directive("defaultFieldDisplay",["$compile",function(e){return{scope:{val:"=defaultFieldDisplay"},templateUrl:"buyer/address_display.html",controller:["$scope",function(e){e.notEmpty=function(e){return angular.isString(e)||angular.isNumber(e)}}]}}]).directive("draggableClick",["$parse","helpers",function(e,t){return{restrict:"A",link:function(t,n,i){var r=e(i.draggableClick),o=function(e,i){return n.hasClass("dragged")&&!i?void n.removeClass("dragged"):void t.$apply(function(){r(t,{$event:e})})};n.on("click",o),t.$on("$destroy",function(){n.off("click",o)})}}}]).directive("loadMoreButton",function(){return{restrict:"A",templateUrl:"core/misc/load_more_button.html",scope:{config:"=loadMoreButton"},link:function(e,t){e.$watch("config.firstLoad",function(e,n){if(e===!1||e===!0){var i=t.parents(".modal:first"),r=i.find("content-spinner").find(":first");if(!r.length){if(i.length)return;r=$("body content-spinner:first").find(":first")}e===!0?r.removeClass("ng-hide"):e===!1&&r.addClass("ng-hide")}})}}}).directive("autoloadOnVerticalScrollEnd",["$timeout",function(e){return{restrict:"A",link:function(t,n,i){var r,o,a,s,c,l,u,d,p,f,g=!1,m=!1;r=t.$eval(i.autoloadOnVerticalScrollEnd),f=function(){o=function(){var e=r.listen;if(e)e=$(r.listen||window);else{if(e=n.parents(".ui-view-wrapper:first"),e.length)return e;e=n.parents("md-content[md-scroll-y]:first"),n.hasClass("overflow-y")||n.hasClass("overflow-auto-y")?e=n:(e.length||(e=n.parents(".overflow-y:first")),e.length||(e=n.parents(".overflow-auto-y:first")))}return e}(),u=function(){e.cancel(p),p=e(function(){var e,t,n=o.get(0),i=n.scrollHeight,s=$(window).height()-56;r.reverse?e=n?o.scrollTop()<(r.top||40):!1:(console.log(s,s-i),e=n?s>=i||s-i>-10:!1),o.length&&n&&(e?(t=a({},angular.noop),t&&t.then(function(){r.reverse||u()})["finally"](function(){g=!1})):g=!1)},1e3,!1)},d=function(){clearInterval(c),c=setInterval(function(){return g?!0:(g=!0,void u())},2e3)},a=function(e,t){if(r.loader&&angular.isFunction(r.loader.load)){var n=r.loader.load();return n?(n.then(function(){t()}),n):(t(),!1)}},l={conditions:{"max-bottom":r.bottom||40},scrollElement:o.get(0),throttle:100,handler:a},r.reverse&&delete l.conditions,s=new Steady(l),r.reverse&&(s.addTracker("checkTop",function(){return o.scrollTop()<(r.top||40)}),s.addCondition("checkTop",!0)),t.$on("$destroy",function(){s.stop(),s=void 0,clearInterval(c),e.cancel(p)}),r.watch?t.$watchGroup(angular.isArray(r.watch)?r.watch:[r.watch],function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&(u(),d())}):(u(),d())},t.$watch(function(){return i.autoloadOnVerticalScrollEnd&&r&&r.loader},function(t,n){t&&!m&&e(function(){m=!0,f()})})}}}]).directive("resizeChart",["helpers",function(e){return{priority:100,link:function(t,n,i){var r=function(){var t=$(n).width(),i=e.newHeightByWidth(640,260,t);$(n).height(i)};r(),t.$on("modalResize",r)}}}]).directive("listButton",function(){return{templateUrl:"core/misc/list_button.html",transclude:!0,replace:!0}}).directive("mdInkRippleList",["$mdInkRipple",function(e){return{link:function(t,n,i){e.attach(t,n,{dimBackground:!0,multiplier:.1,moveToCenter:!1})}}}]).directive("mdInkRippleAction",["$mdInkRipple",function(e){return{link:function(t,n,i){e.attachButtonBehavior(t,n,{dimBackground:!1})}}}]).directive("mdInkRippleFit",["$mdInkRipple",function(e){return{link:function(t,n,i){e.attachButtonBehavior(t,n,{dimBackground:!1,fitRipple:!0,moveToCenter:!1})}}}]).directive("icon",["$mdInkRipple",function(e){return{templateUrl:"core/misc/icon.html",replace:!0,transclude:!0,scope:!0,link:function(e,t,n){e.icon=n.type,e.color=n.color||"normal"}}}]).directive("contentListView",function(){return{scope:{val:"=contentListView"},templateUrl:"core/misc/content_list_view.html"}}).directive("sidenavItem",["$timeout","$mdSidenav",function(e,t){return{templateUrl:"core/misc/sidenav_item.html",transclude:!0,replace:!0}}]).filter("labelize",["GLOBAL_CONFIG","$log",function(e,t){return function(n,i){if(void 0===n||null===n)return n;angular.isUndefined(i)&&(i="default");var r,o=e.labels[i];return angular.isUndefined(o)?(t.warn("Group is not defined: "+i),n):(r=o[n],angular.isDefined(r)?r:(t.warn("Path for label not found: "+i+"."+n),n))}}]).filter("propsFilter",function(){return function(e,t){var n=[];return angular.isArray(e)?e.forEach(function(e){var i,r,o,a=!1,s=Object.keys(t);for(i=0;i<s.length;i++)if(r=s[i],o=t[r].toLowerCase(),-1!==e[r].toString().toLowerCase().indexOf(o)){a=!0;break}a&&n.push(e)}):n=e,n}}).filter("capitalize",function(){return function(e){return _.str.capitalize(e)}}).filter("output",["modelsMeta","outputTypes","$cacheFactory",function(e,t,n){var i=t,r=n("cacheFields"),o=function(t){return r.get(t)||r.put(t,e.getFields(t)),r.get(t)};return function(e,t,n){var r,a,s,c=e[t];if(e.kind&&(r=o(e.kind),a=r[t],angular.isDefined(a))){if(s=i[a.type],angular.isDefined(s))return s(c,a);if(c&&"object"==typeof c&&c.hasOwnProperty("name"))return c.name}return c}}]).filter("escape",function(){return function(e){return e?_.escape(e):e}}).filter("autobr",["helpers",function(e){return function(e){return e?e.replace(/\n\r?/g,"<br />"):e}}]).filter("formatCurrency",["$injector","$locale",function(e,t){var n=e.get("$filter"),i=n("number"),r=t.NUMBER_FORMATS;return r.DEFAULT_PRECISION=angular.isUndefined(r.DEFAULT_PRECISION)?2:r.DEFAULT_PRECISION,function(e,t){if(e=parseFloat(e,10),!angular.isNumber(e)||isNaN(e))return"";var n,r,o,a,s,c,l,u=0>e;return e=Math.abs(e),n=i(e,t.digits),r="<"+n+">",o=t.symbol,o&&(a=u&&t.negative_currency_symbol_precedes||t.positive_currency_symbol_precedes,s=u&&t.negative_separate_by_space||t.positive_separate_by_space,r=a?o+(s?" ":"")+r:r+(s?" ":"")+o),c=u&&t.negative_sign_position||t.positive_sign_position,l=u&&t.negative_sign||t.positive_sign,l||(l=""),0===c?r="("+r+")":1===c?r=l+r:2===c?r+=l:r=3===c?r.replace("<",l):4===c?r.replace(">",l):l+r,r=r.replace("<","").replace(">","")}}]).filter("substr",function(){return function(e){return angular.isString(e)?String.prototype.substr.apply(e,Array.prototype.slice.call(arguments,1)):e}}).filter("nl2br",function(){return function(e){return void 0!==e?e.replace(/\n/g,"<br />"):void 0}}).filter("highlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");

}return function(t,n){return n&&t?t.replace(new RegExp(e(n),"gi"),'<span class="ui-select-highlight">$&</span>'):t}}).factory("outputTypes",["dateFilter","GLOBAL_CONFIG","modelsMeta",function(e,t,n){var i={SuperDateTimeProperty:function(n,i){var r=new Date(n),o=new Date,a=o.getYear()===r.getYear(),s=!1,c=!1,l=t.date.format;return a||(l="d MMM yyyy, HH:mm"),a&&(s=r.getMonth()===o.getMonth(),l="d MMM, HH:mm"),s&&a&&r.getDate()===o.getDate()&&(c=!0,l="HH:mm"),e(r,l)}};return i}]).factory("searchBuilder",["modelsMeta","GLOBAL_CONFIG",function(e,t){var n=function(){var n={kind:null,hide:!1,filters:{},indexes:[],indexID:null,fields:{indexID:{type:"SuperStringProperty",choices:[],code_name:"indexID",required:!0,ui:{args:"search.indexID",label:t.fields.label.search.indexID,specifics:{translatedChoices:!1},writable:!0,attrs:{"ng-change":"search.makeFilters()"}}},ancestor:{type:"SuperStringProperty",code_name:"ancestor",required:"search.indexes[search.indexID].ancestor",ui:{args:"search.send.ancestor",label:t.fields.label.search.ancestor,writable:!0}},filters:[],orders:[]},mapIndexes:function(e){angular.forEach(e,function(e,t){e._index=t})},formatSearchFilter:function(e){var t,n="";return e&&angular.isObject(e)?(e.ancestor&&!e.filters&&(n+="Ancestor and "),e.filters&&(n+="Filter by ",e.ancestor&&(n+="ancestor and "),t=$.map(e.filters,function(e){return e[0]}),n+=t.join(" and "),e.orders&&(n+=" and ")),e.orders&&(n+=" order by "+$.map(e.orders,function(e){return e[0]}).join(", ")),n):e},resetFilters:function(){this.send.filters=[],this.send.orders=[],delete this.send.ancestor},changeKindUI:function(){this.changeKind(),this.setSearch(this.kind,void 0),this.makeFilters()},changeKind:function(){var t,n,i=e.getActionArguments(this.kind,"search"),r=this;if(i){try{t=i.search,this.default_send=t["default"]}catch(o){}t?this.hide=!1:(this.hide=!0,t={}),n=t.cfg,this.cfg=n,this.send.kind=this.kind,this.filters=n.filters||{},this.indexes=n.indexes||[],this.indexID=null,this.mapIndexes(n.indexes),r.fields.indexID.choices=[],angular.forEach(n.indexes,function(e){var t={key:e._index,name:r.formatSearchFilter(e)};r.fields.indexID.choices.push(t)})}},changeOrderBy:function(e){e.field=this.indexes[this.indexID].orders[e._index][0]},makeFilters:function(e){var n,i,r,o=this;angular.isDefined(e)||(e=!0),e&&this.resetFilters(),o.fields.filters=[],o.fields.orders=[],n=o.indexes[o.indexID],angular.forEach(n.filters,function(n,a){i=o.filters[n[0]],i.required="search.indexID != null && search.send.filters.length",i.code_name="filter_"+n[0],i.ui={args:"search.send.filters['"+a+"'].value",writable:!0},e&&o.send.filters.push({field:n[0],operator:n[1][0],value:i["default"]?i["default"]:"",_index:a}),r={type:"SuperStringProperty",choices:n[1],code_name:"op_"+a,required:i.required,ui:{label:t.fields.label.search.operator,writable:!0,args:"search.send.filters['"+a+"'].operator"}},o.fields.filters.push([r,i])}),angular.forEach(n.orders,function(t,n){e&&o.send.orders.push({field:t[0],operator:t[1][0],_index:n}),i={type:"SuperStringProperty",choices:t[1],code_name:"order_by_"+t[0],required:"search.indexID != null && search.send.filters.length",ui:{writable:!0,args:"search.send.orders['"+n+"'].operator"}},o.fields.orders.push(i)}),n.orders||(o.send.orders=[])},discoverIndexID:function(){var e=this,t=this.send.filters,n=this.send.ancestor,i=this.send.orders;angular.forEach(this.indexes,function(r,o){if(!(n&&!r.ancestor||!n&&r.ancestor)){var a=!0,s=0,c=0;r.filters&&(a=!1,t&&t.length&&(angular.forEach(r.filters,function(e){var n=_.findWhere(t,{field:e[0]});n&&-1!==$.inArray(n.operator,e[1])&&(s+=1)}),t.length===s&&r.filters.length===t.length&&(a=!0,e.indexID=o))),angular.forEach(r.orders,function(e,t){var n=_.findWhere(i,{field:e[0]});a&&n&&-1!==$.inArray(n.operator,e[1])&&(c+=1,n._index=t)}),a&&r.orders&&c===i.length&&r.orders.length===i.length&&(e.indexID=o)}})},setSearch:function(t,n){if(void 0===t||null===t)return void(this.hide=!0);this.kind!==t&&(this.kind=t,this.changeKind(),this.resetFilters());var i=e.getActionArguments(this.kind,"search"),r=null;if(i){try{r=i.search}catch(o){}r&&(void 0===n&&r["default"]?this.send=r["default"]:n&&(this.send=n),this.discoverIndexID(),this.makeFilters(!1))}else this.hide=!0},doSearch:function(){throw new Error("Not implemented")},submitSearch:function(){this.doSearch()},send:{filters:[],orders:[]}};return n};return{create:n}}]).factory("channelApi",["GLOBAL_CONFIG",function(e){var t={instances:{},create:function(e){if(!t.instances[e]){var n;n={callbacks:{},events:{},signals:[],socket:null,afterOnclose:[],onclose:function(e){this.afterOnclose.unshift(e)},channel:new goog.appengine.Channel(e),open:function(e){var t=this;return angular.forEach(e,function(e,n){t[n](e)}),null!==t.socket?t:(t.socket=t.channel.open(t.events),console.log("socket.open",t.socket),t.socket.onclose=function(){angular.forEach(t.afterOnclose,function(e){e()})},t)},destroy:function(){delete t.instances[e]},queue:function(e,t){var n=this.signals.length;this.signals.push(n),this.callbacks[e].push([t,n])},dispatch:function(e,t){var n=this,i=[];angular.forEach(this.callbacks[e],function(e){return-1===$.inArray(e[1],n.signals)?void i.push(e):(t=_.toArray(t),t.push(function(){n.signals.remove(e[1])}),void e[0].apply(n.socket,t))}),i&&(angular.forEach(i,function(t){n.callbacks[e].remove(t)}),i=[]),n.signals.length||n.socket.close()}},angular.forEach(["onopen","onmessage","onerror"],function(e){n.callbacks[e]=[],n[e]=function(t){this.queue(e,t)},n.events[e]=function(){n.dispatch(e,arguments)}}),n.afterOnclose.push(function(){n.destroy()}),t.instances[e]=n}return t.instances[e]}};return e.debug&&(window._channelApi=t),t}]).factory("channelNotifications",["channelApi","snackbar",function(e,t){var n={instances:{},create:function(n,i){var r;return r=e.create(n),r.open({onmessage:function(e,n){if(n(),angular.isObject(e)&&e.data)try{var r=angular.fromJson(e.data);i?i(r):t.show(r.body)}catch(o){console.warn("channel callback could not execute, got error",o,"with data",e)}else console.warn("channel returned no parsable data, got",e)}}),r}};return n}]).directive("contentSpinner",function(){return{templateUrl:"core/misc/content_spinner.html",link:function(e,t){var n=function(){return t.find(":first")},i=0,r=function(){i-=1,1>i&&n().addClass("ng-hide")},o=function(){i+=1,n().removeClass("ng-hide")};e.contentSpinner.hide.push(r),e.contentSpinner.show.push(o),e.$on("$destroy",function(){e.contentSpinner.hide.remove(r),e.contentSpinner.show.remove(o)})}}}).directive("activitySpinner",["$animate",function(e){return{scope:!0,templateUrl:"core/misc/activity_spinner.html",link:function(t,n){t.raised=!0,t.slide=!0;var i=function(){return n.find(":first")},r=0,o=function(){return i().find(".slide")},a=function(t){if(r-=1,!i().hasClass("ng-hide")&&1>r){var n=o();if(n.length){if(t)return n.removeClass("in").addClass("out"),void i().addClass("ng-hide");e.addClass(n,"out").then(function(){i().addClass("ng-hide"),n.removeClass("in")})}}},s=function(){i().removeClass("ng-hide"),o().length&&(r+=1,e.removeClass(o(),"out").then(function(){return e.addClass(o(),"in")}))};t.activitySpinner.hide.push(a),t.activitySpinner.show.push(s),t.$on("$destroy",function(){t.activitySpinner.hide.remove(a),t.activitySpinner.show.remove(s)})}}}]).directive("collapse",["$animate",function(e){return{link:function(t,n,i){function r(){n.removeClass("collapse").addClass("collapsing"),e.addClass(n,"in",{to:{height:n[0].scrollHeight+"px"}}).then(o)}function o(){n.removeClass("collapsing"),n.css({height:"auto"})}function a(){n.css({height:n[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing"),e.removeClass(n,"in",{to:{height:"0"}}).then(s)}function s(){n.css({height:"0"}),n.removeClass("collapsing"),n.addClass("collapse")}t.$watch(i.collapse,function(e){e?a():r()})}}}]).directive("nonBlockingNgClass",["$animate","$rootScope","$$rAF",function(e,t,n){return{link:function(e,i,r){var o={},a=$.now();e.$watch(function(){var t=!1,n=e.$eval(r.nonBlockingNgClass);return o&&angular.forEach(n,function(e,n){o[n]===e||t||(t=$.now()),o[n]=e}),t||a},function(o,a){o!==a&&angular.forEach(e.$eval(r.nonBlockingNgClass),function(e,r){t.$$postDigest(function(){n(function(){i[e?"addClass":"removeClass"](r)})})})})}}}]).directive("whenReady",["$interpolate","$$rAF",function(e,t){return{restrict:"A",priority:Number.MIN_SAFE_INTEGER,link:function(n,i,r){function o(e){console.log("dialog",new Date),e.forEach(function(e){n.$eval(e)})}var a=r.whenReady.split(";"),s=!1,c=!1;0!==r.whenReady.trim().length&&(r.waitForInterpolation&&n.$eval(r.waitForInterpolation)&&(s=!0),r.readyCheck&&(c=!0),s||c?t(function l(){var u=!1,d=!1;u=s&&i.text().indexOf(e.startSymbol())>=0?!1:!0,d=c&&!n.$eval(r.readyCheck)?!1:!0,u&&d?o(a):t(l)}):o(a))}}}])}(),function(){"use strict";var e=function(e){var t=e.popFrom;return t?$(t):t},t=function(e,t){var n=e[0].getBoundingClientRect(),i=t[0].getBoundingClientRect(),r=e.width(),o=e.height(),a=t.width(),s=t.height(),c=a/r,l=1/c,u=s/o,d=1/u,p=-i.left+n.left+n.width/2-i.width/2,f=-i.top+n.top+n.height/2-i.height/2;return{top:f,left:p,scale:{x:l,y:d}}};angular.module("app").factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){var n;for(n=0;n<e.length;n++)if(t===e[n].key)return e[n]},keys:function(){var t,n=[];for(t=0;t<e.length;t++)n.push(e[t].key);return n},top:function(){return e[e.length-1]},remove:function(t){var n,i=-1;for(n=0;n<e.length;n++)if(t===e[n].key){i=n;break}return e.splice(i,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("modalBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,templateUrl:"core/modal/backdrop.html",link:function(t,n,i){t.backdropClass=i.backdropClass||"",e(function(){n.addClass("in")},0,!1)}}}]).directive("modalWindow",["$modalStack","$timeout","$$rAF","$mdConstant","$q","$animate","animationGenerator","$rootScope",function(n,i,r,o,a,s,c,l){return{restrict:"EA",scope:{index:"@",animate:"=",modalOptions:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"core/modal/window.html"},link:function(n,a,s){l.$broadcast("disableUI",!0);var u,d=e(n.modalOptions);a.addClass(n.modalOptions.fullScreen?"":"modal-medium"),s.windowClass&&a.addClass(s.windowClass),n.size=s.size,n.$isRendered=!0,n.$renderComplete=function(){i(u,50,!1)},u=function(){var e,i,s,u,p,f,g=n.modalOptions.inDirection,m=g&&!d,h=d,v=!m&&!h,y=!n.modalOptions.fullScreen;m?e=function(){a.addClass(g+" slide drawer visible in")}:y&&(i=a.find(".modal-dialog"),u=i.width(),p=i.height(),n.modalOptions.resize=_.throttle(function(){var e,t,n=$(window).width()-80,r=$(window).height()-48,o=i.width(),a=i.height(),s=p>=r,c=u>=n;e=s||r>a&&s?r:"",t=c||n>o&&c?n:"",i.css("max-height",e),i.css("max-width",t)},100),n.modalOptions.resize(),$(window).on("resize",n.modalOptions.resize)),d?(s=t(d,a),f=c.single("pop-in","0% {top: "+s.top+"px; left: "+s.left+"px; "+o.RAW_CSS.TRANSFORM+": scale("+s.scale.x+", "+s.scale.y+"); }1% { opacity:1; }75% { top: 0px; left: 0px;}100% { top: 0px; left: 0px; "+o.RAW_CSS.TRANSFORM+": scale(1, 1);opacity:1;}"),e=function(){a.addClass("pop "+f.className).data("animator",f),r(function(){d.css("opacity",0)})}):v&&(e=function(){a.addClass("fade in")}),a.oneAnimationEnd(function(){setTimeout(function(){a.addClass("visible"),$(window).triggerHandler("modal.visible",[a]),n.modalOptions.opened=!0,n.$emit("modalOpened"),n.$broadcast("modalOpened"),n.$apply(),l.$broadcast("disableUI",!1)})}),$(window).triggerHandler("modal.open",[a]),r(e)},s.$observe("modalRender",function(e){"true"===e&&i(u,50,!1)}),n.backdropClose=function(e){n.modalOptions.cantCloseWithBackdrop||e.target===e.currentTarget&&n.$parent.close()}}}}]).directive("modalTransclude",function(){return{link:function(e,t,n,i,r){r(e.$parent,function(e){t.empty(),t.append(e)})}}}).factory("$modalStack",["$timeout","$document","$compile","$rootScope","$$stackedMap","mdContextualMonitor","$mdConstant","$q","animationGenerator","$animate","$$rAF",function(n,i,r,o,a,s,c,l,u,d,p){function f(){return v.length()-1}function g(n,i,r){var o,a,s,l=e(i.modalOptions),d="in",f="out",g=n.data("animator");l&&g&&(o=t(l,n),s=u.single("pop-out","0% { opacity:1;top: 0px; left: 0px; "+c.RAW_CSS.TRANSFORM+": scale(1, 1);}75% { top: 0px; left: 0px;}100% { opacity:1;top: "+o.top+"px; left: "+o.left+"px; "+c.RAW_CSS.TRANSFORM+": scale("+o.scale.x+", "+o.scale.y+"); }"),f=s.className,d=g.className),p(function(){n.removeClass(d).addClass(f)}),a=function(e){n.remove(),r&&r(),l&&l.css("opacity",1),n=void 0,g&&g.destroy(),s&&s.destroy()},n.oneAnimationEnd(a),setTimeout(function(){},600)}function m(e,t){var n=i.find("body").eq(0),r=v.get(e).value,o=r.backdropDomEl,a=r.backdropScope;v.remove(e),o.removeClass("in").addClass("out").oneAnimationEnd(function(){o.remove(),a.$destroy(),r.backdropScope=void 0,r.backdropDomEl=void 0}),g(r.modalDomEl,r.modalScope,function(){r.modalScope.$destroy(),n.toggleClass(h,v.length()>0),$(window).triggerHandler("modal.close"),t.resolve()})}var h="modal-open",v=a.createNew(),y={};return y.open=function(e,t){var n,a,c,l,u,d,p,g={deferred:t.deferred,modalScope:t.scope,backdrop:t.backdrop};v.add(e,g),t.scope.modalOptions={inDirection:t.inDirection,outDirection:t.outDirection,cantCloseWithBackdrop:t.cantCloseWithBackdrop,popFrom:t.popFrom,fullScreen:t.fullScreen,noEscape:t.noEscape,opened:!1},c=i.find("body").eq(0),l=f(),a=o.$new(!0),a.index=l,u=angular.element('<div class="opaque" modal-backdrop></div>'),u.attr("backdrop-class",t.backdropClass),n=r(u)(a),c.append(n),g.backdropDomEl=n,g.backdropScope=a,p=angular.element("<div modal-window></div>"),p.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:v.length()-1,"modal-options":"modalOptions",animate:"animate",exiting:"exiting"}).html(t.content),d=r(p)(t.scope),v.top().value.modalDomEl=d,c.append(d),c.addClass(h),t.noEscape||(e.esc=function(t){var n=v.get(e);return t&&t.preventDefault(),n&&n.value&&n.value.modalScope&&n.value.modalScope._close_?n.value.modalScope._close_():(o.$apply(function(){return n&&n.value&&n.value.modalScope?n.value.modalScope.close():void y.dismiss(e,"escape key press")}),!0)},s.queue(e.esc))},y._dequeue=function(e,t){e&&e.value&&(e.value.modalScope.modalOptions.noEscape||s.dequeue(t.esc),e.value.modalScope.modalOptions.resize&&$(window).off("resize",e.value.modalScope.modalOptions.resize))},y.close=function(e,t,n){n||(n="resolve");var i=v.get(e),r=l.defer();return y._dequeue(i,e),i?(i.value.deferred[n](t),m(e,r)):r.resolve(),r.promise},y.dismiss=function(e,t){return y.close(e,t,"reject")},y.dismissAll=function(e){for(var t=this.getTop();t;)this.dismiss(t.key,e),t=this.getTop()},y.getTop=function(){return v.top()},y}]).provider("$modal",function(){var e={options:{backdrop:!1,inDirection:"right",outDirection:"right",fullScreen:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,i,r,o,a,s){function c(e){return e.template?i.when(e.template):r.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:o}).then(function(e){return e.data})}function l(e){var n=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(i.when(t.invoke(e)))}),n}var u={};return u.open=function(t){var r=i.defer(),o=i.defer(),u={result:r.promise,opened:o.promise,close:function(e){return s.close(u,e)},dismiss:function(e){return s.dismiss(u,e)}};if(t=$.extend({},e.options,t),t.resolve=t.resolve||{},!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var d=i.all([c(t)].concat(l(t.resolve)));return d.then(function(e){var o=(t.scope||n).$new();o.$close=u.close,o.close=o.$close,o.$dismiss=u.dismiss,o.$state={completed:!1,errored:!1,using:!1,isCompleted:function(){return o.$state.completed||o.$state.using===!1},complete:function(){o.$state.completed=!0,o.$broadcast("modalStateComplete")},instant:function(e,t){return this.promise(function(){var e=i.defer();return setTimeout(function(){e.resolve()},100),e.promise},e,t)},promise:function(e,t,n){o.$state.using=!0,n||(n=function(){o.close()});var r=function(){return o.$state.completed?void 0:(angular.isFunction(e)&&(e=e()),angular.isArray(e)&&(e=i.all(e)),e.then(function(e){var i=t.call(o,o,e);return i&&i.then?i.then(o.$state.complete,n):o.$state.complete()},n))};return angular.isFunction(e)?void(o.$state.ready=r):r()}},o.$on("modalOpened",function(e){o.$state.ready&&o.$state.ready()});var c,l={},d=1;t.controller&&(l.$scope=o,l.$modalInstance=u,angular.forEach(t.resolve,function(t,n){l[n]=e[d++]}),c=a(t.controller,l),t.controllerAs&&(o[t.controllerAs]=c)),s.open(u,{scope:o,deferred:r,content:e[0],backdrop:t.backdrop,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,cantCloseWithBackdrop:t.cantCloseWithBackdrop,size:t.size,inDirection:t.inDirection,outDirection:t.outDirection,fullScreen:t.fullScreen,popFrom:t.popFrom,noEscape:t.noEscape})},function(e){r.reject(e)}),d.then(function(){o.resolve(!0)},function(){o.reject(!1)}),u},u}]};return e}).directive("fitInModal",function(){return{link:function(e,t,n){var i,r,o=function(n){i&&clearTimeout(i),i=setTimeout(function(){var n=$(t).parents(".modal:first"),i=n.find(".modal-dialog:first"),r=n.hasClass("modal-medium")?parseInt(-1===i.css("max-height").indexOf("%")?i.css("max-height"):0,10)||i.height():$(window).height();i.find(".fixed-height, .min-height, .max-height").each(function(){var e=r,t=i.find(".md-actions"),n=i.find("md-toolbar"),o="height";t.length&&(e-=t.outerHeight()),n.length&&(e-=n.outerHeight()),$(this).hasClass("min-height")&&(o="min-height"),$(this).hasClass("max-height")&&(o="max-height"),$(this).css(o,e)}),e.$broadcast("modalResize")},50)};r=_.throttle(o,100),$(window).bind("resize modal.open",r),e.$on("$destroy",function(){$(window).unbind("resize modal.open",r)}),e.$watch("$state.completed",function(e,t){e===!0&&e!==t&&o()})}}}).factory("modals",["$modal","$q","helpers","GLOBAL_CONFIG",function(e,t,n,i){var r={alert:function(e,t,n){return r.confirm(e,t,n,!0)},confirm:function(e,t,r,o){var a,s={message:e+" missing config, see core/config/config.js"};return angular.isFunction(t)?a={confirm:t}:angular.isObject(t)&&(a=t),angular.isDefined(r)&&(angular.isObject(r)?a=r:a.message=r),a=n.alwaysObject(a),n.extendDeep(s,a,i.modals[o?"alerts":"confirmations"][e]),s.noSecondary=o,s.confirm=function(){var e=this;return a.noAutoDismiss?a.confirm.call(e):void this.dismiss().then(function(){angular.isFunction(a.confirm)&&a.confirm.call(e)})},this.create(s,s.modal)},create:function(t,i){var r,o={message:""};return n.extendDeep(o,t),r={fullScreen:!1,inDirection:!1,outDirection:!1,cantCloseWithBackdrop:!0,templateUrl:"core/misc/confirm.html",controller:["$scope",function(e){var n=angular.isFunction(t)?t:t.ok||null;o.dismiss=function(){var t=e.$close();return t.then(function(){n&&n.call(e)}),t},angular.isObject(t)||(t={}),o.message&&!o.messages&&(o.messages=[o.message]),e.config=o,$.extend(e,o.scope),o.scope=void 0}]},$.extend(r,i),e.open(r)}};return i.debug&&(window._modals=r),r}]).directive("modalLoading",function(){return{templateUrl:"core/modal/loading.html"}})}(),function(){"use strict";angular.module("app").run(["modals","helpers","models","$modal","modelsMeta","snackbar",function(e,t,n,i,r,o){e.models||(e.models={}),e.models.sudo=function(e,a){var s={fullScreen:!1,popFrom:!1,inDirection:!1,outDirection:!1,templateUrl:null,cantCloseWithBackdrop:!0,controller:["$scope",function(i){var s=r.getActionArguments(e.kind,"sudo");i.args={},i.fields=s,angular.forEach(i.fields,function(t){$.extend(t.ui,{writable:!0,label:!1,attrs:{"native-placeholder":"","class":"full-width"}}),i.args[t.code_name]=e[t.code_name]}),i.fields.message.ui.placeholder="Write a message to the user!",i.fields.note.ui.placeholder="Write a note to the admins!",i.validateForm=angular.bind(i,t.form.validate),i.container={},i.config={},i.config.scroll=!0,i.config.dismiss=function(){return i.$close()},i.config.text={primary:"Ok"},i.config.confirm=function(){if(i.validateForm()){var r=n[e.kind].actions.sudo(i.args);r.then(function(e){a.onConfirm&&a.onConfirm(e.data.entity),i.config.dismiss(),o.showK("administered")})}else t.form.wakeUp(i.container.form)}}]};$.extend(s,a),i.open(s)},t.models||(t.models={}),$.extend(t.models,{isEntityListEmpty:function(e,t){var n,i=!e||0===e.length;return i||(n=0,angular.forEach(e,function(e){var i=!1;t&&(i=-1!==$.inArray(e._state,t)),("deleted"===e._state||i)&&(n+=1)}),i=n===e.length),i}})}]).value("modelsInfo",{}).value("currentAccount",{}).factory("modelsMeta",["$injector","GLOBAL_CONFIG",function(e,t){var n={},i=function(e,t){angular.forEach(e,function(e,n){void 0===e.ui&&(e.ui={}),null===e.code_name&&(e.code_name=n),e._maker_=t,void 0!==e.modelclass&&i(e.modelclass,e.modelclass_kind)})};return n.friendlyActionName=function(e,t){var n,i,r=this.get(e);return void 0===r?void 0:(n=r.actions,angular.forEach(n,function(e){e.key===t&&(i=e.id)}),i)},n.getFields=function(e){if(!angular.isDefined(e))return void console.error("provided kind id is not acceptable, got: "+e);var t,n=this.get(e);return angular.isDefined(n)?(t=angular.copy(n.fields),i(t,e),t):void console.error("could not find meta info for kind "+e)},n.getDefaultActionArguments=function(e,t){var n=this.getActionArguments(e,t),i={};return angular.forEach(n.arguments,function(e){null!==e["default"]&&(i[e.code_name]=e["default"])}),i},n.getActionArguments=function(e,t){var n,r,o=this.get(e),a={};return angular.isDefined(o)?angular.isDefined(t)?(n=o.mapped_actions[t],angular.isDefined(n)?(r=angular.copy(n.arguments),i(r,e+"-"+t),r):void console.error("action "+t+" not found for kind "+e)):(angular.forEach(o.mapped_actions,function(t){r=angular.copy(t.arguments),i(r,e+"-"+t.id),a[t.id]=r}),a):void 0},n.getActions=function(e){var t,n=this.get(e);return angular.isDefined(n)?(t=n.mapped_actions,angular.forEach(t,function(t){i(t.arguments,e+"-"+t.id)}),t):void 0},n.getName=function(e){var t=this.get(e);return angular.isDefined(t)?t.name:void console.error("model name not found for kind "+e)},n.get=function(t){var n,i=e.get("modelsInfo"),r=i[t],o={},a={};return void 0===r?void console.error("no info for kind "+t):(angular.forEach(r,function(e,t){"_actions"!==t&&"__name__"!==t&&(o[t]=e)}),angular.forEach(r._actions,function(e){a[e.id]=e}),n={actions:r._actions,mapped_actions:a,fields:o,name:r.__name__})},t.debug&&(window._modelsMeta=n),n}]).factory("ruleEngine",["modelsMeta",function(e){var t={run:function(t){var n={},i={},r=e.get(t.kind),o=t._action_permissions,a=t._field_permissions,s=r.actions,c={action:n,input:i,field:a},l=function(e){return o[s[e].id]},u=function(e){var t=l(e);return t.executable};return void 0===o?void 0:(angular.forEach(s,function(e,t){c.action[e.id]||(c.action[e.id]={}),c.action[e.id].executable=u(t),angular.forEach(e.arguments,function(t){var n=t.code_name;c.input[e.id]||(c.input[e.id]={}),c.input[e.id][n]=t})}),c)}};return t}]).factory("modelsUtil",["modelsMeta","ruleEngine","GLOBAL_CONFIG",function(e,t,n){var i={normalizeMultiple:function(e){angular.forEach(e,function(e){i.normalize(e)})},argumentsToJson:function(e,t){var n=["_field_permissions","_next_read_arguments","_read_arguments","_action_permissions","ui"];return JSON.stringify(e,function(e,t){var i,r=t;return angular.isObject(t)&&t.ui&&(i={},angular.forEach(t,function(e,t){-1===$.inArray(t,n)&&(i[t]=e)}),r=i),"string"==typeof e&&"$"===e.charAt(0)?r=void 0:t&&t.document&&t.location&&t.alert&&t.setInterval?r="$WINDOW":t&&document===t?r="$DOCUMENT":t&&t.$evalAsync&&t.$watch&&(r="$SCOPE"),r},t?"  ":null)},normalize:function(n,r,o,a,s,c){n.ui&&n.ui.normalized||(void 0===r&&(r=e.getFields(n.kind)),void 0===c&&(n.ui={},n.ui.normalized=!0,n.ui.access=[],a&&(n.ui.access.extend(o.ui.access),n.ui.access.push(a),void 0!==s&&n.ui.access.push(s)),void 0===o&&(n.ui.rule=t.run(n))),angular.forEach(r,function(e){var t=e["default"],r=n[e.code_name];"SuperDateTimeProperty"!==e.type||t||(t=new Date),e.repeated&&!angular.isArray(t)&&(t=[]),(void 0===r||null===r)&&null!==t&&void 0!==t&&(n[e.code_name]=t),"SuperDateTimeProperty"===e.type&&angular.isString(r)&&(n[e.code_name]=new Date(r)),e.is_structured&&(e.repeated?angular.forEach(r,function(t,r){i.normalize(t,e.modelclass,n,e.code_name,r)}):((void 0===r||null===r)&&e.required&&(r={kind:e.modelclass_kind},n[e.code_name]=r),void 0!==r&&null!==r&&i.normalize(r,e.modelclass,n,e.code_name,void 0,c)))}))}};return n.debug&&(window._modelsUtil=i),i}]).factory("modelsEditor",["$modal","endpoint","$q","helpers","modelsUtil","errorHandling","models","modelsMeta","$timeout","$filter","formInputTypes","recordBrowser","snackbar",function(e,t,n,i,r,o,a,s,c,l,u,d,p){var f={create:function(o){var f,g,m={showClose:!0,closeAfterSave:!1,action:"update",templateBodyUrl:"core/models/manage_body_default.html",scope:{},fields:[],init:angular.noop,getScope:null,defaultInit:angular.noop,defaultArgumentLoader:function(e){var t=angular.copy(e.entity),n=s.getActionArguments(e.config.kind,e.config.action),i={};return angular.forEach(n,function(e){var n=t[e.code_name];void 0===n&&null!==e["default"]&&void 0!==e["default"]&&(n=e["default"]),void 0!==n&&(i[e.code_name]=n)}),e.entity.key&&(i.key=t.key),e.entity.id&&(i.id=t.id),i.ui=t.ui,t._read_arguments&&(i.read_arguments=t._read_arguments),t._next_read_arguments&&(i._next_read_arguments=t._next_read_arguments),$.extend(i,e.withArgs),i.action_id=e.config.action,i.action_model=e.config.kind,i},argumentLoader:function(e){return this.defaultArgumentLoader(e)},defaultPrepareReadArguments:function(e){angular.isObject(e.args.read_arguments)||(e.args.read_arguments={});var t=e.args.read_arguments,n=function(e,t,n){if(angular.isArray(e)){var i=n[t];i||(i={config:{}}),i.config||(i.config={}),e&&angular.isObject(e[0])&&(i.config.keys=$.map(e,function(e){return e.key})),n[t]=i}};angular.forEach(e.args,function(e,i){n(e,i,t)})},prepareReadArguments:function(e){this.defaultPrepareReadArguments(e)}};return i.mergeDeep(o,m),!angular.isDefined(o.fields)&&angular.isDefined(o.kind)&&angular.isDefined(o.action)&&(o.fields=[],f=s.getActionArguments(o.kind,o.action),angular.forEach(f,function(e){angular.isDefined(o.excludeFields)&&-1!==$.inArray(e.code_name,o.excludeFields)||o.fields.push(e)})),o.keyedFields={},angular.forEach(o.fields,function(e){o.keyedFields[e.code_name]=e}),g={config:o,read:function(e,t,n){return void 0===t&&(t={key:e.key}),this.openPromise(function(){return a[o.kind].actions.read(t,n)},e,t)},prepare:function(e,t,n){return this.openPromise(function(){return a[o.kind].actions.prepare(t,n)},e,t)},openPromise:function(e,t,n){return this.open(t,n,e)},open:function(s,f,g){var m,h=e,v="open",y=n.defer(),b=y.promise;return m=function(e){var n,m,h="edit"+o.kind,v="add"+o.kind;e.config=o,e.container={action:t.url},e.dialog={toolbar:o.toolbar,templateBodyUrl:o.templateBodyUrl},e.entity=s,o.toolbar||(o.toolbar={}),angular.isUndefined(o.toolbar.titleEdit)&&(o.toolbar.titleEdit=h),angular.isUndefined(o.toolbar.titleAdd)&&(o.toolbar.titleAdd=v),n=function(){var t,n=e.dialog.toolbar;return e.entity.id?(angular.isDefined(n.titleEdit)&&(n.title=i.toolbar.title(n.titleEdit)),t=n.titleEdit):(angular.isDefined(n.titleAdd)&&(n.title=i.toolbar.title(n.titleAdd)),t=n.titleAdd),t},o._title_=[n],e.$watch("entity.id",n),n(),m=function(e){var t,n={},g=!1,m=function(){if(g||!e.entity.id)return!1;if(angular.isDefined(e.historyConfig)||(e.historyConfig=!1),e.historyConfig===!0)e.historyConfig={kind:o.kind,key:e.entity.key};else if(e.historyConfig===!1)return!1;g=!0;var t=e.args.ui.rule.field._records;e.historyConfig.key=e.entity.key,t&&t.visible&&e.layouts.groups.push(d.attach(e.historyConfig))};o.getScope=function(){return e},r.normalize(s),e.withArgs=f,e.args=o.argumentLoader(e),e.rootScope=e,e.formSetPristine=angular.bind(e,i.form.setPristine),e.formSetDirty=angular.bind(e,i.form.setDirty),e.validateForm=angular.bind(e,i.form.validate),e.setAction=function(t){e.args.action_id=t,o.action=t},e.save=function(t){if(!e.validateForm())return!1;o.prepareReadArguments(e);var n=a[o.kind].actions[e.args.action_id](e.args,{activitySpinner:!0});return n.then(function(n){$.extend(e.entity,n.data.entity);var i=o.argumentLoader(e);$.extend(e.args,i),m(),angular.isDefined(o.afterSave)&&o.afterSave(e),e.formSetPristine(),t||p.showK("changesSaved")},function(t){angular.isDefined(o.afterSaveError)&&o.afterSaveError(e,t)}),n},e.uploadStart=function(){e.activitySpinner.start()},e.uploadEnd=function(){e.activitySpinner.stop()},e.uploadComplete=function(t){$.extend(e.entity,t.data.entity);var n=o.argumentLoader(e);$.extend(e.args,n),m(),angular.isDefined(o.afterUploadComplete)&&o.afterUploadComplete(e),o.closeAfterSave&&c(function(){e.close()}),e.formSetPristine(),p.showK("changesSaved")},e.noComplete=function(){angular.isDefined(o.noComplete)&&o.noComplete(e)},e.uploadError=function(t){angular.isDefined(o.afterUploadError)&&o.afterUploadError(e,t)},e.close=angular.bind(e,i.form.leave,function(){e._close_=void 0;var t=e.$close();return o.afterClose&&o.afterClose(e),t}),e._close_=e.close,angular.forEach(o.fields,function(e){e._title_=o._title_.concat()}),angular.isDefined(o.scope)&&$.extend(e,o.scope),e.formBuilder={0:[]},angular.isDefined(e.layouts)?angular.forEach(e.layouts.groups,function(i,r){if(e.formBuilder[r]=[],angular.isDefined(i.fields))angular.forEach(i.fields,function(i){n[i]||(t=o.keyedFields[i],e.formBuilder[r].push(t),n[i]=1)});else{var a=!1;angular.forEach(o.fields,function(t){a||n[t.code_name]||(n[t.code_name]=1,t.is_structured&&(a=!0),e.formBuilder[r].push(t))})}}):(e.layouts={groups:[{label:!1}]},angular.forEach(o.fields,function(t){if(t.is_structured&&u[t.type]){t.ui.initialLabel||(t.ui.initialLabel=t.ui.label),e.layouts.groups.push({label:l("humanized")(t.ui.initialLabel||t.code_name)}),t.ui.label=!1;var n=e.layouts.groups.length-1;angular.isDefined(e.formBuilder[n])||(e.formBuilder[n]=[],e.formBuilder[n].push(t)),e.layouts.groups[0].disabled=!1}else e.formBuilder[0].push(t)})),e.$watch("dialog.toolbar.title",function(t){angular.isObject(e.historyConfig)&&(e.historyConfig.title=t)}),o.defaultInit(e),o.init(e),m(),e.$on("$destroy",function(){o.getScope=void 0}),y.resolve(e)},angular.isFunction(g)?e.$state.promise(g,function(e,t){$.extend(s,t.data.entity),m(e)}):e.$state.instant(function(){m(e)})},m.$inject=["$scope"],h[v]($.extend({templateUrl:"core/models/manage.html",controller:m},o.modalConfig)),b}}}};return f}]).factory("modelsConfig",function(){var e=[];return function(t){return t===!0?e:void e.push(t)}}).factory("models",["endpoint","modelsMeta","$injector","modelsConfig","helpers","$q","GLOBAL_CONFIG","$rootScope",function(e,t,n,i,r,o,a,s){var c={},l=function(n){var i={},o={kind:n,actions:{},getCacheKey:function(e){return this.kind+"_"+e},removeCache:function(t){return e.removeCache(this.getCacheKey(t))},getCache:function(t){return e.getCache(this.getCacheKey(t))},get:function(e,t){return angular.isDefined(this.actions.search)?this.actions.search({search:{keys:[e]}},t):void console.error("get() relies on actions.search action. use actions.read() instead.")},paginate:function(e){var n=this,i={args:{search:{}},config:{}},o=t.getActionArguments(e.kind,"search"),a={loading:!1,more:null,cursor:null,firstLoad:!0,args:i.args,load:function(){var t;return this.loading||this.more===!1?!1:(i.args.search.options||(i.args.search.options={}),i.args.search.options.start_cursor=this.cursor,this.loading=!0,$.extend(i.config,{disableUI:!1}),t=n.actions[i.action||"search"](i.args,i.config),t.error(function(t){return a.more=!1,e.error&&e.error(t),t}).then(function(t){return r.endpoint.isResponseError(t)?(a.more=!1,e.error&&e.error(t),e.complete.call(this,t)):(a.more=t.data.more,a.cursor=t.data.cursor,angular.isFunction(e.complete)?e.complete.call(this,t):t)})["finally"](function(){
a.loading=!1,a.firstLoad=!1}),t)}};return i.args.search=o.search["default"],angular.isDefined(e.args)&&(r.merge(e.args,i.args),$.extend(i,e)),a},reader:function(e){if(!angular.isArray(e.access))return void console.error("path must be array, "+typeof e.access+" given");var t,n,i,o,a=this,s=function(e){return r.getProperty(e,t.join(".")+".config.more")},l=function(e){t=[],angular.forEach(e,function(e){isNaN(parseInt(e,10))&&t.push(e)})};return angular.isUndefined(e.next)&&(i={},o=e.args,e.next=i,angular.forEach(e.access,function(e,t){!angular.isDefined(i[e])&&isNaN(parseInt(e,10))&&(i[e]={config:{}},i=i[e]),o=o[e],angular.isUndefined(o)||null!==o.key&&angular.isDefined(o.key)&&(angular.isDefined(i.config.keys)||(i.config.keys=[]),i.config.keys.push(o.key))})),l(e.access),n={next:null,loading:!1,access:e.access,more:s(e.next),config:e,loaded:!1,firstLoad:angular.isDefined(e.firstLoad)?e.firstLoad:!0,previous:null,state:function(e){this.next=e.next,angular.isDefined(e.access)&&(this.access=e.access,l(this.access)),this.more=angular.isDefined(e.more)?e.more:s(this.next)},setNextReadArguments:function(e){this.next=e,this.more=s(this.next)},setAccess:function(e){this.access=e,l(e),this.more=s(this.next)},load:function(i){if(i=r.alwaysObject(i),angular.isUndefined(i.runLast)&&(this.more===!1||this.loading))return!1;var o,l,u,d=this,p=d.next;return p||(p=angular.copy(e.next)),this.more||(l=p,angular.forEach(t,function(e,t){angular.isUndefined(p[e])?p[e]={}:p=p[e]}),p=l),i.hideLoading||(this.loading=!0),u={key:e.key,read_arguments:p},i.runLast&&(u=n.previous||u),i.rpcOptions||(i.rpcOptions={}),$.extend(i.rpcOptions,{disableUI:!1}),o=e.read?e.read(p):(e.kind?c[e.kind]:a).actions.read(u,i.rpcOptions),n.previous=u,o["finally"](function(){n.loading=!1,n.loaded=!0,n.firstLoad=!1,i.runLastFinally&&i.runLastFinally()}),o.error(function(t){d.more=!1,e.error&&e.error(t)}),o.then(function(t){if(r.endpoint.isResponseError(t))return d.more=!1,e.error&&e.error(t),t;var n,o,a=[];return angular.forEach(d.access,function(e){isNaN(parseInt(e,10))||(e=0),a.push(e)}),n=r.getProperty(t.data.entity,a),i.runLast?(i.runLast(n),t):(angular.isFunction(e.complete)&&e.complete(n),o=t.data.entity._next_read_arguments,d.more=s(o),d.more&&(d.next=o),t)})}}}};return o.config=i,angular.forEach(t.getActions(n),function(r,a){o.actions[a]=function(r,o){var s,c=t.getDefaultActionArguments(n,a),l=angular.copy(i);return $.extend(c,r),angular.isDefined(o)&&(o.merge?$.extend(l,o):l=angular.copy(o)),s=i.cache,angular.isDefined(l)&&l.cache&&(s=l.cache),s===!0&&(s=n+"_"+a+"_"+window.btoa(angular.toJson(c))),angular.isDefined(s)&&s!==!1?(delete l.cache,e.cached(s,a,n,c,l)):e.post(a,n,c,l)}}),o};return c.initialized=!1,c.init=function(){if(c.initialized!==!0){var e,t=n.get("modelsInfo");angular.isDefined(t[0])&&(angular.forEach(t,function(e,t){c[t]=l(t)}),e=i(!0),angular.forEach(e,function(e){e(c)}),c.initialized=!0)}},a.debug&&(window._models=c),c}])}(),function(){"use strict";angular.module("app").factory("recordBrowser",["models","GLOBAL_CONFIG","$modal",function(e,t,n){return{attach:function(i){return{label:t.subheaders.history,include:"core/misc/action.html",action:function(){n.open({templateUrl:"core/models/manage.html",controller:["$scope",function(t){t.dialog={templateBodyUrl:"core/record/list.html",toolbar:{hideSave:!0,leftIcon:"arrow_back",title:i.title+" / History"}};var r={access:["_records"],key:i.key,next:{_records:{config:{more:!0,search:{orders:[{field:"logged",operator:"desc"}]}}}},complete:function(e){t.history.records.extend(e)}};$.extend(r,i.reader),t.history={records:[],reader:e[i.kind].reader(r),view:function(e){n.open({templateUrl:"core/models/manage.html",controller:["$scope",function(t){t.record=e,t.dialog={},t.dialog.templateBodyUrl="core/record/view_body.html",t.dialog.toolbar={hideSave:!0,leftIcon:"arrow_back",title:i.title+" / History / Log Entry"}}]})}},t.$state.promise(function(){return t.history.reader.load()},angular.noop)}]})}}}}}])}(),function(){"use strict";angular.module("app").directive("selectInputMultiple",["$timeout","underscoreTemplate","$modal",function(e,t,n){return{require:["ngModel","^?form"],link:function(i,r,o,a){var s=a[0],c=a[1],l=i.$eval(o.grouping),u=i.$eval(o.items),d=i.$eval(o.view),p=i.$eval(o.listView),f=i.$eval(o.search),g=i.$eval(o.select),m=g&&g.init?g.init:null;g.getHash=function(e){return angular.isObject(e)?e.key:e},g.search=f,g.anyItems=0,g.async=!0,g.loading=!1,g.multiple=!0,g.items=[],g.find=function(e){if(null===e)return void 0;var t,n,i=function(e){var t,n;return angular.isObject(g.items[0])?n=_.findWhere(g.items,{key:e}):(t=g.items.indexOf(e),-1!==t&&(n=g.items[t])),n};return g.multiple?(n=[],t=[],e&&e.length&&angular.forEach(e,function(e){var r=i(e);angular.isUndefined(r)?n.push(e):t.push(r)})):(t=i(e),angular.isUndefined(t)&&(n=e)),angular.isDefined(n)&&n.length&&g.search&&g.search.ready&&g.search.ready.then(function(){g.search.missing&&g.search.missing(n)}),t},g.getActive=function(){return g.item=g.find(s.$modelValue),g.item},g.setItems=function(e){g.items=e,g.collectActive(),l&&(g.grouping=l(g.items)),g.anyItems=e.length},g.isSelected=function(e){var t=g.getHash(e);return g.multiple?-1!==$.inArray(t,s.$modelValue):s.$modelValue===t},g.remove=function(e){g.select(e)},g.anySelected=function(){var e=!0;return angular.forEach(g.multipleSelection,function(t){e||(e=t)}),e},g.multipleSelection={},g.multipleSelect=function(e,t){var n=g.getHash(e),i=t?g.multipleSelection[n]:!g.multipleSelection[n],r=s.$modelValue||[],o=-1!==$.inArray(n,s.$modelValue);g.multipleSelection[n]=i,angular.isArray(g.item)||(g.item=r),i?o||(r.push(n),g.item.push(e)):o&&(r.remove(n),g.item.remove(e)),s.$setViewValue(r),c.$setDirty(),g.close()},g.commitMultipleSelect=function(t){e(function(){g.multipleSelect(t,!0)},100)},g.collectActive=function(){angular.forEach(g.items,function(e){var t=g.getHash(e);angular.isUndefined(g.multipleSelection[t])&&-1!==$.inArray(t,s.$modelValue)&&(g.multipleSelection[t]=!0)})},g.isChecked=function(e){return g.multipleSelection[g.getHash(e)]},g.select=function(e){g.multipleSelect(e)},g.close=angular.noop,g.opened=!1,g.open=function(t){g.opened||(g.opened=!0,e(function(){g.openSimpleDialog(t)}))},g.openSimpleDialog=function(e){if(!r.attr("disabled")){g.search&&(g.search.query={});var i,o=r.parents(".modal:first").find(".modal-dialog:first");o.length||(o=r.parents("body:first")),i=t.get(g.openTemplate||"core/select/choices.html")({select:g}),n.open({template:t.get("core/select/single.html")().replace("{{content}}",i),targetEvent:e,parent:o,inDirection:!1,windowClass:"modal-medium-simple "+(g.windowClass||""),outDirection:!1,fullScreen:!1,backdrop:!0,controller:["$scope",function(e){e.select=g,e.$on("$destroy",function(){g.opened=!1,g.close=angular.noop}),e.close=function(){e.$close().then(g.afterClose||angular.noop)},g.close=function(){e.close()}}]})}},d||(d=function(e){return angular.isObject(e)?e.name:e}),g.view=d,g.listView=p||d,s.$formatters.push(function(e){return g.collectActive(),g.item=g.find(e),e}),l&&(g.hasGrouping=!0,g.grouping=[]),g.setItems(u),i.$watchGroup([o.items+".length",o.items],function(t,n){(t[0]!==n[0]||t[1]!==n[1])&&(g.setItems(i.$eval(o.items)),g.getActive(),g.opened&&e(function(){$(window).triggerHandler("resize")},0,!1))}),m&&m(g,i,r,o,a)}}}]).directive("selectInput",["$simpleDialog","$$rAF","$mdConstant","underscoreTemplate","$timeout","$parse","helpers","$q","$modal",function(e,t,n,i,r,o,a,s,c){return{replace:!0,transclude:!0,require:["ngModel","^?mdInputContainer","^?form"],templateUrl:"core/select/input.html",scope:!0,link:function(a,l,u,d){var p,f,g=d[0],m=d[1],h=d[2],v=a.$eval(u.items),y=a.$eval(u.view),b=a.$eval(u.search),w=b&&b.init?b.init:null,k=a.$eval(u.multiple),C=a.$eval(u.async),S=a.$eval(u.grouping),x=a.$eval(u.listView),A=u.placeholder,E={},O=!1;m.input=l,f=function(e){var t=!g.$isEmpty(e);return angular.isArray(e)&&(t=0!==e.length),m.setHasValue(t),e},a.$watch(function(){return g.$invalid&&g.$touched},m.setInvalid),g.$parsers.push(f),g.$formatters.push(f),l.on("keyup",function(e){e.keyCode===n.KEY_CODE.ENTER&&E.open()}).on("click",function(e){O||E.open(),O=!1,e.preventDefault()}).on("blur",function(e){m.setFocused(!1)}),a.$on("$destroy",function(){m.setFocused(!1),m.setHasValue(!1),m.input=null}),E.getHash=function(e){return angular.isObject(e)?e.key:e},E.async=C,E.placeholder=A,E.loading=!1,E.multiple=k,E.items=[],E.find=function(e){if(null===e)return void 0;var t,n,i=function(e){var t,n;return angular.isObject(E.items[0])?n=_.findWhere(E.items,{key:e}):(t=E.items.indexOf(e),-1!==t&&(n=E.items[t])),n};return E.multiple?(n=[],t=[],e&&e.length&&angular.forEach(e,function(e){var r=i(e);angular.isUndefined(r)?n.push(e):t.push(r)})):(t=i(e),angular.isUndefined(t)&&(n=e)),angular.isDefined(n)&&n.length&&E.search&&E.search.ready&&E.search.ready.then(function(){E.search.missing&&E.search.missing(n)}),t},E.getActive=function(){return E.item=E.find(g.$modelValue),E.item},E.setItems=function(e){E.items=e,E.collectActive(),S&&(E.grouping=S(E.items))},E.isSelected=function(e){var t=E.getHash(e);return E.multiple?-1!==$.inArray(t,g.$modelValue):g.$modelValue===t},E.anyUnselected=function(){return!0},E.anySelected=function(){return!0},E.multipleSelection={},E.multipleSelect=function(e){var t=E.getHash(e),n=!E.multipleSelection[t],i=g.$modelValue||[],r=-1!==$.inArray(t,g.$modelValue);E.multipleSelection[t]=n,E.multiple||(angular.isArray(E.item)||(E.item=i),n?r||(i.push(t),E.item.push(e)):r&&(i.remove(t),E.item.remove(e)),g.$setViewValue(i),h.$setDirty(),f(i))},E.completeMultiSelection=function(){var e=[],t=[];angular.forEach(E.items,function(n){var i=E.getHash(n);E.multipleSelection[i]&&(e.push(i),t.push(n))}),g.$setViewValue(e),h.$setDirty(),f(e),E.item=t,E.close()},E.collectActive=function(){angular.forEach(E.items,function(e){var t=E.getHash(e);angular.isUndefined(E.multipleSelection[t])&&-1!==$.inArray(t,g.$modelValue)&&(E.multipleSelection[t]=!0)})},E.isChecked=function(e){return!1},E.select=function(e){var t=E.getHash(e);g.$setViewValue(t),E.item=e,E.close()},E.close=angular.noop,E.opened=!1,E.open=function(e){E.opened||(E.opened=!0,r(function(){E.openSimpleDialog(e)}))},E.openSimpleDialog=function(r){if(!l.attr("disabled")){E.search&&(E.search.query={}),E.multipleSelection={},E.collectActive();var a,u,d=l.parents(".modal:first").find(".modal-dialog:first");d.length||(d=l.parents("body:first")),a=i.get(E.openTemplate||"core/select/choices.html")({select:E}),u=a,(E.multiple||C)&&(u=i.get("core/select/single.html")().replace("{{content}}",a),r=void 0),(E.multiple||C?c.open:e.show)({template:u,popFrom:r?r.target:void 0,targetEvent:r,parent:d,inDirection:!1,windowClass:"modal-medium-simple "+(E.windowClass?E.windowClass:""),outDirection:!1,fullScreen:!1,backdrop:!0,disableScroll:[l.parents("md-content:first"),l.parents(".fixed-height:first")],onBeforeHide:function(e,t){$(window).off("resize",t.resize)},onBeforeShow:function(e,i){var r=s.defer(),a=r.promise,c=!1,u=e.find('[tabindex="2"]'),p=function(){var a=l.parents("md-input-container:first");i.resize=function(){var t,r,o,s,c,p,f,g=a.offset(),m=l.offset(),h=i.parent,v=h.offset(),y=C?24:16,$=C?24:16,b=i.parent.height(),_=e.find("md-content"),w=e.find(".list-row-is-active"),k=d.find("md-toolbar"),S=0;w.length?(r=w.offset(),p=r,c=w):(p=u.offset(),c=u),k.length&&(S=k.height()),t=v.top+y+S,f=b-($+y+S),e.width(a.width()),e.height()>b||_.prop("scrollHeight")>b||e.height()>f?e.css({top:t,left:m.left}).height(f):(e.css(m),o=w.length?m.top-r.top+w.height()/5:g.top-e.height()/2+y,o>t?(s=o+e.height(),s+24>b&&(o-=s-(b-24),t>o&&(o=t)),e.css("top",o)):e.css("top",t)),w.length&&!E.multiple&&_.scrollTop(_.scrollTop()-_.offset().top+w.offset().top),p&&e.css(n.CSS.TRANSFORMORIGIN,p.left+a.width()/2+"px "+(p.top+w.height()/2-_.scrollTop())+"px 0px")},i.resize(),$(window).on("resize",function(){setTimeout(i.resize,100)}),e.oneAnimationEnd(function(t){r.resolve(),c=e.find(".list-row-is-active:first"),c.length||(c=u),E.search?setTimeout(function(){e.find('input[type="search"]').focus()},100):c.focus(),e.addClass("opacity-in")}).on("keyup",function(t){if(c){var i=c,r=!1,a=-1;t.keyCode===n.KEY_CODE.DOWN_ARROW?(c=c.next(),r=!0):t.keyCode===n.KEY_CODE.UP_ARROW?(c=c.prev(),r=!0):t.keyCode===n.KEY_CODE.ENTER&&(c=e.find(".simple-dialog-option:focus"),c.length||(c=e.find(".list-row-is-active:first")),a=c.length?o(c.attr("item"))(c.scope()):E.items[0],a&&E.select(a)),!c.length&&r&&(c=i),r&&c.focus()}}),t(function(){e.addClass("fade in"),O=!1})};return t(p),a},controller:["$scope",function(t){E.close=function(){E.multiple||E.async?t.close():e.hide()},t.close=function(){t.$close().then(E.afterClose||angular.noop)},t.select=E,t.$on("$destroy",function(){E.opened=!1,m.setFocused(!1),l.focus()})}]})}},y||(y=function(e){return angular.isObject(e)?e.name:e}),E.view=y,E.listView=x||y,g.$formatters.push(function(e){return E.item=E.find(e),e}),E.isFilterMatch=function(e){if(!b)return!0;var t,n,i=E.getFindTerm(),r=E.search.query;return E.search.filterProp&&(r=r[E.search.filterProp]),!r||r.length<1?!0:(t=E.search.filterProp?e[E.search.filterProp]:e,n=-1!==t.toString().toLowerCase().indexOf(i))},E.getFindTerm=function(){return o(E.search.filterProp)(E.search.query)},b&&(E.search={query:{},delay:200,enabled:!1,doFind:function(){var e=E.getFindTerm();p&&clearTimeout(p),E.search.find&&(p=setTimeout(function(){E.search.find(e)},E.search.delay)),r(function(){$(window).triggerHandler("resize")},0,!1)}},$.extend(E.search,b),E.search.filterProp=E.search.filterProp?E.search.filterProp:"name",E.search.model||(E.search.model="select.search.query."+E.search.filterProp)),S&&(E.hasGrouping=!0,E.grouping=[]),E.setItems(v),a.$watchGroup([u.items+".length",u.items],function(e,t){(e[0]!==t[0]||e[1]!==t[1])&&(E.setItems(a.$eval(u.items)),E.getActive(),E.opened&&r(function(){$(window).triggerHandler("resize")},0,!1))}),a.select=E,w&&w(E,a,l,u,d)}}}])}(),function(){"use strict";angular.module("app").directive("imageSlider",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(e,n,i){var r,o=t(i.imageSliderLoadMore),a=n.parent(".image-slider-outer:first"),s=!0,c=function(t,n){return s?(s=!1,void o(e,{callback:function(e,t){n(),s=t}})):!1},l=function(){var e=0,t=function(){return"none"!==$(this).css("display")};n.find(".image-slider-item").filter(t).each(function(){e+=$(this).width()}),n.width(Math.ceil(e)+n.find(".vertical-loader").filter(t).width())},u=function(){var t=a.parents(".fixed-height:first").height(),n=a.parents(".modal:first").find(".new-pricetag-bar");n.length&&(t-=n.outerHeight()),t&&(a.height(t),e.$broadcast("imageSliderResized",t))};u(),u=_.throttle(u,100),e.$on("modalResize",u),e.$on("reMeasureImageSlider",function(){u(),l()}),e.$on("readyImageSlider",function(){u(),l(),r=new Steady({throttle:200,scrollElement:a.get(0),handler:c}),r.addTracker("checkLeft",function(){if(o){var e,t,n=a.get(0);return n?(e=n.scrollWidth-n.clientWidth,t=e-a.scrollLeft(),300>t?!0:!1):void r.stop()}}),r.addCondition("checkLeft",!0),a.data("steady",r)}),e.$on("$destroy",function(){r&&(r.stop(),a.data("steady",void 0))})}}}]).directive("sliderImage",["$timeout","helpers","GLOBAL_CONFIG",function(e,t,n){return{restrict:"A",link:function(i,r,o){var a=i.$eval(o.sliderImage),s=function(){var e=r.parents(".modal:first").find(".new-pricetag-bar"),o=r.parents(".fixed-height:first").innerHeight()-window.SCROLLBAR_WIDTH-(e.length?e.outerHeight():0),s=Math.ceil(o*a.proportion),c=t.closestLargestNumber(n.imageSizes,o),l=o,u=r.parents(".image-slider-item:first");s=t.newWidthByHeight(s,l,o),r.bind("load",function(){i.$broadcast("readySingleImageSlider",u)}).attr("src",t.url.handleProtocol(a.serving_url)+"=s"+c).width(s).height(o),u.width(s).height(o)},c=function(){s(),i.$emit("reMeasureImageSlider")};e(function(){s(),i.$last&&i.$emit("readyImageSlider")}),i.$on("modalResize",c),i.$on("itemDelete",function(){e(c)})}}}])}(),function(){"use strict";angular.module("app").factory("social",["$modal","GLOBAL_CONFIG","helpers",function(e,t,n){var i={share:function(t,i,r){e.open({templateUrl:"core/social/share.html",controller:["$scope",function(e){e.container={},e.$state.instant(function(e){e.socials=[{name:"Facebook",key:"facebook",command:"https://www.facebook.com/sharer.php?u={u}",require:["u"]},{name:"Twitter",key:"twitter",command:"https://twitter.com/intent/tweet?text={text}&url={url}",require:["url","text"]},{name:"Pinterest",key:"pinterest",command:"https://www.pinterest.com/pin/create/button/?url={url}&media={media}&description={description}",require:["url","media","description"]},{name:"Reddit",key:"reddit",command:"https://www.reddit.com/submit?url={url}&title={title}",require:["url","title"]},{name:"Linkedin",key:"linkedin",command:"https://www.linkedin.com/shareArticle?url={url}&title={title}",require:["url","title"]},{name:"Google+",icon:"googleplus",key:"googleplus",command:"https://plus.google.com/share?url={url}",require:["url"]},{name:"Tumblr",key:"tumblr",command:"https://www.tumblr.com/share/link?url={url}&name={name}&description={description}",require:["url","name","description"]}],e.getIcon=function(e){return"/client/dist/static/social/"+(e.icon||e.name.toLowerCase())+".png"},e.share=function(e){var i=e.command;return angular.forEach(e.require,function(n){var r=t[e.key][n];angular.isUndefined(r)?(i=i.replace("&"+n+"={"+n+"}",""),i=i.replace("?"+n+"={"+n+"}","")):i=i.replace("{"+n+"}",encodeURIComponent(t[e.key][n]))}),n.popup.openCentered(i,"Share to "+e.name)},angular.isUndefined(r)&&(r={src:t.googleplus.url}),e.link={enabled:r,values:{url:angular.isObject(r)?r.src:r},fields:[{type:"SuperTextProperty",code_name:"url",ui:{label:!1,writable:!0,args:"link.values.url",parentArgs:"link.values",attrs:{readonly:"true",onclick:"this.select()"}}}]},e.embed={enabled:i,values:{width:"100%",height:"100%",code:""},setCode:function(){if(!i)return"";var t=e.embed.values;return t.code='<iframe width="'+t.width+'" height="'+t.height+'" src="'+i.src+'" frameborder="0" allowfullscreen></iframe>',t.code},fields:[{type:"SuperStringProperty",code_name:"width",required:!0,ui:{writable:!0,args:"embed.values.width",parentArgs:"embed.values",attrs:{"ng-change":"embed.setCode()"}}},{type:"SuperStringProperty",code_name:"height",required:!0,ui:{writable:!0,args:"embed.values.height",parentArgs:"embed.values",attrs:{"ng-change":"embed.setCode()"}}},{type:"SuperTextProperty",code_name:"code",ui:{writable:!0,args:"embed.values.code",parentArgs:"embed.values",attrs:{readonly:"true",onclick:"this.select()"}}}]},e.embed.setCode()})}]})}};return t.debug&&(window._social=i),i}])}(),angular.module("app").directive("uploadSubmit",["$parse",function(e){function t(e,n){e=angular.element(e);var i=e.parent();return n=n.toLowerCase(),i&&i[0].tagName.toLowerCase()===n?i:i?t(i,n):null}return{restrict:"AC",link:function(e,n,i){n.bind("click",function(e){if(e&&(e.preventDefault(),e.stopPropagation()),!n.attr("disabled")){var i=t(n,"form");i.triggerHandler("submit"),i[0].submit()}})}}}]).directive("ngUpload",["$log","$parse","$document","$rootScope","errorHandling","modelsUtil",function(e,t,n,i,r,o){function a(e){var t,i=n.find("head");return angular.forEach(i.find("meta"),function(n){n.getAttribute("name")===e&&(t=n)}),angular.element(t)}var s=1;return{require:"form",restrict:"AC",link:function(n,c,l,u){function d(e){n.$isUploading=e}function p(){w.unbind("load"),n.$$phase?d(!1):n.$apply(function(){d(!1)});var t,a=(w[0].contentDocument||w[0].contentWindow.document).body;try{t=angular.fromJson(a.innerText||a.textContent)}catch(s){t=a.innerHTML,e.warn("Response is not valid JSON")}var c={content:{data:t}},l=t&&angular.isObject(t)&&!t.errors;_&&l&&(angular.isDefined(t.entities)?o.normalizeMultiple(t.entities):angular.isDefined(t.entity)&&o.normalize(t.entity)),l?n.$$phase?m(n,c):n.$apply(function(){m(n,c)}):n.$$phase?v(n,c):n.$apply(function(){v(n,c)}),i.$broadcast("disableUI",!1),l?n.$broadcast("ngUploadComplete",t):(r.snackbar(t.errors),n.$broadcast("ngUploadError",t)),n.$broadcast("ngUploadEnd"),y(n)}s++;var f=u,g={},m=l.ngUpload?t(l.ngUpload):angular.noop,h=l.ngUploadStart?t(l.ngUploadStart):angular.noop,v=l.ngUploadError?t(l.ngUploadError):angular.noop,y=l.ngUploadEnd?t(l.ngUploadEnd):angular.noop,$=l.ngUploadLoading?t(l.ngUploadLoading):null,b=n.$eval(l.ngUploadOptions)||{},_=angular.isDefined(b.normalize)?b.normalize:!0;l.hasOwnProperty("uploadOptionsConvertHidden")&&(g.convertHidden="false"!=l.uploadOptionsConvertHidden),l.hasOwnProperty("uploadOptionsEnableRailsCsrf")&&(g.enableRailsCsrf="false"!=l.uploadOptionsEnableRailsCsrf),l.hasOwnProperty("uploadOptionsBeforeSubmit")&&(g.beforeSubmit=t(l.uploadOptionsBeforeSubmit)),c.attr({target:"upload-iframe-"+s,method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});var w=({url:c.attr("action")},angular.element('<iframe name="upload-iframe-'+s+'" border="0" width="0" height="0" style="width:0px;height:0px;border:none;display:none">'));if(g.enableRailsCsrf){var k=angular.element("<input />");k.attr("class","upload-csrf-token"),k.attr("type","hidden"),k.attr("name",a("csrf-param").attr("content")),k.val(a("csrf-token").attr("content")),c.append(k)}c.after(w),d(!1),c.bind("submit",function(){return f&&f.$invalid?!1:g.beforeSubmit&&0==g.beforeSubmit(n,{})?!1:(h(n),n.$broadcast("ngUploadStart"),w.bind("load",p),g.convertHidden&&angular.forEach(c.find("input"),function(e){var t=angular.element(e);t.attr("ng-model")&&t.attr("type")&&"hidden"==t.attr("type")&&t.attr("value",n.$eval(t.attr("ng-model")))}),n.$$phase?($&&$(n),d(!0)):n.$apply(function(){$&&$(n),d(!0)}),n.$broadcast("ngUploadSubmit"),void i.$broadcast("disableUI",!0))})}}}]),function(){"use strict";angular.module("app").run(["helpers",function(e){e.responsive={isTouch:function(){return Modernizr.touch},isMobile:function(){return"visible"===$("#is-mobile").css("visibility")},isTablet:function(){return"visible"===$("#is-tablet").css("visibility")},isDesktop:function(){return!this.isMobile()},isLandscape:function(){return"visible"===$("#is-landscape").css("visibility")},isPortrait:function(){return!this.isLandscape()}}}])}(),function(){"use strict";angular.module("app").constant("LOGIN_PROVIDERS",[{name:"Google",id:1},{name:"Facebook",id:2},{name:"Twitter",id:3},{name:"Pinterest",id:4}]).factory("mappedLoginProviders",["LOGIN_PROVIDERS",function(e){var t={};return angular.forEach(e,function(e){t[e.id]=e}),t}]).controller("LoginProviderConnectedController",["$scope","snackbar","currentAccount","models",function(e,t,n,i){i[11].manageModal(n,{fromRedirect:!0}).then(function(){t.showK("identityConnected")})}]).controller("AccountLoginStatusController",["$scope","$location","$state","snackbar",function(e,t,n,i){var r,o=t.search();return o.popup?void e.contentSpinner.start():void(o.success?n.go("home"):o.errors&&(r=angular.fromJson(o.errors),r&&r.action_denied&&i.showK("accessDenied")))}]).controller("AccountManagementController",["$scope","currentAccount","models","modelsUtil",function(e,t,n,i){e.settings=function(){n[11].manageModal(t)},e.logout=function(){n[11].logout(t.key)}}]).filter("formatLoginProivider",["mappedLoginProviders",function(e){return function(t){var n=t.split("-"),i="";return n&&n[1]&&(i=e[n[1]].name),i}}]).run(["modelsConfig","channelApi","channelNotifications","currentAccount","$http","$state","endpoint","$window","modelsEditor","GLOBAL_CONFIG","modelsMeta","modelsUtil","$modal","helpers","modals","$q","mappedLoginProviders","LOGIN_PROVIDERS","snackbar",function(e,t,n,i,r,o,a,s,c,l,u,d,p,f,g,m,h,v,y){var b=function(e){return e.identity.split("-")[1]};e(function(e){$.extend(e[11],{channel:function(){var e=this.actions.create_channel(void 0,{cache:"accountChannel",cacheType:"memory"},{activitySpinner:!0});return e.then(function(e){var n=e.data.token;return{token:n,channel:t.create(n)}})},channelNotifications:function(e){e=f.alwaysObject(e);var t=this.channel();return t.then(function(t){var i=t.token;return{token:i,channel:n.create(i,e.callback)}})},adminManageModal:function(e,t){return this.manageModal(e,t)},login:function(t){t||(t=""),p.open({templateUrl:"account/login.html",inDirection:!1,windowClass:"modal-medium-simple",outDirection:!1,fullScreen:!1,backdrop:!0,controller:["$scope",function(n){n.$state.promise(function(){return r.post(o.href("login",{provider:"1"},{disableUI:!1}),{action_id:"login",action_model:"11",redirect_to:"popup"})},function(n,s){var c=o.href("login-status");n.socials=[{name:"Facebook",key:"2"},{name:"Twitter",key:"3"},{name:"Pinterest",key:"4"},{name:"Reddit",key:"5"},{name:"Linkedin",key:"6"},{name:"Google+",icon:"googleplus",key:"1"},{name:"Tumblr",key:"7"}],n.getIcon=function(e){return"/client/dist/static/social/"+(e.icon||e.name.toLowerCase())+".png"},n.authorization_urls=s.data.authorization_urls,n.onMessage=[],n.loginPopup=function(t){var r=f.popup.openCentered(n.authorization_urls[t.key],"Login with "+t.name),o=!1,s=!1,l=window.setInterval(function(){if(r.closed)return clearInterval(l),void(o||y.showK("loginCanceled"));var t=function(){s||(s=!0,e[11].actions.current_account(void 0,{ignoreErrors:2}).then(function(e){var t=e.data.entity;t._is_guest||($.extend(i,e.data.entity),a.removeCache(),y.showK("loginSuccess"),o=!0,r.close(),n.close())},function(){y.showK("loginFailed")})["finally"](function(){s=!1}))};try{-1!==r.document.URL.indexOf(c)&&(clearInterval(l),t())}catch(u){u instanceof DOMException&&t()}},500)},n.login=function(e){r.post(o.href("login",{provider:e.key}),{action_id:"login",action_model:"11",redirect_to:t}).then(function(e){var t=e.data;t&&!t.errors&&t.authorization_urls?window.top.location.href=t.authorization_url:g.alert("failedGeneratingAuthorizaitonUrl")})}})}]})},manageModal:function(e,t){t=f.alwaysObject(t);var n={kind:this.kind,templateBodyUrl:"account/manage_body.html",toolbar:{titleEdit:"account.settings",hideSave:!0},modalConfig:{popFrom:t.popFrom,inDirection:!1,outDirection:!1},init:function(e){var t=e.entity,i=["state","ui.rule","created","updated"],a=function(t){angular.forEach(["args","entity"],function(n){f.update(e[n],t,i)})},s=function(){var t=Object.keys(h);e.identities=e.entity.identities.concat(),angular.forEach(e.identities,function(e){var n=b(e);t[n]&&delete t[n]}),angular.forEach(v,function(n){t[n.id]&&e.identities.push({identity:"0-"+n.id,associated:!1})})};s(),t.ui.rule.action.sudo.executable&&(n.toolbar.templateActionsUrl="account/manage_actions.html"),e.args.disassociate=[],e.maybeDisconnect=function(t){t.email&&void 0===t.associated?g.confirm("disconnectSignInMethod",function(){e.args.disassociate.push(t.identity),e.save().then(function(){s(),y.showK("identityDisconnected")})}):g.confirm("connectSignInMethod",function(){var e=o.href("login-provider-connected",{provider:b(t)});r.post(o.href("login",{provider:b(t)}),{action_id:"login",action_model:"11",redirect_to:e}).then(function(e){var t=e.data;t&&!t.errors&&t.authorization_url?window.location.href=t.authorization_url:g.alert("failedGeneratingAuthorizaitonUrl")})})},e.actions.sudo=function(){g.models.sudo(t,{templateUrl:"account/administer.html",onConfirm:a})}},afterClose:function(){t.fromRedirect&&o.go("home")},scope:{historyConfig:!0,isAssociated:function(e){return-1===$.inArray(e.identity,this.args.disassociate)},setPrimary:function(e){this.container.form.$setDirty(),this.args.primary_identity=e.identity},disassociate:function(e){this.container.form.$setDirty(),this.isAssociated(e)?this.args.disassociate.push(e.identity):this.args.disassociate.remove(e.identity)},actions:{},layouts:{groups:[{label:!1},{label:l.subheaders.loginMethods}]}}};return c.create(n).read(e,{key:e.key})},logout:function(e){var t=this;t.actions.logout({key:e}).then(function(e){a.removeCache(),$.extend(i,e.data.entity),o.go("home"),y.showK("loggedOut")})}})})}])}(),function(){"use strict";angular.module("app").controller("BuyerManagementController",["$scope","endpoint","currentAccount","models",function(e,t,n,i){e.settings=function(){i[19].manageModal(n.key,void 0,{inDirection:!1,outDirection:!1})}}]).controller("BuyOrdersController",["$scope","$timeout","modals","snackbar","modelsEditor","GLOBAL_CONFIG","modelsMeta","helpers","models","modelsUtil","$state",function(e,t,n,i,r,o,a,s,c,l,u){var d,p="buy-carts"===u.current.name,f="order-payment-canceled"===u.current.name,g="order-payment-success"===u.current.name,m=null,h=!1,v=null,y=10,b=function(){u.params.key&&(v&&t.cancel(v),v=t(function(){c[34].actions.read({key:u.params.key},{disableUI:!1}).then(function(e){d&&s.update(d,e.data.entity,["state","updated","payment_status","ui"]),"completed"===e.data.entity.state?i.showK("orderPaymentSuccessProgress"+e.data.entity.state):b()},function(){y+=1,10>y&&b()})},2e3))},w={inDirection:!1,outDirection:!1,afterClose:function(){u.go("buy-carts")}},k=function(e){d=e,f?i.showK("orderPaymentSuccessProgresscanceled"):(i.showK("orderPaymentSuccessProgress"),b())},C=function(){h||(m&&clearTimeout(m),m=setTimeout(function(){var t={key:u.params.key},n=_.findWhere(e.search.results,t);return h=!0,n?e.view(n,!1):void c[34].manageModal(t,void 0,void 0,w).then(k)},300))};(f||g)&&(p=!0),e.setPageToolbarTitle("buyer."+(p?"carts":"orders")),e.listHelp=p?o.emptyHelp.cartBuyerList:o.emptyHelp.orderBuyerList,e.search={results:[],pagination:{},loaded:!1},e.scrollEnd={loader:!1},e.$watch(function(){var t=!1;return e.search.results.iremove(function(e){var n="canceled"===e.state;return t||(t=n),n}),t},angular.noop),e.view=function(e,t){c[19].current().then(function(e){return e.data.entity}).then(function(n){var i,r={cartMode:p,popFrom:t?s.clicks.realEventTarget(t.target):!1},o=t===!1;o&&$.extend(r,w),i=c[34].manageModal(e,e._seller,n,r),i&&o&&i.then(k)})},c[19].current().then(function(t){var n=t.data.entity;e.search.pagination=c[34].paginate({kind:"34",args:{search:{ancestor:n.key,filters:[{field:"state",operator:"IN",value:p?["cart","checkout"]:["completed","canceled"]}],orders:[{field:"updated",operator:"desc"},{field:"key",operator:"asc"}]}},config:{ignoreErrors:2},complete:function(t){var n=t.data.errors;n?n.buyer&&i.showK("noBuyer"):e.search.results.extend(t.data.entities),(f||g)&&C(),e.search.loaded=!0}}),e.scrollEnd.loader=e.search.pagination,e.search.pagination.load()})}]).directive("buyerAddressListView",function(){return{scope:{val:"=buyerAddressListView"},templateUrl:"buyer/address_list_view.html",controller:["$scope",function(e){e.notEmpty=function(e){return angular.isString(e)||angular.isNumber(e)}}]}}).run(["$window","modelsEditor","modelsMeta","$q","modelsConfig","currentAccount","endpoint",function(e,t,n,i,r,o,a){r(function(e){$.extend(e[19],{current:function(e){return e||(e={}),e.account=o.key,this.actions.read(e,{cache:this.getCacheKey("current"),cacheType:"memory"})},manageModalFieldsOrder:["country","region","city","postal_code","street","name"],manageModal:function(r,o,s){s||(s={});var c,l=n.getActionArguments(this.kind,"update"),u=this;$.extend(l.addresses.ui,{label:!1,specifics:{listView:"buyer-address-list-view",listConfig:{perLine:3},sortFields:u.manageModalFieldsOrder,beforeSave:function(t,n){var r,o=[],a=t.args;return!a.region||a._region&&a.region===a._region.key||(r=e[13].get(a.region,{activitySpinner:!0}),r.then(function(e){e.data.entities.length&&(a._region=e.data.entities[0])}),o.push(r)),!a.country||a._country&&a.country===a._country.key||(r=e[12].actions.search(void 0,{cache:!0,cacheType:"local",activitySpinner:!0}),r.then(function(e){if(e.data.entities.length){var t=_.findWhere(e.data.entities,{key:a.country});angular.isDefined(t)&&(a._country=t)}}),o.push(r)),o.length?i.all(o):!1}}}),c={fields:_.toArray(l),kind:this.kind,action:"update",modalConfig:s,afterSave:function(e){a.removeCache(u.getCacheKey("current")),angular.isDefined(o)&&o(e)},scope:{layouts:{groups:[{label:!1,fields:["addresses"]}]}},toolbar:{titleEdit:"buyer.viewAddresses",titleAdd:"buyer.viewAddresses"},excludeFields:["account","read_arguments"],argumentLoader:function(e){var t=this.defaultArgumentLoader(e);

return t.account=r,t}},t.create(c).read({},{account:r})}})})}])}(),function(){"use strict";angular.module("app").controller("CatalogViewController",["$scope","$state","models",function(e,t,n){e.site.toolbar.hidden=!0,n[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,afterClose:function(){t.go("home")}})}]).controller("CatalogProductAddToCartController",["$scope","$state","helpers","models",function(e,t,n,i){var r="embed-catalog-product-add-to-cart"===t.current.name;e.site.toolbar.hidden=!0,i[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,hideClose:r,autoAddToCart:!0,noEscape:r,afterClose:r?void 0:function(){t.go("home")},variantSignatureAsDicts:n.url.jsonFromUrlsafe(t.params.variant),autoAddToCartQuantity:t.params.quantity,loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}]).controller("CatalogProductVariantViewController",["$scope","$state","helpers","models",function(e,t,n,i){e.site.toolbar.hidden=!0,i[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,variantSignatureAsDicts:n.url.jsonFromUrlsafe(t.params.variant),afterClose:function(){t.go("home")},loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}]).controller("CatalogProductViewController",["$scope","$state","models",function(e,t,n){e.site.toolbar.hidden=!0,n[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,afterClose:function(){t.go("home")},loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}]).controller("CatalogOrderViewController",["$scope","$state","models",function(e,t,n){var i="embed-catalog-order-view"===t.current.name;e.site.toolbar.hidden=!0,n[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,openCart:!0,afterClose:function(){t.go("home")},hideClose:i,noEscape:i})}]).controller("EmbedCatalogViewController",["$scope","$state","models",function(e,t,n){e.site.toolbar.hidden=!0,n[31].viewModal(t.params.key,{popFrom:void 0,inDirection:!1,outDirection:!1,noEscape:!0,hideClose:!0})}]).controller("EmbedCatalogProductViewController",["$scope","$state","models",function(e,t,n){e.site.toolbar.hidden=!0,n[31].viewModal(t.params.key,{popFrom:void 0,hideClose:!0,noEscape:!0,noEscapeOnProduct:!0,inDirection:!1,outDirection:!1,loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}]).controller("EmbedCatalogProductVariantViewController",["$scope","$state","helpers","models",function(e,t,n,i){e.site.toolbar.hidden=!0,i[31].viewModal(t.params.key,{popFrom:void 0,hideClose:!0,noEscape:!0,noEscapeOnProduct:!0,inDirection:!1,outDirection:!1,variantSignatureAsDicts:n.url.jsonFromUrlsafe(t.params.variant),loadProduct:{image:t.params.image_id,id:t.params.pricetag_id}})}])}(),function(){"use strict";angular.module("app").directive("trackIfProductView",["$timeout",function(e){return{restrict:"A",link:function(t,n,i){var r;t.$watch(i.trackIfProductView,function(t,i){r||angular.isObject(t)&&e(function(){n.find('[data-pricetag-id="'+t.image+"-"+t.id+'"]').click(),r=!0},100)})}}}]).directive("catalogNewPricetag",["$parse",function(e){return{restrict:"A",link:function(t,n,i){var r=e(i.catalogNewPricetag);n.on("click",function(e){var i=n.offset(),o=e.pageX-i.left,a=e.pageY-i.top,s=n.parents(".image-slider-item:first"),c=s.width(),l=s.height();t.$apply(function(){r(t,{config:{position_left:o,position_top:a,image_width:c,image_height:l}})})})}}}]).directive("catalogPricetagPosition",["$timeout","models",function(e,t){return{link:function(n,i,r){var o=n.$eval(r.catalogPricetagPosition),a=function(e){var n,r=$(i).parents(".image-slider-item:first"),a=r.height(),s=36;n=t[31].calculatePricetagPosition(o.position_top,o.position_left,o.image_width,o.image_height,r.width(),a),n[0]<0?n[0]=0:n[0]>a-s&&(n[0]=a-s),o._position_top=n[0],o._position_left=n[1],$(i).css({top:o._position_top,left:o._position_left,visibility:"visible"})},s=[];a=_.throttle(a,100),e(a,0,!1),n.$on("modalResize",a),n.$on("resizePricetags",function(e,t){t?t.key===o.key&&(o.position_top=t.position_top,o.position_left=t.position_left,a()):a()}),angular.forEach(["state","key","position_left","position_top","_position_left","_position_top"],function(e){s.push(r.catalogPricetagPosition+"."+e)}),n.$watch(function(){return!0},a)}}}]).directive("productInstanceCardView",["GLOBAL_CONFIG",function(e){return{scope:{val:"=productInstanceCardView"},templateUrl:"catalog/product/instance_card_view.html",link:function(e){e.showVariantLabel=function(e){return e.split(":")[0]},e.showVariantValue=function(e){var t=e.split(":");return t.slice(1,t.length).join(":")}}}}]).directive("productStockConfigurationCardView",["GLOBAL_CONFIG",function(e){return{scope:{val:"=productStockConfigurationCardView"},templateUrl:"catalog/product/stock_configuration_card_view.html",link:function(t){t.showVariantLabel=function(e){return _.keys(e)[0]},t.showVariantValue=function(e){var t=_.values(e)[0];return"***Any***"===t?"Any":t},t.showMainLabel=function(t){return e.fields.translateChoices[133].availability[t]}}}}])}(),function(){"use strict";angular.module("app").run(["modelsEditor","modelsMeta","modelsConfig","currentAccount","$modal","modals","helpers","$q","GLOBAL_CONFIG","$mdSidenav","$timeout","$state","snackbar","social",function(e,t,n,i,r,o,a,s,c,l,u,d,p,f){n(function(n){var i=function(e,t){t||(t=0);var n=e.modelclass;angular.forEach(n,function(n){if(n.ui.realPath){var r=e.ui.realPath.concat();r.push(n.code_name),n.ui.realPath=r,n.ui.initialRealPath=r,n.modelclass&&i(n,t+1)}})};$.extend(n[31],{adminManageModal:function(e,t){return this.manageModal(e,void 0,t)},manageModal:function(s,l,u){l=l||angular.noop,u=a.alwaysObject(u);var d=t.getActionArguments("31","update"),f=!angular.isDefined(s),g=function(e){e.setAction("catalog_upload_images"),e.dialog.toolbar.templateActionsUrl="catalog/manage_actions.html",l(e.entity)},m=function(e){e.setAction("update"),l(e.entity)},h=function(e){m(e)},v={kind:this.kind,action:f?"create":"update",modalConfig:u,fields:_.toArray(d),toolbar:{templateActionsUrl:f?!1:"catalog/manage_actions.html",titleEdit:"edit31",titleAdd:"add31"},afterSave:g,afterSaveError:g,afterUploadComplete:m,afterUploadError:m,init:function(e){$.extend(d._images.ui,{label:!1,specifics:{setupSortableOptions:function(){return{stop:function(){if(d._images.ui.specifics.parentArgs.length){var e,t=d._images.ui.specifics.parentArgs[0].sequence,n=d._images.ui.directiveScope();angular.forEach(d._images.ui.specifics.parentArgs,function(n,i){i=t-i,(n.sequence!==i||"deleted"===n._state)&&(e=!0),n.sequence=i,n.ui.access[n.ui.access.length-1]=i}),e&&n.formSetDirty(),n.$broadcast("itemOrderChanged"),n.$apply()}}}}}});var t=["state","ui.rule","created","updated"],i=function(n){angular.forEach(["args","entity"],function(i){a.update(e[i],n,t)})};e.actions={publish:function(){o.confirm("publishCatalog",function(){n[31].actions.publish({key:e.entity.key},{activitySpinner:!0}).then(function(e){p.showK("catalogPublished"),i(e.data.entity)})})},discontinue:function(){o.confirm("discontinueCatalog",function(){n[31].actions.discontinue({key:e.entity.key},{activitySpinner:!0}).then(function(e){p.showK("catalogDiscontinued"),i(e.data.entity)})})},duplicate:function(){o.confirm("duplicateCatalog",function(){n[11].channelNotifications({callback:function(e){n[31].actions.read({key:e.catalog_key,read_arguments:{cover:{}}},{disableUI:!1}).then(function(e){p.showK("catalogDuplicated"),l(e.data.entity)})}}).then(function(t){n[31].actions.catalog_duplicate({key:e.entity.key,channel:t.token},{activitySpinner:!0})})})},sudo:function(){o.models.sudo(e.entity,{templateUrl:"catalog/administer.html",onConfirm:i})}}},noComplete:h,scope:{historyConfig:!0,addProducts:function(){var e=this;r.open({templateUrl:"core/models/manage.html",windowClass:"no-overflow",controller:["$scope","$timeout",function(t,r){var s,l,u,f,g,m=angular.copy(e.args.ui.access),h=function(){return"viewProducts"};m.push(d._images.code_name),t.rootScope=e.rootScope,t.config=e.rootScope.config,t.entity=e.entity,t.args=angular.copy(e.args),t.dialog={templateBodyUrl:"catalog/manage_products.html",toolbar:{hideSave:!0}},t.imagesLoaded=!1,t.container={},t.formSetPristine=angular.bind(t,a.form.setPristine),t.formSetDirty=angular.bind(t,a.form.setDirty),t.validateForm=angular.bind(t,a.form.validate),t.fieldProduct=d._images.modelclass.pricetags.modelclass._product,t.args._images=[],t.config._title_.push(h),t.$on("$destroy",function(){t.config._title_.remove(h),d._images._title_.remove(h),d._images.modelclass.pricetags._title_.remove(h),d._images.modelclass.pricetags.modelclass._product._title_.remove(h)}),d._images._title_=t.config._title_.concat(),d._images.modelclass.pricetags._title_=d._images._title_.concat(),t.fieldProduct._title_=d._images._title_.concat(),t.dialog.toolbar.title=a.toolbar.buildTitle(t.config._title_),t.trackPricetags=function(e){return e.key?e.key:"new"+_.uniqueId()},s=n[31].reader({key:t.args.key,next:{_images:{}},access:m,complete:function(e){t.args._images.extend(e),r(function(){t.imagesLoaded=!0},300)}}),u=t.fieldProduct.modelclass._instances.modelclass.variant_options,u.ui.specifics||(u.ui.specifics={}),u.ui.specifics.checkboxes=!0,u.ui.fieldset=!0,u.ui.specifics||(u.ui.specifics={}),u.ui.specifics.listView=function(e){return angular.isObject(e)?e.full:e},u.ui.specifics.grouping=function(e){var t=[],n={};return angular.forEach(e,function(e){var i=e.split(": "),r=n[i[0]];r||(r={label:i[0],items:[]},n[i[0]]=r,t.push(r)),r.items.push({name:i[1],key:e,full:e})}),t},f=function(e,n){e.pricetags.push(n);var i=_.findWhere(t.rootScope.args._images,{key:e.key});i&&i.pricetags.push(n)},g=function(e,n){angular.isDefined(n._destroy)&&n._destroy(),e.pricetags.remove(n);var i=_.findWhere(t.rootScope.args._images,{key:e.key});i&&i.pricetags.iremove(function(e){return e.key===n.key})},t.$stateHiddenLoading=!0,t.$on("modalOpened",function(){s.load()["finally"](function(){t.$stateHiddenLoading=!1,t.dialog.toolbar.hideSave=!1})}),t.onStart=function(e,n,i,r){$(n.helper).addClass("dragged"),$(n.helper).find("a").addClass("dragged"),angular.isUndefined(r._image)&&(r._image=t.args._images.indexOf(i)),t.syncStop()},t.onDrag=function(e,t,n,i){},t.droppableOptions={accept:".catalog-new-pricetag",tolerance:"pointer"},t.draggableOptions={containment:".image-slider-outer",distance:6},t.newPricetagDraggableOptions={revert:function(e){if(!e)return!0;var n=t.container.form.$dirty;return n&&p.showK("saveChangesFirst"),n},distance:10,helper:"clone"},t.onStop=function(e,n,i,r){if(setTimeout(function(){$(n.helper).removeClass("dragged"),$(n.helper).find("a").removeClass("dragged")},350),"deleted"!==r._state){var o,a,s=$(e.target).parents(".image-slider-item:first"),c=$(e.target),l=parseFloat(c.css("left"),10),u=c.width(),d=s.width(),p=d-(u+l),g=t.args._images.indexOf(i),m=0,h=0;a=function(e){var i,a,u,p,v,y=0,b=parseFloat($(n.helper).css("top"),10);for(o=s,m=e?d:0;;)if(e){if(g+=1,o=o.next(),m+=o.width(),m>l){u=o,i=t.args._images[g],v=l-(h||d);break}if(g>1e4)break;h=m}else{if(g-=1,o=o.prev(),y+=o.width(),m-=o.width(),l>m){u=o,i=t.args._images[g],v=y+l;break}if(0>g)break}i&&(r._state="deleted",c.addClass("ng-hide"),a=_.findWhere(i.pricetags,{key:r.key}),a&&(r=a),r.image_width=u.width(),r.image_height=u.height(),r.position_left=v,r.position_top=b,r._position_left=v,r._position_top=b,angular.isUndefined(a)?(p=angular.copy(r),p._state=null,p._must_save=!0,angular.isUndefined(r._image)&&(p._image=g),f(i,p)):a._state=null)},r.position_top=n.position.top,r.position_left=n.position.left,r.image_width=s.width(),r.image_height=s.height(),r._position_top=r.position_top,r._position_left=r.position_left,t.formSetDirty(),3.3>p+u?a(!0):-8.5>l&&a(),t.$$phase||t.$apply(),t.$broadcast("resizePricetags",r)}},t.onDrop=function(e,n,i){if(!t.container.form.$dirty){var o=$(e.target),a=o.offset(),s=n.offset,c=s.top-a.top+6,l=s.left-a.left+4,u=$('<div style="visibility:hidden;"></div>'),d={position_top:c,position_left:l,_image:t.args._images.indexOf(i),image_width:o.width(),image_height:o.height()};u.css({top:c,position:"absolute",left:l,width:n.draggable.width(),height:n.draggable.height()}),u.appendTo(o),d._destroy=function(){r(function(){u.remove()},2e3,!1)},t.createProduct(i,d,u)}},t.imagesReader=s,s.showLoaderAlways=!0,t.loadMoreImages=function(e){var t=s.load();t?t.then(function(t){e.call(this,t,s.more)}):e.call(this,void 0,s.more)},l=function(e,n){t.image=e,t.pricetag=n},t.loadingManageProduct=!1,t.lastManageProduct=null,t.manageProduct=function(e,n,i){var r=t.syncScheduleNext||t.syncLoading,o=t.container.form.$dirty;return r||o?void p.showK("saveChangesFirst"):t.realManageProduct(e,n,i)},t.realManageProduct=function(e,r,o){if(!t.loadingManageProduct){t.loadingManageProduct=!0,l(e,r);var a=function(){return n[31].actions.read({key:t.entity.key,read_arguments:{_images:{config:{keys:[e.key]},pricetags:{config:{keys:[r.key]},_product:{}}}}}).then(function(n){var o=n.data.entity,a=t.args._images.indexOf(e),s=o._images[0].pricetags[0]._product,c=!1,l=_.findIndex(e.pricetags,function(e){return e.key===r.key}),u=["_images",a,"pricetags",l,"_product"];return t.fieldProduct.ui.specifics.toolbar||(t.fieldProduct.ui.specifics.toolbar={}),c=t.entity.ui.rule.action.catalog_pricetag_duplicate.executable||t.entity.ui.rule.field._images.pricetags.writable,t.fieldProduct.ui.specifics.toolbar.templateActionsUrl=c?"catalog/product/manage_actions.html":void 0,r._product=s,s._stock||(s._stock={stocks:[]}),s.ui.access=u,t.fieldProduct.ui.realPath=u,i(t.fieldProduct),{arg:s,defaultArgs:void 0}})["finally"](function(){t.loadingManageProduct=!1})};t.fieldProduct.ui.specifics.manage(a,void 0,{target:$(o.target).hasClass("catalog-pricetag")?o.target:$(o.target).parents(".catalog-pricetag:first").get(0)})}},t.howToDrag=function(e){o.alert("howToDropPricetag")},t.createProduct=function(e,n,r){var o=t.args._images.indexOf(e),a={_sequence:e.pricetags.length,image_height:n.image_height,image_width:n.image_width,position_left:n.position_left,position_top:n.position_top,_position_left:n.position_left,_position_top:n.position_top,value:{},_destroy:n._destroy,_product:{_stock:{stocks:[]}},ui:{access:["_images",o,"pricetags",e.pricetags.length]}};f(e,a),l(e,a),t.fieldProduct.ui.specifics.toolbar.templateActionsUrl=!1,t.fieldProduct.ui.realPath=["_images",o,"pricetags",e.pricetags.length-1,"_product"],i(t.fieldProduct),t.fieldProduct.ui.specifics.create(void 0,a._product,{target:r})},$.extend(t.fieldProduct.ui,{init:function(e){e.config.ui.specifics.remove=function(e,n){t.pricetag._state="deleted",t.formSetDirty(),n()}},args:"pricetag._product",parentArgs:"pricetag",path:["_images","pricetags","_product"],render:!1,label:!1,specifics:{remoteAutoload:!1,modal:!0,removeConfirm:function(e,n){o.confirm("removePricetagConfirm",function(){t.pricetag._state="deleted",r(function(){n().then(function(){r(function(){t.save()})})})})},beforeSave:function(e){e.setAction("update");var t=_.last(e.sendRootArgs._images[0].pricetags);t.value={name:e.args.name,price:e.args.unit_price}},templateFooterUrl:"catalog/product/manage_footer.html",getRootArgs:function(){return t.args},afterClose:function(e){t.pricetag._product=null,e.args.key||g(t.image,t.pricetag)},afterSave:function(e){e.setAction("product_upload_images");var n=e.response.data.entity._images[0].pricetags[0];t.fieldProduct.ui.specifics.toolbar.templateActionsUrl="catalog/product/manage_actions.html",$.extend(t.pricetag,n)},afterUploadComplete:function(e){e.setAction("update")},noComplete:function(e){e.setAction("update")},duplicate:function(){o.confirm("duplicateCatalogPricetag",function(){n[11].channelNotifications({callback:function(e){n[31].actions.read({key:e.catalog_key,read_arguments:{_images:{config:{keys:[e.image_key]},pricetags:{config:{keys:[e.pricetag_key]}}}}},{disableUI:!1}).then(function(n){var i=_.findWhere(t.args._images,{key:e.image_key});i&&angular.forEach(n.data.entity._images[0].pricetags,function(t,n){_.findWhere(i.pricetags,{key:e.pricetag_key})||i.pricetags.push(t)}),p.showK("productDuplicated")})}}).then(function(e){n[31].actions.catalog_pricetag_duplicate({key:t.entity.key,channel:e.token,read_arguments:{_images:{config:{keys:[t.image.key]},pricetags:{config:{keys:[t.pricetag.key]}}}}},{activitySpinner:!0})})})}}}),$.extend(t.fieldProduct.modelclass.images.ui,{name:"images"}),$.extend(t.fieldProduct.modelclass._instances.modelclass.images.ui,{name:"images"}),t.fieldProduct.modelclass.category.ui.specifics={search:{enabled:!0}},$.extend(t.fieldProduct.modelclass._stock.ui,{specifics:{canOpen:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args;return n.id?!0:(p.showK("saveProductFirst"),!1)}}}),$.extend(t.fieldProduct.modelclass._stock.modelclass.stocks.ui,{specifics:{cards:!0,cardView:"product-stock-configuration-card-view",init:function(e){var n,i=t.fieldProduct.ui.specifics.getScope().args.variants,r=e.formBuilder[0].pop(),o=[],a=0;e.formBuilder[0].empty(),e.variantCombination={},angular.forEach(i,function(t){if(!t.allow_custom_value){try{e.variantCombination[a]=_.values(e.args.variant_signature[a])[0]}catch(n){}var i=function(){var t=[];return angular.forEach(e.args.ui.access,function(e,n){angular.isNumber(e)||t.push("['"+e+"']")}),t.join("")}(),r={type:"SuperStringProperty",choices:function(){var e=t.options.concat(),n=[{key:"***Any***",name:"Any"}];return angular.forEach(e,function(e){n.push({key:e,name:e})}),n}(),code_name:"variant_choice_"+a,required:!0,ui:{writable:"entity.ui.rule.field"+i+".variant_signature.writable",label:t.name,help:t.description,args:"variantCombination["+a+"]",attrs:{"ng-change":"changeVariantCommit()"}}};o.push(r),e.formBuilder[0].push(r),a+=1}}),e.formBuilder[0].push(r),e.changeVariantCommit=function(){var t=0;angular.forEach(i,function(n){if(!n.allow_custom_value){var i={};i[n.name]=e.variantCombination[t],angular.isDefined(e.args.variant_signature[t])?e.args.variant_signature[t]=i:e.args.variant_signature.push(i),t+=1}})},n=e.save,e.save=function(){var t,i=JSON.stringify(e.args.variant_signature);return angular.forEach(e.parentArgs,function(e,n){JSON.stringify(e.variant_signature)===i&&(t=e)}),t&&($.extend(t,e.args),e.isNew=!1,e.liveArg=t),n()}}}}),$.extend(t.fieldProduct.modelclass._instances.ui,{label:c.subheaders.productInstances,path:["_images","pricetags"],specifics:{layoutConfig:[{label:c.fields.label[28].variant_options,fields:["variant_options"]},{label:"Details",fields:["code","description","unit_price","weight","volume"]},{fields:["images"]},{fields:["contents"]}],cards:!0,cardView:"product-instance-card-view",getRootArgs:function(){return t.args},beforeSave:function(e){e.setAction("update")},afterSave:function(e){e.setAction("product_instance_upload_images")},afterUploadComplete:function(e){e.setAction("update")},noComplete:function(e){e.setAction("update")},setupSortableOptions:function(){return{forcePlaceholderSize:!0,stop:function(){var e,n,i=t.fieldProduct.modelclass._instances,r=i.ui.directiveScope();i.ui.specifics.parentArgs.length&&(e=i.ui.specifics.parentArgs[0].sequence,angular.forEach(i.ui.specifics.parentArgs,function(t,i){i=e-i,(t.sequence!==i||"deleted"===t._state)&&(n=!0),t.sequence=i,t.ui.access[t.ui.access.length-1]=i}),n&&r.formSetDirty(),r.$broadcast("itemOrderChanged"),r.$apply())}}},canOpen:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args;return n.id?n.variants.length?!0:(p.showK("createVariantsFirst"),!1):(p.showK("saveProductFirst"),!1)},init:function(){var e=t.fieldProduct.ui.specifics.getScope(),n=e.args,i=[];angular.forEach(n.variants,function(e){e.allow_custom_value||angular.forEach(e.options,function(t){i.push(e.name+": "+t)})}),u.choices=i},excludeFields:["created","sequence"]}}),$.extend(t.fieldProduct.modelclass.contents.ui,{specifics:{}}),$.extend(t.fieldProduct.modelclass.images.ui,{name:"images",specifics:{}}),$.extend(t.fieldProduct.modelclass.variants.ui,{specifics:{}}),t.fieldProduct.modelclass.uom.ui.specifics||(t.fieldProduct.modelclass.uom.ui.specifics={}),t.fieldProduct.modelclass.uom.ui.specifics.grouping=function(e){var t,n=[];return angular.forEach(e,function(e){t&&t.label!==e.measurement&&(t=null),t||(t={label:e.measurement,items:[]},n.push(t)),t.items.push(e)}),n},t.loadingSave=!1,t.save=function(i,r,o){if(t.loadingSave)return void p.showK("saveInProgress");var a,s=r?r.promise:void 0;return t.syncCancelDefer=r,t.loadingSave=!0,t.rootScope.config.prepareReadArguments(t),a=n[31].actions[t.args.action_id](t.args,{activitySpinner:!o,timeout:s}),a.then(function(n){if(!t.syncScheduleNext){$.extend(t.entity,n.data.entity);var r=t.rootScope.config.argumentLoader(t);$.extend(e.args,angular.copy(r)),$.extend(t.args,angular.copy(r)),t.formSetPristine()}i||p.showK("changesSaved")}),a["finally"](function(){t.loadingSave=!1}),a},t.close=angular.bind(t,a.form.leave,function(){t.$close()}),t.syncLoading=!1,t.syncID=null,t.syncScheduleNext=!1,t.syncStop=function(){clearTimeout(t.syncID)},t.syncStart=function(e){t.syncScheduleNext=!0,t.syncStop(),t.syncID=setTimeout(function(){t.sync(!1)},1e3)},t.sync=function(e){return t.syncLoading?void(t.syncScheduleNext=!0):(t.syncLoading=!0,t.syncScheduleNext=!1,void t.save(e).then(function(n){return t.syncLoading=!1,t.syncScheduleNext&&t.sync(e),n}))}}]})},layouts:{groups:[{label:!1,fields:["name","discontinue_date"]},{label:c.subheaders.catalogImages,include:"core/misc/action.html",action:function(){var e=v.getScope();return a.form.wakeUp(e.container.form),e.container.form.$valid?void o.fields.remote(v.getScope(),d._images):void p.showK("provideProperValues")}},{label:c.subheaders.catalogProducts,include:"core/misc/action.html",action:function(){var e=v.getScope();return e.entity.cover?void v.getScope().addProducts():void p.showK("uploadImagesFirst")}}]}}};f?n[23].current().then(function(t){e.create(v).prepare({},{seller:t.data.entity.key},{handleError:c.backendErrorHandling.sellerProfileNotFound})}):e.create(v).read(s,{key:s.key})}})})}])}(),function(){"use strict";angular.module("app").run(["modelsEditor","modelsMeta","modelsConfig","currentAccount","$modal","modals","helpers","$q","GLOBAL_CONFIG","$mdSidenav","$timeout","$state","snackbar","social",function(e,t,n,i,r,o,a,s,c,l,u,d,p,f){n(function(e){var t=[".catalog-close-button",".catalog-pricetag",".catalog-pricetag-link"];$.extend(e[31],{calculatePricetagPosition:function(e,t,n,i,r,o){var a=e/n*r,s=t/i*o;return[a,s]},previewModal:function(e,t){return t=a.alwaysObject(t),t.hideAddToCart=!0,this.viewModal(e,t)},viewProductModal:function(n,o,l,g,m){var h={_seller:{},_images:{config:{keys:[o]},pricetags:{config:{keys:[l]},_product:{_category:{}}}}},v=this,y=s.defer(),b=y.promise,w=function(){y.reject()};return m=a.alwaysObject(m),r.open({templateUrl:"catalog/product/view.html",windowClass:"no-overflow",popFrom:m.popFrom,noEscape:m.noEscape,controller:["$scope",function(b){b.hideAddToCart=!1,b.hideClose=m?m.hideClose:!1,y.resolve(),b.$state.promise(function(){return v.actions.read({key:n,read_arguments:h},{disableUI:!1}).then(function(t){var n=t.data.entity,i=function(){var t={};return t.product=n._images[0].pricetags[0]._product,t.originalProduct=angular.copy(t.product),t.catalog=n,t.variants=[],t.variantSelection=[],t.currentVariation=[],t.currentVariationPure=[],t.notInitialLoad=!1,angular.forEach(t.product.variants,function(e,n){t.variants.push({name:e.name,options:e.options,option:g&&g[n]?g[n][e.name]:e.options[0],description:e.description,allow_custom_value:e.allow_custom_value}),t.variantSelection.push({type:"SuperStringProperty",choices:e.allow_custom_value?null:e.options,code_name:"option_"+n,ui:{help:e.allow_custom_value?e.description:void 0,label:e.name,writable:!0,attrs:{"ng-change":"delayedChangeVariation("+(e.allow_custom_value?"true":"false")+")"},args:"variants["+n+"].option"}})}),t.changeVariationPromise=function(n,i){var r,a,c=[],u=!1;return t.currentVariation.empty(),t.currentVariationPure.empty(),angular.forEach(t.variants,function(e){var n={};null===e.option&&(u=!0),n[e.name]=e.option,e.allow_custom_value?!angular.isString(e.option)||!e.option.length:(c.push(e.name+": "+e.option),t.currentVariationPure.push(n)),t.currentVariation.push(n)}),c.length||(u=!0),u||n?(a=s.defer(),r=a.promise,a.resolve(n),r):e[31].actions.read({key:this.catalog.key,read_arguments:{_images:{config:{keys:[o]},pricetags:{config:{keys:[l]},_product:{_instances:{config:{search:{filters:[{field:"variant_options",operator:"ALL_IN",value:c}]}}}}}}}},{activitySpinner:this.notInitialLoad,disableUI:void 0===i?!0:i})},t}();return i.changeVariationPromise(void 0,!1).then(function(e){return{catalog:n,fakeScope:i,productResponse:e,response:t}})},w)},function(n,s){var l,g,h,v,b=s.fakeScope,w=s.productResponse;n.variantMenu={},n.productMenu={},a.sideNav.setup(n.productMenu,"right_product_sidenav",t),a.sideNav.setup(n.variantMenu,"right_variantMenu_sidenav",t),$.extend(n,b),h=function(){if(!n.product)return void(n.socialMeta={});var e=(m.hideCloseCatalog?"embed-":"")+"catalog-product-"+(n.currentVariation.length?"variant-":"")+"view",t=d.href(e,{key:n.catalog.key,image_id:n.catalog._images[0].id,pricetag_id:n.catalog._images[0].pricetags[0].id,variant:a.url.jsonToUrlsafe(n.currentVariation)},{absolute:!0}),i=function(e){return n.product.images&&n.product.images.length?a.url.handleProtocol(n.product.images[0].serving_url+"=s"+(e||"600")):void 0};n.socialMeta={facebook:{u:t},twitter:{url:t,text:"Product - "+n.product.name},pinterest:{url:t,media:i(600),description:"Share on pinterest"},googleplus:{url:t},reddit:{url:t,title:n.product.name},linkedin:{url:t,title:n.product.name},tumblr:{url:t,name:n.product.name}}},n.displayShare=function(){return h(),f.share(n.socialMeta,!1)},n.variantChooser={},n.setupVariantChooser=function(e,t){e.indice=t,n.variantChooser=e,n.variantMenu.open()},n.completeVariantChooser=function(e){n.variantChooser.option=e,n.variantMenu.close(),n.changeVariation()},n.resetVariation=function(){n.resetVariantProduct(),n.variationApplied=!1,angular.forEach(n.variants,function(e){e.option=null})},n.resetVariantProduct=function(){$.extend(n.product,n.originalProduct),n.productInstance=null},n.variationApplied=!1,n.viewContent=function(e){r.open({templateUrl:"core/misc/content_view.html",controller:["$scope",function(t){t.markDown=!0,t.content=e}]})},n.canAddToCart=!0,n.hasThisProduct=!1,n.disableUpdateCart=!1,n.productQuantity=0,g=n.catalog._seller.key,n.cartProductQuantity=function(){n.productQuantity=0,n.hasThisProduct=!1,n.disableUpdateCart=!1,i._is_guest?n.productQuantity=1:(m.orderKey?e[34].actions.read({key:m.orderKey,read_arguments:{_lines:{config:{limit:0}}}},{disableUI:!1}):e[34].current(g,{disableUI:!1})).then(function(e){var t=e.data.entity;t.id?(angular.forEach(t._lines,function(e){e.product._reference.parent.id===n.product.parent.id&&e.product._reference.id===n.product.id&&angular.toJson(n.currentVariation)===angular.toJson(e.product.variant_signature)&&(n.productQuantity=parseInt(e.product.quantity,10),n.productQuantity>0&&(n.hasThisProduct=!0,n.disableUpdateCart=!0))}),n.canAddToCart=t.ui.rule.action.update_line.executable):n.canAddToCart=!0,n.productQuantity||(n.productQuantity=1)})},l=function(e){if(e===!0)return e;var t,i,r=["images","code","unit_price","weight","volume","description","contents"];try{t=e.data.entity._images[0].pricetags[0]._product}catch(o){}t&&(i=t._instances[0]),n.resetVariantProduct(),i&&(n.productInstance=i,angular.forEach(r,function(e){var t=i[e];null!==t&&t.length&&void 0!==t&&(n.product[e]=t)})),n.variationApplied=!0},n.delayedChangeVariation=function(e){v&&u.cancel(v),v=u(function(){v=null,n.changeVariation(e)},500,!1)},n.changeVariation=function(e){n.changeVariationPromise(e).then(l).then(n.cartProductQuantity)},l(w),n.$watch(function(){return i._is_guest},function(e,t){n.cartProductQuantity()}),n.increaseQuantity=function(){n.disableUpdateCart=!1,n.productQuantity=parseInt(n.productQuantity,10)+1},n.decreaseQuantity=function(){0!==parseInt(n.productQuantity,10)&&(n.disableUpdateCart=!1,n.productQuantity=parseInt(n.productQuantity,10)-1)},n.changedQuantity=function(){n.disableUpdateCart=!1},n.getAvailability=function(e){var t,i=n.product._stock,r="in stock",o=JSON.stringify(n.currentVariationPure);return i&&i.stocks.length?(angular.forEach(i.stocks,function(e){var i=!1;i=n.currentVariationPure.length?o===JSON.stringify(e.variant_signature):!e.variant_signature.length,!t&&i&&(r=e.availability,t=!0)}),t||angular.forEach(i.stocks,function(e){if(!t){var i=[];angular.forEach(n.currentVariationPure,function(n,r){if(!t){var o,a,s;try{a=e.variant_signature[r],o=JSON.stringify(a),n=JSON.stringify(n),s=n===o||"***Any***"===_.values(a)[0]}catch(c){return}i.push(s?!0:!1)}}),_.without(i,!0).length||(r=e.availability,t=!0)}}),e?"out of stock"!==r:c.fields.translateChoices[133].availability[r]):c.fields.translateChoices[133].availability[r]},n.addToCart=function(){if(i._is_guest)return void e[11].login(d.href((m.hideCloseCatalog?"embed-":"")+"catalog-product-add-to-cart",{key:n.catalog.key,image_id:n.catalog._images[0].id,pricetag_id:n.catalog._images[0].pricetags[0].id,variant:a.url.jsonToUrlsafe(n.currentVariation),quantity:n.productQuantity}));if(!n.getAvailability(!0))return void p.showK("productOutOfStock");if(m.autoAddToCart&&(n.productQuantity=m.autoAddToCartQuantity),!n.hasThisProduct&&n.productQuantity<1){n.container.form.$setDirty();var t=n.container.form.productQuantity;return t.$setViewValue(void 0!==t.$viewValue?t.$viewValue:""),t.$setDirty(),void t.$setValidity("required",!1)}n.activitySpinner.start(),e[19].current().then(function(t){return e[34].actions.update_line({buyer:t.data.entity.key,product:n.product.key,image:o,quantity:n.productQuantity,variant_signature:n.currentVariation},{handleError:c.backendErrorHandling.productOutOfStock})}).then(function(t){m.events&&m.events.addToCart&&m.events.addToCart.call(this,t),e[34].removeCache("current"+g),n.productQuantity<1?(n.hasThisProduct=!1,n.productQuantity=1):(n.hasThisProduct=!0,n.disableUpdateCart=!0),p.showK("cartUpdated")})["finally"](function(){n.activitySpinner.stop()})},m.autoAddToCart&&u(function(){n.addToCart(),m.autoAddToCart=!1}),n.close=function(){var e=n.$close();return e.then(function(){m.afterClose&&m.afterClose()}),e},n.notInitialLoad=!0,n.$watch("product.id",function(e,t){h()}),y.resolve()},w)}]}).opened["catch"](w),b},viewModal:function(n,o){var s=this;r.open({templateUrl:"catalog/view.html",windowClass:"no-overflow",popFrom:o.popFrom,inDirection:o.inDirection,outDirection:o.outDirection,noEscape:o.noEscape,controller:["$scope",function(r){r.hideClose=o.hideClose,r.$state.promise(function(){return s.actions.read({key:n,read_arguments:{_seller:{_content:{}},_images:{pricetags:{}}}},{disableUI:!1})},function(n,r){var c=r.data.entity;c._images.length||p.showK("noImagesInCatalog"),n.catalogMenu={},a.sideNav.setup(n.catalogMenu,"right_catalog_sidenav",t),n.catalog=c,n.catalog.action_model="31",n.logoImageConfig={size:560};var l,g,m,h=d.href("catalog-view",{key:n.catalog.key},{absolute:!0}),v=d.href("embed-catalog-view",{key:n.catalog.key},{absolute:!0});g=angular.copy(n.catalog.ui.access),g.push("_images"),l=e[31].reader({firstLoad:!1,key:n.catalog.key,next:{_images:n.catalog._next_read_arguments._images},access:g,complete:function(e){n.catalog._images.extend(e)}}),l.showLoaderAlways=!0,n.imagesReader=l,n.socialMeta={facebook:{u:h},twitter:{url:h,text:"Catalog - "+n.catalog.name},pinterest:{url:h,media:a.url.handleProtocol(n.catalog._images[0].serving_url+"=s600"),description:"Share on pinterest"},googleplus:{url:h},reddit:{url:h,title:n.catalog.name},linkedin:{url:h,title:n.catalog.name},tumblr:{url:h,name:n.catalog.name}},n.displayShare=function(){return f.share(n.socialMeta,{src:v})},n.loadMoreImages=function(e){var t=l.load();t?t.then(function(){e.call(this,r,l.more)}):e.call(this,void 0,l.more)},n.displayCart=function(){return i._is_guest?void e[11].login(d.href((o.hideClose?"embed-":"")+"catalog-order-view",{key:n.catalog.key})):void e[19].current().then(function(t){
e[34].manageModal(void 0,n.catalog._seller,t.data.entity,{cartMode:!0})})},o.openCart&&u(function(){n.displayCart()}),n.loadingProduct=!1,n.viewProduct=function(e,t,i){var r=i.target,a=$(r).parents(".catalog-pricetag:first");a.length&&(r=a.get(0)),n.loadingProduct=!0,s.viewProductModal(n.catalog.key,e.key,t.key,o.variantSignatureAsDicts,{popFrom:r,hideClose:o.hideCloseOnProduct,hideCloseCatalog:o.hideClose,noEscapeCatalog:o.noEscape,noEscape:o.noEscapeOnProduct,autoAddToCart:o.variantSignatureAsDicts&&o.autoAddToCart?!0:!1,autoAddToCartQuantity:o.autoAddToCartQuantity,afterClose:o.afterCloseProduct})["finally"](function(){n.loadingProduct=!1}),o.variantSignatureAsDicts=null},n.openSellerDetails=function(){n.sellerDetails.menu.open()},n.maybeLoadProduct=null,o.loadProduct&&(m=function(){if(angular.forEach(n.catalog._images,function(e){e.id.toString()===o.loadProduct.image.toString()&&(n.maybeLoadProduct=o.loadProduct)}),!n.maybeLoadProduct){var e=l.load();e&&e.then(m)}})(),n.sellerDetails=e[23].makeSellerDetails(n.catalog._seller),n.close=function(){var e=n.$close();return e.then(function(){o.afterClose&&o.afterClose()}),e}})}]})}})})}])}(),function(){"use strict";angular.module("app").controller("RootController",["$scope","$mdSidenav","$timeout",function(e,t,n){}]).directive("closeMasterMenu",["$mdSidenav","$timeout","$parse",function(e,t,n){return{link:function(e,t,i){var r=n(i.closeMasterMenu);t.on("click",function(){e.site.toolbar.menu.close().then(function(){r&&(e.$$phase?r(e,{$event:event}):e.$apply(function(){r(e,{$event:event})}))})})}}}]).directive("toolbarPaddingControl",function(e){return{restrict:"A",controller:["$scope","$element",function(e,t){var n=this;n.recalculate=function(){var e=t.find(".md-toolbar-item.md-breadcrumb"),n=0,i=t.find(".md-toolbar-item.md-tools.actions-right");i.length&&(n=i.width()),e.css("padding-right",n+16)}}],link:function(t,n,i,r){e(r.recalculate,0,!1)}}}).directive("toolbarPaddingControlElement",function(e){return{restrict:"A",require:"^toolbarPaddingControl",link:function(t,n,i,r){e(r.recalculate,0,!1),t.$on("$destroy",function(){e(r.recalculate,100,!1)})}}}).directive("homeSplash",["$animate",function(e){return{restrict:"A",link:function(e,t,n){t.addClass("fade out").oneAnimationEnd(function(){t.addClass("ng-hide")})}}}]).controller("LoginLinksController",["$scope","models",function(e,t){e.login=function(){t[11].login()}}]).run(["$rootScope","GLOBAL_CONFIG","currentAccount","helpers",function(e,t,n,i){e.site={title:"",toolbar:{hideRight:!0,hideLeft:!1,title:"",menu:{}}},e.contentSpinner={hide:[],show:[],last:null,stop:function(){if(this.hide){var e=this.hide.length-1;angular.forEach(this.hide,function(t,n){n===e?t():t(!0)})}},start:function(){var e=this.hide.length-1;angular.forEach(this.hide,function(t,n){n!==e&&t()}),this.show&&(_.last(this.show)||angular.noop)()}},e.activitySpinner=angular.copy(e.contentSpinner),e.currentAccount=n,e.GLOBAL_CONFIG=t,e.JSON=JSON,e.helpers=i,e.setPageTitle=function(t,n){e.site.title=i.toolbar.title(t),n||(e.site.toolbar.title=e.site.title)},e.setPageToolbarTitle=function(t,n){e.site.toolbar.title=i.toolbar.title(t),n||(e.site.title=e.site.toolbar.title)},e.$on("$stateChangeStart",function(){e.site.toolbar.hideRight=!0,e.site.toolbar.actionRight=void 0,e.site.toolbar.hidden=!1}),i.sideNav.setup(e.site.toolbar.menu,"left")}]).controller("AboutController",["$scope",function(e){e.socials=[{name:"Facebook",key:"facebook",command:"https://www.facebook.com/themiraclestyle/"},{name:"Twitter",key:"twitter",command:"https://twitter.com/themiraclestyle"},{name:"Pinterest",key:"pinterest",command:"https://www.pinterest.com/themiraclestyle/"},{name:"Instagram",key:"instagram",command:"https://www.instagram.com/themiraclestyle/"},{name:"Linkedin",key:"linkedin",command:"https://www.linkedin.com/company/miraclestyle"},{name:"YouTube",icon:"youtube",command:"https://www.youtube.com/channel/UCy8iFLR6b1NXX8mhCgv2toA"},{name:"Google+",icon:"googleplus",command:"https://plus.google.com/b/117800240045842886424/"},{name:"Tumblr",key:"tumblr",command:"http://themiraclestyle.tumblr.com/"}],e.share=function(e){return e.command},e.getIcon=function(e){return"/client/dist/static/social/"+(e.icon||e.name.toLowerCase())+".png"},e.setPageToolbarTitle("about")}]).controller("HomePageController",["$scope","models","modals","$state","$stateParams","helpers","$q","modelsMeta",function(e,t,n,i,r,o,a,s){var c={search:{filters:[{field:"state",operator:"IN",value:["indexed"]}],orders:[{field:"published_date",operator:"desc"}]}},l=a.defer(),u=l.promise;e.setPageToolbarTitle("home"),e.sellerDetails=!1,e.viewProfile=function(e,n){t[23].viewProfileModal(e,{popFrom:n.target})},e.view=function(e,n){t[31].viewModal(e,{popFrom:o.clicks.realEventTarget(n.target)})},r.key&&(e.sellerMode=!0,e.setPageToolbarTitle("sellerProfile"),c.search.filters=[{field:"seller_account_key",operator:"IN",value:r.key}],t[23].actions.read({account:r.key,read_arguments:{_content:{}}}).then(function(n){e.sellerDetails=t[23].makeSellerDetails(n.data.entity)}),e.site.toolbar.hideRight=!1,e.site.toolbar.actionRight=function(){e.sellerDetails.menu.open()}),l.resolve(),e.search={results:[],pagination:t[31].paginate({kind:"31",args:c,config:{normalizeEntity:!1},action:"search",complete:function(t){var n=t.data.entities;e.search.results.extend(n)}})},e.scrollEnd={loader:!1},e.scrollEnd.loader=e.search.pagination,u.then(function(){e.search.pagination.load()})}])}(),function(){"use strict";angular.module("app").run(["modelsConfig","modelsMeta",function(e,t){e(function(e){e[12].config.cache=!0,e[12].getSubdivisions=function(n,i){var r=e[13],o=t.getDefaultActionArguments(r.kind,"search");return o.ancestor=n,r.search(o,i)}})}])}(),function(){"use strict";angular.module("app").controller("OrderViewController",["$scope","models","currentAccount","$state",function(e,t,n,i){var r=!1;t[34].manageModal({key:i.params.key},void 0,void 0,{inDirection:!1,outDirection:!1,afterClose:function(){r&&i.go(r.parent.parent.key===n.key?"buy-orders":"sell-orders")}}).then(function(e){r=e})}]).directive("alwaysScrollToBottom",["$timeout",function(e){return{link:function(t,n,i){var r=function(){n.scrollTop(n[0].scrollHeight)};t.$watchGroup(t.$eval(i.alwaysScrollToBottom),function(t,n){JSON.stringify(t)!==JSON.stringify(n)&&e(r,100,0)})}}}]).filter("displayTaxes",function(){return function(e){var t="";return e&&(t=$.map(e,function(e){return e.name}).join(", ")),t}}).run(["modelsMeta","modelsConfig","$modal","modals","snackbar","$state","helpers","endpoint","$q","$filter","currentAccount","$mdSidenav","$timeout",function(e,t,n,i,r,o,a,s,c,l,u,d,p){t(function(t){$.extend(t[34],{current:function(e,n){var i=this;return t[19].current().then(function(t){var r=t.data.entity;return i.actions.view_order({buyer:r.key,seller:e},$.extend({cache:i.getCacheKey("current"+e),cacheType:"memory"},n))})},adminManageModal:function(e,t){return t=a.alwaysObject(t),this.manageModal(e,e._seller,void 0,$.extend({sellerMode:!0},t))},manageModal:function(s,l,f,g){g=a.alwaysObject(g);var m,h,v=this,y=g.cartMode,b=g.sellerMode,w=c.defer(),k=w.promise;return m=y?{buyer:f.key,seller:l.key,read_arguments:{_seller:{_content:{}},_messages:{_agent:{}}}}:{key:s.key,read_arguments:{_lines:{config:{limit:0}},_seller:{_content:{}},_messages:{_agent:{}}}},h={templateUrl:"order/view.html",controller:["$scope",function(c){c.dialog={toolbar:{title:s&&"cart"!==s.state?"Order":"Cart",templateRight:"order/toolbar_actions.html"}},c.$state.promise(function(){return t[34].actions[y?"view_order":"read"](m,{disableUI:!1})},function(c,f){l=f.data.entity._seller;var m={customPlaceholder:null,spawnAddress:null,updateLiveEntity:function(e,t){var n=c.order._messages,i=c.order._lines;$.extend(c.order,e.data.entity),c.order._messages=n,t&&t.noLines&&(c.order._lines=i),i=null},reactOnStateChange:function(e){a.update(c.order,e.data.entity,["state","ui"]),m.reactOnUpdate()},reactOnUpdate:function(e){s&&$.extend(s,c.order),v.removeCache("current"+l.key)},logMessageAction:e.getActionArguments("34","log_message"),orderUpdateFields:e.getActionArguments("34","update"),billingAddressFields:[],shippingAddressFields:[],sorter:function(e,n){var i=t[19].manageModalFieldsOrder.indexOf(e.code_name),r=t[19].manageModalFieldsOrder.indexOf(n.code_name);return-1===i&&(i=99999),i-r}};angular.forEach(m.orderUpdateFields.shipping_address.modelclass,function(e){$.extend(e.ui,{args:"addresses.shipping."+e.code_name,parentArgs:"addresses.shipping",writable:!0,name:"supplier_"+e.code_name}),e.required=e.required?"!addresses.sameAsBilling":!1,m.shippingAddressFields.push(e)}),angular.forEach(m.orderUpdateFields.billing_address.modelclass,function(e){$.extend(e.ui,{args:"addresses.billing."+e.code_name,parentArgs:"addresses.billing",writable:!0,name:"supplier_"+e.code_name}),m.billingAddressFields.push(e)}),m.billingAddressFields.sort(m.sorter),m.shippingAddressFields.sort(m.sorter),$.extend(m.logMessageAction.message.ui,{label:!1,args:"messages.draft.message",parentArgs:"messages.draft",writable:"order.ui.rule.action.log_message.executable || !order.id",placeholder:"Type a message here",attrs:{"native-placeholder":"","class":"primary","min-length":"1","on-enter":"messages.logMessage()"}}),c.dialog={toolbar:{templateRight:"order/toolbar_actions.html"}},c.$watch("order.state",function(e,t){var n="Cart";"completed"===e&&(n="Order"),c.dialog.toolbar.title=n}),c.today=new Date,c.stage={checkout:null,current:1,out:[],canShowPay:function(){return"checkout"===c.order.state},isOut:function(e){return-1!==$.inArray(e,c.stage.out)},toCheckout:function(){c.stage.animating=2,c.stage.out.push(1),c.stage.current=2,p(function(){c.stage.animating=!1},6e4)},toDeliveryMethod:function(){var e=c.addresses.form.billing.$valid,t={billing_address:c.addresses.billing};c.addresses.sameAsBilling?t.shipping_address=c.addresses.billing:(e=e&&c.addresses.form.shipping.$valid,t.shipping_address=c.addresses.shipping),e?c.cmd.order.update(t).then(function(e){a.endpoint.isResponseError(e)||(c.stage.out.push(2),c.stage.current=3)}):(a.form.wakeUp(c.addresses.form.billing),c.addresses.sameAsBilling||a.form.wakeUp(c.addresses.form.shipping))},toReviewOrder:function(){i.confirm("toCheckout",function(){c.carrier.form.$valid?c.cmd.order.update({carrier:c.carrier.selected,state:"checkout"}).then(function(){c.stage.out.push(3),c.stage.current=4}):a.form.wakeUp(c.carrier.form)})},complete:function(){c.stage.out=[],c.stage.current=1}},c.logoImageConfig={size:280},m.spawnAddress=function(e){return e?(e.country=null,e.kind="14",delete e.key,e.region=null,t[12].actions.search({search:{keys:[[["12",e.country_code.toLowerCase()]]]}},{cache:!0,disableUI:!1}).then(function(n){return e.country=n.data.entities[0].key,t[13].actions.search({search:{keys:[[["12",e.country_code.toLowerCase(),"13",e.region_code.toLowerCase()]]]}},{cache:!0,disableUI:!1}).then(function(t){e.region=t.data.entities[0].key})}),e):e},c.cmd={},c.container={},c.cartMode=y,c.sellerMode=b,c.order=f.data.entity,c.seller=l,c.currentAccount=u,c.addresses={sameAsBilling:!0,form:{},shipping:m.spawnAddress(c.order.shipping_address)||{},billing:m.spawnAddress(c.order.billing_address)||{},browse:function(e){var i=c;n.open({inDirection:!1,windowClass:"modal-medium-simple",outDirection:!1,fullScreen:!1,backdrop:!0,templateUrl:"order/browse_addresses.html",controller:["$scope",function(n){n.$state.promise(function(){return t[19].current()},function(n,r){n.addresses=r.data.entity.addresses,n.select=function(t){var r=function(){angular.forEach(t,function(t,n){i.addresses[e][n]=t})};r(),n.$close().then(function(){p(r,100)})},n.manage=function(){t[19].manageModal(r.data.entity.parent.key,function(e){n.addresses=e.args.addresses},{inDirection:!1,outDirection:!1})}})}]})},fields:{shipping:m.shippingAddressFields,billing:m.billingAddressFields,sameAsBilling:{type:"SuperBooleanProperty",code_name:"sameAsBilling",ui:{writable:!0,parentArgs:"addresses",args:"addresses.sameAsBilling",specifics:{type:"checkbox"}}}}},c.payment={method:c.order.payment_method},c.carrier={selected:c.order.carrier?c.order.carrier.reference:null,available:f.data.carriers||[],form:null},c.format={variantVisible:function(e){var t=c.format.variantValue(e);return angular.isString(t)&&t.length?!0:!1},variantLabel:function(e){return Object.keys(e)[0]},variantValue:function(e){return e[c.format.variantLabel(e)]}},c.order._messages&&c.order._messages.length&&c.order._messages.reverse(),c.messages={isToday:function(e){return e.created?c.today.getDay()===e.created.getDay()&&c.today.getMonth()===e.created.getMonth():!1},reader:c.order.id?t[34].reader({key:c.order.key,next:{_messages:angular.copy(c.order._next_read_arguments._messages)},access:["_messages"],complete:function(e){c.order._messages.prepend(e)}}):{},toggling:!1,open:!1,stateChanged:function(e){c.messages.sync.toggle(e)},sync:{timer:null,active:!1,stop:function(){this.active=!1,this.loading=!1,clearTimeout(this.timer)},start:function(){c.order.id&&c.order._lines.length&&(this.active=!0,this.run())},toggle:function(e){e?this.start():this.stop()},loading:!1,run:function(){var e=this;!this.loading&&this.active&&(clearTimeout(this.timer),this.loading=!0,this.timer=setTimeout(function(){t[34].actions.read({key:c.order.key,read_arguments:{_messages:{_agent:{}}}},{disableUI:!1}).then(function(e){var t={},n=!1,i=e.data.entity._messages;angular.forEach(c.order._messages,function(e,n){t[e.key]=1}),angular.forEach(i,function(e){t[e.key]||(c.order._messages.push(e),n=!0)}),n&&c.messages.forceReflow()})["finally"](function(){e.loading=!1,e.timer=null,e.run()})},2e3))}},draft:{message:null,key:c.order.key},field:m.logMessageAction.message,nav:function(){return d(c.messages.sidebarID)},sent:!1,resendMaybe:function(e){e._failed=!1;var n=angular.copy(e);return n.key=c.order.key,n.message=n.body,t[34].actions.log_message(n,{disableUI:!1}).then(function(t){return c.messages.forceReflow(),t.data.entity?($.extend(e,t.data.entity._messages[0]),m.reactOnStateChange(t),t):void 0},function(){e._failed=!0})},send:function(e){var n=angular.copy(c.messages.draft),i={body:n.message};return c.messages.draft.message="",c.order._messages.push(i),t[34].actions[e](n,{disableUI:!1}).then(function(e){return c.messages.forceReflow(),e.data.entity?($.extend(i,e.data.entity._messages[0]),m.reactOnStateChange(e),e):void 0},function(){i._failed=!0})},forceReflow:function(){c.messages.sent=!c.messages.sent},sidebarID:"messages"+_.uniqueId(),logMessage:function(){return c.order._lines.length?c.container.messages.$valid?this.send("log_message").then(function(e){return c.container.messages.$setSubmitted(!0),c.container.messages.$setPristine(!0),e}):void a.form.wakeUp(c.container.messages):void r.showK("messangerDisabledWhenEmpty")},close:function(){return c.message.toggle(!0)},toggle:function(e){if(!c.order._lines.length)return void r.showK("messangerDisabledWhenEmpty");if(!c.messages.toggling){var t=c.messages.nav(),n=t.isOpen();c.messages.toggling=!0,e===!0&&(n=!0),p(function(){t[n?"close":"open"]().then(function(){c.messages.toggling=!1,c.messages.open=!n})})}}},c.cmd.order={scheduleUpdatePromise:null,scheduleNext:!0,scheduleLoading:!1,scheduleUpdate:function(e,t){var n=this;return n.scheduleLoading?n.scheduleNext=[e,t]:(n.scheduleLoading=!0,n.scheduleNext=null,n.scheduleUpdatePromise=n.update(e,t).then(function(e){return n.scheduleLoading=!1,n.scheduleNext?n.scheduleUpdate.apply(n,n.scheduleNext):e})),n.scheduleUpdatePromise},update:function(e,n){n=a.alwaysObject(n);var i={key:c.order.key,payment_method:c.payment.method,_lines:c.order._lines};return $.extend(i,e),t[34].actions.update(i,{ignoreErrors:2,activitySpinner:!n.noLoader}).then(function(e){var t=e.data.errors;return t?(t.plugin_error&&-1!==$.inArray("invalid_address",t.plugin_error)&&r.showK("sellerProhibtsAddress"),e):(m.updateLiveEntity(e,n),m.reactOnUpdate(),c.carrier.available=e.data.carriers,c.carrier.selected=e.data.entity.carrier?e.data.entity.carrier.reference:null,e)})["finally"](function(){c.container.paypal&&c.container.paypal.$setPristine()})},showNetTotalAmount:function(){var e=parseFloat(c.order.untaxed_amount,10);return 1===c.stage.current?(c.order.carrier&&c.order.carrier.subtotal&&(e-=parseFloat(c.order.carrier.subtotal,10)),e):e},showTotalAmount:function(){var e=parseFloat(c.order.total_amount,10);return 1===c.stage.current?(c.order.carrier&&c.order.carrier.subtotal&&(e-=parseFloat(c.order.carrier.subtotal,10)),c.order.tax_amount&&(e-=parseFloat(c.order.tax_amount,10)),e):e},cancel:function(){"checkout"===c.order.state&&i.confirm("cancelOrder",function(){t[34].actions.cancel({key:c.order.key},{activitySpinner:!0}).then(function(e){m.updateLiveEntity(e),m.reactOnUpdate(!0),t[34].removeCache("current"+l.key),c.close()})["finally"](function(){c.activitySpinner.stop()})})}},c.cmd.line={view:function(e,n){var i=e.product._reference;t[31].viewProductModal(i.parent.parent.parent.key,i.parent.parent.key,i.pricetag.key,e.product.variant_signature,{popFrom:a.clicks.realEventTarget(n.target),orderKey:c.order.key,events:{addToCart:m.updateLiveEntity}})},remove:function(e){e.quantity=0,e._state="deleted"}},c.cmd.seller={view:function(){c.sellerDetails.menu.open()}},c.sellerDetails=t[23].makeSellerDetails(c.seller),c.lineDrag={options:{disabled:!1,axis:"x",handle:".sort-handle",distance:10,stop:function(e,t){c.$apply()}},whatSortMeans:function(){i.alert("howToDeleteDragging")},onStart:function(e,t,n){$(t.helper).find(".sort-handle").addClass("dragged")},onDrag:function(e,t,n){var i,r,o=t.helper.width();r=t.offset.left+o,o/2>r&&(i=!0),n&&(i?t.helper.addClass("about-to-delete"):t.helper.removeClass("about-to-delete"))},onStop:function(e,t,n){t.helper.hasClass("about-to-delete")?t.helper.animate({left:2*t.helper.width()*-1},function(){p(function(){n.product.quantity="0",n._state="deleted",t.helper.hide(),c.cmd.order.scheduleUpdate(void 0,{noLines:!0}).then(function(e){e&&e.then||r.showK("cartUpdated")})})}):t.helper.animate(t.originalPosition,function(){t.helper.attr("style","")})}},function(){("checkout"===c.order.state||"canceled"===c.order.state||"completed"===c.order.state)&&(c.stage.out.extend([1,2,3]),c.stage.current=4,c.stage.checkout=1)}(),c.close=function(){var e=c.$close();return e.then(g.afterClose||angular.noop),e},c.notifyUrl=o.href("order-notify",{method:"paypal"},{absolute:!0}),c.completePath=o.href("order-payment-success",{key:c.order.key},{absolute:!0}),c.cancelPath=o.href("order-payment-canceled",{key:c.order.key},{absolute:!0}),c.$on("$destroy",function(){c.messages.sync.stop()}),w.resolve(c.order)})}]},$.extend(h,g),n.open(h),k}})})}])}(),function(){"use strict";var e=function(e){return angular.isString(e)||angular.isNumber(e)};angular.module("app").controller("SellerInfo",["$scope","$state","$stateParams","models",function(e,t,n,i){e.site.toolbar.hidden=!0,i[23].viewProfileModal(n.key,{inDirection:!1,outDirection:!1,afterClose:function(){t.go("home")}})}]).controller("SellerEmbedInfo",["$scope","$stateParams","models",function(e,t,n){e.site.toolbar.hidden=!0,n[23].viewProfileModal(t.key,{hideClose:!0,inDirection:!1,outDirection:!1})}]).directive("addressRuleLocationListView",function(){return{scope:{val:"=addressRuleLocationListView"},templateUrl:"seller/address_rule_location_list_view.html",controller:["$scope",function(t){t.notEmpty=e,t.postalCodes=function(e){return e.join(", ")}}]}}).directive("defaultLineListView",function(){return{scope:{val:"=defaultLineListView"},templateUrl:"seller/default_line_list_view.html"}}).directive("carrierLineRuleListView",function(){return{scope:{val:"=carrierLineRuleListView"},templateUrl:"seller/carrier_line_rule_list_view.html",controller:["$scope",function(t){t.notEmpty=e}]}}).controller("SellerManagementController",["$scope","endpoint","currentAccount","models",function(e,t,n,i){e.settings=function(){i[23].manageModal(n.key)}}]).controller("SellCatalogsController",["$scope","modals","helpers","currentAccount","modelsEditor","modelsMeta","snackbar","models","modelsUtil","$rootScope",function(e,t,n,i,r,o,a,s,c,l){e.setPageToolbarTitle("seller.catalogs");var u=function(t){t.key&&(_.findWhere(e.search.results,{key:t.key})||e.search.results.unshift(t))};e.create=function(e){s[31].manageModal(void 0,u,{popFrom:n.clicks.realEventTarget(e.target)})},e.preview=function(e,t){s[31].previewModal(e,{popFrom:n.clicks.realEventTarget(t.target)})},e.manage=function(e,t){s[31].manageModal(e,u,{popFrom:n.clicks.realEventTarget(t.target)})},e.search={results:[],pagination:{},loaded:!1},e.scrollEnd={loader:!1},s[23].current().then(function(t){var n=t.data.entity;e.search.pagination=s[31].paginate({kind:"31",args:{search:{ancestor:n.key,filters:[{field:"state",operator:"IN",value:["draft","published","indexed"]}],orders:[{field:"created",operator:"desc"},{field:"key",operator:"desc"}]}},error:function(t){e.search.loaded=!0},complete:function(t){e.search.results.extend(t.data.entities),e.search.loaded=!0}}),e.scrollEnd.loader=e.search.pagination,e.search.pagination.load()})}]).controller("SellOrdersController",["$scope","modals","modelsEditor","snackbar","helpers","currentAccount","GLOBAL_CONFIG","modelsMeta","models","modelsUtil","$state",function(e,t,n,i,r,o,a,s,c,l,u){var d="sell-carts"===u.current.name;e.setPageToolbarTitle("seller."+(d?"carts":"orders")),e.listHelp=d?a.emptyHelp.cartSellerList:a.emptyHelp.orderSellerList,e.search={results:[],pagination:{},loaded:!1},e.scrollEnd={loader:!1},e.view=function(e,t){c[34].manageModal(e,e._seller,void 0,{sellerMode:d,popFrom:r.clicks.realEventTarget(t.target)})},c[23].current().then(function(t){var n=t.data.entity;e.search.pagination=c[34].paginate({kind:"34",args:{search:{filters:[{field:"seller_reference",operator:"==",value:n.key}],orders:[{field:"updated",operator:"desc"}]}},config:{ignoreErrors:2},complete:function(t){var n=t.data.errors;n||e.search.results.extend(t.data.entities),e.search.loaded=!0}}),e.scrollEnd.loader=e.search.pagination,e.search.pagination.load()})}]).run(["modelsConfig","modelsMeta","modelsEditor","formInputTypes","underscoreTemplate","$state","$stateParams","$modal","modals","social","helpers","$q","$timeout","currentAccount","$filter","dateFilter","GLOBAL_CONFIG","snackbar",function(e,t,n,i,r,o,a,s,c,l,u,d,p,f,g,m,h,v){var y=function(e){var t=h.fields.translateChoices.rules.kind[e];return angular.isDefined(t)?t:e};e(function(e){i.SuperPluginStorageProperty=function(n){var o=n.config,a=o.kinds,l=u.callable(n.scope.formSetDirty),f=function(){return{listView:"default-line-list-view",listConfig:{perLine:2}}},m=function(){return{ui:{specifics:{type:"radio",trueLabel:h.fields.radioLabel.pluginLocation.trueLabel,falseLabel:h.fields.radioLabel.pluginLocation.falseLabel}}}},v=function(e,t,n){return{ui:{groupBy:e,groupHelp:n,groupLabel:t,label:!1}}},b=function(){return{listView:"address-rule-location-list-view",sortFields:["country","region","postal_codes"],listConfig:{calculate:function(e,t){var n=0;return angular.forEach(["country","region","postal_codes"],function(t){var i=e[t];i&&i.length&&(n+=1)}),n===t}},beforeSave:function(t,n){var i,r=[],o=t.args;return!o.region||o._region&&o.region===o._region.key||(i=e[13].get(o.region,{activitySpinner:!0}),i.then(function(e){e.data.entities.length&&(o._region=e.data.entities[0])}),r.push(i)),!o.country||o._country&&o.country===o._country.key||(i=e[12].actions.search(void 0,{cache:!0,cacheType:"local",activitySpinner:!0}),i.then(function(e){if(e.data.entities.length){var t=_.findWhere(e.data.entities,{key:o.country});angular.isDefined(t)&&(o._country=t)}}),r.push(i)),r.length?d.all(r):!1}}},w={aboutPlugins:function(){s.open({templateUrl:"core/models/manage.html",controller:["$scope",function(e){e.dialog={templateBodyUrl:"seller/help/plugins.html",toolbar:{hideSave:!0,leftIcon:"arrow_back",title:u.toolbar.title("seller.settings.aboutRules")}}}]})},setupSortableOptions:function(){return{disabled:!1,start:function(e,t){n.scope.$broadcast("itemOrderStarted")},distance:6,axis:!1,containment:!1,whatSortMeans:function(){c.alert("howToSort")},handle:".sort-handle",tolerance:"pointer",helper:"clone",sort:function(e,t){var i,r,o=t.helper.width(),a=t.item.scope(),s=a.$eval(t.item.attr("current-item"));r=t.offset.left+o,o/2>r&&(i=!0),s&&(i?(t.helper.addClass("about-to-delete"),s._state="deleted",n.scope.formSetDirty()):(t.helper.removeClass("about-to-delete"),s._state=null)),n.scope.$broadcast("itemOrderSorting")},stop:function(e,t){var i;angular.forEach(o.ui.specifics.parentArgs,function(e,t){t=o.ui.specifics.parentArgs.length-1-t,(e._sequence!==t||"deleted"===e._state)&&(i=!0),e._sequence=t,e.ui&&(e.ui.access[e.ui.access.length-1]=t)}),i&&n.scope.formSetDirty(),n.scope.$broadcast("itemOrderChanged"),n.scope.$apply()}}},pluginFieldOverrides:{113:{lines:{ui:{specifics:f()},modelclass:{prices:{ui:{specifics:{toolbar:{titleEdit:"editPrice",titleAdd:"addPrice"},listView:"carrier-line-rule-list-view",listConfig:{perLine:2}}},modelclass:{condition_type:v("conditional",h.fields.label["111-update"].condition_type,h.fields.help["111-update"].condition_type),condition_operator:v("conditional"),condition_value:v("conditional"),price_type:v("price",h.fields.label["111-update"].price_type,h.fields.help["111-update"].price_type),price_operator:u.extendDeep(v("price"),{ui:{active:"args.price_type !== 'fixed'"}}),price_value:v("price")}},exclusion:m(),locations:{ui:{specifics:b()}}}}},107:{exclusion:m(),locations:{ui:{specifics:b()}}},126:{lines:{ui:{specifics:f()},modelclass:{product_categories:{ui:{specifics:{search:{enabled:!0}}}},condition_type:v("conditional",h.fields.label["124-update"].condition_type,h.fields.help["124-update"].condition_type),condition_operator:v("conditional"),condition_value:v("conditional")}}},109:{product_categories:{ui:{specifics:{search:{enabled:!0}}}},carriers:{ui:{specifics:{checkboxes:!0,entities:function(){return o.ui.specifics.parentArgs?$.map(o.ui.specifics.parentArgs,function(e){return e.active&&"113"===e.kind?{key:e.key,name:e.name}:void 0}):[]}}}},exclusion:m(),locations:{ui:{specifics:b()}}}},showType:y,kind:void 0,selectKinds:{type:"SuperStringProperty",_maker_:"rules",choices:a,required:!0,ui:{args:"info.kind",label:h.fields.label.plugins.kind,attrs:{"ng-change":"setNewArg()"},writable:!0},code_name:"kind"},remove:function(e){e._state="deleted",n.scope.$emit("itemDelete",e),n.scope.$broadcast("itemDelete",e),l()},create:function(){return this.manage()},manage:function(e){angular.isDefined(o.ui.specifics.templateUrl)||(o.ui.specifics.templateUrl="core/fields/manage_structured.html"),s.open({template:r.get(o.ui.specifics.templateUrl)({config:o}),controller:["$scope","modelsUtil",function(r,a){var s,f=function(){r.layouts={groups:[{label:!1}]},r.formBuilder={0:[o.ui.specifics.selectKinds]}},m=function(e,t){var n=w.pluginFieldOverrides[e];return angular.isDefined(n)&&angular.isDefined(n[t])?angular.copy(n[t]):{}};o.ui.specifics.toolbar={leftIcon:"arrow_back",hideSave:!0},angular.isUndefined(o.ui.specifics.toolbar.titleAdd)&&(o.ui.specifics.toolbar.titleAdd="add"+u.toolbar.makeTitle(o.code_name)),angular.isUndefined(o.ui.specifics.toolbar.titleEdit)&&(o.ui.specifics.toolbar.titleEdit="edit"+u.toolbar.makeTitle(o.code_name)),s=function(){return o.ui.specifics.toolbar["title"+(r.isNew?"Add":"Edit")]},o._title_.push(s),r.isNew=!1,e?a.normalize(e,void 0,o.ui.specifics.entity,o.code_name,o.ui.specifics.parentArgs.length):(e={},r.isNew=!0),r.$watch("isNew",function(){o.ui.specifics.toolbar.title=u.toolbar.buildTitle(o._title_)}),r.info={build:!0},r.container={},r.config=o,r.$on("$destroy",function(){o._title_.remove(s),o.ui.specifics.getScope=void 0}),r.$state.instant(function(){r.setNewArg=function(){0!==r.info.kind&&r.args.kind!==r.info.kind&&(e={kind:r.info.kind},a.normalize(e,void 0,o.ui.specifics.entity,o.code_name,o.ui.specifics.parentArgs.length,!1),r.isNew=!0,r.args=e,r.getFormBuilder(),r.info.build=!1,p(function(){r.info.build=!0,r.$apply()},100))},f(),r.getFormBuilder=function(){f();var e=r.info.kind,n=t.getFields(e),a=0,s=!1;n=_.toArray(n),n.sort(u.fields.sorter),o.ui.specifics.fields=n,angular.forEach(n,function(t){u.fields.applyGlobalConfig(t),t._title_=o._title_.concat(),t.ui.name="plugin."+t.code_name,t.ui.writable=!0;var n,a=m(e,t.code_name);a&&u.extendDeep(t,a),u.fields.isFieldset(t)&&i[t.type]?(r.layouts.groups.push({label:t.ui.label||g("humanized")(t.code_name),disabled:!1,open:!1}),t.ui.label=!1,n=r.layouts.groups.length-1,angular.isDefined(r.formBuilder[n])||(r.formBuilder[n]=[],r.formBuilder[n].push(t)),r.layouts.groups[0].disabled=!1):r.formBuilder[0].push(t)}),angular.forEach(r.layouts.groups,function(e,t){r.formBuilder[t].length&&(a+=1),s===!1&&(r.formBuilder[t].length?(e.open=!0,s=e):e.open=!1)}),1===a&&(s.disabled=!0)},r.args=angular.copy(e),r.parentArgs=o.ui.specifics.parentArgs,r.entity=o.ui.specifics.entity,r.rootFormSetDirty=l,r.formSetDirty=angular.bind(r,u.form.setDirty),r.formSetPristine=angular.bind(r,u.form.setPristine),r.validateForm=angular.bind(r,u.form.validate),r.args&&r.args.kind&&(r.info.kind=r.args.kind,r.getFormBuilder()),r.close=function(){if(!r.container.form.$dirty)return r.$close();var e=r.save();return e?e.then(function(){return r._close_=void 0,r.$close()}):c.confirm("discardWithFieldsRequired",r.$close)},r._close_=r.close,r.save=function(){var t,i,a=d.defer(),s=a.promise;if(r.validateForm()&&r.info.kind)return angular.isFunction(o.ui.specifics.beforeSave)&&(t=o.ui.specifics.beforeSave(r,n)),i=function(){var t=null,i=0;r.isNew?(r.parentArgs.unshift(r.args),r.isNew=!1,i=r.parentArgs.length,angular.forEach(r.parentArgs,function(e,t){t=i-t,e._sequence=t})):$.extend(e,r.args),angular.isFunction(o.ui.specifics.afterSave)&&(t=o.ui.specifics.afterSave(r,n)),t&&t.then?t.then(function(){a.resolve()}):a.resolve()},r.container.form.$dirty&&l(),t&&t.then?t.then(i):i(),r.isNew=!1,s}})}]})}};return o.ui.specifics.parentArgs=n.scope.$eval(o.ui.args),o.ui.specifics.entity=n.scope.$eval(o.ui.model),n.scope.$watch(o.ui.args,function(e,t){e!==t&&(o.ui.specifics.parentArgs=e)}),angular.forEach(w,function(e,t){void 0===o.ui.specifics[t]&&(o.ui.specifics[t]=e)}),o.ui.specifics.setupSortableOptions&&(o.ui.specifics.sortableOptions=o.ui.specifics.setupSortableOptions()),"plugins"}}),e(function(e){var i={_content:{documents:{}},_plugin_group:{}};$.extend(e[23],{makeSellerDetails:function(e,t){t=u.alwaysObject(t);t.removedOrAdded;return function(t){var n=o.href("seller-info",{key:e.parent.key},{absolute:!0}),i=o.href("embed-seller-info",{key:e.parent.key},{absolute:!0}),r=u.url.handleProtocol(e.logo.serving_url);return t.seller=e,t.menu={},u.sideNav.setup(t.menu,"right_seller_details"),t.socialMeta={facebook:{u:n},twitter:{url:n,text:t.seller.name},pinterest:{url:n,media:r,description:t.seller.name},googleplus:{url:n},reddit:{url:n,title:t.seller.name},linkedin:{url:n,title:t.seller.name},tumblr:{url:n,name:t.seller.name}},t.displayShare=function(){return l.share(t.socialMeta,{src:i})},t.viewContent=function(e){s.open({templateUrl:"core/misc/content_view.html",controller:["$scope",function(t){t.plainText=!0,t.content=e}]})},t}({})},current:function(e){return e||(e={}),e.account=f.key,this.actions.read(e,{cache:"currentSeller",cacheType:"memory"})},viewProfileModal:function(t,n){n=u.alwaysObject(n),s.open({templateUrl:"seller/profile.html",popFrom:n.popFrom,inDirection:n.inDirection,outDirection:n.outDirection,noEscape:n.noEscape,controller:["$scope",function(i){i.$state.promise(function(){return e[23].actions.read({account:t,read_arguments:{_content:{}}},{disableUI:!1})},function(t,i){var r=i.data.entity;t.view=function(t,n){e[31].viewModal(t,{popFrom:u.clicks.realEventTarget(n.target)})},t.hideClose=n.hideClose,t.seller=r,t.sellerDetails=e[23].makeSellerDetails(t.seller,n.sellerDetails),t.search={results:[],pagination:e[31].paginate({kind:"31",args:{search:{ancestor:t.seller.key,filters:[{field:"state",operator:"IN",value:["published","indexed"]}],orders:[{field:"published_date",
operator:"desc"},{field:"key",operator:"desc"}]}},config:{normalizeEntity:!1},action:"search",complete:function(e){var n=e.data.entities;t.search.results.extend(n)}})},t.scrollEnd={loader:t.search.pagination},t.search.pagination.load(),t.close=function(){var e=t.$close();return e.then(n.afterClose||angular.noop),e}})}]})},manageModal:function(e){var r,o=t.getActionArguments(this.kind,"update");o._content.ui.label=!1,o._plugin_group.ui.label=!1,$.extend(o._content.modelclass.documents.ui,{label:!1,specifics:{listView:"content-list-view",listConfig:{perLine:1}}}),$.extend(o._plugin_group.modelclass.plugins.ui,{label:!1}),o.logo.ui.specifics={displayImageConfig:{size:240,defaultImage:"defaultLogo"}},r={kind:this.kind,action:"update",fields:_.toArray(o),toolbar:{submitNative:!0,titleEdit:"seller.settings",titleAdd:"seller.settings"},modalConfig:{inDirection:!1,outDirection:!1},excludeFields:["account","read_arguments"],argumentLoader:function(t){var n=this.defaultArgumentLoader(t);return n.account=e,null===n._content&&(n._content={kind:"21",documents:[]}),n.read_arguments=i,n},scope:{layouts:{groups:[{label:!1,fields:["name","logo"]},{label:h.subheaders.sellerContents,fields:["_content"]},{label:h.subheaders.sellerPlugins,fields:["_plugin_group"]}]}}},n.create(r).read({},{account:e,read_arguments:i})}})})}])}(),function(){"use strict";angular.module("app").controller("AdminListController",["$scope","models","$stateParams","GLOBAL_CONFIG","searchBuilder","$state","helpers",function(e,t,n,i,r,o,a){var s=n.kind,c=null,l={},u=i.admin.listViewDirective[s];try{c=a.url.jsonFromUrlsafe(n.query),c.search.t&&delete c.search.t,l=c}catch(d){}e.config={titles:i.admin.listTitles,kind:s},e.maybeTemplate=u===!0?"admin/list_view/"+s+".html":u,e.setPageToolbarTitle("admin."+e.config.titles[s]),e.manage=function(e,n){t[s].adminManageModal(e,{popFrom:a.clicks.realEventTarget(n.target)})},e.search=r.create(),$.extend(e.search,{doSearch:function(){this.send.t=(new Date).getTime(),o.go("admin-list",{kind:this.kind,query:a.url.jsonToUrlsafe({search:this.send})})},results:[],pagination:t[s].paginate({args:l,kind:s,complete:function(t){e.search.results.extend(t.data.entities)}})}),e.search.kind=s,c||(c=e.search.pagination.args),e.search.changeKindUI(),c&&e.search.setSearch(s,c.search),e.scrollEnd={loader:e.search.pagination},e.search.pagination.load()}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","GLOBAL_CONFIG",function(e,t){e.state("home",{url:"/",templateUrl:"home/index.html",controller:"HomePageController"}).state("following",{url:"/following",templateUrl:"home/index.html",controller:"HomePageController"}).state("seller-info",{url:"/seller/:key",controller:"SellerInfo",template:""}).state("embed-seller-info",{url:"/embed/seller/:key",controller:"SellerEmbedInfo",template:""}).state("catalog-view",{url:"/catalog/:key",controller:"CatalogViewController",template:""}).state("catalog-product-add-to-cart",{url:"/catalog/:key/product-add-to-cart/:image_id/:pricetag_id/:variant/:quantity",controller:"CatalogProductAddToCartController",template:""}).state("embed-catalog-product-add-to-cart",{url:"/embed/catalog/:key/product-add-to-cart/:image_id/:pricetag_id/:variant/:quantity",controller:"CatalogProductAddToCartController",template:""}).state("catalog-order-view",{url:"/catalog/:key/order/view",controller:"CatalogOrderViewController",template:""}).state("embed-catalog-order-view",{url:"/embed/catalog/:key/order/view",controller:"CatalogOrderViewController",template:""}).state("catalog-product-view",{url:"/catalog/:key/product/:image_id/:pricetag_id",controller:"CatalogProductViewController",template:""}).state("catalog-product-variant-view",{url:"/catalog/:key/product/:image_id/:pricetag_id/:variant",controller:"CatalogProductVariantViewController",template:""}).state("embed-catalog-view",{url:"/embed/catalog/:key",controller:"EmbedCatalogViewController",template:""}).state("embed-seller-view",{url:"/embed/seller/:key",controller:"EmbedSellerViewController",template:""}).state("embed-catalog-product-variant-view",{url:"/embed/catalog/:key/product/:image_id/:pricetag_id/:variant",controller:"EmbedCatalogProductVariantViewController",template:""}).state("embed-catalog-product-view",{url:"/embed/catalog/:key/product/:image_id/:pricetag_id",controller:"EmbedCatalogProductViewController",template:""}).state("sell-catalogs",{url:"/sell/catalogs",controller:"SellCatalogsController",templateUrl:"catalog/list.html"}).state("sell-orders",{url:"/sell/orders",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("sell-carts",{url:"/sell/carts",controller:"SellOrdersController",templateUrl:"order/list.html"}).state("buy-orders",{url:"/buy/orders",controller:"BuyOrdersController",templateUrl:"order/list.html"}).state("buy-carts",{url:"/buy/carts",controller:"BuyOrdersController",templateUrl:"buyer/carts.html"}).state("login",{url:"/api/account/login/:provider",template:""}).state("login-provider-connected",{url:"/login_provider_connected/:provider",controller:"LoginProviderConnectedController",template:""}).state("order-payment-canceled",{url:"/order/payment/canceled/:key",controller:"BuyOrdersController",templateUrl:"buyer/carts.html"}).state("order-payment-success",{url:"/order/payment/success/:key",controller:"BuyOrdersController",templateUrl:"buyer/carts.html"}).state("order-view",{url:"/order/:key",controller:"OrderViewController",template:""}).state("login-status",{url:"/login/status",template:"",controller:"AccountLoginStatusController"}).state("order-notify",{url:"/api/order/notify/:method",template:""}).state("about",{url:"/about",controller:"AboutController",templateUrl:"home/about.html"}).state("tos",{url:"/tos",title:"tos",templateUrl:"home/tos.html"}).state("support",{url:"/support",title:"support",templateUrl:"home/support.html"}).state("acceptable_use_policy",{url:"/acceptable_use_policy",title:"acceptable_use_policy",templateUrl:"home/acceptable_use_policy.html"}).state("privacy_policy",{url:"/privacy_policy",title:"privacy_policy",templateUrl:"home/privacy_policy.html"}).state("copyright_policy",{url:"/copyright_policy",title:"copyright_policy",templateUrl:"home/copyright_policy.html"}).state("admin-list",{url:"/admin/list/:kind/:query",templateUrl:function(e){var n,i="admin/list.html";return void 0!==e.kind&&(n=t.admin.listTemplates[e.kind],n&&n.templateUrl&&(i=n.templateUrl)),i},controller:"AdminListController"})}]).run(["$rootScope","modelsInfo","$state","endpoint","models","currentAccount","GLOBAL_CONFIG","modelsUtil","$animate",function(e,t,n,i,r,o,a,s,c){e.$on("$stateChangeSuccess",function(t,i,r,o,a){i.title&&e.setPageToolbarTitle(i.title),window.ga&&window.ga("send","pageview",n.href(i,r))}),$.extend(t,window.MODELS_META),$.extend(o,window.CURRENT_ACCOUNT),s.normalize(o),r.init(),a.debug||(delete window.MODELS_META,delete window.CURRENT_ACCOUNT)}])}();